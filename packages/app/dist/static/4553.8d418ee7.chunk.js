"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([["4553"],{56420(e,t,r){r.d(t,{Y:()=>F});var a=r(31085),i=r(54290),n=r(96170),s=r(96814),l=r(77125),o=r(64947),u=r(93453),c=r(29365),d=r(46423),p=r(5951),f=r(26343),m=r(28233),h=r(55197),g=r(58837),v=r(72501),y=r(5893),b=r(14041);r(45250);var x=r(70209),j=r(92483),A=r(75202),k=r(89475),E=r(47250);let w=(0,g.A)({popoverList:{minWidth:260,maxWidth:400},menuItem:{whiteSpace:"normal"}},{name:"BackstageSupportButton"}),C=({icon:e})=>{let t=(0,i.n)(),r=e?t.getSystemIcon(e)??j.NT:j.NT;return(0,a.jsx)(r,{})},S=({link:e})=>(0,a.jsx)(A.N_,{to:e.url,children:e.title??e.url}),I=({item:e})=>(0,a.jsxs)(f.A,{button:!1,children:[(0,a.jsx)(d.A,{children:(0,a.jsx)(C,{icon:e.icon})}),(0,a.jsx)(p.A,{primary:e.title,secondary:e.links?.reduce((e,t,r)=>[...e,r>0&&(0,a.jsx)("br",{},r),(0,a.jsx)(S,{link:t},t.url)],[])})]});function F(e){let{t}=(0,E.i)(k.O),{title:r,items:i,children:d}=e,{items:p}=(0,x.l)(),[g,A]=(0,b.useState)(!1),[C,S]=(0,b.useState)(null),F=w(),N=(0,n.gf)(s.U).getOptionalConfig("app.support"),O=(0,y.A)(e=>e.breakpoints.down("sm")),P=e=>{S(e.currentTarget),A(!0)},$=()=>{A(!1)};return N?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.A,{display:"flex",ml:1,children:O?(0,a.jsx)(c.A,{color:"primary",size:"small",onClick:P,"data-testid":"support-button","aria-label":"Support",children:(0,a.jsx)(j.NT,{})}):(0,a.jsx)(o.A,{"data-testid":"support-button","aria-label":"Support",color:"primary",onClick:P,startIcon:(0,a.jsx)(j.NT,{}),children:t("supportButton.title")})}),(0,a.jsxs)(h.Ay,{"data-testid":"support-button-popover",open:g,anchorEl:C,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:$,children:[(0,a.jsxs)(m.A,{className:F.popoverList,autoFocusItem:!!C,children:[r&&(0,a.jsx)(f.A,{button:!1,alignItems:"flex-start",className:F.menuItem,children:(0,a.jsx)(v.A,{variant:"subtitle1",children:r})}),b.Children.map(d,(e,t)=>(0,a.jsx)(f.A,{button:!1,alignItems:"flex-start",className:F.menuItem,children:e},`child-${t}`)),(i??p).map((e,t)=>(0,a.jsx)(I,{item:e},`item-${t}`))]}),(0,a.jsx)(u.A,{children:(0,a.jsx)(o.A,{color:"primary",onClick:$,"aria-label":"Close",children:t("supportButton.close")})})]})]}):null}},57101(e,t,r){r.d(t,{Q:()=>k});var a=r(31085),i=r(77125),n=r(72501),s=r(4321),l=r(87263),o=r(16249),u=r(33145),c=r(58837),d=r(7031),p=r(99703),f=r(6924),m=r(98312),h=r(14041),g=r(45250),v=r(53373),y=r.n(v);let b=(0,c.A)(e=>({root:{margin:e.spacing(1,0)},label:{position:"relative",fontWeight:"bold",fontSize:e.typography.body2.fontSize,fontFamily:e.typography.fontFamily,color:e.palette.text.primary,"& > span":{top:0,left:0,position:"absolute"}}}),{name:"BackstageAutocomplete"}),x=(0,d.A)(e=>(0,p.A)({root:{},paper:{margin:0},hasClearIcon:{},hasPopupIcon:{},focused:{},inputRoot:{marginTop:24,backgroundColor:e.palette.background.paper,"$root$hasClearIcon$hasPopupIcon &":{paddingBlock:e.spacing(.75),paddingInlineStart:e.spacing(.75)},"$root$focused &":{outline:"none"},"$root &:hover > fieldset":{borderColor:"#ced4da"},"$root$focused & > fieldset":{borderWidth:1,borderColor:e.palette.primary.main}},popupIndicator:{padding:0,margin:0,color:"#616161","&:hover":{backgroundColor:"unset"},'& [class*="MuiTouchRipple-root"]':{display:"none"}},endAdornment:{"$root$hasClearIcon$hasPopupIcon &":{right:4}},input:{"$root$hasClearIcon$hasPopupIcon &":{fontSize:e.typography.body1.fontSize,paddingBlock:e.spacing(.8125)}}}),{name:"BackstageAutocompleteBase"})(m.Ay),j=e=>(0,a.jsx)(l.A,{...e,transition:!0,placement:"bottom-start",children:({TransitionProps:t})=>(0,a.jsx)(u.A,{...t,style:{transformOrigin:"0 0 0"},children:(0,a.jsx)(i.A,{children:e.children})})}),A=e=>(0,a.jsx)(s.A,{...e,elevation:8});function k(e){let{label:t,name:r,LabelProps:s,TextFieldProps:l,...u}=e,c=b(),d=(0,h.useCallback)(e=>(0,a.jsx)(o.A,{...(0,g.merge)(e,l),variant:"outlined"}),[l]),p=(0,a.jsx)(x,{size:"small",...u,renderInput:u.renderInput??d,popupIcon:(0,a.jsx)(f.default,{"data-testid":`${r}-expand`}),PaperComponent:A,PopperComponent:j});return(0,a.jsx)(i.A,{className:c.root,children:t?(0,a.jsxs)(n.A,{...s,className:y()(c.label,s?.className),component:"label",children:[(0,a.jsx)(i.A,{component:"span",children:t}),p]}):p})}},77509(e,t,r){r.d(t,{GI:()=>h});var a=r(31085),i=r(14041),n=r(77125),s=r(64947),l=r(73845),o=r(42899),u=r(72501),c=r(5893),d=r(54917),p=r(65859),f=r(80084),m=r(47250);let h=e=>(0,a.jsx)(o.A,{container:!0,style:{position:"relative"},children:e.children});h.Filters=e=>{let t=(0,c.A)(t=>t.breakpoints.down(e.options?.drawerBreakpoint??"md"),{noSsr:!0}),r=(0,d.A)(),[h,g]=(0,i.useState)(!1),{t:v}=(0,m.i)(f.j);return t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.A,{style:{marginTop:r.spacing(1),marginLeft:r.spacing(1)},onClick:()=>g(!0),startIcon:(0,a.jsx)(p.default,{}),children:v("catalogFilter.buttonTitle")}),(0,a.jsx)(l.Ay,{open:h,onClose:()=>g(!1),anchor:e.options?.drawerAnchor??"left",disableAutoFocus:!0,keepMounted:!0,variant:"temporary",children:(0,a.jsxs)(n.A,{m:2,children:[(0,a.jsx)(u.A,{variant:"h6",component:"h2",style:{marginBottom:r.spacing(1)},children:v("catalogFilter.title")}),e.children]})})]}):(0,a.jsx)(o.A,{item:!0,lg:2,children:e.children})},h.Content=e=>(0,a.jsx)(o.A,{item:!0,xs:12,lg:10,children:e.children})},84817(e,t,r){r.d(t,{y:()=>k});var a=r(31085),i=r(77125),n=r(58837),s=r(14041),l=r(96170),o=r(73466),u=r(30043),c=r(98552),d=r(86901),p=r(44148),f=r(41260);let m=(0,a.jsx)(f.default,{fontSize:"small"}),h=(0,a.jsx)(p.default,{fontSize:"small"});function g({selected:e}){return(0,a.jsx)(c.A,{icon:m,checkedIcon:h,checked:e})}let v=(0,s.memo)(e=>{let{selected:t,value:r,availableOptions:i,showCounts:n}=e,s=n?`${r} (${i?.[r]})`:r;return(0,a.jsx)(d.A,{control:(0,a.jsx)(g,{selected:t}),label:s,onClick:e=>e.preventDefault()})});var y=r(18453),b=r(15998),x=r(57101),j=r(45250);let A=(0,n.A)({root:{},label:{textTransform:"none",fontWeight:"bold"}},{name:"CatalogReactEntityAutocompletePicker"});function k(e){let{label:t,name:r,path:n,showCounts:c,Filter:d,InputProps:p,initialSelectedOptions:f=[],filtersForAvailableValues:m=["kind"],hidden:h}=e,g=A(),{updateFilters:k,filters:E,queryParameters:{[r]:w}}=(0,y.nK)(),C=(0,l.gf)(u.v),S=m.map(e=>E[e]),{value:I}=(0,o.A)(async()=>{let{facets:e}=await C.getEntityFacets({facets:[n],filter:(0,b.Rr)(S.filter(Boolean))});return Object.fromEntries(e[n].map(({value:e,count:t})=>[e,t]))},[...S]),F=(0,s.useMemo)(()=>[w].flat().filter(Boolean),[w]),N=E[r]?.values,[O,P]=(0,s.useState)(F.length?F:N??f);(0,s.useEffect)(()=>{F.length&&P(F)},[F]);let $=Object.keys(I??{}),L=O.length&&$.length;(0,s.useEffect)(()=>{k({[r]:L?new d(O):void 0})},[r,L,O,d,k]),(0,s.useEffect)(()=>{if(!L)return;let e=N??[];(0,j.isEqual)(e,O)||P(e)},[N]);let T=E[r];return(!T||"object"!=typeof T||"values"in T)&&$.length?h?null:(0,a.jsx)(i.A,{className:g.root,pb:1,pt:1,children:(0,a.jsx)(x.Q,{multiple:!0,disableCloseOnSelect:!0,label:t,name:`${String(r)}-picker`,options:$,value:O,TextFieldProps:p,onChange:(e,t)=>P(t),renderOption:(e,{selected:t})=>(0,a.jsx)(v,{selected:t,value:e,availableOptions:I,showCounts:!!c})})}):null}},46923(e,t,r){r.d(t,{t:()=>L});var a=r(31085),i=r(78560),n=r(77125),s=r(98552),l=r(86901),o=r(72501),u=r(71677),c=r(58837),d=r(7031),p=r(44148),f=r(41260),m=r(14041),h=r(18453),g=r(49724),v=r(16261),y=r(48108),b=r(47966),x=r(53318),j=r(96170),A=r(87290),k=r(30043),E=r(76842);r(46123);var w=r(27849);r(96403);var C=r(80084),S=r(47250),I=r(57101);let F=(0,c.A)({root:{},label:{},input:{},fullWidth:{width:"100%"},boxLabel:{width:"100%",textOverflow:"ellipsis",overflow:"hidden"}},{name:"CatalogReactEntityOwnerPicker"}),N=(0,d.A)(e=>({label:{width:"100%"},root:{width:"90%"}}),{name:"FixedWidthFormControlLabel"})(l.A),O=(0,a.jsx)(f.default,{fontSize:"small"}),P=(0,a.jsx)(p.default,{fontSize:"small"});function $(e){let t=F(),r="group"===e.entity.kind.toLocaleLowerCase("en-US"),{primaryTitle:i}=(0,w.f)(e.entity);return(0,a.jsx)(n.A,{className:t.fullWidth,children:(0,a.jsx)(N,{className:t.fullWidth,control:(0,a.jsx)(s.A,{icon:O,checkedIcon:P,checked:e.isSelected}),onClick:e=>e.preventDefault(),label:(0,a.jsx)(u.Ay,{title:i,children:(0,a.jsxs)(n.A,{display:"flex",alignItems:"center",children:[r?(0,a.jsx)(b.default,{fontSize:"small"}):(0,a.jsx)(y.default,{fontSize:"small"}),"\xa0",(0,a.jsx)(n.A,{className:t.boxLabel,children:(0,a.jsx)(o.A,{noWrap:!0,children:i})})]})})})})}let L=e=>{let t=F(),{mode:r="owners-only"}=e||{},{updateFilters:s,filters:l,queryParameters:{owners:o}}=(0,h.nK)(),[u,c]=(0,m.useState)(""),{t:d}=(0,S.i)(C.j),p=(0,m.useMemo)(()=>[o].flat().filter(Boolean),[o]),[f,y]=(0,m.useState)(p.length?p:l.owners?.values??[]),[{value:b,loading:w},N,O]=function({mode:e,initialSelectedOwnersRefs:t}){let r,a="owners-only"===e,n=(r=(0,j.gf)(k.v),(0,A.A)(async(e,t)=>{let a=t?.limit??20;if(e.cursor){let t=await r.queryEntities({cursor:e.cursor,limit:a});return{cursor:t.pageInfo.nextCursor,items:[...e.items,...t.items]}}let i=await r.queryEntities({fullTextFilter:{term:e.text||"",fields:["metadata.name","kind","spec.profile.displayname","metadata.title"]},filter:{kind:["User","Group"]},orderFields:[{field:"metadata.name",order:"asc"}],limit:a});return{cursor:i.pageInfo.nextCursor,items:i.items}},[],{loading:!0})),s=function({enabled:e}){let t=(0,j.gf)(k.v),[r]=(0,m.useState)(async()=>{if(!e)return[];let r="relations.ownedBy";return t.getEntityFacets({facets:[r]}).then(e=>e.facets[r].map(e=>e.value).map(e=>{let{kind:t,name:r,namespace:a}=(0,i.KU)(e);return{apiVersion:"backstage.io/v1beta1",kind:t,metadata:{name:r,namespace:a}}}).sort((e,t)=>e.kind.localeCompare(t.kind,"en-US")||e.metadata.namespace.localeCompare(t.metadata.namespace,"en-US")||e.metadata.name.localeCompare(t.metadata.name,"en-US"))).catch(()=>[])});return(0,A.A)(async(e,t)=>{var a;let i=await r;if(!i)return{items:[]};let n=t?.limit??20,{text:s,start:l}=(a=e).cursor&&a.cursor?JSON.parse(atob(a.cursor)):{text:a.text||"",start:0},o=i.filter(e=>{var t,r;let a;return t=s,r=e,a=t.trim(),r.kind.includes(a)||r.metadata.namespace?.includes(a)||r.metadata.name.includes(a)}),u=l+n;return{items:o.slice(0,u),...function({entities:e,limit:t,payload:r}){return e.length>t?{cursor:btoa(JSON.stringify(r))}:{}}({entities:o,limit:u,payload:{text:s,start:u}})}},[r],{loading:!0,value:{items:[]}})}({enabled:a}),[l,o]=a?s:n;return[l,o,function({enabled:e,initialSelectedOwnersRefs:t}){let r=(0,m.useRef)({}),a=(0,j.gf)(k.v),[,n]=(0,A.A)(async()=>{(await a.getEntitiesByRefs({entityRefs:t})).items.forEach(e=>{e&&(r.current[(0,i.U2)(e)]=e)})},[]);return(0,E.u)(()=>{e&&t.length>0&&n()}),{getEntity:e=>r.current[e],setEntity:e=>{r.current[(0,i.U2)(e)]=e}}}({enabled:!a,initialSelectedOwnersRefs:t})]}({mode:r,initialSelectedOwnersRefs:f});!function(e,t,r,a=0){(0,m.useEffect)(function(e,t,r,a=0){let i,n=(0,m.useRef)(),s=(0,m.useRef)(),l=(0,m.useRef)(e),o=(0,m.useRef)(),u=()=>{n.current&&(clearTimeout(n.current),n.current=void 0),s.current&&(clearTimeout(s.current),s.current=void 0)};return i=(0,v.J)(u),(0,m.useEffect)(()=>()=>{i.current()},[]),(0,m.useEffect)(()=>{l.current=e},t),(0,m.useMemo)(()=>{let t=()=>{if(u(),!o.current)return;let e=o.current;o.current=void 0,l.current.apply(e.this,e.args)},r=function(...e){n.current&&clearTimeout(n.current),o.current={args:e,this:this},n.current=setTimeout(t,250),a>0&&!s.current&&(s.current=setTimeout(t,a))};return Object.defineProperties(r,{length:{value:e.length},name:{value:`${e.name||"anonymous"}__debounced__${250}`}}),r},[250,a,...t])}(e,t,250,a),t)}(()=>N({text:u.toLocaleLowerCase("en-US")}),[u,N],0);let P=b?.items||[];return((0,m.useEffect)(()=>{p.length&&y(new g.N9(p).values)},[p]),(0,m.useEffect)(()=>{s({owners:f.length?new g.N9(f):void 0})},[f,s]),["user","group"].includes(l.kind?.value.toLocaleLowerCase("en-US")||""))?null:(0,a.jsx)(n.A,{className:t.root,pb:1,pt:1,children:(0,a.jsx)(I.Q,{label:d("entityOwnerPicker.title"),multiple:!0,disableCloseOnSelect:!0,loading:w,options:P,value:f,getOptionSelected:(e,t)=>"string"==typeof t?(0,i.U2)(e)===t:e===t,getOptionLabel:e=>{let t="string"==typeof e?O.getEntity(e)||(0,i.KU)(e,{defaultKind:"group",defaultNamespace:"default"}):e;return(0,x.Z)(t,(0,x.S)(t))},onChange:(e,t)=>{c(""),y(t.map(e=>{let t="string"==typeof e?e:(0,i.U2)(e);return"string"!=typeof e&&O.setEntity(e),t}))},filterOptions:e=>e,renderOption:(e,{selected:t})=>(0,a.jsx)($,{entity:e,isSelected:t}),name:"owner-picker",onInputChange:(e,t)=>{c(t)},ListboxProps:{onScroll:e=>{let t=e.currentTarget;1>Math.abs(t.scrollHeight-t.clientHeight-t.scrollTop)&&b?.cursor&&N({items:b.items,cursor:b.cursor})},"data-testid":"owner-picker-listbox"},LabelProps:{className:t.label},TextFieldProps:{className:t.input}})})}},56829(e,t,r){r.d(t,{m:()=>c});var a=r(31085),i=r(58837),n=r(49724),s=r(84817),l=r(80084),o=r(47250);let u=(0,i.A)({input:{}},{name:"CatalogReactEntityTagPicker"}),c=e=>{let t=u(),{t:r}=(0,o.i)(l.j);return(0,a.jsx)(s.y,{label:r("entityTagPicker.title"),name:"tags",path:"metadata.tags",Filter:n.q_,showCounts:e.showCounts,InputProps:{className:t.input},initialSelectedOptions:e.initialFilter?e.initialFilter:[],hidden:e.hidden})}},75303(e,t,r){r.d(t,{y:()=>L});var a=r(31085),i=r(96170),n=r(96814),s=r(40703),l=r(58007),o=r(46423),u=r(65569),c=r(5951),d=r(26343),p=r(72501),f=r(58837),m=r(9684),h=r(92483),g=r(14041),v=r(49724),y=r(18453);r(46343),r(40074),r(46123),r(96403);var b=r(79890),x=r(45250),j=r(73466),A=r(30043),k=r(15998),E=r(87290);let w=function(e,t,r){var a=(0,g.useRef)(void 0);a.current&&r(t,a.current)||(a.current=t),(0,g.useEffect)(e,a.current)};var C=r(56307);let S=r.n(C)(),I=function(e,t){w(e,t,S)};var F=r(78560),N=r(44861),O=r(47250),P=r(80084);let $=(0,f.A)(e=>({root:{backgroundColor:"rgba(0, 0, 0, .11)",boxShadow:"none",margin:e.spacing(1,0,1,0)},title:{margin:e.spacing(1,0,0,1),textTransform:"uppercase",fontSize:12,fontWeight:"bold"},listIcon:{minWidth:30,color:e.palette.text.primary},menuItem:{minHeight:e.spacing(6)},groupWrapper:{margin:e.spacing(1,1,2,1)}}),{name:"CatalogReactUserListPicker"}),L=e=>{let{initialFilter:t,availableFilters:r,hidden:f,alwaysKeepFilters:w}=e,C=$(),S=(0,i.gf)(n.U),{t:L}=(0,O.i)(P.j),T=S.getOptionalString("organization.name")??L("userListPicker.defaultOrgName"),{filters:U,updateFilters:z,queryParameters:{kind:B,user:R}}=(0,y.nK)(),q=["starred","all"],M=[{name:L("userListPicker.personalFilter.title"),items:[{id:"owned",label:L("userListPicker.personalFilter.ownedLabel"),icon:m.default},{id:"starred",label:L("userListPicker.personalFilter.starredLabel"),icon:h.Gg}]},{name:T,items:[{id:"all",label:L("userListPicker.orgFilterAllLabel")}]}].map(e=>({...e,items:e.items.filter(({id:e})=>["group","user"].some(e=>e===B)?q.includes(e):!r||r.includes(e))})).filter(({items:e})=>!!e.length),{count:V,loading:K,filter:Q}=function(){let e=(0,i.gf)(b.K),t=(0,i.gf)(A.v),{filters:r}=(0,y.nK)(),{value:a,loading:n}=(0,j.A)(async()=>(await e.getBackstageIdentity()).ownershipEntityRefs,[]),{user:s,owners:l,...o}=r,{orderFields:u,...c}=(0,k.$3)((0,x.compact)(Object.values(o))),[{value:d,loading:p},f]=(0,E.A)(async e=>{let r=function(e,t){if(void 0===t)return;let r=e?.values??[];if(r.length){let e=(0,x.intersection)(r,t);if(0===e.length)return;return e}return t}(e.owners,e.ownershipEntityRefs);if(void 0===r)return 0;let{"metadata.name":a,...i}=e.filter.filter,{totalItems:n}=await t.queryEntities({...e.filter,filter:{...i,"relations.ownedBy":r},limit:0});return n},[],{loading:!0});return I(()=>{0===Object.keys(c.filter).length||void 0!==a&&f({ownershipEntityRefs:a,owners:l,filter:c})},[a,l,c]),{count:d,loading:n||p,filter:(0,g.useMemo)(()=>v.tN.owned(a??[]),[a]),ownershipEntityRefs:a}}(),{count:W}=function(){let e=(0,i.gf)(A.v),{filters:t}=(0,y.nK)(),r=(0,g.useRef)(),a=(0,g.useMemo)(()=>{let{user:e,...a}=t,i=(0,x.compact)(Object.values(a)),{orderFields:n,...s}=(0,k.$3)(i),l={...s,limit:0};return 0===Object.keys(s.filter).length?(r.current=void 0,r.current):(0,x.isEqual)(l,r.current)?r.current:(r.current=l,l)},[t]),{value:n,loading:s}=(0,j.A)(async()=>{if(void 0===a)return 0;let{totalItems:t}=await e.queryEntities(a);return t},[a]);return{count:n,loading:s}}(),{count:_,filter:H,loading:G}=function(){let e=(0,i.gf)(A.v),{filters:t}=(0,y.nK)(),{starredEntities:r}=(0,N.I)(),a=(0,g.useRef)(),n=(0,g.useMemo)(()=>{let{user:e,...i}=t,n=(0,x.compact)(Object.values(i)),{orderFields:s,...l}=(0,k.$3)(n),o={...l,filter:{...l.filter,"metadata.name":Array.from(r).map(e=>(0,F.KU)(e).name)},limit:1e3};return(0,x.isEqual)(o,a.current)?a.current:(a.current=o,o)},[t,r]),{value:s,loading:l}=(0,j.A)(async()=>r.size?(await e.queryEntities(n)).items.map(e=>(0,F.U2)({kind:e.kind,namespace:e.metadata.namespace,name:e.metadata.name})).filter(e=>r.has(e)).length:0,[n,r]);return{count:s,loading:l,filter:(0,g.useMemo)(()=>v.tN.starred(Array.from(r)),[r])}}(),J=(0,g.useMemo)(()=>[R].flat()[0],[R]),[Z,D]=(0,g.useState)(J??t),Y=(0,g.useMemo)(()=>({all:W,starred:_,owned:V}),[_,V,W]);(0,g.useEffect)(()=>{J&&D(J)},[J]);let X=K||G;return(0,g.useEffect)(()=>{X||!Z||"all"===Z||0!==Y[Z]||w||D("all")},[X,Y,Z,D,w]),(0,g.useEffect)(()=>{!Z||X||z({user:"owned"===Z?Q:"starred"===Z?H:v.tN.all()})},[Z,H,Q,z,X]),f?null:(0,a.jsx)(s.A,{className:C.root,children:M.map(e=>(0,a.jsxs)(g.Fragment,{children:[(0,a.jsx)(p.A,{variant:"subtitle2",component:"span",className:C.title,children:e.name}),(0,a.jsx)(s.A,{className:C.groupWrapper,children:(0,a.jsx)(l.A,{disablePadding:!0,dense:!0,role:"menu","aria-label":e.name,children:e.items.map((t,r)=>(0,a.jsxs)(d.A,{role:"none presentation",divider:r!==e.items.length-1,onClick:()=>D(t.id),selected:t.id===U.user?.value,className:C.menuItem,disabled:0===Y[t.id],"data-testid":`user-picker-${t.id}`,tabIndex:0,ContainerProps:{role:"menuitem"},children:[t.icon&&(0,a.jsx)(o.A,{className:C.listIcon,children:(0,a.jsx)(t.icon,{fontSize:"small"})}),(0,a.jsx)(c.A,{children:(0,a.jsxs)(p.A,{variant:"body1",children:[t.label," "]})}),(0,a.jsx)(u.A,{children:Y[t.id]??"-"})]},t.id))})})]},e.name))})}},49724(e,t,r){r.d(t,{I5:()=>d,Kf:()=>h,N9:()=>c,V3:()=>u,gM:()=>s,gZ:()=>m,mT:()=>g,qA:()=>l,q_:()=>o,tN:()=>f,z:()=>p});var a=r(78560),i=r(97214),n=r(699);class s{value;label;constructor(e,t){this.value=e,this.label=t}getCatalogFilters(){return{kind:this.value}}toQueryValue(){return this.value}}class l{value;constructor(e){this.value=e}getTypes(){return Array.isArray(this.value)?this.value:[this.value]}getCatalogFilters(){return{"spec.type":this.getTypes()}}toQueryValue(){return this.getTypes()}}class o{values;constructor(e){this.values=e}filterEntity(e){return this.values.every(t=>(e.metadata.tags??[]).includes(t))}getCatalogFilters(){return{"metadata.tags":this.values}}toQueryValue(){return this.values}}class u{value;constructor(e){this.value=e}filterEntity(e){let t=this.toUpperArray(this.value.split(/\s/)),r=this.toUpperArray([e.metadata.tags]),a=this.toUpperArray([e.metadata.name,e.metadata.title,e.spec?.profile?.displayName]);for(let e of t)if(r.every(t=>t!==e)&&a.every(t=>!t.includes(e)))return!1;return!0}getFullTextFilters(){return{term:this.value,fields:["metadata.name","metadata.title","spec.profile.displayName"]}}toQueryValue(){return this.value}toUpperArray(e){return e.flat().filter(e=>!!e).map(e=>e.toLocaleUpperCase("en-US"))}}class c{values;constructor(e){this.values=e.reduce((e,t)=>{try{return e.push((0,a.U2)((0,a.KU)(t,{defaultKind:"Group"}))),e}catch(t){return e}},[])}getCatalogFilters(){return{"relations.ownedBy":this.values}}filterEntity(e){return this.values.some(t=>(0,n.t)(e,i.vv).some(e=>(0,a.U2)(e)===t))}toQueryValue(){return this.values}}class d{values;constructor(e){this.values=e}getCatalogFilters(){return{"spec.lifecycle":this.values}}filterEntity(e){return this.values.some(t=>e.spec?.lifecycle===t)}toQueryValue(){return this.values}}class p{values;constructor(e){this.values=e}getCatalogFilters(){return{"metadata.namespace":this.values}}filterEntity(e){return this.values.some(t=>e.metadata.namespace===t)}toQueryValue(){return this.values}}class f{value;refs;constructor(e,t){this.value=e,this.refs=t}static owned(e){return new f("owned",e)}static all(){return new f("all")}static starred(e){return new f("starred",e)}getCatalogFilters(){return"owned"===this.value?{"relations.ownedBy":this.refs??[]}:"starred"===this.value?{"metadata.name":this.refs?.map(e=>(0,a.KU)(e).name)??[]}:{}}filterEntity(e){if("starred"===this.value)return this.refs?.includes((0,a.U2)(e))??!0;if("owned"===this.value){let t=(0,n.t)(e,i.vv);return this.refs?.some(e=>t.some(t=>(0,a.U2)(t)===e))??!1}return!0}toQueryValue(){return this.value}}class m{value;isOwnedEntity;isStarredEntity;constructor(e,t,r){this.value=e,this.isOwnedEntity=t,this.isStarredEntity=r}filterEntity(e){switch(this.value){case"owned":return this.isOwnedEntity(e);case"starred":return this.isStarredEntity(e);default:return!0}}toQueryValue(){return this.value}}class h{value;constructor(e){this.value=e}getCatalogFilters(){return this.value?{"metadata.annotations.backstage.io/orphan":String(this.value)}:{}}filterEntity(e){let t=e.metadata.annotations?.["backstage.io/orphan"];return void 0!==t&&this.value.toString()===t}}class g{value;constructor(e){this.value=e}filterEntity(e){let t=e?.status?.items?.length>0;return void 0!==t&&this.value===t}}},18453(e,t,r){r.d(t,{B9:()=>b,nK:()=>x});var a=r(31085),i=r(96170),n=r(54852),s=r(4790),l=r(45250),o=r(45810),u=r.n(o),c=r(14041),d=r(18690),p=r(87290),f=r(48240),m=r(71581),h=r(30043),g=r(15998);let v=(0,n.tK)("entity-list-context"),y=(0,c.createContext)(void 0),b=e=>{let t=(0,m.A)(),r=(0,i.gf)(h.v),[n,o]=(0,c.useState)({}),b=(0,d.zy)(),x=!0===e.pagination?"cursor":"object"==typeof e.pagination?e.pagination.mode??"cursor":"none",j="object"==typeof e.pagination?e.pagination.limit??20:20,{queryParameters:A,cursor:k,offset:E,limit:w}=(0,c.useMemo)(()=>{let e=u().parse(b.search,{ignoreQueryPrefix:!0}),t=j;if("string"==typeof e.limit){let r=Number.parseInt(e.limit,10);isNaN(r)||(t=r)}let r="string"==typeof e.offset&&"offset"===x?Number.parseInt(e.offset,10):void 0;return{queryParameters:e.filters??{},cursor:"string"==typeof e.cursor&&"cursor"===x?e.cursor:void 0,offset:"offset"===x&&r&&!isNaN(r)?r:void 0,limit:t}},[x,b.search,j]),[C,S]=(0,c.useState)(k),[I,F]=(0,c.useState)(E),[N,O]=(0,c.useState)(w),[P,$]=(0,c.useState)(()=>({appliedFilters:{},entities:[],backendEntities:[],pageInfo:{},offset:I,limit:N})),[{value:L,loading:T,error:U},z]=(0,p.A)(async()=>{let e=n.kind?.value?.toLocaleLowerCase("en-US"),t="user"===e||"group"===e?{...n,owners:void 0}:n,a=(0,l.compact)(Object.values(t)),i=(0,g.be)(a);if("none"!==x){if(C){if(C!==P.appliedCursor){let e=await r.queryEntities({cursor:C,limit:N});return{appliedFilters:n,appliedCursor:C,backendEntities:e.items,entities:e.items.filter(i),pageInfo:e.pageInfo,totalItems:e.totalItems}}let e=P.backendEntities.filter(i);return{appliedFilters:n,appliedCursor:P.appliedCursor,backendEntities:P.backendEntities,entities:e,pageInfo:P.pageInfo,totalItems:P.totalItems,limit:P.limit,offset:P.offset}}let e=(0,g.$3)(a),t=(0,g.$3)((0,l.compact)(Object.values(P.appliedFilters)));if("offset"===x&&(P.limit!==N||P.offset!==I)||!(0,l.isEqual)(t,e)){let t=await r.queryEntities({...e,limit:N,offset:I});return{appliedFilters:n,backendEntities:t.items,entities:t.items.filter(i),pageInfo:t.pageInfo,totalItems:t.totalItems,limit:N,offset:I}}let s=P.backendEntities.filter(i);return{appliedFilters:n,backendEntities:P.backendEntities,entities:s,pageInfo:P.pageInfo,totalItems:P.totalItems,limit:P.limit,offset:P.offset}}let s=(0,g.Rr)(a),{orderFields:o}=(0,g.$3)(a),u=(0,g.Rr)((0,l.compact)(Object.values(P.appliedFilters)));if(!(0,l.isEqual)(u,s)){let e=await r.getEntities({filter:s,order:o}),t=e.items.filter(i);return{appliedFilters:n,backendEntities:e.items,entities:t,totalItems:t.length}}let c=P.backendEntities.filter(i);return{appliedFilters:n,backendEntities:P.backendEntities,entities:c,totalItems:c.length}},[r,A,n,P,C,x,N,I],{loading:!0});(0,f.A)(z,10,[n,C,N,I]),(0,c.useEffect)(()=>{if(void 0!==L&&($(L),t())){let e=Object.keys(n).reduce((e,t)=>{let r=n[t];return r?.toQueryValue&&(e[t]=r.toQueryValue()),e},{}),t=u().parse(b.search,{ignoreQueryPrefix:!0}),r=u().stringify({...t,filters:e,..."none"===x?{}:{cursor:C,limit:N,offset:I}},{addQueryPrefix:!0,arrayFormat:"repeat"}),a=`${window.location.pathname}${r}`;window.history?.replaceState(null,document.title,a)}},[C,t,N,b.search,I,n,L,x]);let B=(0,c.useCallback)(e=>{"cursor"===x?S(void 0):"offset"===x&&F(0),o(t=>{let r="function"==typeof e?e(t):e;return{...t,...r}})},[x]),R=(0,c.useMemo)(()=>{if("cursor"!==x)return;let e=P.pageInfo?.prevCursor,t=P.pageInfo?.nextCursor;return{prev:e?()=>S(e):void 0,next:t?()=>S(t):void 0}},[x,P.pageInfo]),q=(0,c.useMemo)(()=>({filters:P.appliedFilters,entities:P.entities,backendEntities:P.backendEntities,updateFilters:B,queryParameters:A,loading:T,error:U,pageInfo:R,totalItems:P.totalItems,limit:N,offset:I,setLimit:O,setOffset:F,paginationMode:x}),[P,B,A,T,U,R,N,I,x,O,F]);return(0,a.jsx)(y.Provider,{value:q,children:(0,a.jsx)(v.Provider,{value:(0,s.B)({1:q}),children:e.children})})};function x(){let e=(0,n.qO)("entity-list-context"),t=(0,c.useContext)(y);if(e){let t=e.atVersion(1);if(!t)throw Error("EntityListContext v1 not available");return t}if(t)return t;throw Error("useEntityList must be used within EntityListProvider")}},44861(e,t,r){r.d(t,{I:()=>u});var a=r(78560),i=r(96170),n=r(14041),s=r(10581);r(46123);var l=r(9974);function o(e){return"string"==typeof e?e:(0,a.U2)(e)}function u(){let e=(0,i.gf)(l.a),t=(0,s.A)((0,n.useMemo)(()=>e.starredEntitie$(),[e]),new Set),r=(0,n.useCallback)(e=>t.has(o(e)),[t]);return{starredEntities:t,toggleStarredEntity:(0,n.useCallback)(t=>e.toggleStarred(o(t)).then(),[e]),isStarredEntity:r}}r(96403)},15998(e,t,r){r.d(t,{$3:()=>s,Rr:()=>l,be:()=>o});var a=r(49724);function i(e){return!!e.getFullTextFilters}function n(e){return!!e.getOrderFilters}function s(e){let t=e.reduce((e,t)=>({...e,...t.getCatalogFilters?t.getCatalogFilters():{}}),{});return{filter:t,fullTextFilter:e.find(i)?.getFullTextFilters(),orderFields:e.find(n)?.getOrderFilters()||[{field:"metadata.name",order:"asc"}]}}function l(e){let t={};return e.forEach(e=>{e instanceof a.q_||e instanceof a.N9||e instanceof a.I5||e instanceof a.z||e instanceof a.tN||e instanceof a.Kf||e instanceof a.V3||e instanceof a.gZ||Object.assign(t,e.getCatalogFilters?.()||{})}),t}function o(e){return t=>e.every(e=>!e.filterEntity||e.filterEntity(t))}},44148(e,t,r){var a=r(4293),i=r(78920);t.default=void 0;var n=i(r(14041));t.default=(0,a(r(74044)).default)(n.createElement("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox")},41260(e,t,r){var a=r(4293),i=r(78920);t.default=void 0;var n=i(r(14041));t.default=(0,a(r(74044)).default)(n.createElement("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank")},47966(e,t,r){var a=r(4293),i=r(78920);t.default=void 0;var n=i(r(14041));t.default=(0,a(r(74044)).default)(n.createElement("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"}),"Group")}}]);
//# sourceMappingURL=4553.8d418ee7.chunk.js.map