{"version":3,"file":"defaultEnvironment.cjs.js","sources":["../../src/lib/defaultEnvironment.ts"],"sourcesContent":["/*\n * Copyright 2025 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Config } from '@backstage/config';\nimport { JsonObject } from '@backstage/types';\n\nexport interface DefaultEnvironmentConfig {\n  parameters?: Record<string, any>;\n  secrets?: Record<string, string>;\n}\n\nexport interface ResolvedDefaultEnvironment {\n  parameters: JsonObject;\n  secrets: Record<string, string>;\n}\n\nexport function resolveDefaultEnvironment(\n  config: Config,\n): ResolvedDefaultEnvironment {\n  const defaultEnvConfig = config.getOptionalConfig(\n    'scaffolder.defaultEnvironment',\n  );\n  if (!defaultEnvConfig) {\n    return {\n      parameters: {},\n      secrets: {},\n    };\n  }\n\n  const parameters: JsonObject = {};\n  const secrets: Record<string, string> = {};\n\n  const parametersConfig = defaultEnvConfig.getOptionalConfig('parameters');\n  if (parametersConfig) {\n    for (const paramKey of parametersConfig.keys()) {\n      const paramValue = parametersConfig.getString(paramKey);\n      parameters[paramKey] = paramValue;\n    }\n  }\n\n  const secretsConfig = defaultEnvConfig.getOptionalConfig('secrets');\n  if (secretsConfig) {\n    for (const secretKey of secretsConfig.keys()) {\n      const secretValue = secretsConfig.getString(secretKey);\n      secrets[secretKey] = secretValue;\n    }\n  }\n\n  return {\n    parameters,\n    secrets,\n  };\n}\n"],"names":[],"mappings":";;AA6BO,SAAS,0BACd,MAAA,EAC4B;AAC5B,EAAA,MAAM,mBAAmB,MAAA,CAAO,iBAAA;AAAA,IAC9B;AAAA,GACF;AACA,EAAA,IAAI,CAAC,gBAAA,EAAkB;AACrB,IAAA,OAAO;AAAA,MACL,YAAY,EAAC;AAAA,MACb,SAAS;AAAC,KACZ;AAAA,EACF;AAEA,EAAA,MAAM,aAAyB,EAAC;AAChC,EAAA,MAAM,UAAkC,EAAC;AAEzC,EAAA,MAAM,gBAAA,GAAmB,gBAAA,CAAiB,iBAAA,CAAkB,YAAY,CAAA;AACxE,EAAA,IAAI,gBAAA,EAAkB;AACpB,IAAA,KAAA,MAAW,QAAA,IAAY,gBAAA,CAAiB,IAAA,EAAK,EAAG;AAC9C,MAAA,MAAM,UAAA,GAAa,gBAAA,CAAiB,SAAA,CAAU,QAAQ,CAAA;AACtD,MAAA,UAAA,CAAW,QAAQ,CAAA,GAAI,UAAA;AAAA,IACzB;AAAA,EACF;AAEA,EAAA,MAAM,aAAA,GAAgB,gBAAA,CAAiB,iBAAA,CAAkB,SAAS,CAAA;AAClE,EAAA,IAAI,aAAA,EAAe;AACjB,IAAA,KAAA,MAAW,SAAA,IAAa,aAAA,CAAc,IAAA,EAAK,EAAG;AAC5C,MAAA,MAAM,WAAA,GAAc,aAAA,CAAc,SAAA,CAAU,SAAS,CAAA;AACrD,MAAA,OAAA,CAAQ,SAAS,CAAA,GAAI,WAAA;AAAA,IACvB;AAAA,EACF;AAEA,EAAA,OAAO;AAAA,IACL,UAAA;AAAA,IACA;AAAA,GACF;AACF;;;;"}