(self.webpackChunkapp=self.webpackChunkapp||[]).push([["3366"],{45575(e,t,r){"use strict";r.d(t,{f:()=>c});var n=r(31085),i=r(77125),o=r(99703),s=r(58837),a=r(72501);let l=(0,s.A)(e=>(0,o.A)({root:{color:e.getPageTheme({themeId:"card"}).fontColor,padding:e.spacing(2,2,3),backgroundImage:e.getPageTheme({themeId:"card"}).backgroundImage,backgroundPosition:0,backgroundSize:"inherit"}}),{name:"BackstageItemCardHeader"});function c(e){let{title:t,subtitle:r,children:o}=e,s=l(e);return(0,n.jsxs)(i.A,{className:s.root,children:[r&&(0,n.jsx)(a.A,{variant:"subtitle2",component:"h3",children:r}),t&&(0,n.jsx)(a.A,{variant:"h6",component:"h4",children:t}),o]})}},13977(e,t,r){"use strict";r.d(t,{m:()=>m});var n=r(31085),i=r(79089),o=r(96170),s=r(42858),a=r(77125),l=r(14041),c=r(49724),u=r(18453);r(46343),r(40074),r(46123),r(96403);var h=r(73466),d=r(30043),f=r(80084),p=r(47250);let m=e=>{let t,r,{allowedKinds:m,hidden:g,initialFilter:y="component"}=e,{t:v}=(0,p.i)(f.j),b=(0,o.gf)(s.k),{error:x,allKinds:w,selectedKind:k,setSelectedKind:A}=function(e){let{filters:t,queryParameters:{kind:r},updateFilters:n}=(0,u.nK)(),i=(0,l.useMemo)(()=>[r].flat()[0],[r]),[s,a]=(0,l.useState)(i??t.kind?.value??e.initialFilter);(0,l.useEffect)(()=>{i&&a(i)},[i]),(0,l.useEffect)(()=>{t.kind?.value&&a(t.kind?.value)},[t.kind]);let{allKinds:f,loading:p,error:m}=function(){let e=(0,o.gf)(d.v),{error:t,loading:r,value:n}=(0,h.A)(async()=>{let{facets:t}=await e.getEntityFacets({facets:["kind"]});return new Map((t.kind??[]).map(e=>e.value).map(e=>[e.toLocaleLowerCase("en-US"),e]))},[e]);return{loading:r,error:t,allKinds:n??new Map}}(),g=f.get(s)||s;return(0,l.useEffect)(()=>{n({kind:s?new c.gM(s,g):void 0})},[s,g,n]),{loading:p,error:m,allKinds:f,selectedKind:s,setSelectedKind:a}}({initialFilter:y});if((0,l.useEffect)(()=>{x&&b.post({message:v("entityKindPicker.errorMessage"),severity:"error"})},[x,b,v]),x)return null;let S=[...(t=Array.from(w.keys()),m&&(t=m.map(e=>e.toLocaleLowerCase("en-US")).filter(e=>w.has(e))),r=new Map(t.map(e=>[e,w.get(e)||e])),k&&!r.has(k)&&r.set(k.toLocaleLowerCase("en-US"),k),r).entries()].map(([e,t])=>({label:t,value:e}));return g?null:(0,n.jsx)(a.A,{pb:1,pt:1,children:(0,n.jsx)(i.w,{label:v("entityKindPicker.title"),items:S,selected:k.toLocaleLowerCase("en-US"),onChange:e=>A(String(e))})})}},79533(e,t,r){"use strict";r.d(t,{l:()=>b});var n=r(31085),i=r(95061),o=r(29365),s=r(63301),a=r(34839),l=r(75173),c=r(58837),u=r(64704),h=r(45917),d=r(14041),f=r(16983),p=r(18453),m=r(49724),g=r(80084),y=r(47250);let v=(0,c.A)(e=>({searchToolbar:{paddingLeft:0,paddingRight:0},input:{}}),{name:"CatalogReactEntitySearchBar"}),b=()=>{let e=v(),{t}=(0,y.i)(g.j),{updateFilters:r,queryParameters:{text:c}}=(0,p.nK)(),b=(0,d.useMemo)(()=>[c].flat()[0],[c]),[x,w]=(0,d.useState)(b??"");return(0,f.default)(()=>{r({text:x.length?new m.V3(x):void 0})},250,[x,r]),(0,d.useEffect)(()=>{b&&w(b)},[b]),(0,n.jsx)(l.A,{className:e.searchToolbar,children:(0,n.jsx)(i.A,{children:(0,n.jsx)(s.A,{"aria-label":"search",id:"input-with-icon-adornment",className:e.input,placeholder:t("entitySearchBar.placeholder"),autoComplete:"off",onChange:e=>w(e.target.value),value:x,startAdornment:(0,n.jsx)(a.A,{position:"start",children:(0,n.jsx)(h.default,{})}),endAdornment:(0,n.jsx)(a.A,{position:"end",children:(0,n.jsx)(o.A,{"aria-label":"clear search",onClick:()=>w(""),edge:"end",disabled:0===x.length,children:(0,n.jsx)(u.default,{})})})})})})}},57278(e,t,r){"use strict";r.d(t,{j:()=>f});var n=r(14041),i=r(73466),o=r(46343),s=r.n(o),a=r(40074),l=r.n(a),c=r(96170),u=r(30043),h=r(18453),d=r(49724);function f(){let e=(0,c.gf)(u.v),{filters:{kind:t,type:r},queryParameters:{type:o},updateFilters:a}=(0,h.nK)(),f=(0,n.useMemo)(()=>[o].flat().filter(Boolean),[o]),[p,m]=(0,n.useState)(f.length?f:r?.getTypes()??[]);(0,n.useEffect)(()=>{f.length&&m(f)},[f]);let[g,y]=(0,n.useState)([]),v=(0,n.useMemo)(()=>t?.value,[t]),{error:b,loading:x,value:w}=(0,i.A)(async()=>v?await e.getEntityFacets({filter:{kind:v},facets:["spec.type"]}).then(e=>e.facets["spec.type"]||[]):[],[v,e]),k=(0,n.useRef)(w);return(0,n.useEffect)(()=>{let e=k.current;if(k.current=w,x||!v||e===w||!w)return;let t=[...new Set(l()(w,e=>-e.count).map(e=>e.value.toLocaleLowerCase("en-US")))];y(t);let r=p.filter(e=>t.includes(e));s()(p,r)||m(r)},[x,v,p,m,w]),(0,n.useEffect)(()=>{a({type:p.length?new d.qA(p):void 0})},[p,a]),{loading:x,error:b,availableTypes:g,selectedTypes:p,setSelectedTypes:m}}},94037(e,t,r){"use strict";let n,i,o,s,a,l;r.d(t,{Router:()=>Tk});var c,u,h,d,f,p,m,g,y={};r.r(y),r.d(y,{DescriptionField:()=>pk});var v=r(31085),b=r(18690),x=r(91042),w=r(76842),k=r(96170),A=r(77026),S=r(19579);let j={AdditionalItemsError:"Array at `{{pointer}}` may not have an additional item `{{key}}`",AdditionalPropertiesError:"Additional property `{{property}}` on `{{pointer}}` does not match schema `{{schema}}`",AllOfError:"Value `{{value}}` at `{{pointer}}` does not match schema of `{{allOf}}`",AnyOfError:"Value `{{value}}` at `{{pointer}}` does not match any schema of `{{anyOf}}`",ConstError:"Expected value at `{{pointer}}` to be `{{expected}}`, but value given is `{{value}}`",containsAnyError:"The array at `{{pointer}}` must contain at least one item",ContainsArrayError:"The property at `{{pointer}}` must not be an array",ContainsError:"The array at `{{pointer}}` must contain an element that matches `{{schema}}`",EnumError:"Expected given value `{{value}}` in `{{pointer}}` to be one of `{{values}}`",ForbiddenPropertyError:"Property name `{{property}}` at `{{pointer}}` is not allowed",FormatDateError:"Value `{{value}}` at `{{pointer}}` is not a valid date",FormatDateTimeError:"Value `{{value}}` at `{{pointer}}` is not a valid date-time",FormatEmailError:"Value `{{value}}` at `{{pointer}}` is not a valid email",FormatHostnameError:"Value `{{value}}` at `{{pointer}}` is not a valid hostname",FormatIPV4Error:"Value `{{value}}` at `{{pointer}}` is not a valid IPv4 address",FormatIPV4LeadingZeroError:"IPv4 addresses starting with zero are invalid, since they are interpreted as octals",FormatIPV6Error:"Value `{{value}}` at `{{pointer}}` is not a valid IPv6 address",FormatIPV6LeadingZeroError:"IPv6 addresses starting with zero are invalid, since they are interpreted as octals",FormatJsonPointerError:"Value `{{value}}` at `{{pointer}}` is not a valid json-pointer",FormatRegExError:"Value `{{value}}` at `{{pointer}}` is not a valid regular expression",FormatTimeError:"Value `{{value}}` at `{{pointer}}` is not a valid time",FormatURIError:"Value `{{value}}` at `{{pointer}}` is not a valid uri",FormatURIReferenceError:"Value `{{value}}` at `{{pointer}}` is not a valid uri-reference",FormatURITemplateError:"Value `{{value}}` at `{{pointer}}` is not a valid uri-template",FormatURLError:"Value `{{value}}` at `{{pointer}}` is not a valid url",InvalidDataError:"No value may be specified in `{{pointer}}`",InvalidPropertyNameError:"Invalid property name `{{property}}` at `{{pointer}}`",MaximumError:"Value in `{{pointer}}` is `{{length}}`, but should be `{{maximum}}` at maximum",MaxItemsError:"Too many items in `{{pointer}}`, should be `{{maximum}}` at most, but got `{{length}}`",MaxLengthError:"Value `{{pointer}}` should have a maximum length of `{{maxLength}}`, but got `{{length}}`.",MaxPropertiesError:"Too many properties in `{{pointer}}`, should be `{{maximum}}` at most, but got `{{length}}`",MinimumError:"Value in `{{pointer}}` is `{{length}}`, but should be `{{minimum}}` at minimum",MinItemsError:"Too few items in `{{pointer}}`, should be at least `{{minItems}}`, but got `{{length}}`",MinItemsOneError:"At least one item is required in `{{pointer}}`",MinLengthError:"Value `{{pointer}}` should have a minimum length of `{{minLength}}`, but got `{{length}}`.",MinLengthOneError:"A value is required in `{{pointer}}`",MinPropertiesError:"Too few properties in `{{pointer}}`, should be at least `{{minimum}}`, but got `{{length}}`",MissingDependencyError:"The required propery '{{missingProperty}}' in `{{pointer}}` is missing",MissingOneOfPropertyError:"Value at `{{pointer}}` property: `{{property}}`",MultipleOfError:"Expected `{{value}}` in `{{pointer}}` to be multiple of `{{multipleOf}}`",MultipleOneOfError:"Value `{{value}}` should not match multiple schemas in oneOf `{{matches}}`",NoAdditionalPropertiesError:"Additional property `{{property}}` in `{{pointer}}` is not allowed",NotError:"Value `{{value}}` at pointer should not match schema `{{not}}`",OneOfError:"Value `{{value}}` in `{{pointer}}` does not match any given oneof schema",OneOfPropertyError:"Failed finding a matching oneOfProperty schema in `{{pointer}}` where `{{property}}` matches `{{value}}`",PatternError:"Value in `{{pointer}}` should match `{{description}}`, but received `{{received}}`",PatternPropertiesError:"Property `{{key}}` does not match any patterns in `{{pointer}}`. Valid patterns are: {{patterns}}",RequiredPropertyError:"The required property `{{key}}` is missing at `{{pointer}}`",SchemaWarning:"Failed retrieving a schema from '{{pointer}}' to key '{{key}}'",TypeError:"Expected `{{value}}` ({{received}}) in `{{pointer}}` to be of type `{{expected}}`",UndefinedValueError:"Value must not be undefined in `{{pointer}}`",UniqueItemsError:"Items in array must be unique. Value `{{value}}` in `{{pointer}}` is a duplicate of {{duplicatePointer}}.",UnknownPropertyError:"Could not find a valid schema for property `{{pointer}}` within object",ValueNotEmptyError:"A value for `{{property}}` is required at `{{pointer}}`"},C=Object.prototype.toString;function E(e){let t=C.call(e).match(/\s([^\]]+)\]/).pop().toLowerCase();return"file"===t?"object":t}function O(e,t){return{type:"error",name:e,code:e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),message:function(e,t,r=e){var n;return function(e,t={}){return e.replace(/\{\{\w+\}\}/g,e=>{let r=t[e.replace(/[{}]/g,"")],n=E(r);return"object"===n||"array"===n?JSON.stringify(r):r})}(null!=(n=j[e])?n:r,t)}(e,t),data:t}}function M(e){return O.bind(null,e)}function P(e,t=[]){for(let r=0;r<e.length;r+=1){let n=e[r];Array.isArray(n)?P(n,t):t.push(n)}return t}let T={DECLARATOR_ONEOF:"oneOfProperty",GET_TEMPLATE_RECURSION_LIMIT:1,propertyBlacklist:["_id"],templateDefaultOptions:{addOptionalProps:!1,removeInvalidData:!1,extendDefaults:!0}};function I(e,t,r){let n={...t};return Object.defineProperty(n,"getOneOfOrigin",{enumerable:!1,value:()=>({index:r,schema:e})}),n}function $(e){return(null==e?void 0:e.type)==="error"}function D(e){return $(e)||e instanceof Promise}let{DECLARATOR_ONEOF:R}=T;function N(e,t,r=e.rootSchema,n="#"){if(null!=t&&r[R]){let i=[],o=r[R],s=t[r[R]];if(void 0===s)return e.errors.missingOneOfPropertyError({property:o,pointer:n,schema:r,value:t});for(let a=0;a<r.oneOf.length;a+=1){let l=e.resolveRef(r.oneOf[a]),c=e.step(o,l,t,n);if($(c))return c;let u=P(e.validate(s,c,n));if(!((u=u.filter(D)).length>0))return I(r,l,a);i.push(...u)}return e.errors.oneOfPropertyError({property:o,value:s,pointer:n,schema:r,errors:i})}let i=[];for(let o=0;o<r.oneOf.length;o+=1){let s=e.resolveRef(r.oneOf[o]);e.isValid(t,s,n)&&i.push({schema:s,index:o})}if(1===i.length)return I(r,i[0].schema,i[0].index);if("object"===E(t)){let i,o=-1,s=0;for(let n=0;n<r.oneOf.length;n+=1){let a=e.resolveRef(r.oneOf[n]),l=function(e,t,r,n){if(null==r||null==t.properties)return -1;let i=0,o=Object.keys(t.properties);for(let n=0;n<o.length;n+=1){let s=o[n];null!=r[s]&&e.isValid(r[s],t.properties[s],void 0)&&(i+=1)}return i}(e,a,t);s<l&&(s=l,i=r.oneOf[n],o=n)}return void 0===i?e.errors.oneOfError({value:JSON.stringify(t),pointer:n,schema:r,oneOf:r.oneOf}):I(r,i,o)}return i.length>1?e.errors.multipleOneOfError({matches:i,pointer:n,schema:r,value:t}):e.errors.oneOfError({value:JSON.stringify(t),pointer:n,schema:r,oneOf:r.oneOf})}var _=r(52743),L=r.n(_);let F=(e,t)=>t,B=(e,t)=>L()(e,t,{arrayMerge:F}),z=(e,t)=>{let r=e.concat(t);return r.filter((e,t)=>r.indexOf(e)===t)};function W(e,t){if(E(e)!==E(t))return e;let r=L()(e,t,{arrayMerge:z});return e.getOneOfOrigin?Object.defineProperty(r,"getOneOfOrigin",{enumerable:!1,value:e.getOneOfOrigin}):t.getOneOfOrigin&&Object.defineProperty(r,"getOneOfOrigin",{enumerable:!1,value:t.getOneOfOrigin}),r}function V(e,...t){let r={};return Object.keys(e).forEach(n=>{t.includes(n)||(r[n]=e[n])}),e.getOneOfOrigin&&Object.defineProperty(r,"getOneOfOrigin",{enumerable:!1,value:e.getOneOfOrigin}),r}var H=Function.prototype.toString,U=Object.create,q=Object.prototype.toString,K=function(){function e(){this._keys=[],this._values=[]}return e.prototype.has=function(e){return!!~this._keys.indexOf(e)},e.prototype.get=function(e){return this._values[this._keys.indexOf(e)]},e.prototype.set=function(e,t){this._keys.push(e),this._values.push(t)},e}(),G="u">typeof WeakMap?function(){return new WeakMap}:function(){return new K};function J(e){if(!e)return U(null);var t=e.constructor;if(t===Object)return e===Object.prototype?{}:U(e);if(t&&~H.call(t).indexOf("[native code]"))try{return new t}catch(e){}return U(e)}var Y="g"===/test/g.flags?function(e){return e.flags}:function(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t};function X(e){var t=q.call(e);return t.substring(8,t.length-1)}var Z="u">typeof Symbol?function(e){return e[Symbol.toStringTag]||X(e)}:X,Q=Object.defineProperty,ee=Object.getOwnPropertyDescriptor,et=Object.getOwnPropertyNames,er=Object.getOwnPropertySymbols,en=Object.prototype,ei=en.hasOwnProperty,eo=en.propertyIsEnumerable,es="function"==typeof er,ea=es?function(e){return et(e).concat(er(e))}:et;function el(e,t,r){for(var n=ea(e),i=0,o=n.length,s=void 0,a=void 0;i<o;++i)if("callee"!==(s=n[i])&&"caller"!==s){if(!(a=ee(e,s))){t[s]=r.copier(e[s],r);continue}a.get||a.set||(a.value=r.copier(a.value,r));try{Q(t,s,a)}catch(e){t[s]=a.value}}return t}function ec(e,t){return e.slice(0)}function eu(e,t){var r=new t.Constructor;return t.cache.set(e,r),e.forEach(function(e,n){r.set(n,t.copier(e,t))}),r}function eh(e,t){return new t.Constructor(e.valueOf())}function ed(e,t){return e}function ef(e,t){var r=new t.Constructor;return t.cache.set(e,r),e.forEach(function(e){r.add(t.copier(e,t))}),r}var ep=Array.isArray,em=Object.assign,eg=Object.getPrototypeOf||function(e){return e.__proto__},ey={array:function(e,t){var r=new t.Constructor;t.cache.set(e,r);for(var n=0,i=e.length;n<i;++n)r[n]=t.copier(e[n],t);return r},arrayBuffer:ec,blob:function(e,t){return e.slice(0,e.size,e.type)},dataView:function(e,t){return new t.Constructor(ec(e.buffer))},date:function(e,t){return new t.Constructor(e.getTime())},error:ed,map:eu,object:es?function(e,t){var r=J(t.prototype);for(var n in t.cache.set(e,r),e)ei.call(e,n)&&(r[n]=t.copier(e[n],t));for(var i=er(e),o=0,s=i.length,a=void 0;o<s;++o)a=i[o],eo.call(e,a)&&(r[a]=t.copier(e[a],t));return r}:function(e,t){var r=J(t.prototype);for(var n in t.cache.set(e,r),e)ei.call(e,n)&&(r[n]=t.copier(e[n],t));return r},regExp:function(e,t){var r=new t.Constructor(e.source,Y(e));return r.lastIndex=e.lastIndex,r},set:ef},ev=em({},ey,{array:function(e,t){var r=new t.Constructor;return t.cache.set(e,r),el(e,r,t)},map:function(e,t){return el(e,eu(e,t),t)},object:function(e,t){var r=J(t.prototype);return t.cache.set(e,r),el(e,r,t)},set:function(e,t){return el(e,ef(e,t),t)}});function eb(e){var t,r={Arguments:(t=em({},ey,e)).object,Array:t.array,ArrayBuffer:t.arrayBuffer,Blob:t.blob,Boolean:eh,DataView:t.dataView,Date:t.date,Error:t.error,Float32Array:t.arrayBuffer,Float64Array:t.arrayBuffer,Int8Array:t.arrayBuffer,Int16Array:t.arrayBuffer,Int32Array:t.arrayBuffer,Map:t.map,Number:eh,Object:t.object,Promise:ed,RegExp:t.regExp,Set:t.set,String:eh,WeakMap:ed,WeakSet:ed,Uint8Array:t.arrayBuffer,Uint8ClampedArray:t.arrayBuffer,Uint16Array:t.arrayBuffer,Uint32Array:t.arrayBuffer,Uint64Array:t.arrayBuffer},n=r.Array,i=r.Object;function o(e,t){if(t.prototype=t.Constructor=void 0,!e||"object"!=typeof e)return e;if(t.cache.has(e))return t.cache.get(e);if(t.prototype=eg(e),t.Constructor=t.prototype&&t.prototype.constructor,!t.Constructor||t.Constructor===Object)return i(e,t);if(ep(e))return n(e,t);var o=r[Z(e)];return o?o(e,t):"function"==typeof e.then?e:i(e,t)}return function(e){return o(e,{Constructor:void 0,cache:G(),copier:o,prototype:void 0})}}eb(em({},ev,{}));var ex=eb({});function ew(e,t,r){if(null!=t.if){if(!1===t.if)return t.else;if(t.if&&(t.then||t.else)){let n=e.validate(r,e.resolveRef(t.if));if(0===n.length&&t.then)return e.resolveRef(t.then);if(0!==n.length&&t.else)return e.resolveRef(t.else)}}}function ek(e,t,r){var n;let i={...null!=(n=e.resolveRef(t))?n:{}},o=ew(e,i,r);return o||V(i,"if","then","else")}function eA(e,t){let{allOf:r}=t;if(!Array.isArray(r)||0===r.length)return;let n={};return r.forEach(t=>{n=W(n,e.resolveRef(t))}),n}function eS(e){return"object"===E(e)}function ej(e,t,r){let{dependencies:n}=t;if(!eS(n)||!eS(r))return;let i=!1,o={required:[]};if(Object.keys(n).forEach(s=>{var a,l;if(null==r[s]&&!((null==(a=t.required)?void 0:a.includes(s))||(null==(l=o.required)?void 0:l.includes(s))))return;let c=n[s];if(Array.isArray(c)){i=!0,o.required.push(...c);return}if(eS(c)){i=!0,o=W(o,e.resolveRef(c));return}}),i){var s;return o.required=(s=o.required).filter((e,t)=>s.indexOf(e)===t),o}}function eC(e,t,r){let n;if(Array.isArray(t.anyOf)&&0!==t.anyOf.length)return t.anyOf.forEach(t=>{t=e.resolveRef(t),e.isValid(r,t)&&(n=n?W(n,t):t)}),n}let eE=["allOf","anyOf","oneOf","dependencies","if","then","else"],eO=["allOf","anyOf","oneOf","dependencies","if"],eM=["allOf","anyOf","oneOf","dependencies","if","then","else"];function eP(e,t,r,n){let i=function e(t,r,n,i){let o,s;if((r=t.resolveRef(r)).oneOf){let e=N(t,n,r,i);$(e)?s=e:e&&(o=W(null!=o?o:{},e))}if(Array.isArray(r.allOf)){let s=r.allOf.map(r=>{let o;if(o=Object.keys(r),-1!==eO.findIndex(e=>o.includes(e))){let o=e(t,r,n,i);return o?V(o=W(r,o),...eE):void 0}return r});s.length>0&&(o=W(null!=o?o:{},eA(t,{allOf:s})))}let a=eC(t,r,n);a&&(o=W(null!=o?o:{},a));let l=ej(t,r,n);l&&(o=W(null!=o?o:{},l));let c=ew(t,r,n);if(c&&(o=W(null!=o?o:{},c)),null==o)return s;let u=e(t,o,n,i);return u&&(o=W(o,u)),V(o,...eE)}(e,t,r,n);return i?V(i=W(t,i),...eM):t}class eT{constructor(e,t){this.remotes={},this.errors={},this.typeKeywords={},this.validateKeyword={},this.validateType={},this.validateFormat={},this.config=e,this.typeKeywords=ex(e.typeKeywords),this.validateKeyword=Object.assign({},e.validateKeyword),this.validateType=Object.assign({},e.validateType),this.validateFormat=Object.assign({},e.validateFormat),this.errors=Object.assign({},e.errors),this.setSchema(t)}get rootSchema(){return this.__rootSchema}set rootSchema(e){null!=e&&(this.__rootSchema=this.config.compileSchema(this,e))}addRemoteSchema(e,t){this.config.addRemoteSchema(this,e,t)}compileSchema(e){var t;return this.config.compileSchema(this,e,null!=(t=this.rootSchema)?t:e)}createSchemaOf(e){return this.config.createSchemaOf(e)}each(e,t,r,n){return this.config.each(this,e,t,r,n)}eachSchema(e,t=this.rootSchema){return this.config.eachSchema(t,e)}getChildSchemaSelection(e,t){return this.config.getChildSchemaSelection(this,e,t)}getSchema(e){return this.config.getSchema(this,e)}getTemplate(e,t,r=this.config.templateDefaultOptions){return this.config.getTemplate(this,e,t,r)}isValid(e,t,r){return this.config.isValid(this,e,t,r)}resolveAnyOf(e,t,r){return this.config.resolveAnyOf(this,e,t,r)}resolveAllOf(e,t){return this.config.resolveAllOf(this,e,t)}resolveRef(e){return this.config.resolveRef(e,this.rootSchema)}resolveOneOf(e,t,r){return this.config.resolveOneOf(this,e,t,r)}setSchema(e){this.rootSchema=e}step(e,t,r,n){return this.config.step(this,e,t,r,n)}validate(e,t,r){return this.config.validate(this,e,t,r)}}var eI=r(95716),e$=r.n(eI),eD=r(22193);let eR="[^?/{}*,()#]+",eN=`
root ::= ("#" recursion | recursion | (query | pattern) recursion* | "#" SEP? | SEP)
recursion ::= (SEP query | pattern)*

query ::= (ESC escaped ESC | property | all | any | regex) typecheck? lookahead?
property ::= ${eR}
regex ::= "{" [^}]+ "}"
SEP ::= "/"
all ::= "**"
any ::= "*"

typecheck ::= "?:" ("value" | "boolean" | "string" | "number" | "object" | "array")
lookahead ::= "?" expression ((andExpr | orExpr) expression)*
andExpr ::= S? "&&" S?
orExpr ::= S? "||" S?

expression ::= (exprProperty | ESC escaped ESC) ((isnot | is) (exprProperty | regex | ESC escaped ESC))*
exprProperty ::= [a-zA-Z0-9-_ $]+
escaped ::= [^"]+
is ::= ":"
isnot ::= ":!"
ESC ::= '"'

pattern ::= S? "(" (SEP query | pattern (orPattern? pattern)*)* ")" quantifier? S? lookahead?
quantifier ::= "+" | "*" | [0-9]+
orPattern ::= S? "," S?

S ::= [ ]*
`,e_=new eD.default.Parser(eN),eL=(e,t)=>`${e}/${t}`,eF=Object.prototype.toString,eB=/Object|Array/,ez=e=>eB.test(eF.call(e));function eW(e){return new RegExp(e.text.replace(/(^{|}$)/g,""))}function eV(e){return Array.isArray(e)?e.map(function(e,t){return`${t}`}):"[object Object]"===Object.prototype.toString.call(e)?Object.keys(e):[]}let eH={mem:[],get(e,t){let r=e[0][t];if(!eH.mem.includes(r))return ez(r)&&eH.mem.push(r),[r,t,e[0],eL(e[3],t)]},reset(){eH.mem.length=0}},eU={any(e,t){let r=t[0];return eV(r).map(e=>[r[e],e,r,eL(t[3],e)])},all(e,t){var r,n;let i=[t];return r=t[0],n=(r,n)=>{let o=eH.get(t,n);o&&i.push(...eU.all(e,o))},Array.isArray(r)?r.forEach(n):"[object Object]"===Object.prototype.toString.call(r)&&Object.keys(r).forEach(function(e){n(r[e],e,r)}),i},regex(e,t){let r=eW(e),n=t[0];return eV(n).filter(e=>r.test(e)).map(e=>[n[e],e,n,eL(t[3],e)])}},eq={escaped:(e,t)=>eq.property(e,t),property:(e,t)=>{let r=e.text;if(t[0]&&void 0!==t[0][r])return[t[0][r],r,t[0],eL(t[3],r)]},typecheck:(e,t)=>{let r,n=e.text.replace(/^\?:/,"");return"value"===n?ez(t[0])?void 0:t:(r=t[0],eF.call(r).match(/\s([^\]]+)\]/).pop().toLowerCase()===n)?t:void 0},lookahead:(e,t)=>{let r=!0,n=!1;return e.children.forEach(e=>{if("expression"===e.type){let i=void 0!==eq.expression(e,t);r=!0===n?r||i:r&&i}else n="orExpr"===e.type}),r?t:void 0},expression:(e,t)=>{let r=e.children[0].text,n=e.children[1],i=e.children[2],o=t[0];if(!1!==ez(o))return!function(e,t,r){let n;if(void 0===t)return void 0!==e;let i=`${e}`;return n="regex"===r.type?eW(r).test(i):i===r.text,"isnot"===t.type&&(n=!1===n&&void 0!==e),n}(o[r],n,i)?void 0:t}},eK={value:e=>e.map(e=>e[0]),pointer:e=>e.map(e=>e[3]),all:e=>e,map:e=>{let t={};return e.forEach(e=>t[e[3]]=e[0]),t}};function eG(e,t,r=md.VALUE){let n;if(null==t)return[];""===(t=t.replace(/(\/$)/g,""))&&(t="#");let i=(n=t,e_.getAST(n));if(null==i)throw Error(`empty ast for '${t}'`);if(""!==i.rest)throw Error(`Failed parsing queryString from: '${i.rest}'`);let o=(eH.reset(),eH.mem.push(e),function e(t,r,n){let i;if("query"===r.type){let e;e=t,r.children.forEach(t=>{if(eU[t.type])e=function(e,t,r,n){let i=[];for(let o=0,s=t.length;o<s;o+=1)i.push(...e(r,t[o],r,n));return i}(eU[t.type],e,t,n);else if(eq[t.type])e=function(e,t,r,n){let i=[];for(let o=0,s=t.length;o<s;o+=1){let s=e(r,t[o],n);s&&i.push(s)}return i}(eq[t.type],e,t,n);else throw Error(`Unknown filter ${t.type}`)}),i=e}else if("pattern"===r.type)i=function(t,r,n){let i=[],o=r.children.find(e=>"quantifier"===e.type),s=function(e){if(null==e)return 1;if("*"===e||"+"===e)return 1/0;let t=parseInt(e);return isNaN(t)?1:t}(o&&o.text),a=t;o&&"*"===o.text&&i.push(...a);let l=0;for(;a.length>0&&l<s;)i.push(...a=function(t,r,n){let i=[],o=t;return r.children.forEach(r=>{if("orPattern"===r.type){i.push(...o),o=t;return}o=e(o,r,n)}),i.push(...o),i}(a,r,n)),l+=1;return i}(t,r,n);else{let o;o=t,r.children.forEach(t=>o=e(o,t,n)),i=o}return eH.reset(),eH.mem.push(t),i}([[e,null,null,"#"]],i));return"function"==typeof r?o.map(e=>r(...e)):eK[r]?eK[r](o):o}(mt=md||(md={})).POINTER="pointer",mt.VALUE="value",mt.ALL="all",mt.MAP="map",eG.POINTER=md.POINTER,eG.VALUE=md.VALUE,eG.ALL=md.ALL,eG.MAP=md.MAP;let eJ=["root","recursion"],eY=e=>JSON.parse(JSON.stringify(e)),eX=Object.prototype.toString,eZ=e=>eX.call(e).match(/\s([^\]]+)\]/).pop().toLowerCase(),eQ=RegExp(`^("[^"]+"|${eR})$`),e0=["string","number","boolean","null"],e1=/^\[\d*\]$/,e2=/^\[(\d+)\]$/,e4=/^".+"$/,e3=/(^\[\d*\]$|^\d+$)/;function e5(e){return parseInt(e.replace(/^(\[|\]$)/,""))}function e6(e){return e4.test(e)?e.replace(/(^"|"$)/g,""):e}function e9(e,t,r,n){let i=e[0];if(/^\[\]$/.test(t)){i.push(r);let t=i.length-1;return[i[t],t,i,`${e[3]}/${t}}`]}if(null==n&&"object"===eZ(i[t])&&"object"===eZ(r))return Object.assign(i[t],r),[i[t],t,i,`${e[3]}/${t}}`];if(n===e8.INSERT_ITEMS||null==n&&e2.test(t)){let n=e5(t);return i.length<=n?i[n]=r:i.splice(n,0,r),[i[n],n,i,`${e[3]}/${n}}`]}if(n===e8.REPLACE_ITEMS||null==n){let n=e5(t);return i[n]=r,[i[n],n,i,`${e[3]}/${n}}`]}throw Error(`Unknown array index '${t}' with force-option '${n}'`)}function e8(e,t,r,n){if(null==t)return eY(e);if(""===(t=t.replace(/(\/$)/g,"")))return eY(r);let i=eY(e),o=[[i,null,null,"#"]],s=function(e){return null==e||""===e?[]:function e(t,r=[]){return eJ.includes(t.type)?t.children.forEach(t=>e(t,r)):r.push(t.text),r}(e_.getAST(e))}(t),a=s.pop(),l=e1.test(a)&&!1===e2.test(a);if(!1===eQ.test(a)||l)throw Error(`Unsupported query '${t}' ending with non-property`);return s.forEach((e,t)=>{var r,i;if("__proto__"===e||"prototyped"===e||"constructor"===e)return;if(!1===eQ.test(e)){let t;t=[],o.forEach(r=>t.push(...eG(r[0],e,md.ALL))),o=t;return}let l=t>=s.length-1?a:s[t+1],c=e3.test(l);r=o,i=e6(i=e),o=r.filter(e=>!!(Array.isArray(e[0])&&e3.test(i))||!1===e0.includes(eZ(e[0][i]))).map(e=>{let t=c?[]:{},r=e[0],o=eZ(t),s=eZ(r[i]);return Array.isArray(r)&&s!==o?e9(e,i,t,n):(r[i]=r[i]||t,[r[i],i,r,`${e[3]}/${i}`])})}),o.forEach(e=>{let t=r;"function"===eZ(r)&&(t=r(e[3],a,e[0],`${e[3]}/${a}`));let i=e[0];if(Array.isArray(i))e9(e,a,t,n);else{let e=e6(a);if("__proto__"===e||"prototyped"===e||"constructor"===e)return;i[e]=t}}),i}(mr=mf||(mf={})).REPLACE_ITEMS="replace",mr.INSERT_ITEMS="insert",e8.REPLACE_ITEMS=mf.REPLACE_ITEMS,e8.INSERT_ITEMS=mf.INSERT_ITEMS;let e7={$ref:{type:!1},allOf:{type:!1,definitions:["allOf/*"]},anyOf:{type:!1,definitions:["anyOf/*"]},array:{type:!0,definitions:["allOf/*","anyOf/*","oneOf/*","not","items","items/*","additionalItems"],validationKeywords:["minItems","maxItems","uniqueItems"],keywords:["items","additionalItems","minItems","maxItems","uniqueItems"]},boolean:{type:!0},enum:{type:!1},integer:{type:!0,definitions:["allOf/*","anyOf/*","oneOf/*","not"],validationKeywords:["minimum","maximum","multipleOf"]},not:{type:!1,definitions:["not"]},number:{type:!0,definitions:["allOf/*","anyOf/*","oneOf/*","not"],validationKeywords:["minimum","maximum","multipleOf"]},null:{type:!0},object:{type:!0,definitions:["allOf/*","anyOf/*","oneOf/*","not","properties/*","additionalProperties","patternProperties/*","dependencies/*"],validationKeywords:["minProperties","maxProperties","required"],keywords:["properties","additionalProperties","patternProperties","dependencies","minProperties","maxProperties","required"]},oneOf:{type:!1,definitions:["oneOf/*"]},string:{type:!0,definitions:["allOf/*","anyOf/*","oneOf/*","not"],validationKeywords:["minLength","maxLength","pattern"]}},te=Object.keys(e7).filter(e=>!1===e7[e].type),tt=Object.prototype.hasOwnProperty;function tr(e){if(!1===eS(e))return;if(e.enum)return"enum";let t=e.type;if(Array.isArray(t)||e7[t])return t;let r=te.filter(t=>e[t]);if(1===r.length)return r[0];if(0===r.length){for(let t=0,r=e7.object.keywords.length;t<r;t+=1){let r=e7.object.keywords[t];if(tt.call(e,r))return"object"}for(let t=0,r=e7.array.keywords.length;t<r;t+=1){let r=e7.array.keywords[t];if(tt.call(e,r))return"array"}return}throw Error(`Mutiple typeIds [${r.join(", ")}] matched in ${JSON.stringify(e)}`)}function tn(e,t){!0===this.callback(e,t)||(function(e){let t,r=[],n=tr(e);if(null==n)return r;if(Array.isArray(n)){t={};for(let e=0,r=n.length;e<r;e+=1)Object.assign(t,e7[n[e]])}else t=e7[n];return null==t.definitions||t.definitions.forEach(t=>{eG(e,t,(e,t,n,i)=>{eS(e)&&tr(e)&&r.push({pointer:e$().join(e$().split(i),!1),def:e})})}),r})(e).forEach(e=>this.nextTypeDefs(e.def,e$().join(t,e.pointer,!1)))}function ti(e,t,r,n="definitions"){let i=t[n];Object.keys(i).forEach(t=>{if(!1===i[t]||eS(i[t]))return void e.nextTypeDefs(i[t],e$().join(r,n,t,!1))})}function to(e,t,r="#"){let n={callback:t,nextTypeDefs:tn};n.nextTypeDefs(e,r),null!=e.definitions&&(n.callback=(e,r)=>{t(e,r),null!=e.definitions&&ti(n,e,r)},ti(n,e,r)),null!=e.$defs&&(n.callback=(e,r)=>{t(e,r),null!=e.definitions&&ti(n,e,r)},ti(n,e,r,"$defs"))}let ts=/(#|\/)+$/,ta=/#$/,tl=/^[^:]+:\/\/[^/]+\//,tc=/\/[^/]*$/,tu=/#.*$/;function th(e,t){return null==e&&null==t?"#":null==t?e.replace(ta,""):null==e?t.replace(ta,""):"#"===t[0]?`${e.replace(tu,"")}${t.replace(ts,"")}`:tl.test(t)?t.replace(ta,""):`${e.replace(tc,"")}/${t.replace(ta,"")}`}let td=/(#|\/)+$/g,tf=["",null,"#"],tp=/(#|\/)+$/g,tm={additionalItemsError:M("AdditionalItemsError"),additionalPropertiesError:M("AdditionalPropertiesError"),anyOfError:M("AnyOfError"),allOfError:M("AllOfError"),constError:M("ConstError"),containsError:M("ContainsError"),containsArrayError:M("ContainsArrayError"),containsAnyError:M("ContainsAnyError"),enumError:M("EnumError"),forbiddenPropertyError:M("ForbiddenPropertyError"),formatURLError:M("FormatURLError"),formatURIError:M("FormatURIError"),formatURIReferenceError:M("FormatURIReferenceError"),formatURITemplateError:M("FormatURITemplateError"),formatDateError:M("FormatDateError"),formatDateTimeError:M("FormatDateTimeError"),formatEmailError:M("FormatEmailError"),formatHostnameError:M("FormatHostnameError"),formatIPV4Error:M("FormatIPV4Error"),formatIPV4LeadingZeroError:M("FormatIPV4LeadingZeroError"),formatIPV6Error:M("FormatIPV6Error"),formatIPV6LeadingZeroError:M("FormatIPV6LeadingZeroError"),formatJsonPointerError:M("FormatJsonPointerError"),formatRegExError:M("FormatRegExError"),formatTimeError:M("FormatTimeError"),invalidSchemaError:M("InvalidSchemaError"),invalidDataError:M("InvalidDataError"),invalidTypeError:M("InvalidTypeError"),invalidPropertyNameError:M("InvalidPropertyNameError"),maximumError:M("MaximumError"),maxItemsError:M("MaxItemsError"),maxLengthError:M("MaxLengthError"),maxPropertiesError:M("MaxPropertiesError"),minimumError:M("MinimumError"),minItemsError:M("MinItemsError"),minItemsOneError:M("MinItemsOneError"),minLengthError:M("MinLengthError"),minLengthOneError:M("MinLengthOneError"),minPropertiesError:M("MinPropertiesError"),missingDependencyError:M("MissingDependencyError"),missingOneOfPropertyError:M("MissingOneOfPropertyError"),multipleOfError:M("MultipleOfError"),multipleOneOfError:M("MultipleOneOfError"),noAdditionalPropertiesError:M("NoAdditionalPropertiesError"),notError:M("NotError"),oneOfError:M("OneOfError"),oneOfPropertyError:M("OneOfPropertyError"),patternError:M("PatternError"),patternPropertiesError:M("PatternPropertiesError"),requiredPropertyError:M("RequiredPropertyError"),schemaWarning:M("SchemaWarning"),typeError:M("TypeError"),undefinedValueError:M("UndefinedValueError"),uniqueItemsError:M("UniqueItemsError"),unknownPropertyError:M("UnknownPropertyError"),valueNotEmptyError:M("ValueNotEmptyError")};var tg=r(47112),ty=r.n(tg),tv=r(96542);let tb=RegExp("^([0-9]+)-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])[Tt]([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?(([Zz])|([\\+|\\-]([01][0-9]|2[0-3]):[0-5][0-9]))$"),tx=/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,tw=/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,tk=/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,tA=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,tS=/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,tj=[0,31,28,31,30,31,30,31,31,30,31,30,31],tC=/^(?:\/(?:[^~/]|~0|~1)*)*$/,tE=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,tO=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,tM=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,tP={},tT=T.templateDefaultOptions;function tI(e,t){let{$ref:r}=e;return null==r||(null==n[t]||null==n[t][r]?0:n[t][r])<T.GET_TEMPLATE_RECURSION_LIMIT}function t$(e,t,r){let{$ref:i}=t;return null==i?t:(n[r]=n[r]||{},n[r][i]=n[r][i]||0,n[r][i]+=1,e.resolveRef(t))}function tD(e,t,r,n,i){if("object"!==E(t))return Object.assign({pointer:n},t);if(!1===tI(t,n)&&null==r)return!1;let o=ex(t$(e,t,n));if(Array.isArray(t.anyOf)&&t.anyOf.length>0&&(tI(t.anyOf[0],`${n}/anyOf/0`)&&((o=B(o,t$(e,t.anyOf[0],`${n}/anyOf/0`))).pointer=t.anyOf[0].$ref||o.pointer),delete o.anyOf),Array.isArray(t.allOf)&&t.allOf.map((e,t)=>tI(e,`${n}/allOf/${t}`)).reduceRight((e,t)=>e&&t,!0)){let s=[],a=ex(r);for(let r=0;r<t.allOf.length;r+=1)s.push(ek(e,t.allOf[r],a)),a=tR(e,a,{type:t.type,...s[r]},`${n}/allOf/${r}`,i);let l=eA(e,{allOf:s});l&&(o=W(o,l))}return o.pointer=o.pointer||t.$ref||n,o}function tR(e,t,r,n,i){var o;let s,a;if(null==r)throw Error(`getTemplate: missing schema for data: ${JSON.stringify(t)}`);if(null==n)throw Error("Missing pointer");let l=tD(e,r,t,n,i);if(!((s=l)&&"object"==typeof s))return;if(n=l.pointer,null==l?void 0:l.const)return l.const;if(Array.isArray(l.oneOf))if(function(e){switch(E(e)){case"string":case"array":return(null==e?void 0:e.length)===0;case"null":case"undefined":return!0;case"object":return 0===Object.keys(e).length;default:return!1}}(t)){let e=l.oneOf[0].type||l.type||l.const&&typeof l.const||E(t);l={...l.oneOf[0],type:e}}else{let r=N(e,t,l);if($(r)){if(null!=t&&!0!==i.removeInvalidData)return t;l=l.oneOf[0],t=void 0}else r.type=null!=(o=r.type)?o:l.type,l=r}if(!((a=l)&&"object"==typeof a)||null==l.type)return;if(t instanceof File)return t;let c=Array.isArray(l.type)?function(e,t,r){if(void 0==t){if(null!=r){let t=E(r);if(e.includes(t))return t}return e[0]}let n=E(t);return e.includes(n)?n:e[0]}(l.type,t,l.default):l.type,u=E(t);if(null!=t&&u!==c&&("number"!==u||"integer"!==c)&&(t=function(e,t){if("string"===e)return JSON.stringify(t);if("string"!=typeof t)return null;try{if(typeof(t=JSON.parse(t))===e)return t}catch(e){}return null}(c,t)),null==tN[c]){if(i.removeInvalidData)return;return t}return tN[c](e,l,t,n,i)}let tN={null:(e,t,r)=>t_(t,r,null),string:(e,t,r)=>t_(t,r,""),number:(e,t,r)=>t_(t,r,0),integer:(e,t,r)=>t_(t,r,0),boolean:(e,t,r)=>t_(t,r,!1),object:(e,t,r,n,i)=>{var o;let s=void 0===t.default?{}:t.default,a={},l=!1===i.extendDefaults&&void 0!==t.default?[]:null!=(o=t.required)?o:[];t.properties&&Object.keys(t.properties).forEach(o=>{let c=null==r||null==r[o]?s[o]:r[o],u=l.includes(o);(null!=c||u||i.addOptionalProps)&&(a[o]=tR(e,c,t.properties[o],`${n}/properties/${o}`,i))});let c=ej(e,t,a);c&&(c=W(t,c),delete c.dependencies,Object.assign(a,tR(e,r,c,`${n}/dependencies`,i))),r&&(!0===i.removeInvalidData&&(!1===t.additionalProperties||"object"===E(t.additionalProperties))?"object"===E(t.additionalProperties)&&Object.keys(r).forEach(n=>{null==a[n]&&e.isValid(r[n],t.additionalProperties)&&(a[n]=r[n])}):Object.keys(r).forEach(e=>null==a[e]&&(a[e]=r[e])));let u=ew(e,t,a);if(u){let t=tR(e,a,{type:"object",...u},n,i);Object.assign(a,t)}return a},array:(e,t,r,n,i)=>{var o,s;if(null==t.items)return r||[];let a=void 0===t.default?[]:t.default,l=r||a,c=!1===i.extendDefaults&&void 0!==t.default?0:t.minItems||0;if(Array.isArray(t.items)){for(let r=0,u=Math.max(null!=c?c:0,null!=(s=null==(o=t.items)?void 0:o.length)?s:0);r<u;r+=1)l[r]=tR(e,null==l[r]?a[r]:l[r],t.items[r],`${n}/items/${r}`,i);return l}if("object"!==E(t.items))return l;let u=tD(e,t.items,r,n,i);if(!1===u)return l;if(n=u.pointer||n,u.oneOf&&0===l.length){let t=u.oneOf[0];for(let r=0;r<c;r+=1)l[r]=tR(e,null==l[r]?a[r]:l[r],t,`${n}/oneOf/0`,i);return l}if(u.oneOf&&l.length>0){let t=Math.max(c,l.length);for(let r=0;r<t;r+=1){let t=null==l[r]?a[r]:l[r],o=N(e,t,u);null==o||$(o)?null!=t&&!0!==i.removeInvalidData?l[r]=t:(t=void 0,o=u.oneOf[0],l[r]=tR(e,t,o,`${n}/oneOf/${r}`,i)):l[r]=tR(e,t,o,`${n}/oneOf/${r}`,i)}return l}if(u.type)for(let t=0,r=Math.max(c,l.length);t<r;t+=1)l[t]=tR(e,null==l[t]?a[t]:l[t],u,`${n}/items`,i);return l}};function t_(e,t,r){return null!=t?t:e.const?e.const:void 0===e.default&&Array.isArray(e.enum)?e.enum[0]:void 0===e.default?r:e.default}function tL(e){let t=[],r=0,n=e.length;for(;r<n;){let i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){let n=e.charCodeAt(r++);(64512&n)==56320?t.push(((1023&i)<<10)+(1023&n)+65536):(t.push(i),r--)}else t.push(i)}return t}function tF(e){let t=`${e}`,r=t.indexOf(".");return -1===r?0:t.length-(r+1)}var tB=r(38792),tz=r.n(tB);let tW=Object.prototype.hasOwnProperty,tV=(e,t)=>!(void 0===e[t]||!tW.call(e,t));function tH(e){if(void 0===e)return;let t={type:E(e)};return"object"===t.type&&eS(e)&&(t.properties={},Object.keys(e).forEach(r=>t.properties[r]=tH(e[r]))),"array"===t.type&&Array.isArray(e)&&(1===e.length?t.items=tH(e[0]):t.items=e.map(tH)),t}let tU={array:(e,t,r,n,i)=>{let o=null==n?void 0:n[t],s=E(r.items);if("object"===s)return eP(e,r.items,o,`${i}/${t}`)||e.resolveRef(r.items);if("array"===s){if(!0===r.items[t])return tH(o);if(!1===r.items[t])return e.errors.invalidDataError({key:t,value:o,pointer:i,schema:r});if(r.items[t])return e.resolveRef(r.items[t]);if(!1===r.additionalItems)return e.errors.additionalItemsError({key:t,value:o,pointer:i,schema:r});if(!0===r.additionalItems||void 0===r.additionalItems)return tH(o);if("object"===E(r.additionalItems))return r.additionalItems;throw Error(`Invalid schema ${JSON.stringify(r,null,2)} for ${JSON.stringify(n,null,2)}`)}return!1!==r.additionalItems&&o?tH(o):Error(`Invalid array schema for ${t} at ${i}`)},object:(e,t,r,n,i)=>{var o;let s=null==(o=null==(r=eP(e,r,n,i))?void 0:r.properties)?void 0:o[t];if(void 0!==s){if(!1===s)return e.errors.forbiddenPropertyError({property:t,value:n,pointer:i,schema:r});if(!0===s)return tH(null==n?void 0:n[t]);let o=e.resolveRef(s);if($(o))return o;if(o&&Array.isArray(o.oneOf)){let r=e.resolveOneOf(n[t],o,`${i}/${t}`);for(let e in o)"oneOf"!==e&&void 0===r[e]&&(r[e]=o[e]);return r}if(o)return o}let{patternProperties:a}=r;if("object"===E(a)){let e=Object.keys(a);for(let r=0,n=e.length;r<n;r+=1)if(new RegExp(e[r]).test(t))return a[e[r]]}let{additionalProperties:l}=r;return"object"===E(l)?r.additionalProperties:n&&(void 0===l||!0===l)?tH(n[t]):e.errors.unknownPropertyError({property:t,value:n,pointer:`${i}`,schema:r})}};T.templateDefaultOptions;let tq="__compiled",tK="__ref",tG=/(#|\/)+$/g;T.templateDefaultOptions;let tJ={typeKeywords:{array:["allOf","anyOf","contains","enum","if","items","maxItems","minItems","not","oneOf","uniqueItems"],boolean:["allOf","anyOf","enum","not","oneOf"],object:["additionalProperties","allOf","anyOf","dependencies","enum","format","if","maxProperties","minProperties","not","oneOf","patternProperties","properties","propertyNames","required"],string:["allOf","anyOf","enum","format","if","maxLength","minLength","not","oneOf","pattern"],number:["allOf","anyOf","enum","exclusiveMaximum","exclusiveMinimum","format","if","maximum","minimum","multipleOf","not","oneOf"],null:["allOf","anyOf","enum","format","not","oneOf"]},validateKeyword:{additionalProperties:(e,t,r,n)=>{if(!0===t.additionalProperties||null==t.additionalProperties||"object"===E(t.patternProperties)&&!1===t.additionalProperties)return;let i=[],o=Object.keys(r).filter(e=>!1===T.propertyBlacklist.includes(e)),s=Object.keys(t.properties||{});if("object"===E(t.patternProperties)){let e=Object.keys(t.patternProperties).map(e=>new RegExp(e));o=o.filter(t=>{for(let r=0;r<e.length;r+=1)if(e[r].test(t))return!1;return!0})}for(let a=0,l=o.length;a<l;a+=1){let l=o[a];if(-1===s.indexOf(l)){let c=eS(t.additionalProperties);if(c&&Array.isArray(t.additionalProperties.oneOf)){let c=e.resolveOneOf(r[l],t.additionalProperties,`${n}/${l}`);$(c)?i.push(e.errors.additionalPropertiesError({pointer:n,schema:t.additionalProperties,value:r,property:o[a],properties:s,errors:c.data.errors})):i.push(...e.validate(r[l],c,n))}else c?i.push(...e.validate(r[l],t.additionalProperties,`${n}/${l}`)):i.push(e.errors.noAdditionalPropertiesError({pointer:n,schema:t,value:r,property:o[a],properties:s}))}}return i},allOf:(e,t,r,n)=>{let{allOf:i}=t;if(!Array.isArray(i)||0===i.length)return;let o=[];return t.allOf.forEach(t=>{o.push(...e.validate(r,t,n))}),o},anyOf:(e,t,r,n)=>{if(Array.isArray(t.anyOf)&&0!==t.anyOf.length){for(let n=0;n<t.anyOf.length;n+=1)if(e.isValid(r,t.anyOf[n]))return;return e.errors.anyOfError({pointer:n,schema:t,value:r,anyOf:t.anyOf})}},dependencies:(e,t,r,n)=>{if("object"!==E(t.dependencies))return;let i=[];return Object.keys(r).forEach(o=>{let s;if(void 0===t.dependencies[o]||!0===t.dependencies[o])return;if(!1===t.dependencies[o])return void i.push(e.errors.missingDependencyError({pointer:n,schema:t,value:r}));let a=E(t.dependencies[o]);if("array"===a)s=t.dependencies[o].filter(e=>void 0===r[e]).map(i=>e.errors.missingDependencyError({missingProperty:i,pointer:n,schema:t,value:r}));else if("object"===a)s=e.validate(r,t.dependencies[o],n);else throw Error(`Invalid dependency definition for ${n}/${o}. Must be string[] or schema`);i.push(...s)}),i.length>0?i:void 0},enum:(e,t,r,n)=>{let i=E(r);if("object"===i||"array"===i){let e=JSON.stringify(r);for(let r=0;r<t.enum.length;r+=1)if(JSON.stringify(t.enum[r])===e)return}else if(t.enum.includes(r))return;return e.errors.enumError({pointer:n,schema:t,value:r,values:t.enum})},format:(e,t,r,n)=>{if(e.validateFormat[t.format])return e.validateFormat[t.format](e,t,r,n)},items:(e,t,r,n)=>{if(!1===t.items){if(Array.isArray(r)&&0===r.length)return;return e.errors.invalidDataError({pointer:n,value:r,schema:t})}let i=[];for(let o=0;o<r.length;o+=1){let s=r[o],a=e.step(o,t,r,n);if($(a))return[a];let l=e.validate(s,a,`${n}/${o}`);i.push(...l)}return i},maximum:(e,t,r,n)=>{if(!isNaN(t.maximum)){if(t.maximum&&t.maximum<r)return e.errors.maximumError({maximum:t.maximum,length:r,value:r,pointer:n,schema:t});if(t.maximum&&!0===t.exclusiveMaximum&&t.maximum===r)return e.errors.maximumError({maximum:t.maximum,length:r,pointer:n,schema:t,value:r})}},maxItems:(e,t,r,n)=>{if(!isNaN(t.maxItems)&&t.maxItems<r.length)return e.errors.maxItemsError({maximum:t.maxItems,length:r.length,schema:t,value:r,pointer:n})},maxLength:(e,t,r,n)=>{if(isNaN(t.maxLength))return;let i=tL(r).length;if(t.maxLength<i)return e.errors.maxLengthError({maxLength:t.maxLength,length:i,pointer:n,schema:t,value:r})},maxProperties:(e,t,r,n)=>{let i=Object.keys(r).length;if(!1===isNaN(t.maxProperties)&&t.maxProperties<i)return e.errors.maxPropertiesError({maxProperties:t.maxProperties,length:i,pointer:n,schema:t,value:r})},minLength:(e,t,r,n)=>{if(isNaN(t.minLength))return;let i=tL(r).length;if(t.minLength>i)return 1===t.minLength?e.errors.minLengthOneError({minLength:t.minLength,length:i,pointer:n,schema:t,value:r}):e.errors.minLengthError({minLength:t.minLength,length:i,pointer:n,schema:t,value:r})},minimum:(e,t,r,n)=>{if(!isNaN(t.minimum)&&(t.minimum>r||!0===t.exclusiveMinimum&&t.minimum===r))return e.errors.minimumError({minimum:t.minimum,length:r,pointer:n,schema:t,value:r})},minItems:(e,t,r,n)=>{if(!isNaN(t.minItems)&&t.minItems>r.length)return 1===t.minItems?e.errors.minItemsOneError({minItems:t.minItems,length:r.length,pointer:n,schema:t,value:r}):e.errors.minItemsError({minItems:t.minItems,length:r.length,pointer:n,schema:t,value:r})},minProperties:(e,t,r,n)=>{if(isNaN(t.minProperties))return;let i=Object.keys(r).length;if(t.minProperties>i)return e.errors.minPropertiesError({minProperties:t.minProperties,length:i,pointer:n,schema:t,value:r})},multipleOf:(e,t,r,n)=>{if(isNaN(t.multipleOf)||"number"!=typeof r)return;let i=tF(r),o=tF(t.multipleOf);if(i>o)return e.errors.multipleOfError({multipleOf:t.multipleOf,value:r,pointer:n,schema:t});let s=Math.pow(10,o);if(Math.round(r*s)%Math.round(t.multipleOf*s)/s!=0)return e.errors.multipleOfError({multipleOf:t.multipleOf,value:r,pointer:n,schema:t})},not:(e,t,r,n)=>{let i=[];return 0===e.validate(r,t.not,n).length&&i.push(e.errors.notError({value:r,not:t.not,pointer:n,schema:t})),i},oneOf:(e,t,r,n)=>{if(Array.isArray(t.oneOf)){let i=e.resolveOneOf(r,t,n);if($(i))return i}},pattern:(e,t,r,n)=>{if(!1===RegExp(t.pattern,"u").test(r))return e.errors.patternError({pattern:t.pattern,description:t.patternExample||t.pattern,received:r,schema:t,value:r,pointer:n})},patternProperties:(e,t,r,n)=>{let i=t.properties||{},o=t.patternProperties;if("object"!==E(o))return;let s=[],a=Object.keys(r),l=Object.keys(o).map(e=>({regex:new RegExp(e),patternSchema:o[e]}));return a.forEach(a=>{let c=!1;for(let t=0,i=l.length;t<i;t+=1)if(l[t].regex.test(a)){c=!0;let i=e.validate(r[a],l[t].patternSchema,`${n}/${a}`);i&&i.length>0&&s.push(...i)}i[a]||!1===c&&!1===t.additionalProperties&&s.push(e.errors.patternPropertiesError({key:a,pointer:n,schema:t,value:r,patterns:Object.keys(o).join(",")}))}),s},properties:(e,t,r,n)=>{let i=[],o=Object.keys(t.properties||{});for(let s=0;s<o.length;s+=1){let a=o[s];if(tV(r,a)){let o=e.step(a,t,r,n),s=e.validate(r[a],o,`${n}/${a}`);i.push(...s)}}return i},propertiesRequired:(e,t,r,n)=>{let i=[],o=Object.keys(t.properties||{});for(let s=0;s<o.length;s+=1){let a=o[s];if(void 0===r[a])i.push(e.errors.requiredPropertyError({key:a,pointer:n,schema:t,value:r}));else{let o=e.step(a,t,r,n),s=e.validate(r[a],o,`${n}/${a}`);i.push(...s)}}return i},required:(e,t,r,n)=>{if(!1!==Array.isArray(t.required))return t.required.map(i=>{if(!tV(r,i))return e.errors.requiredPropertyError({key:i,pointer:n,schema:t,value:r})})},requiredNotEmpty:(e,t,r,n)=>{if(!1!==Array.isArray(t.required))return t.required.map(i=>{if(null==r[i]||""===r[i])return e.errors.valueNotEmptyError({property:i,pointer:`${n}/${i}`,schema:t,value:r})})},uniqueItems:(e,t,r,n)=>{if(!1===(Array.isArray(r)&&t.uniqueItems))return;let i=[],o=[];return r.forEach((s,a)=>{for(let l=a+1;l<r.length;l+=1)tz()(s,r[l])&&!i.includes(l)&&(o.push(e.errors.uniqueItemsError({pointer:`${n}/${l}`,duplicatePointer:`${n}/${a}`,arrayPointer:n,value:JSON.stringify(s),schema:t})),i.push(l))}),o},contains:(e,t,r,n)=>{if(!1===t.contains)return e.errors.containsArrayError({pointer:n,value:r,schema:t});if(!0===t.contains)return Array.isArray(r)&&0===r.length?e.errors.containsAnyError({pointer:n,value:r,schema:t}):void 0;if("object"===E(t.contains)){for(let n=0;n<r.length;n+=1)if(e.isValid(r[n],t.contains))return;return e.errors.containsError({pointer:n,schema:t,value:r})}},exclusiveMaximum:(e,t,r,n)=>{if(!isNaN(t.exclusiveMaximum)&&t.exclusiveMaximum<=r)return e.errors.maximumError({maximum:t.exclusiveMaximum,length:r,pointer:n,schema:t,value:r})},exclusiveMinimum:(e,t,r,n)=>{if(!isNaN(t.exclusiveMinimum)&&t.exclusiveMinimum>=r)return e.errors.minimumError({minimum:t.exclusiveMinimum,length:r,pointer:n,schema:t,value:r})},if:(e,t,r,n)=>{let i=ew(e,t,r);if(i)return e.validate(r,i,n)},maximum:(e,t,r,n)=>{if(!isNaN(t.maximum)&&t.maximum&&t.maximum<r)return e.errors.maximumError({maximum:t.maximum,length:r,pointer:n,schema:t,value:r})},minimum:(e,t,r,n)=>{if(!isNaN(t.minimum)&&t.minimum>r)return e.errors.minimumError({minimum:t.minimum,length:r,pointer:n,schema:t,value:r})},patternProperties:(e,t,r,n)=>{let i=t.properties||{},o=t.patternProperties;if("object"!==E(o))return;let s=[],a=Object.keys(r),l=Object.keys(o).map(e=>({regex:new RegExp(e),patternSchema:o[e]}));return a.forEach(a=>{let c=!1;for(let i=0,u=l.length;i<u;i+=1)if(l[i].regex.test(a)){if(c=!0,!1===l[i].patternSchema)return void s.push(e.errors.patternPropertiesError({key:a,pointer:n,patterns:Object.keys(o).join(","),schema:t,value:r}));let u=e.validate(r[a],l[i].patternSchema,`${n}/${a}`);u&&u.length>0&&s.push(...u)}i[a]||!1===c&&!1===t.additionalProperties&&s.push(e.errors.patternPropertiesError({key:a,pointer:n,patterns:Object.keys(o).join(","),schema:t,value:r}))}),s},propertyNames:(e,t,r,n)=>{if(!1===t.propertyNames){if(0===Object.keys(r).length)return;return e.errors.invalidPropertyNameError({property:Object.keys(r),pointer:n,value:r,schema:t})}if(!0===t.propertyNames||"object"!==E(t.propertyNames))return;let i=[],o=Object.keys(r),s={...t.propertyNames,type:"string"};return o.forEach(o=>{let a=e.validate(o,s,`${n}/${o}`);a.length>0&&i.push(e.errors.invalidPropertyNameError({property:o,pointer:n,validationError:a[0],value:r[o],schema:t}))}),i}},validateType:{array:(e,t,r,n)=>e.typeKeywords.array.filter(e=>t&&null!=t[e]).map(i=>e.validateKeyword[i](e,t,r,n)),object:(e,t,r,n)=>e.typeKeywords.object.filter(e=>t&&null!=t[e]).map(i=>e.validateKeyword[i](e,t,r,n)),string:(e,t,r,n)=>e.typeKeywords.string.filter(e=>t&&null!=t[e]).map(i=>e.validateKeyword[i](e,t,r,n)),integer:(e,t,r,n)=>e.typeKeywords.number.filter(e=>t&&null!=t[e]).map(i=>e.validateKeyword[i](e,t,r,n)),number:(e,t,r,n)=>e.typeKeywords.number.filter(e=>t&&null!=t[e]).map(i=>e.validateKeyword[i](e,t,r,n)),boolean:(e,t,r,n)=>e.typeKeywords.boolean.filter(e=>t&&null!=t[e]).map(i=>e.validateKeyword[i](e,t,r,n)),null:(e,t,r,n)=>e.typeKeywords.null.filter(e=>t&&null!=t[e]).map(i=>e.validateKeyword[i](e,t,r,n))},validateFormat:{date:(e,t,r,n)=>{if("string"!=typeof r||""===r)return;let i=r.match(tA);if(!i)return e.errors.formatDateTimeError({value:r,pointer:n,schema:t});let o=+i[1],s=+i[2],a=+i[3];if(!(s>=1)||!(s<=12)||!(a>=1)||!(a<=(2==s&&o%4==0&&(o%100!=0||o%400==0)?29:tj[s])))return e.errors.formatDateError({value:r,pointer:n,schema:t})},"date-time":(e,t,r,n)=>{if("string"==typeof r&&""!==r)return""===r||tb.test(r)?"Invalid Date"===new Date(r).toString()?e.errors.formatDateTimeError({value:r,pointer:n,schema:t}):void 0:e.errors.formatDateTimeError({value:r,pointer:n,schema:t})},email:(e,t,r,n)=>{if("string"!=typeof r||""===r)return;if('"'===r[0])return e.errors.formatEmailError({value:r,pointer:n,schema:t});let[i,o,...s]=r.split("@");if(!i||!o||0!==s.length||i.length>64||o.length>253||"."===i[0]||i.endsWith(".")||i.includes("..")||!/^[a-z0-9.-]+$/i.test(o)||!/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+$/i.test(i)||!o.split(".").every(e=>/^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?$/i.test(e)))return e.errors.formatEmailError({value:r,pointer:n,schema:t})},"idn-email":(e,t,r,n)=>{if("string"==typeof r&&""!==r)try{(0,tv.parse)(r);return}catch(i){return e.errors.formatEmailError({value:r,pointer:n,schema:t})}},hostname:(e,t,r,n)=>{if("string"==typeof r&&!(""===r||tk.test(r)))return e.errors.formatHostnameError({value:r,pointer:n,schema:t})},ipv4:(e,t,r,n)=>"string"!=typeof r||""===r?void 0:r&&"0"===r[0]?e.errors.formatIPV4LeadingZeroError({value:r,pointer:n,schema:t}):r.length<=15&&tx.test(r)?void 0:e.errors.formatIPV4Error({value:r,pointer:n,schema:t}),ipv6:(e,t,r,n)=>"string"!=typeof r||""===r?void 0:r&&"0"===r[0]?e.errors.formatIPV6LeadingZeroError({value:r,pointer:n,schema:t}):r.length<=45&&tw.test(r)?void 0:e.errors.formatIPV6Error({value:r,pointer:n,schema:t}),"json-pointer":(e,t,r,n)=>{if("string"==typeof r&&""!==r&&!tC.test(r))return e.errors.formatJsonPointerError({value:r,pointer:n,schema:t})},"relative-json-pointer":(e,t,r,n)=>{if("string"==typeof r&&""!==r&&!tE.test(r))return e.errors.formatJsonPointerError({value:r,pointer:n,schema:t})},regex:(e,t,r,n)=>{if("string"==typeof r&&!1===/\\Z$/.test(r)){try{new RegExp(r);return}catch(e){}return e.errors.formatRegExError({value:r,pointer:n,schema:t})}if(!("object"==typeof r||"number"==typeof r||Array.isArray(r)))return e.errors.formatRegExError({value:r,pointer:n,schema:t})},time:(e,t,r,n)=>{if("string"==typeof r&&""!==r)return r.match(tS)?void 0:e.errors.formatDateTimeError({value:r,pointer:n,schema:t})},uri:(e,t,r,n)=>{if("string"==typeof r&&""!==r&&!ty().isUri(r))return e.errors.formatURIError({value:r,pointer:n,schema:t})},"uri-reference":(e,t,r,n)=>{if("string"==typeof r&&""!==r&&!tO.test(r))return e.errors.formatURIReferenceError({value:r,pointer:n,schema:t})},"uri-template":(e,t,r,n)=>{if("string"==typeof r&&""!==r&&!tM.test(r))return e.errors.formatURITemplateError({value:r,pointer:n,schema:t})},url:(e,t,r,n)=>{if(!(""===r||ty().isWebUri(r)))return e.errors.formatURLError({value:r,pointer:n,schema:t})}},errors:tm,addRemoteSchema:function(e,t,r){r.id=r.id||t,e.remotes[t]=e.compileSchema(r)},compileSchema:function(e,t,r=t,n=!1){if(!0===t||!1===t||void 0===t||void 0!==t[tq])return t;let i={ids:{},remotes:e.remotes},o=JSON.stringify(t),s=JSON.parse(o);if(Object.defineProperty(s,tq,{enumerable:!1,value:!0}),Object.defineProperty(s,"getRef",{enumerable:!1,value:(function e(t,r,n){let i;if("object"===E(n)&&(n=n.__ref||n.$ref),null==n)return r;let o=n.replace(tp,"");if(t.remotes[o])return(i=t.remotes[o])&&i.$ref?e(t,r,i.$ref):i;if(t.ids[n])return(i=(0,eI.get)(r,t.ids[n]))&&i.$ref?e(t,r,i.$ref):i;let s=function(e){if(tf.includes(e))return[];if(-1===(e=e.replace(td,"")).indexOf("#")||0===e.indexOf("#"))return[e.replace(td,"")];let t=e.split("#");return t[0]=t[0].replace(td,""),t[1]=`#${t[1].replace(td,"")}`,t}(n);if(0===s.length)return r;if(1===s.length){if(n=s[0],t.remotes[n])return i=t.remotes[n],e(t,r,i.$ref);if(t.ids[n])return(i=(0,eI.get)(r,t.ids[n]))&&i.$ref?e(t,r,i.$ref):i}if(2===s.length){let i=s[0];if(n=s[1],t.remotes[i])return t.remotes[i].getRef?t.remotes[i].getRef(n):e(t,t.remotes[i],n);if(t.ids[i])return e(t,(0,eI.get)(r,t.ids[i]),n)}return(i=(0,eI.get)(r,t.ids[n]||n))&&i.$ref?e(t,r,i.$ref):i}).bind(null,i,s)}),!1===n&&!1===o.includes("$ref"))return s;s!==r&&Object.defineProperty(s,"$defs",{enumerable:!0,value:Object.assign({},r.definitions,r.$defs,s.definitions,s.$defs)});let a={},l=()=>s;return to(s,(e,t)=>{var r;if(e.$id){if(e.$id.startsWith("http")&&/(allOf|anyOf|oneOf)\/\d+$/.test(t)){let n=t.replace(/\/(allOf|anyOf|oneOf)\/\d+$/,"");e.$id=null!=(r=(0,eI.get)(s,n).$id)?r:e.$id}i.ids[e.$id.replace(tG,"")]=t}let n=(t=`#${t}`.replace(/##+/,"#")).replace(/\/[^/]+$/,""),o=t.replace(/\/[^/]+\/[^/]+$/,""),c=th(a[n]||a[o],e.$id);a[t]=c,null==i.ids[c]&&(i.ids[c]=t),e.$ref&&!e[tK]&&(Object.defineProperty(e,tK,{enumerable:!1,value:th(c,e.$ref)}),Object.defineProperty(e,"getRoot",{enumerable:!1,value:l}))}),s},createSchemaOf:tH,each:function(e,t,r,n=e.rootSchema,i="#"){r(n=e.resolveRef(n),t,i);let o=E(t);"object"===o?Object.keys(t).forEach(o=>{let s=e.step(o,n,t,i),a=t[o];e.each(a,r,s,`${i}/${o}`)}):"array"===o&&t.forEach((o,s)=>{let a=e.step(s,n,t,i);e.each(o,r,a,`${i}/${s}`)})},eachSchema:to,getChildSchemaSelection:function(e,t,r=e.rootSchema){var n;if(r.oneOf)return r.oneOf.map(t=>e.resolveRef(t));if(null==(n=r.items)?void 0:n.oneOf)return r.items.oneOf.map(t=>e.resolveRef(t));let i=e.step(t,r,{},"#");return $(i)?i:[i]},getSchema:function(e,t=tP){let{pointer:r="#",data:n,schema:i=e.rootSchema,withSchemaWarning:o=!1}=t,s=e$().split(r),a=function e(t,r,n,i,o=tP){if(0===n.length)return t.resolveRef(r);let s=n.shift();return $(r=t.step(s,r,o,i))?r:(o=o[s],e(t,r,n,`${i}/${s}`,o))}(e,e.resolveRef(i),s,"#",n);if(o||(null==a?void 0:a.code)!=="schema-warning")return a},getTemplate:(e,t,r=e.rootSchema,i)=>(n={},i)?tR(e,t,r,"#",{...tT,...i}):tR(e,t,r,"#",tT),isValid:function(e,t,r=e.rootSchema,n="#"){return 0===e.validate(t,r,n).length},resolveAllOf:function(e,t,r=e.rootSchema){let n=ex(r);for(let i=0;i<r.allOf.length;i+=1)n=W(n,ek(e,r.allOf[i],t));return delete n.allOf,n},resolveAnyOf:function(e,t,r=e.rootSchema,n="#"){let{anyOf:i}=r;if(!Array.isArray(i)||0===i.length)return r;let o=eC(e,r,t);return null==o?e.errors.anyOfError({pointer:n,schema:r,value:t,anyOf:JSON.stringify(i)}):V(W(r,o),"anyOf")},resolveOneOf:function(e,t,r=e.rootSchema,n="#"){if(null!=t&&r[R]){let i=[],o=r[R],s=t[r[R]];if(void 0===s)return e.errors.missingOneOfPropertyError({property:o,pointer:n,schema:r,value:t});for(let a=0;a<r.oneOf.length;a+=1){let l=e.resolveRef(r.oneOf[a]),c=e.step(o,l,t,n);if($(c))return c;let u=P(e.validate(s,c,n));if(!((u=u.filter(D)).length>0))return I(r,l,a);i.push(...u)}return e.errors.oneOfPropertyError({property:o,value:s,pointer:n,schema:r,errors:i})}let i=[],o=[];for(let s=0;s<r.oneOf.length;s+=1){let a=e.resolveRef(r.oneOf[s]),l=P(e.validate(t,a,n));(l=l.filter(D)).length>0?o.push(...l):i.push({index:s,schema:a})}return 1===i.length?I(r,i[0].schema,i[0].index):i.length>1?e.errors.multipleOneOfError({value:t,pointer:n,schema:r,matches:i}):e.errors.oneOfError({value:JSON.stringify(t),pointer:n,schema:r,oneOf:r.oneOf,errors:o})},resolveRef:function(e,t){return null==e||null==e.$ref?e:e.getRoot?e.getRoot().getRef(e):t.getRef(e)},step:function(e,t,r,n,i="#"){var o;let s=E(n),a=null!=(o=r.type)?o:s;if(Array.isArray(a)){if(!a.includes(s))return e.errors.typeError({value:n,pointer:i,expected:r.type,received:s,schema:r});a=s}let l=tU[a];if(l){let o=l(e,`${t}`,r,n,i);return void 0===o?e.errors.schemaWarning({pointer:i,value:n,schema:r,key:t}):o}return Error(`Unsupported schema type ${r.type} for key ${t}`)},validate:function(e,t,r=e.rootSchema,n="#"){var i;let o;if("boolean"===E(r=e.resolveRef(r)))return r?[]:[e.errors.invalidDataError({pointer:n,schema:r,value:t})];if($(r))return[r];if(void 0!==r.const)return tz()(r.const,t)?[]:[e.errors.constError({pointer:n,schema:r,value:t,expected:r.const})];let s=(i=r.type,"number"===(o=E(t))&&("integer"===i||Array.isArray(i)&&i.includes("integer"))?Number.isInteger(t)||isNaN(t)?"integer":"number":o),a=r.type||s;return s===a||Array.isArray(a)&&a.includes(s)?null==e.validateType[s]?[e.errors.invalidTypeError({pointer:n,schema:r,value:t,receivedType:s})]:P(e.validateType[s](e,r,t,n)).filter(D):[e.errors.typeError({pointer:n,schema:r,value:t,received:s,expected:a})]},templateDefaultOptions:T.templateDefaultOptions};class tY extends eT{constructor(e,t={}){super(B(tJ,t),e)}}({...tJ,resolveOneOf:N,resolveRef:function(e,t){if(null==e||null==e.$ref)return e;let r=Object.assign({},t.getRef(e),e);return delete r.$ref,Object.defineProperty(r,"__ref",{enumerable:!1,value:e.__ref}),Object.defineProperty(r,"getRoot",{enumerable:!1,value:e.getRoot}),r}});var tX=r(45250),tZ=r(14041),tQ=r.t(tZ,2),t0=r(4794),t1=r.n(t0),t2=r(12784),t4=r.n(t2),t3=r(46108),t5=r.n(t3),t6=r(75706),t9=r(97909),t8=r(17875),t7=r(79541),re=r(62416),rt=r(26611),rr=r(6451),rn=r(5507),ri=r(77795),ro=r(9739),rs=r(34861),ra=r(71135),rl=r(16249);let rc=e=>{let{setSecrets:t,secrets:r}=(0,t9.Z)(),{name:n,onChange:i,schema:{title:o,minLength:s,maxLength:a},required:l,disabled:c}=e,[u,h]=(0,tZ.useState)(r[n]??""),d=(0,tZ.useMemo)(()=>t4()(e=>{t({[n]:e})},300),[t,n]);return(0,v.jsx)(rl.A,{id:o,label:o,"aria-describedby":o,onChange:e=>{let t=e.target.value;h(t),i(Array(t.length).fill("*").join("")),d(t)},value:u,type:"password",autoComplete:"off",required:l,disabled:c,inputProps:{minLength:s,maxLength:a}})};var ru=r(22139),rh=r(82235),rd=r(58464),rf=r(54094),rp=r(34345),rm=r(95201),rg=r(71004),ry=r(8886),rv=r(21775),rb=r(63653),rx=r(19742),rw=r(63374),rk=r(23654);let rA=[{component:t8.q,name:"EntityPicker",schema:rm.f2},{component:t7.R,name:"EntityNamePicker",validation:re._,schema:rg.a},{component:rt.t,name:"EntityTagsPicker",schema:ry.u},{component:rn.e,name:"RepoUrlPicker",validation:ri._,schema:rv.d},{component:rr.u,name:"OwnerPicker",schema:rb.h},{component:ro.F,name:"OwnedEntityPicker",schema:rx.M},{component:rs.T,name:"MyGroupsPicker",schema:rw.M},{component:e=>{let{schema:{description:t},rawErrors:r,disabled:n,errors:i,required:o,uiSchema:s}=e;return(0,v.jsx)(ra.g,{rawErrors:r,rawDescription:s["ui:description"]??t,disabled:n,errors:i,required:o,children:(0,v.jsx)(rc,{...e})})},name:"Secret"},{component:ru.R,name:"MultiEntityPicker",schema:rk.mG,validation:ru.e},{component:rh.z,name:"RepoBranchPicker",schema:rd._},{component:rf.O,name:"RepoOwnerPicker",schema:rp.b}];var rS=r(66446),rj=r(73466),rC=r(63163),rE=r(8973),rO=r(91567),rM=r(29655),rP=r(77125),rT=r(72501),rI=r(58837),r$=r(6924),rD=r(86613),rR=r(98312),rN=r(34839),r_=r(45917),rL=r(32585),rF=r(96872),rB=r(12554),rz=r(56711),rW=r(75202),rV=r(28364),rH=r(82326),rU=r(79182),rq=r(16454),rK=r(47250),rG=r(29365),rJ=r(46423),rY=r(5951),rX=r(26343),rZ=r(28233),rQ=r(55197),r0=r(25534),r1=r(82451),r2=r(75625),r4=r(20353),r3=r(43135),r5=r(71407),r6=r(90712),r9=r(31627);let r8=(0,r(67254).h)({id:"scaffolder-react",messages:{passwordWidget:{content:"This widget is insecure. Please use [`ui:field: Secret`](https://backstage.io/docs/features/software-templates/writing-templates/#using-secrets) instead of `ui:widget: password`"},scaffolderPageContextMenu:{moreLabel:"more",createLabel:"Create",editorLabel:"Manage Templates",actionsLabel:"Installed Actions",tasksLabel:"Task List",templatingExtensionsLabel:"Templating Extensions"},stepper:{backButtonText:"Back",createButtonText:"Create",reviewButtonText:"Review",stepIndexLabel:"Step {{index, number}}",nextButtonText:"Next"},templateCategoryPicker:{title:"Categories"},templateCard:{noDescription:"No description",chooseButtonText:"Choose"},cardHeader:{detailBtnTitle:"Show template entity details"},templateOutputs:{title:"Text Output"},workflow:{noDescription:"No description"}}}),r7=(0,rI.A)(e=>({button:{color:e.page.fontColor}}));function ne(e){let{t}=(0,rK.i)(r8),{onEditorClicked:r,onActionsClicked:n,onTasksClicked:i,onCreateClicked:o,onTemplatingExtensionsClicked:s}=e,a=r7(),[l,c]=(0,tZ.useState)(),{allowed:u}=(0,r6.J)({permission:r9.$});return r||n||i||o||s?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(rG.A,{id:"long-menu","aria-label":t("scaffolderPageContextMenu.moreLabel"),"aria-controls":"long-menu","aria-expanded":!!l,"aria-haspopup":"true",role:"button",onClick:e=>{c(e.currentTarget)},"data-testid":"menu-button",color:"inherit",className:a.button,children:(0,v.jsx)(r5.default,{})}),(0,v.jsx)(rQ.Ay,{"aria-labelledby":"long-menu",open:!!l,onClose:()=>{c(void 0)},anchorEl:l,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:(0,v.jsxs)(rZ.A,{children:[o&&(0,v.jsxs)(rX.A,{onClick:o,children:[(0,v.jsx)(rJ.A,{children:(0,v.jsx)(r0.default,{fontSize:"small"})}),(0,v.jsx)(rY.A,{primary:t("scaffolderPageContextMenu.createLabel")})]}),r&&u&&(0,v.jsxs)(rX.A,{onClick:r,children:[(0,v.jsx)(rJ.A,{children:(0,v.jsx)(r2.default,{fontSize:"small"})}),(0,v.jsx)(rY.A,{primary:t("scaffolderPageContextMenu.editorLabel")})]}),s&&(0,v.jsxs)(rX.A,{onClick:s,children:[(0,v.jsx)(rJ.A,{children:(0,v.jsx)(r3.default,{fontSize:"small"})}),(0,v.jsx)(rY.A,{primary:t("scaffolderPageContextMenu.templatingExtensionsLabel")})]}),n&&(0,v.jsxs)(rX.A,{onClick:n,children:[(0,v.jsx)(rJ.A,{children:(0,v.jsx)(r1.default,{fontSize:"small"})}),(0,v.jsx)(rY.A,{primary:t("scaffolderPageContextMenu.actionsLabel")})]}),i&&(0,v.jsxs)(rX.A,{onClick:i,children:[(0,v.jsx)(rJ.A,{children:(0,v.jsx)(r4.default,{fontSize:"small"})}),(0,v.jsx)(rY.A,{primary:t("scaffolderPageContextMenu.tasksLabel")})]})]})})]}):null}var nt=r(30268),nr=r(94390),nn=r(69621),ni=r(58007),no=r(8109),ns=r(4321),na=r(61009),nl=r(13677),nc=r(54801),nu=r(10985),nh=r(47625),nd=r(9719),nf=r(71677),np=r(23164),nm=r(85006),ng=r(53373),ny=r.n(ng);let nv=["allOf","anyOf","not","oneOf"],nb=e=>{if(!e.type){if(Object.getOwnPropertyNames(e).some(e=>nv.includes(e)))return;return["unknown"]}return"array"!==e.type?[e.type].flat():[`${e.type}(${e.items?.type??"unknown"})`]},nx=(0,rI.A)({description:{width:"40%",whiteSpace:"normal",wordWrap:"break-word","&.MuiTableCell-root":{whiteSpace:"normal"}},standard:{whiteSpace:"normal"}}),nw=(e,t)=>e.key?`${t.parentId}.${e.key}`:t.parentId,nk={key:"name",title:e=>e("renderSchema.tableCell.name"),render:(e,t)=>(0,v.jsx)("div",{className:ny()(t.classes.code,{[t.classes.codeRequired]:e.required}),children:e.key})},nA={key:"title",title:e=>e("renderSchema.tableCell.title"),render:e=>(0,v.jsx)(rV.h,{content:e.schema.title??""})},nS={key:"description",title:e=>e("renderSchema.tableCell.description"),render:e=>(0,v.jsx)(rV.h,{content:e.schema.description??""}),className:"description"},nj=e=>{if("array"===e.type){if(e.items&&"boolean"!=typeof e.items)if(!Array.isArray(e.items))return e.items?.enum;else{let t=e.items.filter(e=>"object"==typeof e&&"enum"in e).map(e=>e);if(t.length)return t[0].enum}return}return e.enum},nC=e=>"boolean"==typeof e?{canSubschema:!1,hasEnum:!1}:{canSubschema:Object.getOwnPropertyNames(e).some(e=>nv.includes(e))||nb(e).some(e=>e.includes("object")),hasEnum:!!nj(e)},nE={key:"type",title:e=>e("renderSchema.tableCell.type"),render:(e,t)=>{if("boolean"==typeof e.schema)return(0,v.jsx)(rT.A,{children:e.schema?"any":"none"});let r=nb(e.schema),[n,i]=t.expanded,o=nw(e,t),s=nC(e.schema);return(0,v.jsx)(v.Fragment,{children:r?.map((e,t)=>s.canSubschema||s.hasEnum&&0===t?(0,v.jsx)(nr.A,{"data-testid":`expand_${o}`,label:e,icon:n[o]?(0,v.jsx)(np.default,{}):(0,v.jsx)(r$.default,{}),variant:"outlined",onClick:()=>i(e=>({...e,[o]:!e[o]}))},e):(0,v.jsx)(nr.A,{label:e,variant:"outlined"},e))})}},nO=({e,classes:t,...r})=>(0,v.jsx)(ni.A,{...r,children:e.map((e,r)=>{let n=(0,v.jsx)(rT.A,{"data-testid":`enum_el${r}`,className:ny()(t.code),children:JSON.stringify(e)});return null!==e&&["object","array"].includes(typeof e)&&(n=(0,v.jsxs)(v.Fragment,{children:[n,(0,v.jsx)(nf.Ay,{title:(0,v.jsx)(rT.A,{"data-testid":`pretty_${r}`,className:ny()(t.code),style:{whiteSpace:"pre-wrap"},children:JSON.stringify(e,void 0,2)}),children:(0,v.jsx)(rG.A,{"data-testid":`wrap-text_${r}`,children:(0,v.jsx)(nm.default,{})})})]})),(0,v.jsx)(no.A,{children:n},r)})}),nM=(0,rI.A)({schema:{width:"100%",overflowX:"hidden","& table":{width:"100%",tableLayout:"fixed"}}}),nP=({strategy:e,context:t,schema:r})=>{let{t:n}=(0,rK.i)(nt.W),i=nM(),o=nx();return(()=>{if("object"==typeof r){let s,a,l=(e=>{if("boolean"==typeof e)return{};let t={},r={};for(let[n,i]of Object.entries(e))if(nv.includes(n)){let e;if(Array.isArray(i)){if(!i.length)continue;e=i}else{if(!i)continue;e=[i]}r[n]=e}else t[n]=i;return t?.type==="object"||"properties"in t?Object.fromEntries(Object.entries(r).map(([r,n])=>[r,n.map(r=>{if("boolean"!=typeof r&&r.required){let n={};if(e.properties)for(let t of r.required)t in e.properties&&(n[t]=e.properties[t]);return Object.assign(n,r.properties),{...t,...r,properties:n}}return r})])):r})(r);if("root"===e)("type"in r||!Object.keys(l).length)&&(a=[{schema:r}],s=[nE],r.description&&s.unshift(nS),r.title&&s.unshift(nA));else if(r.properties)s=[nk,nA,nS,nE],a=Object.entries(r.properties).map(([e,t])=>({schema:t,key:e,required:r.required?.includes(e)}));else if(!Object.keys(l).length)return;let[c]=t.expanded;return(0,v.jsxs)(v.Fragment,{children:[s&&a&&(0,v.jsx)(nu.A,{component:ns.A,className:i.schema,children:(0,v.jsxs)(na.A,{"data-testid":`${e}_${t.parentId}`,size:"small",children:[(0,v.jsx)(nh.A,{children:(0,v.jsx)(nd.A,{children:s.map((e,t)=>(0,v.jsx)(nc.A,{className:o[e.className??"standard"],children:e.title(n)},t))})}),(0,v.jsx)(nl.A,{children:a.map(r=>{let n=nw(r,t),i=nC(r.schema),a=[(0,v.jsx)(nd.A,{"data-testid":`${e}-row_${n}`,children:s.map(e=>(0,v.jsx)(nc.A,{className:o[e.className??"standard"],children:e.render(r,t)},e.key))})];if("boolean"!=typeof r.schema&&(i.canSubschema||i.hasEnum)){let e=(0,v.jsxs)(rP.A,{"data-testid":`expansion_${n}`,sx:{margin:1},children:[i.canSubschema&&(0,v.jsx)(nP,{strategy:"properties",context:{...t,parentId:n,parent:t},schema:"array"===r.schema.type?r.schema.items:r.schema}),i.hasEnum&&(0,v.jsxs)(v.Fragment,{children:[(0,tZ.cloneElement)(t.headings[0],{},"Valid values:"),(0,v.jsx)(nO,{"data-testid":`enum_${n}`,e:nj(r.schema),classes:t.classes})]})]});nb(r.schema)&&(e=(0,v.jsx)(nn.A,{in:c[n],timeout:"auto",unmountOnExit:!0,children:e})),a.push((0,v.jsx)(nd.A,{children:(0,v.jsx)(nc.A,{style:{paddingBottom:0,paddingTop:0},colSpan:s.length,children:e})}))}return(0,v.jsx)(tZ.Fragment,{children:a},n)})})]})}),Object.keys(l).map(r=>(0,v.jsxs)(tZ.Fragment,{children:[(0,tZ.cloneElement)(t.headings[0],{},r),l[r].map((n,i)=>(0,v.jsx)(nP,{strategy:"boolean"!=typeof n&&"properties"in n?e:"root",...{context:{...t,parentId:`${t.parentId}_${r}${i}`},schema:n}},i))]},r))]})}})()??(0,v.jsx)(rT.A,{children:"No schema defined"})};var nT=r(62112),nI=r(42899);let n$=e=>(0,v.jsx)(nI.A,{"data-testid":"examples",container:!0,children:e.examples.map((e,t)=>(0,v.jsxs)(tZ.Fragment,{children:[(0,v.jsx)(nI.A,{"data-testid":`example_desc${t}`,item:!0,lg:3,children:(0,v.jsxs)(rP.A,{padding:1,style:{overflowX:"auto"},children:[e.description&&(0,v.jsx)(rV.h,{content:e.description}),e.notes?.length&&(0,v.jsx)(rV.h,{content:e.notes})]})}),(0,v.jsx)(nI.A,{"data-testid":`example_code${t}`,item:!0,lg:9,children:(0,v.jsx)(rP.A,{padding:1,children:(0,v.jsx)(nT.z,{text:e.example?.trim(),showLineNumbers:!0,showCopyCodeButton:!0,language:"yaml"})})})]},`example-${t}`))}),nD=(0,rI.A)(e=>({code:{fontFamily:"Menlo, monospace",padding:e.spacing(1),backgroundColor:"dark"===e.palette.type?e.palette.grey[700]:e.palette.grey[300],display:"inline-block",borderRadius:5,border:`1px solid ${e.palette.grey[500]}`,position:"relative"},codeRequired:{"&::after":{position:"absolute",content:'"*"',top:0,right:e.spacing(.5),fontWeight:"bolder",color:e.palette.error.light}},link:{paddingLeft:e.spacing(1)}})),nR=()=>{let e=(0,k.gf)(rC.z),{t}=(0,rK.i)(nt.W),r=nD(),{loading:n,value:i=[],error:o}=(0,rj.A)(async()=>e.listActions(),[e]),[s,a]=(0,tZ.useState)(null),l=(0,tZ.useState)({});return((0,tZ.useEffect)(()=>{i.length&&window.location.hash&&document.querySelector(window.location.hash)?.scrollIntoView()},[i]),n)?(0,v.jsx)(rF.k,{}):o?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(rB.b,{error:o}),(0,v.jsx)(rz.p,{missing:"info",title:t("actionsPage.content.emptyState.title"),description:t("actionsPage.content.emptyState.description")})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(rP.A,{pb:3,children:(0,v.jsx)(rR.Ay,{id:"actions-autocomplete",options:i,loading:n,getOptionLabel:e=>e.id,renderInput:e=>(0,v.jsx)(rl.A,{...e,"aria-label":t("actionsPage.content.searchFieldPlaceholder"),placeholder:t("actionsPage.content.searchFieldPlaceholder"),variant:"outlined",InputProps:{...e.InputProps,startAdornment:(0,v.jsx)(rN.A,{position:"start",children:(0,v.jsx)(r_.default,{})})}}),onChange:(e,t)=>{a(t)},fullWidth:!0})}),(s?[s]:i).map(e=>{if(e.id.startsWith("legacy:"))return;let n={classes:r,expanded:l,headings:[(0,v.jsx)(rT.A,{variant:"h6",component:"h4"})]};return(0,v.jsxs)(rP.A,{pb:3,children:[(0,v.jsxs)(rP.A,{display:"flex",alignItems:"center",children:[(0,v.jsx)(rT.A,{id:e.id.replaceAll(":","-"),variant:"h5",component:"h2",className:r.code,children:e.id}),(0,v.jsx)(rW.N_,{className:r.link,to:`#${e.id.replaceAll(":","-")}`,children:(0,v.jsx)(rD.default,{})})]}),e.description&&(0,v.jsx)(rV.h,{content:e.description}),e.schema?.input&&(0,v.jsxs)(rP.A,{pb:2,children:[(0,v.jsx)(rT.A,{variant:"h6",component:"h3",children:t("actionsPage.action.input")}),(0,v.jsx)(nP,{strategy:"properties",context:{parentId:`${e.id}.input`,...n},schema:e?.schema?.input})]}),e.schema?.output&&(0,v.jsxs)(rP.A,{pb:2,children:[(0,v.jsx)(rT.A,{variant:"h5",component:"h3",children:t("actionsPage.action.output")}),(0,v.jsx)(nP,{strategy:"properties",context:{parentId:`${e.id}.output`,...n},schema:e?.schema?.output})]}),e.examples&&(0,v.jsxs)(rE.A,{children:[(0,v.jsx)(rM.A,{expandIcon:(0,v.jsx)(r$.default,{}),children:(0,v.jsx)(rT.A,{variant:"h6",component:"h3",children:t("actionsPage.action.examples")})}),(0,v.jsx)(rO.A,{children:(0,v.jsx)(rP.A,{pb:2,children:(0,v.jsx)(n$,{examples:e.examples})})})]})]},e.id)})]})},nN=e=>{let t=(0,b.Zp)(),r=(0,rL.S)(rS.Dg),n=(0,rL.S)(rS.JX),i=(0,rL.S)(rS.rQ),o=(0,rL.S)(rS.SE),{t:s}=(0,rK.i)(nt.W),a={onEditorClicked:e?.contextMenu?.editor!==!1?()=>t(r()):void 0,onActionsClicked:void 0,onTasksClicked:e?.contextMenu?.tasks!==!1?()=>t(n()):void 0,onCreateClicked:e?.contextMenu?.create!==!1?()=>t(i()):void 0,onTemplatingExtensionsClicked:e?.contextMenu?.templatingExtensions!==!1?()=>t(o()):void 0};return(0,v.jsxs)(rH.Y,{themeId:"home",children:[(0,v.jsx)(rU.Y,{pageTitleOverride:s("actionsPage.pageTitle"),title:s("actionsPage.title"),subtitle:s("actionsPage.subtitle"),children:(0,v.jsx)(ne,{...a})}),(0,v.jsx)(rq.U,{children:(0,v.jsx)(nR,{})})]})};var n_=r(3571),nL=r(77509),nF=r(40703),nB=r(9684),nz=r(53364);let nW=(0,rI.A)(e=>({root:{backgroundColor:"rgba(0, 0, 0, .11)",boxShadow:"none",margin:e.spacing(1,0,1,0)},title:{margin:e.spacing(1,0,0,1),textTransform:"uppercase",fontSize:12,fontWeight:"bold"},listIcon:{minWidth:30,color:e.palette.text.primary},menuItem:{minHeight:e.spacing(6)},groupWrapper:{margin:e.spacing(1,1,2,1)}}),{name:"ScaffolderReactOwnerListPicker"}),nV=e=>{let{filter:t,onSelectOwner:r}=e,n=nW(),{t:i}=(0,rK.i)(nt.W),o=[{name:i("ownerListPicker.title"),items:[{id:"owned",label:i("ownerListPicker.options.owned"),icon:nB.default},{id:"all",label:i("ownerListPicker.options.all"),icon:nz.default}]}];return(0,v.jsx)(nF.A,{className:n.root,children:o.map(e=>(0,v.jsxs)(tZ.Fragment,{children:[(0,v.jsx)(rT.A,{variant:"subtitle2",component:"span",className:n.title,children:e.name}),(0,v.jsx)(nF.A,{className:n.groupWrapper,children:(0,v.jsx)(ni.A,{disablePadding:!0,dense:!0,role:"menu",children:e.items.map((i,o)=>(0,v.jsxs)(rX.A,{divider:o!==e.items.length-1,ContainerProps:{role:"menuitem"},onClick:()=>r(i.id),selected:i.id===t,className:n.menuItem,"data-testid":`owner-picker-${i.id}`,children:[i.icon&&(0,v.jsx)(rJ.A,{className:n.listIcon,children:(0,v.jsx)(i.icon,{fontSize:"small"})}),(0,v.jsx)(rY.A,{children:(0,v.jsx)(rT.A,{variant:"body1",children:i.label})})]},i.id))})})]},e.name))})};var nH=r(69374);let nU=({createdAt:e,locale:t})=>{let r=nH.c9.fromISO(e),n=t||window.navigator.language||"en-US",i=r.setLocale(n).toLocaleString({...nH.c9.DATETIME_SHORT_WITH_SECONDS});return(0,v.jsx)(rT.A,{paragraph:!0,children:i})};var nq=r(30043),nK=r(37281),nG=r(78560);let nJ=({entityRef:e})=>{let t=(0,k.gf)(nq.v),{value:r,loading:n,error:i}=(0,rj.A)(()=>t.getEntityByRef(e||""),[t,e]);return e?n||i?null:(0,v.jsx)(nK.z,{entityRef:(0,nG.KU)(e),title:r?.spec?.profile?.displayName??r?.metadata.name}):(0,v.jsx)(rT.A,{paragraph:!0,children:"Unknown"})};var nY=r(12714);let nX=({status:e})=>{switch(e){case"processing":return(0,v.jsx)(nY.Ek,{children:e});case"completed":return(0,v.jsx)(nY.z3,{children:e});default:return(0,v.jsx)(nY.Xs,{children:e})}},nZ=({entityRef:e})=>{let t=(0,k.gf)(rC.z),{value:r,loading:n,error:i}=(0,rj.A)(()=>t.getTemplateParameterSchema(e||""),[t,e]);return n||i||!e?null:(0,v.jsx)(nK.z,{entityRef:(0,nG.KU)(e),title:r?.title})},nQ=e=>{let{initiallySelectedFilter:t="owned"}=e,{t:r}=(0,rK.i)(nt.W),[n,i]=(0,tZ.useState)(5),[o,s]=(0,tZ.useState)(0),a=(0,k.gf)(rC.z),l=(0,rL.S)(rS.rQ),[c,u]=(0,tZ.useState)(t),{value:h,loading:d,error:f}=(0,rj.A)(()=>a.listTasks?a.listTasks?.({filterByOwnership:c,limit:n,offset:o*n}):(console.warn("listTasks is not implemented in the scaffolderApi, please make sure to implement this method."),Promise.resolve({tasks:[],totalTasks:0})),[a,c,n,o]);return d?(0,v.jsx)(rF.k,{}):f?(0,v.jsxs)(nL.GI,{children:[(0,v.jsx)(nL.GI.Filters,{children:(0,v.jsx)(nV,{filter:c,onSelectOwner:e=>u(e)})}),(0,v.jsxs)(nL.GI.Content,{children:[(0,v.jsx)(rB.b,{error:f}),(0,v.jsx)(rz.p,{missing:"info",title:r("listTaskPage.content.emptyState.title"),description:r("listTaskPage.content.emptyState.description")})]})]}):(0,v.jsxs)(nL.GI,{children:[(0,v.jsx)(nL.GI.Filters,{children:(0,v.jsx)(nV,{filter:c,onSelectOwner:e=>u(e)})}),(0,v.jsx)(nL.GI.Content,{children:(0,v.jsx)(n_.X,{onRowsPerPageChange:e=>{s(0),i(e)},onPageChange:e=>s(e),options:{pageSize:n,emptyRowsWhenPaging:!1},data:h?.tasks??[],page:o,totalCount:h?.totalTasks??0,title:r("listTaskPage.content.tableTitle"),columns:[{title:r("listTaskPage.content.tableCell.taskID"),field:"id",render:e=>(0,v.jsx)(rW.N_,{to:`${l()}/tasks/${e.id}`,children:e.id})},{title:r("listTaskPage.content.tableCell.template"),field:"spec.templateInfo.entity.metadata.title",render:e=>(0,v.jsx)(nZ,{entityRef:e.spec.templateInfo?.entityRef})},{title:r("listTaskPage.content.tableCell.created"),field:"createdAt",render:e=>(0,v.jsx)(nU,{createdAt:e.createdAt})},{title:r("listTaskPage.content.tableCell.owner"),field:"createdBy",render:e=>(0,v.jsx)(nJ,{entityRef:e.spec?.user?.ref})},{title:r("listTaskPage.content.tableCell.status"),field:"status",render:e=>(0,v.jsx)(nX,{status:e.status})}]})})]})},n0=e=>{let t=(0,b.Zp)(),r=(0,rL.S)(rS.Dg),n=(0,rL.S)(rS.GF),i=(0,rL.S)(rS.rQ),{t:o}=(0,rK.i)(nt.W),s=(0,rL.S)(rS.SE),a={onEditorClicked:e?.contextMenu?.editor!==!1?()=>t(r()):void 0,onActionsClicked:e?.contextMenu?.actions!==!1?()=>t(n()):void 0,onTasksClicked:void 0,onCreateClicked:e?.contextMenu?.create!==!1?()=>t(i()):void 0,onTemplatingExtensionsClicked:e?.contextMenu?.templatingExtensions!==!1?()=>t(s()):void 0};return(0,v.jsxs)(rH.Y,{themeId:"home",children:[(0,v.jsx)(rU.Y,{pageTitleOverride:o("listTaskPage.pageTitle"),title:o("listTaskPage.title"),subtitle:o("listTaskPage.subtitle"),children:(0,v.jsx)(ne,{...a})}),(0,v.jsx)(rq.U,{children:(0,v.jsx)(nQ,{...e})})]})};var n1=r(54290),n2=r(92483),n4=r(17138),n3=r(56420),n5=r(18453),n6=r(79533),n9=r(13977),n8=r(75303),n7=r(56829),ie=r(46923),it=r(42858),ir=r(57278),ii=r(98552),io=r(86901),is=r(44148),ia=r(41260),il=r(56005),ic=r.n(il);let iu=(0,v.jsx)(ia.default,{fontSize:"small"}),ih=(0,v.jsx)(is.default,{fontSize:"small"}),id=(0,rI.A)({root:{},label:{}},{name:"ScaffolderReactTemplateCategoryPicker"}),ip=()=>{let{t:e}=(0,rK.i)(r8),t=id(),r=(0,k.gf)(it.k),{error:n,loading:i,availableTypes:o,selectedTypes:s,setSelectedTypes:a}=(0,ir.j)();return i?(0,v.jsx)(rF.k,{}):n?(r.post({message:`Failed to load entity types with error: ${n}`,severity:"error"}),null):o?(0,v.jsxs)(rP.A,{className:t.root,pb:1,pt:1,children:[(0,v.jsx)(rT.A,{className:t.label,variant:"button",component:"label",htmlFor:"categories-picker",children:e("templateCategoryPicker.title")}),(0,v.jsx)(rR.Ay,{PopperComponent:e=>(0,v.jsx)("div",{...e,children:e.children}),multiple:!0,id:"categories-picker",options:o,value:s,onChange:(e,t)=>a(t),renderOption:(e,{selected:t})=>(0,v.jsx)(io.A,{control:(0,v.jsx)(ii.A,{icon:iu,checkedIcon:ih,checked:t}),label:ic()(e)}),size:"small",popupIcon:(0,v.jsx)(r$.default,{}),renderInput:e=>(0,v.jsx)(rl.A,{...e,variant:"outlined"})})]}):null};var im=r(63382),ig=r(38282),iy=r(17174),iv=r(97214),ib=r(52262),ix=r(699),iw=r(59469),ik=r(48653),iA=r(37197),iS=r(54917),ij=r(45575),iC=r(86184),iE=r(20987);let iO=({template:e,className:t})=>{let r=(0,rL.S)(iE.s),{t:n}=(0,rK.i)(r8),i=(0,nG.U2)(e),o=(0,n1.n)().getSystemIcon("kind:template")||r1.default;return(0,v.jsx)(nf.Ay,{id:`tooltip-${i}`,title:n("cardHeader.detailBtnTitle"),children:(0,v.jsx)(rG.A,{"aria-label":n("cardHeader.detailBtnTitle"),id:`viewDetail-${i}`,style:{padding:0},children:(0,v.jsx)(rT.A,{component:"span",children:(0,v.jsx)(rW.N_,{to:r((0,iE.$)(e)),style:{display:"flex",alignItems:"center"},children:(0,v.jsx)(o,{className:t})})})})})},iM=(0,rI.A)(()=>({header:{backgroundImage:({cardBackgroundImage:e})=>e,color:({cardFontColor:e})=>e},subtitleWrapper:{display:"flex",justifyContent:"space-between"},detailIcon:{color:({cardFontColor:e})=>e}})),iP=e=>{let{template:{metadata:{title:t,name:r},spec:{type:n}}}=e,{getPageTheme:i}=(0,iS.A)(),o=i({themeId:n}),s=iM({cardFontColor:o.fontColor,cardBackgroundImage:o.backgroundImage}),a=(0,v.jsxs)("div",{className:s.subtitleWrapper,children:[(0,v.jsx)("div",{children:n}),(0,v.jsxs)("div",{children:[(0,v.jsx)(iO,{className:s.detailIcon,template:e.template}),(0,v.jsx)(iC.u,{entity:e.template,style:{padding:0,marginLeft:6}})]})]});return(0,v.jsx)(ij.f,{title:t??r,subtitle:a,classes:{root:s.header}})},iT=(0,rI.A)(()=>({box:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box","-webkit-line-clamp":10,"-webkit-box-orient":"vertical"},markdown:{"& :first-child":{margin:0}}})),iI=({template:e})=>{let{t}=(0,rK.i)(r8),r=iT();return(0,v.jsx)(nI.A,{item:!0,xs:12,"data-testid":"template-card-content-grid",children:(0,v.jsx)(rP.A,{className:r.box,"data-testid":"template-card-content-container",children:(0,v.jsx)(rV.h,{className:r.markdown,content:e.metadata.description??t("templateCard.noDescription")})})})},i$=({template:e})=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(nI.A,{item:!0,xs:12,children:(0,v.jsx)(iA.A,{"data-testid":"template-card-separator--tags"})}),(0,v.jsx)(nI.A,{item:!0,xs:12,children:(0,v.jsx)(nI.A,{container:!0,spacing:2,"data-testid":"template-card-tags",children:e.metadata.tags?.map(e=>(0,v.jsx)(nI.A,{item:!0,"data-testid":`template-card-tag-item-${e}`,children:(0,v.jsx)(nr.A,{style:{margin:0},size:"small","data-testid":`template-card-tag-chip-${e}`,label:e},e)},`grid-${e}`))})})]});var iD=r(23127);let iR=(0,rI.A)(()=>({linkText:{display:"inline-flex",alignItems:"center"}})),iN=({icon:e,text:t,url:r})=>{let n=iR();return(0,v.jsxs)("div",{className:n.linkText,children:[(0,v.jsx)(e,{fontSize:"small"}),(0,v.jsx)(rW.N_,{style:{marginLeft:"8px"},to:r,children:t||r})]})},i_=(0,rI.A)({}),iL=({template:e,additionalLinks:t})=>{let r=i_(),n=(0,n1.n)();return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(nI.A,{item:!0,xs:12,children:(0,v.jsx)(iA.A,{"data-testid":"template-card-separator--links"})}),(0,v.jsx)(nI.A,{item:!0,xs:12,children:(0,v.jsxs)(nI.A,{container:!0,spacing:2,"data-testid":"template-card-links",children:[t?.map(({icon:e,text:t,url:n},i)=>(0,v.jsx)(nI.A,{className:r.linkText,item:!0,xs:6,"data-testid":"template-card-links--item",children:(0,v.jsx)(iN,{icon:e,text:t,url:n})},i)),e.metadata.links?.map(({url:e,icon:t,title:i},o)=>(0,v.jsx)(nI.A,{className:r.linkText,item:!0,xs:6,"data-testid":"template-card-links--metalink",children:(0,v.jsx)(iN,{icon:t?n.getSystemIcon(t)??iD.default:iD.default,text:i||e,url:e})},o))]})})]})};var iF=r(14158),iB=r(64947);let iz=(0,rI.A)(e=>({footer:{display:"flex",justifyContent:"space-between",flex:1,alignItems:"center"},ownedBy:{display:"flex",alignItems:"center",flex:1,color:e.palette.link},actionContainer:{padding:"16px",flex:1,alignItems:"flex-end"}})),iW=({canCreateTask:e,handleChoose:t,ownedByRelations:r})=>{let{t:n}=(0,rK.i)(r8),i=iz();return(0,v.jsxs)("div",{className:i.footer,"data-testid":"template-card-actions--footer",children:[(0,v.jsx)("div",{className:i.ownedBy,"data-testid":"template-card-actions--ownedby",children:r.length>0&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(n2.ny,{fontSize:"small"}),(0,v.jsx)(iF.i,{style:{marginLeft:"8px"},entityRefs:r,defaultKind:"Group",hideIcons:!0})]})}),e?(0,v.jsx)(iB.A,{size:"small",variant:"outlined",color:"primary","data-testid":"template-card-actions--create",onClick:t,children:n("templateCard.chooseButtonText")}):null]})},iV=(0,rI.A)(()=>({actionContainer:{padding:"16px",flex:1,alignItems:"flex-end"}})),iH=e=>{let{additionalLinks:t,onSelected:r,template:n}=e,i=iV(),o=(0,ib.s)(),s=(0,ix.t)(n,iv.vv),a=!!n.metadata.tags?.length,l=!!t?.length||!!n.metadata.links?.length,{allowed:c}=(0,r6.J)({permission:r9.X6}),u=(0,tZ.useCallback)(()=>{o.captureEvent("click","Template has been opened"),r?.(n)},[o,r,n]);return(0,v.jsxs)(nF.A,{children:[(0,v.jsx)(iP,{template:n,"data-testid":"template-card-header"}),(0,v.jsx)(ik.A,{children:(0,v.jsxs)(nI.A,{container:!0,spacing:2,"data-testid":"template-card-content",children:[(0,v.jsx)(iI,{template:n}),!a&&!l&&(0,v.jsx)(nI.A,{item:!0,xs:12,children:(0,v.jsx)(iA.A,{"data-testid":"template-card-separator"})}),a&&(0,v.jsx)(i$,{template:n}),l&&(0,v.jsx)(iL,{template:n,additionalLinks:t})]})}),(0,v.jsx)(iw.A,{className:i.actionContainer,"data-testid":"template-card-actions",children:(0,v.jsx)(iW,{canCreateTask:c,handleChoose:u,ownedByRelations:s})})]})};var iU=r(19224);let iq=e=>{let{templates:t,title:r,components:{CardComponent:n}={},onSelected:i}=e,o="string"==typeof r?(0,v.jsx)(n4.d,{title:r}):r;if(0===t.length)return null;let s=n||iH;return(0,v.jsxs)(rq.U,{children:[o,(0,v.jsx)(iy.s,{children:t.map(({template:e,additionalLinks:t})=>(0,v.jsx)(iU.I,{attributes:{entityRef:(0,nG.U2)(e)},children:(0,v.jsx)(s,{additionalLinks:t,template:e,onSelected:i})},(0,nG.U2)(e)))})]})},iK=e=>{let{loading:t,error:r,entities:n}=(0,n5.nK)(),{groups:i,templateFilter:o,TemplateCardComponent:s,onTemplateSelected:a}=e,l=(0,k.gf)(im.m),c=(0,tZ.useCallback)(e=>{a?.(e)},[a]);return((0,tZ.useEffect)(()=>{r&&l.post(r)},[r,l]),t)?(0,v.jsx)(rF.k,{}):r?null:n&&n.length?(0,v.jsx)(v.Fragment,{children:i.map(({title:t,filter:r},i)=>{let a=n.filter(ig.c).filter(e=>!o||o(e)).filter(r).map(t=>{let r=e.additionalLinksForEntity?.(t)??[];return{template:t,additionalLinks:r}});return(0,v.jsx)(iq,{templates:a,title:t,components:{CardComponent:s},onSelected:c},i)})}):(0,v.jsxs)(rT.A,{variant:"body2",children:["No templates found that match your filter. Learn more about"," ",(0,v.jsx)(rW.N_,{to:"https://backstage.io/docs/features/software-templates/adding-templates",children:"adding templates"}),"."]})};var iG=r(5893),iJ=r(73657),iY=r(71913);let iX=e=>{let{title:t,to:r}=e,{allowed:n}=(0,r6.J)({permission:iY.C4}),i=(0,iG.A)(e=>e.breakpoints.down("xs"));return r&&n?i?(0,v.jsx)(rG.A,{component:iJ.N_,color:"primary",title:t,size:"small",to:r,children:(0,v.jsx)(r0.default,{})}):(0,v.jsx)(iB.A,{component:iJ.N_,variant:"outlined",color:"primary",to:r,children:t}):null};var iZ=r(11642),iQ=r(19108);let i0=e=>{let t=(0,rL.S)(rS.J0),{TemplateCardComponent:r,groups:n=[],templateFilter:i,headerOptions:o}=e,s=(0,b.Zp)(),a=(0,rL.S)(rS.Dg),l=(0,rL.S)(rS.GF),c=(0,rL.S)(rS.JX),u=(0,rL.S)(rS.UJ),h=(0,rL.S)(rS.sP),d=(0,rL.S)(rS.SE),f=(0,n1.n)(),{t:p}=(0,rK.i)(nt.W),m=n.length?[...n,{title:p("templateListPage.templateGroups.otherTitle"),filter:e=>![...n].some(({filter:t})=>t(e))}]:[{title:p("templateListPage.templateGroups.defaultTitle"),filter:()=>!0}],g={onEditorClicked:e?.contextMenu?.editor!==!1?()=>s(a()):void 0,onActionsClicked:e?.contextMenu?.actions!==!1?()=>s(l()):void 0,onTasksClicked:e?.contextMenu?.tasks!==!1?()=>s(c()):void 0,onTemplatingExtensionsClicked:e?.contextMenu?.templatingExtensions!==!1?()=>s(d()):void 0},y=(0,tZ.useCallback)(e=>{if(!(e.metadata.annotations?.[iQ.As]||e.metadata.annotations?.[iQ.GO])||!u)return[];let t=(0,iZ.b1)(e,u);return t?[{icon:f.getSystemIcon("docs")??n2.Vf,text:p("templateListPage.additionalLinksForEntity.viewTechDocsTitle"),url:t}]:[]},[f,u,p]),x=(0,tZ.useCallback)(e=>{let{namespace:t,name:r}=(0,nG.KU)((0,nG.U2)(e));s(h({namespace:t,templateName:r}))},[s,h]);return(0,v.jsx)(n5.B9,{children:(0,v.jsxs)(rH.Y,{themeId:"home",children:[(0,v.jsx)(rU.Y,{pageTitleOverride:p("templateListPage.pageTitle"),title:p("templateListPage.title"),subtitle:p("templateListPage.subtitle"),...o,children:(0,v.jsx)(ne,{...g})}),(0,v.jsxs)(rq.U,{children:[(0,v.jsxs)(n4.d,{children:[(0,v.jsx)(iX,{title:p("templateListPage.contentHeader.registerExistingButtonTitle"),to:t&&t()}),(0,v.jsx)(n3.Y,{children:p("templateListPage.contentHeader.supportButtonTitle")})]}),(0,v.jsxs)(nL.GI,{children:[(0,v.jsxs)(nL.GI.Filters,{children:[(0,v.jsx)(n6.l,{}),(0,v.jsx)(n9.m,{initialFilter:"template",hidden:!0}),(0,v.jsx)(n8.y,{initialFilter:"all",availableFilters:["all","starred"]}),(0,v.jsx)(ip,{}),(0,v.jsx)(n7.m,{}),(0,v.jsx)(ie.t,{})]}),(0,v.jsx)(nL.GI.Content,{children:(0,v.jsx)(iK,{groups:m,templateFilter:i,TemplateCardComponent:r,onTemplateSelected:x,additionalLinksForEntity:y})})]})]})]})})};var i1=r(55488),i2=r(76888);let i4=e=>{let t=(0,k.gf)(rC.z),{value:r,loading:n,error:i}=(0,rj.A)(()=>t.getTemplateParameterSchema(e),[t,e]);return{manifest:r,loading:n,error:i}};var i3=r(21332),i5=r(45995),i6=r(91638),i9=r(88951),i8=r(21619),i7=r(37877),oe=r(78733);function ot(e){return!("object"!=typeof e||null===e||"number"==typeof e.lastModified&&"u">typeof File&&e instanceof File)&&("function"!=typeof e.getMonth||!("u">typeof Date)||!(e instanceof Date))&&!Array.isArray(e)}function or(e){if(""===e)return;if(null===e)return null;if(/\.$/.test(e)||/\.0$/.test(e)||/\.\d*0$/.test(e))return e;let t=Number(e);return"number"!=typeof t||Number.isNaN(t)?e:t}let on="__additional_property",oi="additionalProperties",oo="dependencies",os="__errors",oa="properties",ol="submitButtonOptions",oc="__rjsf_additionalProperties",ou="__rjsf_rootSchema",oh="ui:widget",od="ui:options";function of(e={},t={}){return Object.keys(e).filter(e=>0===e.indexOf("ui:")).reduce((t,r)=>{let n=e[r];return r===oh&&ot(n)?(console.error("Setting options via ui:widget object is no longer supported, use ui:options instead"),t):r===od&&ot(n)?{...t,...n}:{...t,[r.substring(3)]:n}},{...t})}function op(e,t={},r){if(!e.additionalProperties)return!1;let{expandable:n=!0}=of(t);return!1===n?n:void 0===e.maxProperties||!r||Object.keys(r).length<e.maxProperties}var om="object"==typeof global&&global&&global.Object===Object&&global,og="object"==typeof self&&self&&self.Object===Object&&self,oy=om||og||Function("return this")(),ov=oy.Symbol,ob=Object.prototype,ox=ob.hasOwnProperty,ow=ob.toString,ok=ov?ov.toStringTag:void 0;let oA=function(e){var t=ox.call(e,ok),r=e[ok];try{e[ok]=void 0;var n=!0}catch(e){}var i=ow.call(e);return n&&(t?e[ok]=r:delete e[ok]),i};var oS=Object.prototype.toString,oj=ov?ov.toStringTag:void 0;let oC=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":oj&&oj in Object(e)?oA(e):oS.call(e)},oE=function(e,t){return function(r){return e(t(r))}};var oO=oE(Object.getPrototypeOf,Object);let oM=function(e){return null!=e&&"object"==typeof e};var oP=Object.prototype,oT=Function.prototype.toString,oI=oP.hasOwnProperty,o$=oT.call(Object);let oD=function(e){if(!oM(e)||"[object Object]"!=oC(e))return!1;var t=oO(e);if(null===t)return!0;var r=oI.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&oT.call(r)==o$};function oR(e){let t={[os]:[],addError(e){this[os].push(e)}};return Array.isArray(e)?e.reduce((e,t,r)=>({...e,[r]:oR(t)}),t):oD(e)?Object.keys(e).reduce((t,r)=>({...t,[r]:oR(e[r])}),t):t}let oN=function(e,t){return e===t||e!=e&&t!=t},o_=function(e,t){for(var r=e.length;r--;)if(oN(e[r][0],t))return r;return -1};var oL=Array.prototype.splice;function oF(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}oF.prototype.clear=function(){this.__data__=[],this.size=0},oF.prototype.delete=function(e){var t=this.__data__,r=o_(t,e);return!(r<0)&&(r==t.length-1?t.pop():oL.call(t,r,1),--this.size,!0)},oF.prototype.get=function(e){var t=this.__data__,r=o_(t,e);return r<0?void 0:t[r][1]},oF.prototype.has=function(e){return o_(this.__data__,e)>-1},oF.prototype.set=function(e,t){var r=this.__data__,n=o_(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};let oB=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},oz=function(e){if(!oB(e))return!1;var t=oC(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t};var oW=oy["__core-js_shared__"],oV=(mn=/[^.]+$/.exec(oW&&oW.keys&&oW.keys.IE_PROTO||""))?"Symbol(src)_1."+mn:"",oH=Function.prototype.toString;let oU=function(e){if(null!=e){try{return oH.call(e)}catch(e){}try{return e+""}catch(e){}}return""};var oq=/^\[object .+?Constructor\]$/,oK=Object.prototype,oG=Function.prototype.toString,oJ=oK.hasOwnProperty,oY=RegExp("^"+oG.call(oJ).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");let oX=function(e){return!!oB(e)&&(!oV||!(oV in e))&&(oz(e)?oY:oq).test(oU(e))},oZ=function(e,t){var r=null==e?void 0:e[t];return oX(r)?r:void 0};var oQ=oZ(oy,"Map"),o0=oZ(Object,"create"),o1=Object.prototype.hasOwnProperty,o2=Object.prototype.hasOwnProperty;function o4(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}o4.prototype.clear=function(){this.__data__=o0?o0(null):{},this.size=0},o4.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=!!t,t},o4.prototype.get=function(e){var t=this.__data__;if(o0){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return o1.call(t,e)?t[e]:void 0},o4.prototype.has=function(e){var t=this.__data__;return o0?void 0!==t[e]:o2.call(t,e)},o4.prototype.set=function(e,t){var r=this.__data__;return this.size+=+!this.has(e),r[e]=o0&&void 0===t?"__lodash_hash_undefined__":t,this};let o3=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},o5=function(e,t){var r=e.__data__;return o3(t)?r["string"==typeof t?"string":"hash"]:r.map};function o6(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function o9(e){var t=this.__data__=new oF(e);this.size=t.size}function o8(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new o6;++t<r;)this.add(e[t])}o6.prototype.clear=function(){this.size=0,this.__data__={hash:new o4,map:new(oQ||oF),string:new o4}},o6.prototype.delete=function(e){var t=o5(this,e).delete(e);return this.size-=!!t,t},o6.prototype.get=function(e){return o5(this,e).get(e)},o6.prototype.has=function(e){return o5(this,e).has(e)},o6.prototype.set=function(e,t){var r=o5(this,e),n=r.size;return r.set(e,t),this.size+=+(r.size!=n),this},o9.prototype.clear=function(){this.__data__=new oF,this.size=0},o9.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},o9.prototype.get=function(e){return this.__data__.get(e)},o9.prototype.has=function(e){return this.__data__.has(e)},o9.prototype.set=function(e,t){var r=this.__data__;if(r instanceof oF){var n=r.__data__;if(!oQ||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new o6(n)}return r.set(e,t),this.size=r.size,this},o8.prototype.add=o8.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},o8.prototype.has=function(e){return this.__data__.has(e)};let o7=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1},se=function(e,t){return e.has(t)},st=function(e,t,r,n,i,o){var s=1&r,a=e.length,l=t.length;if(a!=l&&!(s&&l>a))return!1;var c=o.get(e),u=o.get(t);if(c&&u)return c==t&&u==e;var h=-1,d=!0,f=2&r?new o8:void 0;for(o.set(e,t),o.set(t,e);++h<a;){var p=e[h],m=t[h];if(n)var g=s?n(m,p,h,t,e,o):n(p,m,h,e,t,o);if(void 0!==g){if(g)continue;d=!1;break}if(f){if(!o7(t,function(e,t){if(!se(f,t)&&(p===e||i(p,e,r,n,o)))return f.push(t)})){d=!1;break}}else if(!(p===m||i(p,m,r,n,o))){d=!1;break}}return o.delete(e),o.delete(t),d};var sr=oy.Uint8Array;let sn=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r},si=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r};var so=ov?ov.prototype:void 0,ss=so?so.valueOf:void 0;let sa=function(e,t,r,n,i,o,s){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":if(e.byteLength!=t.byteLength||!o(new sr(e),new sr(t)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return oN(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=sn;case"[object Set]":var l=1&n;if(a||(a=si),e.size!=t.size&&!l)break;var c=s.get(e);if(c)return c==t;n|=2,s.set(e,t);var u=st(a(e),a(t),n,i,o,s);return s.delete(e),u;case"[object Symbol]":if(ss)return ss.call(e)==ss.call(t)}return!1},sl=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e};var sc=Array.isArray;let su=function(e,t,r){var n=t(e);return sc(e)?n:sl(n,r(e))},sh=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var s=e[r];t(s,r,e)&&(o[i++]=s)}return o},sd=function(){return[]};var sf=Object.prototype.propertyIsEnumerable,sp=Object.getOwnPropertySymbols,sm=sp?function(e){return null==e?[]:sh(sp(e=Object(e)),function(t){return sf.call(e,t)})}:sd;let sg=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n},sy=function(e){return oM(e)&&"[object Arguments]"==oC(e)};var sv=Object.prototype,sb=sv.hasOwnProperty,sx=sv.propertyIsEnumerable,sw=sy(function(){return arguments}())?sy:function(e){return oM(e)&&sb.call(e,"callee")&&!sx.call(e,"callee")},sk="object"==typeof exports&&exports&&!exports.nodeType&&exports,sA=sk&&"object"==typeof module&&module&&!module.nodeType&&module,sS=sA&&sA.exports===sk?oy.Buffer:void 0;let sj=(sS?sS.isBuffer:void 0)||function(){return!1};var sC=/^(?:0|[1-9]\d*)$/;let sE=function(e,t){var r=typeof e;return!!(t=null==t?0x1fffffffffffff:t)&&("number"==r||"symbol"!=r&&sC.test(e))&&e>-1&&e%1==0&&e<t},sO=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff};var sM={};sM["[object Float32Array]"]=sM["[object Float64Array]"]=sM["[object Int8Array]"]=sM["[object Int16Array]"]=sM["[object Int32Array]"]=sM["[object Uint8Array]"]=sM["[object Uint8ClampedArray]"]=sM["[object Uint16Array]"]=sM["[object Uint32Array]"]=!0,sM["[object Arguments]"]=sM["[object Array]"]=sM["[object ArrayBuffer]"]=sM["[object Boolean]"]=sM["[object DataView]"]=sM["[object Date]"]=sM["[object Error]"]=sM["[object Function]"]=sM["[object Map]"]=sM["[object Number]"]=sM["[object Object]"]=sM["[object RegExp]"]=sM["[object Set]"]=sM["[object String]"]=sM["[object WeakMap]"]=!1;let sP=function(e){return function(t){return e(t)}};var sT="object"==typeof exports&&exports&&!exports.nodeType&&exports,sI=sT&&"object"==typeof module&&module&&!module.nodeType&&module,s$=sI&&sI.exports===sT&&om.process,sD=function(){try{var e=sI&&sI.require&&sI.require("util").types;if(e)return e;return s$&&s$.binding&&s$.binding("util")}catch(e){}}(),sR=sD&&sD.isTypedArray,sN=sR?sP(sR):function(e){return oM(e)&&sO(e.length)&&!!sM[oC(e)]},s_=Object.prototype.hasOwnProperty;let sL=function(e,t){var r=sc(e),n=!r&&sw(e),i=!r&&!n&&sj(e),o=!r&&!n&&!i&&sN(e),s=r||n||i||o,a=s?sg(e.length,String):[],l=a.length;for(var c in e)(t||s_.call(e,c))&&!(s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||sE(c,l)))&&a.push(c);return a};var sF=Object.prototype;let sB=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||sF)};var sz=oE(Object.keys,Object),sW=Object.prototype.hasOwnProperty;let sV=function(e){if(!sB(e))return sz(e);var t=[];for(var r in Object(e))sW.call(e,r)&&"constructor"!=r&&t.push(r);return t},sH=function(e){return null!=e&&sO(e.length)&&!oz(e)},sU=function(e){return sH(e)?sL(e):sV(e)},sq=function(e){return su(e,sU,sm)};var sK=Object.prototype.hasOwnProperty;let sG=function(e,t,r,n,i,o){var s=1&r,a=sq(e),l=a.length;if(l!=sq(t).length&&!s)return!1;for(var c=l;c--;){var u=a[c];if(!(s?u in t:sK.call(t,u)))return!1}var h=o.get(e),d=o.get(t);if(h&&d)return h==t&&d==e;var f=!0;o.set(e,t),o.set(t,e);for(var p=s;++c<l;){var m=e[u=a[c]],g=t[u];if(n)var y=s?n(g,m,u,t,e,o):n(m,g,u,e,t,o);if(!(void 0===y?m===g||i(m,g,r,n,o):y)){f=!1;break}p||(p="constructor"==u)}if(f&&!p){var v=e.constructor,b=t.constructor;v!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof v&&v instanceof v&&"function"==typeof b&&b instanceof b)&&(f=!1)}return o.delete(e),o.delete(t),f};var sJ=oZ(oy,"DataView"),sY=oZ(oy,"Promise"),sX=oZ(oy,"Set"),sZ=oZ(oy,"WeakMap"),sQ="[object Map]",s0="[object Promise]",s1="[object Set]",s2="[object WeakMap]",s4="[object DataView]",s3=oU(sJ),s5=oU(oQ),s6=oU(sY),s9=oU(sX),s8=oU(sZ),s7=oC;(sJ&&s7(new sJ(new ArrayBuffer(1)))!=s4||oQ&&s7(new oQ)!=sQ||sY&&s7(sY.resolve())!=s0||sX&&s7(new sX)!=s1||sZ&&s7(new sZ)!=s2)&&(s7=function(e){var t=oC(e),r="[object Object]"==t?e.constructor:void 0,n=r?oU(r):"";if(n)switch(n){case s3:return s4;case s5:return sQ;case s6:return s0;case s9:return s1;case s8:return s2}return t});let ae=s7;var at="[object Arguments]",ar="[object Array]",an="[object Object]",ai=Object.prototype.hasOwnProperty;let ao=function(e,t,r,n,i,o){var s=sc(e),a=sc(t),l=s?ar:ae(e),c=a?ar:ae(t);l=l==at?an:l,c=c==at?an:c;var u=l==an,h=c==an,d=l==c;if(d&&sj(e)){if(!sj(t))return!1;s=!0,u=!1}if(d&&!u)return o||(o=new o9),s||sN(e)?st(e,t,r,n,i,o):sa(e,t,l,r,n,i,o);if(!(1&r)){var f=u&&ai.call(e,"__wrapped__"),p=h&&ai.call(t,"__wrapped__");if(f||p){var m=f?e.value():e,g=p?t.value():t;return o||(o=new o9),i(m,g,r,n,o)}}return!!d&&(o||(o=new o9),sG(e,t,r,n,i,o))},as=function e(t,r,n,i,o){return t===r||(null!=t&&null!=r&&(oM(t)||oM(r))?ao(t,r,n,i,e,o):t!=t&&r!=r)},aa=function(e,t,r){var n=(r="function"==typeof r?r:void 0)?r(e,t):void 0;return void 0===n?as(e,t,void 0,r):!!n};function al(e,t){return aa(e,t,(e,t)=>{if("function"==typeof e&&"function"==typeof t)return!0})}let ac=function(e){return"symbol"==typeof e||oM(e)&&"[object Symbol]"==oC(e)};var au=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ah=/^\w*$/;let ad=function(e,t){if(sc(e))return!1;var r=typeof e;return!!("number"==r||"symbol"==r||"boolean"==r||null==e||ac(e))||ah.test(e)||!au.test(e)||null!=t&&e in Object(t)};function af(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=e.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(af.Cache||o6),r}af.Cache=o6;var ap=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,am=/\\(\\)?/g,ag=(mo=(mi=af(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ap,function(e,r,n,i){t.push(n?i.replace(am,"$1"):r||e)}),t},function(e){return 500===mo.size&&mo.clear(),e})).cache,mi);let ay=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i};var av=1/0,ab=ov?ov.prototype:void 0,ax=ab?ab.toString:void 0;let aw=function e(t){if("string"==typeof t)return t;if(sc(t))return ay(t,e)+"";if(ac(t))return ax?ax.call(t):"";var r=t+"";return"0"==r&&1/t==-av?"-0":r},ak=function(e){return null==e?"":aw(e)},aA=function(e,t){return sc(e)?e:ad(e,t)?[e]:ag(ak(e))};var aS=1/0;let aj=function(e){if("string"==typeof e||ac(e))return e;var t=e+"";return"0"==t&&1/e==-aS?"-0":t},aC=function(e,t){t=aA(t,e);for(var r=0,n=t.length;null!=e&&r<n;)e=e[aj(t[r++])];return r&&r==n?e:void 0},aE=function(e,t,r){var n=null==e?void 0:aC(e,t);return void 0===n?r:n};var aO=Object.prototype.hasOwnProperty;let aM=function(e){if(null==e)return!0;if(sH(e)&&(sc(e)||"string"==typeof e||"function"==typeof e.splice||sj(e)||sN(e)||sw(e)))return!e.length;var t=ae(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(sB(e))return!sV(e).length;for(var r in e)if(aO.call(e,r))return!1;return!0};var aP=r(45838);let aT=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e};var aI=function(){try{var e=oZ(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();let a$=function(e,t,r){"__proto__"==t&&aI?aI(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r};var aD=Object.prototype.hasOwnProperty;let aR=function(e,t,r){var n=e[t];aD.call(e,t)&&oN(n,r)&&(void 0!==r||t in e)||a$(e,t,r)},aN=function(e,t,r,n){var i=!r;r||(r={});for(var o=-1,s=t.length;++o<s;){var a=t[o],l=n?n(r[a],e[a],a,r,e):void 0;void 0===l&&(l=e[a]),i?a$(r,a,l):aR(r,a,l)}return r},a_=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t};var aL=Object.prototype.hasOwnProperty;let aF=function(e){if(!oB(e))return a_(e);var t=sB(e),r=[];for(var n in e)"constructor"==n&&(t||!aL.call(e,n))||r.push(n);return r},aB=function(e){return sH(e)?sL(e,!0):aF(e)};var az="object"==typeof exports&&exports&&!exports.nodeType&&exports,aW=az&&"object"==typeof module&&module&&!module.nodeType&&module,aV=aW&&aW.exports===az?oy.Buffer:void 0,aH=aV?aV.allocUnsafe:void 0;let aU=function(e,t){if(t)return e.slice();var r=e.length,n=aH?aH(r):new e.constructor(r);return e.copy(n),n},aq=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t};var aK=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)sl(t,sm(e)),e=oO(e);return t}:sd;let aG=function(e){return su(e,aB,aK)};var aJ=Object.prototype.hasOwnProperty;let aY=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&aJ.call(e,"index")&&(r.index=e.index,r.input=e.input),r},aX=function(e){var t=new e.constructor(e.byteLength);return new sr(t).set(new sr(e)),t},aZ=function(e,t){var r=t?aX(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)};var aQ=/\w*$/;let a0=function(e){var t=new e.constructor(e.source,aQ.exec(e));return t.lastIndex=e.lastIndex,t};var a1=ov?ov.prototype:void 0,a2=a1?a1.valueOf:void 0;let a4=function(e,t){var r=t?aX(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},a3=function(e,t,r){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return aX(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return aZ(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a4(e,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return a0(e);case"[object Symbol]":return a2?Object(a2.call(e)):{}}};var a5=Object.create,a6=function(){function e(){}return function(t){if(!oB(t))return{};if(a5)return a5(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();let a9=function(e){return"function"!=typeof e.constructor||sB(e)?{}:a6(oO(e))};var a8=sD&&sD.isMap,a7=a8?sP(a8):function(e){return oM(e)&&"[object Map]"==ae(e)},le=sD&&sD.isSet,lt=le?sP(le):function(e){return oM(e)&&"[object Set]"==ae(e)},lr="[object Arguments]",ln="[object Function]",li="[object Object]",lo={};lo[lr]=lo["[object Array]"]=lo["[object ArrayBuffer]"]=lo["[object DataView]"]=lo["[object Boolean]"]=lo["[object Date]"]=lo["[object Float32Array]"]=lo["[object Float64Array]"]=lo["[object Int8Array]"]=lo["[object Int16Array]"]=lo["[object Int32Array]"]=lo["[object Map]"]=lo["[object Number]"]=lo[li]=lo["[object RegExp]"]=lo["[object Set]"]=lo["[object String]"]=lo["[object Symbol]"]=lo["[object Uint8Array]"]=lo["[object Uint8ClampedArray]"]=lo["[object Uint16Array]"]=lo["[object Uint32Array]"]=!0,lo["[object Error]"]=lo[ln]=lo["[object WeakMap]"]=!1;let ls=function e(t,r,n,i,o,s){var a,l=1&r,c=2&r,u=4&r;if(n&&(a=o?n(t,i,o,s):n(t)),void 0!==a)return a;if(!oB(t))return t;var h=sc(t);if(h){if(a=aY(t),!l)return aq(t,a)}else{var d,f,p,m,g=ae(t),y=g==ln||"[object GeneratorFunction]"==g;if(sj(t))return aU(t,l);if(g==li||g==lr||y&&!o){if(a=c||y?{}:a9(t),!l)return c?(f=(d=a)&&aN(t,aB(t),d),aN(t,aK(t),f)):(m=(p=a)&&aN(t,sU(t),p),aN(t,sm(t),m))}else{if(!lo[g])return o?t:{};a=a3(t,g,l)}}s||(s=new o9);var v=s.get(t);if(v)return v;s.set(t,a),lt(t)?t.forEach(function(i){a.add(e(i,r,n,i,t,s))}):a7(t)&&t.forEach(function(i,o){a.set(o,e(i,r,n,o,t,s))});var b=u?c?aG:sq:c?aB:sU,x=h?void 0:b(t);return aT(x||t,function(i,o){x&&(i=t[o=i]),aR(a,o,e(i,r,n,o,t,s))}),a},la=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0},ll=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o};var lc=Object.prototype.hasOwnProperty;let lu=function(e,t){t=aA(t,e);var r,n=-1,i=t.length;if(!i)return!0;for(var o=null==e||"object"!=typeof e&&"function"!=typeof e;++n<i;){var s=t[n];if("string"==typeof s){if("__proto__"===s&&!lc.call(e,"__proto__"))return!1;if("constructor"===s&&n+1<i&&"string"==typeof t[n+1]&&"prototype"===t[n+1]){if(o&&0===n)continue;return!1}}}var a=(r=t).length<2?e:aC(e,ll(r,0,-1));return null==a||delete a[aj(la(t))]},lh=function(e){return oD(e)?void 0:e};var ld=ov?ov.isConcatSpreadable:void 0;let lf=function(e){return sc(e)||sw(e)||!!(ld&&e&&e[ld])},lp=function e(t,r,n,i,o){var s=-1,a=t.length;for(n||(n=lf),o||(o=[]);++s<a;){var l=t[s];r>0&&n(l)?r>1?e(l,r-1,n,i,o):sl(o,l):i||(o[o.length]=l)}return o},lm=function(e){return(null==e?0:e.length)?lp(e,1):[]},lg=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)};var ly=Math.max;let lv=function(e,t,r){return t=ly(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=ly(n.length-t,0),s=Array(o);++i<o;)s[i]=n[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=n[i];return a[t]=r(s),lg(e,this,a)}},lb=function(e){return e};var lx=Date.now,lw=(ms=aI?function(e,t){return aI(e,"toString",{configurable:!0,enumerable:!1,value:function(){return t},writable:!0})}:lb,ma=0,ml=0,function(){var e=lx(),t=16-(e-ml);if(ml=e,t>0){if(++ma>=800)return arguments[0]}else ma=0;return ms.apply(void 0,arguments)});let lk=function(e){return lw(lv(e,void 0,lm),e+"")};var lA=lk(function(e,t){var r={};if(null==e)return r;var n=!1;t=ay(t,function(t){return t=aA(t,e),n||(n=t.length>1),t}),aN(e,aG(e),r),n&&(r=ls(r,7,lh));for(var i=t.length;i--;)lu(r,t[i]);return r});function lS(e,t){let r=t[e];return[lA(t,[e]),r]}function lj(e,t={}){return function e(t,r={},n=[]){let i,o=t||"";if(o.startsWith("#"))i=decodeURIComponent(o.substring(1));else throw Error(`Could not find a definition for ${t}.`);let s=aP.get(r,i);if(void 0===s)throw Error(`Could not find a definition for ${t}.`);let a=s.$ref;if(a){if(n.includes(a)){if(1===n.length)throw Error(`Definition for ${t} is a circular reference`);let[e,...r]=n,i=[...r,o,e].join(" -> ");throw Error(`Definition for ${e} contains a circular reference through ${i}`)}let[i,l]=lS("$ref",s),c=e(l,r,[...n,o]);return Object.keys(i).length>0?{...i,...c}:c}return s}(e,t,[])}var lC=Object.prototype.hasOwnProperty;let lE=function(e,t){return null!=e&&lC.call(e,t)},lO=function(e,t,r){t=aA(t,e);for(var n=-1,i=t.length,o=!1;++n<i;){var s=aj(t[n]);if(!(o=null!=e&&r(e,s)))break;e=e[s]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&sO(i)&&sE(s,i)&&(sc(e)||sw(e))},lM=function(e,t){return null!=e&&lO(e,t,lE)},lP=function(e){return"number"==typeof e||oM(e)&&"[object Number]"==oC(e)},lT=function(e){return"string"==typeof e||!sc(e)&&oM(e)&&"[object String]"==oC(e)},lI=function(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r},l$=function(e,t,r){for(var n=-1,i=Object(e),o=r(e),s=o.length;s--;){var a=o[++n];if(!1===t(i[a],a,i))break}return e},lD=function(e,t){return e&&l$(e,t,sU)};var lR=function(e,t){if(null==e)return e;if(!sH(e))return lD(e,t);for(var r=e.length,n=-1,i=Object(e);++n<r&&!1!==t(i[n],n,i););return e};let lN=function(e,t,r,n){var i=r.length,o=i,s=!n;if(null==e)return!o;for(e=Object(e);i--;){var a=r[i];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){var l=(a=r[i])[0],c=e[l],u=a[1];if(s&&a[2]){if(void 0===c&&!(l in e))return!1}else{var h=new o9;if(n)var d=n(c,u,l,e,t,h);if(!(void 0===d?as(u,c,3,n,h):d))return!1}}return!0},l_=function(e){return e==e&&!oB(e)},lL=function(e){for(var t=sU(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,l_(i)]}return t},lF=function(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}},lB=function(e){var t=lL(e);return 1==t.length&&t[0][2]?lF(t[0][0],t[0][1]):function(r){return r===e||lN(r,e,t)}},lz=function(e,t){return null!=e&&t in Object(e)},lW=function(e,t){return null!=e&&lO(e,t,lz)},lV=function(e){var t;return ad(e)?(t=aj(e),function(e){return null==e?void 0:e[t]}):function(t){return aC(t,e)}},lH=function(e){if("function"==typeof e)return e;if(null==e)return lb;if("object"==typeof e){var t,r;return sc(e)?(t=e[0],r=e[1],ad(t)&&l_(r)?lF(aj(t),r):function(e){var n=aE(e,t);return void 0===n&&n===r?lW(e,t):as(r,n,3)}):lB(e)}return lV(e)},lU=function(e,t,r,n,i){return i(e,function(e,i,o){r=n?(n=!1,e):t(r,e,i,o)}),r},lq=function(e,t,r){var n=sc(e)?lI:lU,i=arguments.length<3;return n(e,lH(t,4),r,i,lR)},lK=function(e){return"function"==typeof e?e:lb};var lG=/\s/;let lJ=function(e){for(var t=e.length;t--&&lG.test(e.charAt(t)););return t};var lY=/^\s+/,lX=0/0,lZ=/^[-+]0x[0-9a-f]+$/i,lQ=/^0b[01]+$/i,l0=/^0o[0-7]+$/i,l1=parseInt;let l2=function(e){if("number"==typeof e)return e;if(ac(e))return lX;if(oB(e)){var t,r="function"==typeof e.valueOf?e.valueOf():e;e=oB(r)?r+"":r}if("string"!=typeof e)return 0===e?e:+e;e=(t=e)?t.slice(0,lJ(t)+1).replace(lY,""):t;var n=lQ.test(e);return n||l0.test(e)?l1(e.slice(2),n?2:8):lZ.test(e)?lX:+e};var l4=1/0;let l3=function(e){var t,r=(t=e)?(t=l2(t))===l4||t===-l4?(t<0?-1:1)*17976931348623157e292:t==t?t:0:0===t?t:0,n=r%1;return r==r?n?r-n:r:0};var l5=Math.min;let l6=function(e,t){if((e=l3(e))<1||e>0x1fffffffffffff)return[];var r=0xffffffff,n=l5(e,0xffffffff);t=lK(t),e-=0xffffffff;for(var i=sg(n,t);++r<e;)t(r);return i};function l9(e,t,r){var n;if(e&&r){let i=aE(e,r);if(void 0===i)return;for(let e=0;e<t.length;e++){let o=aE(t[e],[oa,r],{});if("object"!==o.type&&"array"!==o.type&&(o.const===i||(null==(n=o.enum)?void 0:n.includes(i))))return e}}}function l8(e,t,r,n,i){if(void 0===t)return 0;let o=l9(t,r,i);if(lP(o))return o;for(let o=0;o<r.length;o++){let s=r[o];if(i&&lM(s,[oa,i])){let r=aE(t,i),a=aE(s,[oa,i],{});if(e.isValid(a,r,n))return o}else if(s[oa]){let r,i={anyOf:Object.keys(s[oa]).map(e=>({required:[e]}))};if(s.anyOf){let{...e}=s;e.allOf?e.allOf=e.allOf.slice():e.allOf=[],e.allOf.push(i),r=e}else r=Object.assign({},s,i);if(delete r.required,e.isValid(r,t,n))return o}else if(e.isValid(s,t,n))return o}return 0}let l7=function(e,t,r,n){if(!oB(e))return e;t=aA(t,e);for(var i=-1,o=t.length,s=o-1,a=e;null!=a&&++i<o;){var l=aj(t[i]),c=r;if("__proto__"===l||"constructor"===l||"prototype"===l)break;if(i!=s){var u=a[l];void 0===(c=n?n(u,l,a):void 0)&&(c=oB(u)?u:sE(t[i+1])?[]:{})}aR(a,l,c),a=a[l]}return e},ce=function(e,t,r){return null==e?e:l7(e,t,r)},ct=function(e,t,r){var n=sc(e),i=n||sj(e)||sN(e);if(t=lH(t,4),null==r){var o=e&&e.constructor;r=i?n?new o:[]:oB(e)&&oz(o)?a6(oO(e)):{}}return(i?aT:lD)(e,function(e,n,i){return t(r,e,n,i)}),r},cr=function(e,t,r){(void 0===r||oN(e[t],r))&&(void 0!==r||t in e)||a$(e,t,r)},cn=function(e){return oM(e)&&sH(e)},ci=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},co=function(e,t,r,n,i,o,s){var a=ci(e,r),l=ci(t,r),c=s.get(l);if(c)return void cr(e,r,c);var u=o?o(a,l,r+"",e,t,s):void 0,h=void 0===u;if(h){var d=sc(l),f=!d&&sj(l),p=!d&&!f&&sN(l);(u=l,d||f||p)?sc(a)?u=a:cn(a)?u=aq(a):f?(h=!1,u=aU(l,!0)):p?(h=!1,u=a4(l,!0)):u=[]:oD(l)||sw(l)?(u=a,sw(a))?u=aN(a,aB(a)):(!oB(a)||oz(a))&&(u=a9(l)):h=!1}h&&(s.set(l,u),i(u,l,n,o,s),s.delete(l)),cr(e,r,u)},cs=function e(t,r,n,i,o){t!==r&&l$(r,function(s,a){if(o||(o=new o9),oB(s))co(t,r,a,n,e,i,o);else{var l=i?i(ci(t,a),s,a+"",t,r,o):void 0;void 0===l&&(l=s),cr(t,a,l)}},aB)},ca=function(e,t){return lw(lv(e,t,lb),e+"")},cl=function(e,t,r){if(!oB(r))return!1;var n=typeof t;return("number"==n?!!(sH(r)&&sE(t,r.length)):"string"==n&&t in r)&&oN(r[t],e)};var cc=(mc=function(e,t,r){cs(e,t,r)},ca(function(e,t){var r=-1,n=t.length,i=n>1?t[n-1]:void 0,o=n>2?t[2]:void 0;for(i=mc.length>3&&"function"==typeof i?(n--,i):void 0,o&&cl(t[0],t[1],o)&&(i=n<3?void 0:i,n=1),e=Object(e);++r<n;){var s=t[r];s&&mc(e,s,r,i)}return e})),cu=1/0;let ch=function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return -1},cd=function(e){return e!=e},cf=function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return -1},cp=function(e,t){return!!(null==e?0:e.length)&&(t==t?cf(e,t,0):ch(e,cd,0))>-1},cm=function(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1};var cg=sX&&1/si(new sX([,-0]))[1]==1/0?function(e){return new sX(e)}:function(){};let cy=function(e,t,r){var n=-1,i=cp,o=e.length,s=!0,a=[],l=a;if(r)s=!1,i=cm;else if(o>=200){var c=t?null:cg(e);if(c)return si(c);s=!1,i=se,l=new o8}else l=t?[]:a;e:for(;++n<o;){var u=e[n],h=t?t(u):u;if(u=r||0!==u?u:0,s&&h==h){for(var d=l.length;d--;)if(l[d]===h)continue e;t&&l.push(h),a.push(u)}else i(l,h,r)||(l!==a&&l.push(h),a.push(u))}return a};var cv=r(587),cb=r.n(cv);function cx(e){let t,r=aE(e,"discriminator.propertyName",void 0);return lT(r)?t=r:void 0!==r&&console.warn(`Expecting discriminator to be a string, got "${typeof r}" instead`),t}function cw(e){return Array.isArray(e)?"array":"string"==typeof e?"string":null==e?"null":"boolean"==typeof e?"boolean":isNaN(e)?"object"==typeof e?"object":"string":"number"}var ck=ca(function(e){return cy(lp(e,1,cn,!0))});function cA(e){let{type:t}=e;return!t&&e.const?cw(e.const):!t&&e.enum?"string":!t&&(e.properties||e.additionalProperties)?"object":(Array.isArray(t)&&(t=2===t.length&&t.includes("null")?t.find(e=>"null"!==e):t[0]),t)}function cS(e,t){let r=Object.assign({},e);return Object.keys(t).reduce((r,n)=>{let i=e?e[n]:{},o=t[n];return e&&n in e&&ot(o)?r[n]=cS(i,o):e&&t&&("object"===cA(e)||"object"===cA(t))&&"required"===n&&Array.isArray(i)&&Array.isArray(o)?r[n]=ck(i,o):r[n]=o,r},r)}function cj(e,t,r={},n,i){return cM(e,t,r,n,void 0,void 0,i)[0]}function cC(e){return e.reduce((e,t)=>t.length>1?t.flatMap(t=>l6(e.length,r=>[...e[r]].concat(t))):(e.forEach(e=>e.push(t[0])),e),[[]])}function cE(e,t,r,n,i,o,s){let a=cO(t,r,i);return a!==t?cM(e,a,r,o,n,i,s):[t]}function cO(e,t,r){if(!ot(e))return e;let n=e;if("$ref"in n){let{$ref:e,...i}=n;if(r.includes(e))return n;r.push(e),n={...lj(e,t),...i}}if(oa in n){var i;let e=[],o=ct(n[oa],(n,i,o)=>{let s=[...r];n[o]=cO(i,t,s),e.push(s)},{});cc(r,(i=(null==e?0:e.length)?lp(e,cu):[])&&i.length?cy(i):[]),n={...n,[oa]:o}}return"items"in n&&!Array.isArray(n.items)&&"boolean"!=typeof n.items&&(n={...n,items:cO(n.items,t,r)}),al(e,n)?e:n}function cM(e,t,r,n,i=!1,o=[],s){let a;return ot(t)?((a=cE(e,t,r,i,o,n)).length>1||a[0]!==t?a:oo in t?cP(e,t,r,i,o,n).flatMap(t=>cM(e,t,r,n,i,o,s)):"allOf"in t&&Array.isArray(t.allOf)?cC(t.allOf.map(t=>cM(e,t,r,n,i,o,s))).map(e=>({...t,allOf:e})):[t]).flatMap(t=>{var a,l;let c=t;if("if"in c)return function(e,t,r,n,i,o,s){let{if:a,then:l,else:c,...u}=t,h=e.isValid(a,o||{},r),d=[u],f=[];if(n)l&&"boolean"!=typeof l&&(f=f.concat(cM(e,l,r,o,n,i,s))),c&&"boolean"!=typeof c&&(f=f.concat(cM(e,c,r,o,n,i,s)));else{let t=h?l:c;t&&"boolean"!=typeof t&&(f=f.concat(cM(e,t,r,o,n,i,s)))}return f.length&&(d=f.map(e=>cS(u,e))),d.flatMap(t=>cM(e,t,r,o,n,i,s))}(e,c,r,i,o,n,s);if("allOf"in c){if(i){let{allOf:e,...t}=c;return[...e,t]}try{let e=[],t=[];null==(a=c.allOf)||a.forEach(r=>{"object"==typeof r&&r.contains?e.push(r):t.push(r)}),e.length&&(c={...c,allOf:t}),c=s?s(c):cb()(c,{deep:!1}),e.length&&(c.allOf=e)}catch(r){console.warn("could not merge subschemas in allOf:\n",r);let{allOf:e,...t}=c;return t}}if(oi in c&&!1!==c.additionalProperties){let t,i;return t={...l=c,properties:{...l.properties}},Object.keys(i=n&&ot(n)?n:{}).forEach(n=>{if(n in t.properties)return;let o={};o="boolean"!=typeof t.additionalProperties?"$ref"in t.additionalProperties?cj(e,{$ref:aE(t.additionalProperties,["$ref"])},r,i,s):"type"in t.additionalProperties?{...t.additionalProperties}:"anyOf"in t.additionalProperties||"oneOf"in t.additionalProperties?{type:"object",...t.additionalProperties}:{type:cw(aE(i,[n]))}:{type:cw(aE(i,[n]))},t.properties[n]=o,ce(t.properties,[n,on],!0)}),t}return c}):[{}]}function cP(e,t,r,n,i,o,s){let{dependencies:a,...l}=t;return(function(e,t,r,n,i){let o,{oneOf:s,anyOf:a,...l}=t;if(Array.isArray(s)?o=s:Array.isArray(a)&&(o=a),o){let s=cx(t),a=l8(e,void 0===i&&n?{}:i,o=o.map(e=>cO(e,r,[])),r,s);if(n)return o.map(e=>cS(l,e));t=cS(l,o[a])}return[t]})(e,l,r,n,o).flatMap(t=>(function e(t,r,n,i,o,s,a,l){let c=[n];for(let u in r){if(!o&&void 0===aE(a,[u])||n.properties&&!(u in n.properties))continue;let[h,d]=lS(u,r);return Array.isArray(d)?c[0]=function(e,t){if(!t)return e;let r=Array.isArray(e.required)?Array.from(new Set([...e.required,...t])):t;return{...e,required:r}}(n,d):ot(d)&&(c=function(e,t,r,n,i,o,s,a,l){return cM(e,i,r,a,o,s,l).flatMap(i=>{let{oneOf:c,...u}=i;return(t=cS(t,u),void 0===c)?t:cC(c.map(t=>"boolean"!=typeof t&&"$ref"in t?cE(e,t,r,o,s,a):[t])).flatMap(i=>(function(e,t,r,n,i,o,s,a,l){let c=i.filter(t=>{if("boolean"==typeof t||!t||!t.properties)return!1;let{[n]:i}=t.properties;return!!i&&(e.isValid({type:"object",properties:{[n]:i}},a,r)||o)});return o||1===c.length?c.flatMap(i=>{let[c]=lS(n,i.properties);return cM(e,{...i,properties:c},r,a,o,s,l).map(e=>cS(t,e))}):(console.warn("ignoring oneOf in dependencies because there isn't exactly one subschema that is valid"),[t])})(e,t,r,n,i,o,s,a,l))})}(t,n,i,u,d,o,s,a,l)),c.flatMap(r=>e(t,h,r,i,o,s,a,l))}return c})(e,a,t,r,n,i,o,s))}let cT={type:"object",$id:"_$junk_option_schema_id$_",properties:{__not_really_there__:{type:"number"}}};function cI(e,t,r,n,i=-1,o,s){let a=n.map(e=>cO(e,t,[])),l=l9(r,n,o);if(lP(l))return l;let c=a.reduce((n,i,s)=>(1===l8(e,r,[cT,i],t,o)&&n.push(s),n),[]);if(1===c.length)return c[0];c.length||l6(a.length,e=>c.push(e));let u=new Set,{bestIndex:h}=c.reduce((n,i)=>{let{bestScore:o}=n,l=function e(t,r,n,i,o){let s=0;return n&&(oB(n.properties)?s+=lq(n.properties,(n,s,a)=>{let l=aE(i,a);if("boolean"==typeof s)return n;if(lM(s,"$ref")){let i=cj(t,s,r,l,o);return n+e(t,r,i,l||{},o)}if((lM(s,"oneOf")||lM(s,"anyOf"))&&l){let e=lM(s,"oneOf")?"oneOf":"anyOf",i=cx(s);return n+cI(t,r,l,aE(s,e),-1,i,o)}if("object"===s.type)return oB(l)&&(n+=1),n+e(t,r,s,l,o);if(s.type===cw(l)){let e=n+1;return s.default?e+=l===s.default?1:-1:s.const&&(e+=l===s.const?1:-1),e}return n},0):lT(n.type)&&n.type===cw(i)&&(s+=1)),s}(e,t,a[i],r,s);return(u.add(l),l>o)?{bestIndex:i,bestScore:l}:n},{bestIndex:i,bestScore:0});return 1===u.size&&i>=0?i:h}function c$(e){return Array.isArray(e.items)&&e.items.length>0&&e.items.every(e=>ot(e))}let cD=function(e){return null==e};function cR(e,t,r=!1,n=!1,i=!1){if(Array.isArray(t)){let o=Array.isArray(e)?e:[],s=i?o:t,a=i?t:o,l=s.map((e,s)=>void 0!==a[s]?cR(o[s],t[s],r,n,i):e);return(r||i)&&l.length<a.length&&l.push(...a.slice(l.length)),l}if(ot(t)){let o=Object.assign({},e);return Object.keys(t).reduce((o,s)=>{let a=aE(t,s),l=ot(e)&&s in e,c=s in t;return o[s]=cR(e?aE(e,s):{},a,r,n,i&&(l||!c)),o},o)}return n&&(!cD(e)&&cD(t)||"number"==typeof t&&isNaN(t))||i&&!cD(t)?e:t}function cN(e,t,r=!1){return Object.keys(t).reduce((n,i)=>{let o=e?e[i]:{},s=t[i];if(e&&i in e&&ot(s))n[i]=cN(o,s,r);else if(r&&Array.isArray(o)&&Array.isArray(s)){let e=s;"preventDuplicates"===r&&(e=s.reduce((e,t)=>(o.includes(t)||e.push(t),e),[])),n[i]=o.concat(e)}else n[i]=s;return n},Object.assign({},e))}function c_(e){return Array.isArray(e.enum)&&1===e.enum.length||"const"in e}function cL(e,t,r={},n){let i=cj(e,t,r,void 0,n),o=i.oneOf||i.anyOf;return!!Array.isArray(i.enum)||!!Array.isArray(o)&&o.every(e=>"boolean"!=typeof e&&c_(e))}function cF(e,t,r,n){return!!t.uniqueItems&&!!t.items&&"boolean"!=typeof t.items&&cL(e,t.items,r,n)}function cB(e){let t=e.const,r=cA(e);return ot(t)&&lT(null==t?void 0:t.$data)&&"object"!==r&&"array"!==r}function cz(e,t){let r,n;if(e.enum){let r;if(t){let{enumNames:e}=of(t);r=e}return!r&&e.enumNames&&(r=e.enumNames),e.enum.map((e,t)=>({label:(null==r?void 0:r[t])||String(e),value:e}))}return e.anyOf?(r=e.anyOf,n=null==t?void 0:t.anyOf):e.oneOf&&(r=e.oneOf,n=null==t?void 0:t.oneOf),r&&r.map((e,t)=>{let{title:r}=of(null==n?void 0:n[t]),i=function(e){if("enum"in e&&Array.isArray(e.enum)&&1===e.enum.length)return e.enum[0];if("const"in e)return e.const;throw Error("schema cannot be inferred as a constant")}(e),o=r||e.title||String(i);return{schema:e,label:o,value:i}})}let cW=["string","number","integer","boolean","null"];function cV(e,t=mp.Ignore,r=-1){if(r>=0){if(Array.isArray(e.items)&&r<e.items.length){let t=e.items[r];if("boolean"!=typeof t)return t}}else if(e.items&&!Array.isArray(e.items)&&"boolean"!=typeof e.items)return e.items;return t!==mp.Ignore&&ot(e.additionalItems)?e.additionalItems:{}}function cH(e,t,r,n,i,o=[],s={},a=!1){let{emptyObjectFields:l="populateAllDefaults"}=s;if(n||a)e[t]=r;else if("skipDefaults"!==l){let n=void 0===i?o.includes(t):i;ot(r)?"skipEmptyDefaults"===l?aM(r)||(e[t]=r):(!aM(r)||o.includes(t))&&(n||"populateRequiredDefaults"!==l)&&(e[t]=r):void 0!==r&&("populateAllDefaults"===l||"skipEmptyDefaults"===l||n&&o.includes(t))&&(e[t]=r)}}function cU(e,t,r={}){let{parentDefaults:n,rawFormData:i,rootSchema:o={},includeUndefinedValues:s=!1,_recurseList:a=[],experimental_defaultFormStateBehavior:l,experimental_customMergeAllOf:c,required:u,shouldMergeDefaultsIntoFormData:h=!1}=r,d=ot(i)?i:{},f=ot(t)?t:{},p=n,m=null,g=l,y=a;if(void 0===f.const||(null==l?void 0:l.constAsDefaults)==="never"||cB(f)){if(ot(p)&&ot(f.default))p=cN(p,f.default);else if("default"in f&&!f.anyOf&&!f.oneOf)p=f.default;else if("$ref"in f){let e=f.$ref;a.includes(e)||(y=a.concat(e),m=lj(e,o)),m&&!p&&(p=f.default),h&&m&&!ot(i)&&(d=i)}else if(oo in f){let t={...cq(e,f,r,p),...d};m=cP(e,f,o,!1,[],t,c)[0]}else if(c$(f))p=f.items.map((t,r)=>cU(e,t,{rootSchema:o,includeUndefinedValues:s,_recurseList:a,experimental_defaultFormStateBehavior:l,experimental_customMergeAllOf:c,parentDefaults:Array.isArray(n)?n[r]:void 0,rawFormData:d,required:u,shouldMergeDefaultsIntoFormData:h}));else if("oneOf"in f){let{oneOf:t,...r}=f;if(0===t.length)return;let n=cx(f),{type:s="null"}=r;!Array.isArray(s)&&cW.includes(s)&&(null==g?void 0:g.constAsDefaults)==="skipOneOf"&&(g={...g,constAsDefaults:"never"}),m=cS(r,m=t[cI(e,o,null!=i?i:f.default,t,0,n,c)])}else if("anyOf"in f){let{anyOf:t,...r}=f;if(0===t.length)return;let n=cx(f);m=cS(r,m=t[cI(e,o,null!=i?i:f.default,t,0,n,c)])}}else p=f.const;if(m)return cU(e,m,{rootSchema:o,includeUndefinedValues:s,_recurseList:y,experimental_defaultFormStateBehavior:g,experimental_customMergeAllOf:c,parentDefaults:p,rawFormData:null!=i?i:d,required:u,shouldMergeDefaultsIntoFormData:h});void 0===p&&(p=f.default);let v=cq(e,f,r,p),b=null!=v?v:p;if(h){let{arrayMinItems:t={}}=l||{},{mergeExtraDefaults:r}=t,n=function(e,t,r,n,i,o){let s=!c_(t)&&cL(e,t,r,o),a=n;if(s){let e=cz(t);a=(null==e?void 0:e.some(e=>al(e.value,n)))?n:void 0}return t.const&&(null==i?void 0:i.constAsDefaults)==="always"&&(a=t.const),a}(e,f,o,i,l,c);(!ot(i)||"allOf"in f)&&(b=cR(b,n,r,!0))}return b}function cq(e,t,r={},n){switch(cA(t)){case"object":return function(e,t,{rawFormData:r,rootSchema:n={},includeUndefinedValues:i=!1,_recurseList:o=[],experimental_defaultFormStateBehavior:s,experimental_customMergeAllOf:a,required:l,shouldMergeDefaultsIntoFormData:c}={},u){{let h=ot(r)?r:{},d=(null==s?void 0:s.allOf)==="populateDefaults"&&"allOf"in t?cj(e,t,n,h,a):t,f=d.const,p=Object.keys(d.properties||{}).reduce((t,r)=>{var p;let m=aE(d,[oa,r]),g=ot(f)&&void 0!==f[r],y=(ot(m)&&"const"in m||g)&&(null==s?void 0:s.constAsDefaults)!=="never"&&!cB(m),v=cU(e,m,{rootSchema:n,_recurseList:o,experimental_defaultFormStateBehavior:s,experimental_customMergeAllOf:a,includeUndefinedValues:!0===i,parentDefaults:aE(u,[r]),rawFormData:aE(h,[r]),required:null==(p=d.required)?void 0:p.includes(r),shouldMergeDefaultsIntoFormData:c});return cH(t,r,v,i,l,d.required,s,y),t},{});if(d.additionalProperties){let t=ot(d.additionalProperties)?d.additionalProperties:{},r=new Set;ot(u)&&Object.keys(u).filter(e=>!d.properties||!d.properties[e]).forEach(e=>r.add(e));let f=[];Object.keys(h).filter(e=>!d.properties||!d.properties[e]).forEach(e=>{r.add(e),f.push(e)}),r.forEach(r=>{var m;let g=cU(e,t,{rootSchema:n,_recurseList:o,experimental_defaultFormStateBehavior:s,experimental_customMergeAllOf:a,includeUndefinedValues:!0===i,parentDefaults:aE(u,[r]),rawFormData:aE(h,[r]),required:null==(m=d.required)?void 0:m.includes(r),shouldMergeDefaultsIntoFormData:c});cH(p,r,g,i,l,f)})}return p}}(e,t,r,n);case"array":return function(e,t,{rawFormData:r,rootSchema:n={},_recurseList:i=[],experimental_defaultFormStateBehavior:o,experimental_customMergeAllOf:s,required:a,shouldMergeDefaultsIntoFormData:l}={},c){var u,h;let d=null!=(u=null==o?void 0:o.arrayMinItems)?u:{},{populate:f,mergeExtraDefaults:p}=d,m="never"===f,g="requiredOnly"===f,y=null!=(h=null==d?void 0:d.computeSkipPopulate)?h:()=>!1,v=(null==o?void 0:o.emptyObjectFields)==="skipEmptyDefaults"?void 0:[];if(Array.isArray(c)&&(c=c.map((r,c)=>cU(e,cV(t,mp.Fallback,c),{rootSchema:n,_recurseList:i,experimental_defaultFormStateBehavior:o,experimental_customMergeAllOf:s,parentDefaults:r,required:a,shouldMergeDefaultsIntoFormData:l}))),Array.isArray(r)){let u=cV(t);if(m)c=r;else{let t=r.map((t,r)=>cU(e,u,{rootSchema:n,_recurseList:i,experimental_defaultFormStateBehavior:o,experimental_customMergeAllOf:s,rawFormData:t,parentDefaults:aE(c,[r]),required:a,shouldMergeDefaultsIntoFormData:l}));c=cR(c,t,(g&&a||"all"===f||!m&&!g)&&p)}}if(!1===(ot(t)&&"const"in t&&(null==o?void 0:o.constAsDefaults)!=="never")){if(m)return null!=c?c:v;if(g&&!a)return c||void 0}let b=Array.isArray(c)?c.length:0;if(!t.minItems||cF(e,t,n,s)||y(e,t,n)||t.minItems<=b)return c||v;let x=c||[],w=cV(t,mp.Invert),k=w.default,A=Array(t.minItems-b).fill(cU(e,w,{parentDefaults:k,rootSchema:n,_recurseList:i,experimental_defaultFormStateBehavior:o,experimental_customMergeAllOf:s,required:a,shouldMergeDefaultsIntoFormData:l}));return x.concat(A)}(e,t,r,n)}}function cK(e,t,r,n,i=!1,o,s){if(!ot(t))throw Error("Invalid schema: "+t);let a=cj(e,t,n,r,s),l=cU(e,a,{rootSchema:n,includeUndefinedValues:i,experimental_defaultFormStateBehavior:o,experimental_customMergeAllOf:s,rawFormData:r,shouldMergeDefaultsIntoFormData:!0});if(ot(r)||Array.isArray(r)){let{mergeDefaultsIntoFormData:e}=o||{};return cR(l,r,!0,"useDefaultIfFormDataUndefined"===e,!0)}return l}function cG(e={}){return"widget"in of(e)&&"hidden"!==of(e).widget}function cJ(e,t,r={},n,i){if("files"===r[oh])return!0;if(t.items){let r=cj(e,t.items,n,void 0,i);return"string"===r.type&&"data-url"===r.format}return!1}(mu=mp||(mp={}))[mu.Ignore=0]="Ignore",mu[mu.Invert=1]="Invert",mu[mu.Fallback=2]="Fallback";let cY=Symbol("no Value");class cX{constructor(e,t,r,n){this.rootSchema=t,this.validator=e,this.experimental_defaultFormStateBehavior=r,this.experimental_customMergeAllOf=n}getValidator(){return this.validator}doesSchemaUtilsDiffer(e,t,r={},n){return!!e&&!!t&&(this.validator!==e||!al(this.rootSchema,t)||!al(this.experimental_defaultFormStateBehavior,r)||this.experimental_customMergeAllOf!==n)}getDefaultFormState(e,t,r=!1){return cK(this.validator,e,t,this.rootSchema,r,this.experimental_defaultFormStateBehavior,this.experimental_customMergeAllOf)}getDisplayLabel(e,t,r){return function(e,t,r={},n,i,o){let{label:s=!0}=of(r,i),a=!!s,l=cA(t);return"array"===l&&(a=cF(e,t,n,o)||cJ(e,t,r,n,o)||cG(r)),"object"===l&&(a=!1),"boolean"!==l||r[oh]||(a=!1),r["ui:field"]&&(a=!1),a}(this.validator,e,t,this.rootSchema,r,this.experimental_customMergeAllOf)}getClosestMatchingOption(e,t,r,n){return cI(this.validator,this.rootSchema,e,t,r,n,this.experimental_customMergeAllOf)}getFirstMatchingOption(e,t,r){var n;return n=this.validator,l8(n,e,t,this.rootSchema,r)}getMatchingOption(e,t,r){return l8(this.validator,e,t,this.rootSchema,r)}isFilesArray(e,t){return cJ(this.validator,e,t,this.rootSchema,this.experimental_customMergeAllOf)}isMultiSelect(e){return cF(this.validator,e,this.rootSchema,this.experimental_customMergeAllOf)}isSelect(e){return cL(this.validator,e,this.rootSchema,this.experimental_customMergeAllOf)}mergeValidationData(e,t){return function(e,t,r){if(!r)return t;let{errors:n,errorSchema:i}=t,o=e.toErrorList(r),s=r;return aM(i)||(s=cN(i,r,!0),o=[...n].concat(o)),{errorSchema:s,errors:o}}(this.validator,e,t)}retrieveSchema(e,t){return cj(this.validator,e,this.rootSchema,t,this.experimental_customMergeAllOf)}sanitizeDataForNewSchema(e,t,r){return function e(t,r,n,i,o={},s){let a;if(lM(n,oa)){let l={};lM(i,oa)&&Object.keys(aE(i,oa,{})).forEach(e=>{lM(o,e)&&(l[e]=void 0)});let c=Object.keys(aE(n,oa,{})),u={};c.forEach(a=>{let c=aE(o,a),h=aE(i,[oa,a],{}),d=aE(n,[oa,a],{});lM(h,"$ref")&&(h=cj(t,h,r,c,s)),lM(d,"$ref")&&(d=cj(t,d,r,c,s));let f=aE(h,"type"),p=aE(d,"type");if(!f||f===p)if(lM(l,a)&&delete l[a],"object"===p||"array"===p&&Array.isArray(c)){let n=e(t,r,d,h,c,s);(void 0!==n||"array"===p)&&(u[a]=n)}else{let e=aE(d,"default",cY),t=aE(h,"default",cY);e!==cY&&e!==c&&(t===c?l[a]=e:!0===aE(d,"readOnly")&&(l[a]=void 0));let r=aE(d,"const",cY),n=aE(h,"const",cY);r!==cY&&r!==c&&(l[a]=n===c?r:void 0)}}),a={..."string"==typeof o||Array.isArray(o)?void 0:o,...l,...u}}else if("array"===aE(i,"type")&&"array"===aE(n,"type")&&Array.isArray(o)){let l=aE(i,"items"),c=aE(n,"items");if("object"!=typeof l||"object"!=typeof c||Array.isArray(l)||Array.isArray(c))"boolean"==typeof l&&"boolean"==typeof c&&l===c&&(a=o);else{lM(l,"$ref")&&(l=cj(t,l,r,o,s)),lM(c,"$ref")&&(c=cj(t,c,r,o,s));let i=aE(l,"type"),u=aE(c,"type");if(!i||i===u){let i=aE(n,"maxItems",-1);a="object"===u?o.reduce((n,o)=>{let a=e(t,r,c,l,o,s);return void 0!==a&&(i<0||n.length<i)&&n.push(a),n},[]):i>0&&o.length>i?o.slice(0,i):o}}}return a}(this.validator,this.rootSchema,e,t,r,this.experimental_customMergeAllOf)}toIdSchema(e,t,r,n="root",i="_"){return function(e,t,r,n,i,o="root",s="_",a){return function e(t,r,n,i,o,s,a,l=[],c){if("$ref"in r||oo in r||"allOf"in r){let u=cj(t,r,s,a,c);if(-1===l.findIndex(e=>al(e,u)))return e(t,u,n,i,o,s,a,l.concat(u),c)}if("items"in r&&!aE(r,["items","$ref"]))return e(t,aE(r,"items"),n,i,o,s,a,l,c);let u={$id:o||n};if("object"===cA(r)&&oa in r)for(let o in r.properties){let h=aE(r,[oa,o]),d=u.$id+i+o;u[o]=e(t,ot(h)?h:{},n,i,d,s,aE(a,[o]),l,c)}return u}(e,t,o,s,r,n,i,void 0,a)}(this.validator,e,t,this.rootSchema,r,n,i,this.experimental_customMergeAllOf)}toPathSchema(e,t,r){return function(e,t,r="",n,i,o){return function e(t,r,n,i,o,s=[],a){if("$ref"in r||oo in r||"allOf"in r){let l=cj(t,r,i,o,a);if(-1===s.findIndex(e=>al(e,l)))return e(t,l,n,i,o,s.concat(l),a)}let l={$name:n.replace(/^\./,"")};if("oneOf"in r||"anyOf"in r){let c="oneOf"in r?r.oneOf:r.anyOf,u=cI(t,i,o,c,0,cx(r),a),h=c[u];l={...l,...e(t,h,n,i,o,s,a)}}if(oi in r&&!1!==r[oi]&&ce(l,oc,!0),"items"in r&&Array.isArray(o)){let{items:c,additionalItems:u}=r;Array.isArray(c)?o.forEach((r,o)=>{c[o]?l[o]=e(t,c[o],`${n}.${o}`,i,r,s,a):u?l[o]=e(t,u,`${n}.${o}`,i,r,s,a):console.warn(`Unable to generate path schema for "${n}.${o}". No schema defined for it`)}):o.forEach((r,o)=>{l[o]=e(t,c,`${n}.${o}`,i,r,s,a)})}else if(oa in r)for(let c in r.properties){let u=aE(r,[oa,c]);l[c]=e(t,u,`${n}.${c}`,i,aE(o,[c]),s,a)}return l}(e,t,r,n,i,void 0,o)}(this.validator,e,t,this.rootSchema,r,this.experimental_customMergeAllOf)}}function cZ(e,t){let r=String(e);for(;r.length<t;)r="0"+r;return r}function cQ(e,t){let r=e;if(Array.isArray(t)){let e=r.split(/(%\d)/);t.forEach((t,r)=>{let n=e.findIndex(e=>e===`%${r+1}`);n>=0&&(e[n]=t)}),r=e.join("")}return r}function c0(e,t=[],r){if(Array.isArray(e))return e.map(e=>c0(e,t)).filter(e=>e!==r);let n=t[""===e||null===e?-1:Number(e)];return n?n.value:r}function c1(e,t,r=[]){let n=c0(e,r);return Array.isArray(t)?t.filter(e=>!al(e,n)):al(n,t)?void 0:t}function c2(e,t){return Array.isArray(t)?t.some(t=>al(t,e)):al(t,e)}function c4(e,t=[],r=!1){let n=t.map((t,r)=>c2(t.value,e)?String(r):void 0).filter(e=>void 0!==e);return r?n:n[0]}function c3(e,t,r=[]){let n=c0(e,r);if(!cD(n)){let e=r.findIndex(e=>n===e.value),i=r.map(({value:e})=>e);return t.slice(0,e).concat(n,t.slice(e)).sort((e,t)=>Number(i.indexOf(e)>i.indexOf(t)))}return t}function c5(e){let t={};return e.multipleOf&&(t.step=e.multipleOf),(e.minimum||0===e.minimum)&&(t.min=e.minimum),(e.maximum||0===e.maximum)&&(t.max=e.maximum),t}function c6(e,t,r={},n=!0){let i={type:t||"text",...c5(e)};return r.inputType?i.type=r.inputType:!t&&("number"===e.type?(i.type="number",n&&void 0===i.step&&(i.step="any")):"integer"===e.type&&(i.type="number",void 0===i.step&&(i.step=1))),r.autocomplete&&(i.autoComplete=r.autocomplete),r.accept&&(i.accept=r.accept),i}let c9={props:{disabled:!1},submitText:"Submit",norender:!1};function c8(e={}){let t=of(e);if(t&&t[ol]){let e=t[ol];return{...c9,...e}}return c9}function c7(e,t,r={}){let{templates:n}=t;return"ButtonTemplates"===e?n[e]:r[e]||n[e]}var ue=r(35631);let ut={boolean:{checkbox:"CheckboxWidget",radio:"RadioWidget",select:"SelectWidget",hidden:"HiddenWidget"},string:{text:"TextWidget",password:"PasswordWidget",email:"EmailWidget",hostname:"TextWidget",ipv4:"TextWidget",ipv6:"TextWidget",uri:"URLWidget","data-url":"FileWidget",radio:"RadioWidget",select:"SelectWidget",textarea:"TextareaWidget",hidden:"HiddenWidget",date:"DateWidget",datetime:"DateTimeWidget","date-time":"DateTimeWidget","alt-date":"AltDateWidget","alt-datetime":"AltDateTimeWidget",time:"TimeWidget",color:"ColorWidget",file:"FileWidget"},number:{text:"TextWidget",select:"SelectWidget",updown:"UpDownWidget",range:"RangeWidget",radio:"RadioWidget",hidden:"HiddenWidget"},integer:{text:"TextWidget",select:"SelectWidget",updown:"UpDownWidget",range:"RangeWidget",radio:"RadioWidget",hidden:"HiddenWidget"},array:{select:"SelectWidget",checkboxes:"CheckboxesWidget",files:"FileWidget",hidden:"HiddenWidget"}};function ur(e,t,r={}){let n=cA(e);if("function"==typeof t||t&&ue.isForwardRef((0,tZ.createElement)(t))||ue.isMemo(t)){let e=aE(t,"MergedWidget");if(!e){let r=t.defaultProps&&t.defaultProps.options||{};e=({options:e,...n})=>(0,v.jsx)(t,{options:{...r,...e},...n}),ce(t,"MergedWidget",e)}return e}if("string"!=typeof t)throw Error(`Unsupported widget definition: ${typeof t}`);if(t in r)return ur(e,r[t],r);if("string"==typeof n){if(!(n in ut))throw Error(`No widget for type '${n}'`);if(t in ut[n])return ur(e,r[ut[n][t]],r)}throw Error(`No widget '${t}' for type '${n}'`)}function un(e,t){let r=lT(e)?e:e.$id;return`${r}__${t}`}function ui(e){return un(e,"description")}function uo(e){return un(e,"error")}function us(e){return un(e,"examples")}function ua(e){return un(e,"help")}function ul(e){return un(e,"title")}function uc(e,t=!1){let r=t?` ${us(e)}`:"";return`${uo(e)} ${ui(e)} ${ua(e)}${r}`}function uu(e,t){return`${e}-${t}`}function uh(e,t=!0){if(!e)return{year:-1,month:-1,day:-1,hour:t?-1:0,minute:t?-1:0,second:t?-1:0};let r=new Date(e);if(Number.isNaN(r.getTime()))throw Error("Unable to parse date "+e);return{year:r.getUTCFullYear(),month:r.getUTCMonth()+1,day:r.getUTCDate(),hour:t?r.getUTCHours():0,minute:t?r.getUTCMinutes():0,second:t?r.getUTCSeconds():0}}function ud(e){return!!e.const||!!e.enum&&1===e.enum.length&&!0===e.enum[0]||(e.anyOf&&1===e.anyOf.length?ud(e.anyOf[0]):e.oneOf&&1===e.oneOf.length?ud(e.oneOf[0]):!!e.allOf&&e.allOf.some(e=>ud(e)))}function uf(e,t=!0){let{year:r,month:n,day:i,hour:o=0,minute:s=0,second:a=0}=e,l=new Date(Date.UTC(r,n-1,i,o,s,a)).toJSON();return t?l:l.slice(0,10)}function up(e,t=[]){if(!e)return[];let r=[];return os in e&&(r=r.concat(e[os].map(e=>{let r=`.${t.join(".")}`;return{property:r,message:e,stack:`${r} ${e}`}}))),Object.keys(e).reduce((r,n)=>{if(n!==os){let i=e[n];oD(i)&&(r=r.concat(up(i,[...t,n])))}return r},r)}let um=function(e){return sc(e)?ay(e,aj):ac(e)?[e]:aq(ag(ak(e)))},ug=function(e){return ls(e,5)};class uy{constructor(e){this.errorSchema={},this.resetAllErrors(e)}get ErrorSchema(){return this.errorSchema}getOrCreateErrorBlock(e){let t=Array.isArray(e)&&e.length>0||"string"==typeof e?aE(this.errorSchema,e):this.errorSchema;if(!t&&e){var r,n,i;t={},r=this.errorSchema,n=t,i="function"==typeof(i=Object)?i:void 0,null==r||l7(r,e,n,i)}return t}resetAllErrors(e){return this.errorSchema=e?ug(e):{},this}addErrors(e,t){let r=this.getOrCreateErrorBlock(t),n=aE(r,os);return Array.isArray(n)||(n=[],r[os]=n),Array.isArray(e)?ce(r,os,[...new Set([...n,...e])]):ce(r,os,[...new Set([...n,e])]),this}setErrors(e,t){return ce(this.getOrCreateErrorBlock(t),os,Array.isArray(e)?[...new Set([...e])]:[e]),this}clearErrors(e){return ce(this.getOrCreateErrorBlock(e),os,[]),this}}function uv(e){return Object.keys(e).reduce((t,r)=>{if("addError"===r)return t;{let n=e[r];return oD(n)?{...t,[r]:uv(n)}:{...t,[r]:n}}},{})}function ub(e,t){if(!t)return e;let{errors:r,errorSchema:n}=e,i=up(t),o=t;return aM(n)||(o=cN(n,t,!0),i=[...r].concat(i)),{errorSchema:o,errors:i}}let ux=function(e,t,r){for(var n=-1,i=t.length,o={};++n<i;){var s=t[n],a=aC(e,s);r(a,s)&&l7(o,aA(s,e),a)}return o},uw=function(e,t){if(null==e)return{};var r=ay(aG(e),function(e){return[e]});return t=lH(t),ux(e,r,function(e,r){return t(e,r[0])})},uk=function(e,t,r,n){var i=-1,o=cp,s=!0,a=e.length,l=[],c=t.length;if(!a)return l;r&&(t=ay(t,sP(r))),n?(o=cm,s=!1):t.length>=200&&(o=se,s=!1,t=new o8(t));e:for(;++i<a;){var u=e[i],h=null==r?u:r(u);if(u=n||0!==u?u:0,s&&h==h){for(var d=c;d--;)if(t[d]===h)continue e;l.push(u)}else o(t,h,n)||l.push(u)}return l};var uA=ca(function(e,t){return cn(e)?uk(e,lp(t,1,cn,!0)):[]});(mh=mm||(mm={})).ArrayItemTitle="Item",mh.MissingItems="Missing items definition",mh.YesLabel="Yes",mh.NoLabel="No",mh.CloseLabel="Close",mh.ErrorsLabel="Errors",mh.NewStringDefault="New Value",mh.AddButton="Add",mh.AddItemButton="Add Item",mh.CopyButton="Copy",mh.MoveDownButton="Move down",mh.MoveUpButton="Move up",mh.RemoveButton="Remove",mh.NowLabel="Now",mh.ClearLabel="Clear",mh.AriaDateLabel="Select a date",mh.PreviewLabel="Preview",mh.DecrementAriaLabel="Decrease value by 1",mh.IncrementAriaLabel="Increase value by 1",mh.UnknownFieldType="Unknown field type %1",mh.OptionPrefix="Option %1",mh.TitleOptionPrefix="%1 option %2",mh.KeyLabel="%1 Key",mh.InvalidObjectField='Invalid "%1" object field configuration: _%2_.',mh.UnsupportedField="Unsupported field schema.",mh.UnsupportedFieldWithId="Unsupported field schema for field `%1`.",mh.UnsupportedFieldWithReason="Unsupported field schema: _%1_.",mh.UnsupportedFieldWithIdAndReason="Unsupported field schema for field `%1`: _%2_.",mh.FilesInfo="**%1** (%2, %3 bytes)";var uS=r(11601),uj=r.n(uS),uC=r(74421),uE=r.n(uC);let uO={allErrors:!0,multipleOfPrecision:8,strict:!1,verbose:!0,discriminator:!1},uM=/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,uP=/^data:([a-z]+\/[a-z0-9-+.]+)?;(?:name=(.*);)?base64,(.*)$/;class uT{constructor(e,t){const{additionalMetaSchemas:r,customFormats:n,ajvOptionsOverrides:i,ajvFormatOptions:o,AjvClass:s}=e;this.ajv=function(e,t,r={},n,i=uj()){let o=new i({...uO,...r});return n?uE()(o,n):!1!==n&&uE()(o),o.addFormat("data-url",uP),o.addFormat("color",uM),o.addKeyword(on),o.addKeyword(oc),Array.isArray(e)&&o.addMetaSchema(e),oB(t)&&Object.keys(t).forEach(e=>{o.addFormat(e,t[e])}),o}(r,n,i,o,s),this.localizer=t}reset(){this.ajv.removeSchema()}toErrorList(e,t=[]){return up(e,t)}rawValidation(e,t){var r,n;let i,o,s;e.$id&&(i=this.ajv.getSchema(e.$id));try{void 0===i&&(i=this.ajv.compile(e)),i(t)}catch(e){s=e}return i&&("function"==typeof this.localizer&&((null!=(r=i.errors)?r:[]).forEach(e=>{var t;["missingProperty","property"].forEach(t=>{var r;(null==(r=e.params)?void 0:r[t])&&(e.params[t]=`'${e.params[t]}'`)}),(null==(t=e.params)?void 0:t.deps)&&(e.params.deps=e.params.deps.split(", ").map(e=>`'${e}'`).join(", "))}),this.localizer(i.errors),(null!=(n=i.errors)?n:[]).forEach(e=>{var t;["missingProperty","property"].forEach(t=>{var r;(null==(r=e.params)?void 0:r[t])&&(e.params[t]=e.params[t].slice(1,-1))}),(null==(t=e.params)?void 0:t.deps)&&(e.params.deps=e.params.deps.split(", ").map(e=>e.slice(1,-1)).join(", "))})),o=i.errors||void 0,i.errors=null),{errors:o,validationError:s}}validateFormData(e,t,r,n,i){return function(e,t,r,n,i,o,s){var a;let l,{validationError:c}=t,u=function(e=[],t){return e.map(e=>{var r;let{instancePath:n,keyword:i,params:o,schemaPath:s,parentSchema:a,...l}=e,{message:c=""}=l,u=n.replace(/\//g,"."),h=`${u} ${c}`.trim(),d=[...(null==(r=o.deps)?void 0:r.split(", "))||[],o.missingProperty,o.property].filter(e=>e);if(d.length>0)d.forEach(e=>{let r=u?`${u}.${e}`:e,n=of(aE(t,`${r.replace(/^\./,"")}`)).title;if(void 0===n&&(n=of(aE(t,s.replace(/\/properties\//g,"/").split("/").slice(1,-1).concat([e]))).title),n)c=c.replace(`'${e}'`,`'${n}'`);else{let t=aE(a,[oa,e,"title"]);t&&(c=c.replace(`'${e}'`,`'${t}'`))}}),h=c;else{let e=of(aE(t,`${u.replace(/^\./,"")}`)).title;if(e)h=`'${e}' ${c}`.trim();else{let e=null==a?void 0:a.title;e&&(h=`'${e}' ${c}`.trim())}}return"missingProperty"in o&&(u=u?`${u}.${o.missingProperty}`:o.missingProperty),{name:i,property:u,message:c,params:o,stack:h,schemaPath:s}})}(t.errors,s);c&&(u=[...u,{stack:c.message}]),"function"==typeof o&&(u=o(u,s));let h=(a=u,l=new uy,a.length&&a.forEach(e=>{let{property:t,message:r}=e,n="."===t?[]:um(t);n.length>0&&""===n[0]&&n.splice(0,1),r&&l.addErrors(r,n)}),l.ErrorSchema);if(c&&(h={...h,$schema:{__errors:[c.message]}}),"function"!=typeof i)return{errors:u,errorSchema:h};let d=cK(e,n,r,n,!0);return ub({errors:u,errorSchema:h},uv(i(d,oR(d),s)))}(this,this.rawValidation(t,e),e,t,r,n,i)}handleSchemaUpdate(e){var t,r;let n=null!=(t=e.$id)?t:ou;void 0===this.ajv.getSchema(n)?this.ajv.addSchema(e,n):al(e,null==(r=this.ajv.getSchema(n))?void 0:r.schema)||(this.ajv.removeSchema(n),this.ajv.addSchema(e,n))}isValid(e,t,r){var n;try{let i;this.handleSchemaUpdate(r);let o=function e(t){if(Array.isArray(t)){var r=[...t];for(let t=0;t<r.length;t++)r[t]=e(r[t]);return r}if(oB(t)){var n={...t};for(let t in n){let r=n[t];"$ref"===t&&"string"==typeof r&&r.startsWith("#")?n[t]=ou+r:n[t]=e(r)}return n}return t}(e),s=null!=(n=o.$id)?n:function(e){let t=new Set;JSON.stringify(e,(e,r)=>(t.add(e),r));var r=JSON.stringify(e,Array.from(t).sort());let n=0;for(let e=0;e<r.length;e+=1)n=(n<<5)-n+r.charCodeAt(e),n&=n;return n.toString(16)}(o);return i=this.ajv.getSchema(s),void 0===i&&(i=this.ajv.addSchema(o,s).getSchema(s)||this.ajv.compile(o)),i(t)}catch(e){return console.warn("Error encountered compiling schema:",e),!1}}}function uI(e={},t){return new uT(e,t)}let u$=uI();var uD=r(67156),uR=r.n(uD),uN=r(45810),u_=r.n(uN);let{parse:uL,stringify:uF}=JSON,{keys:uB}=Object,uz=String,uW="string",uV={},uH="object",uU=(e,t)=>t,uq=e=>e instanceof uz?uz(e):e,uK=(e,t)=>typeof t===uW?new uz(t):t,uG=(e,t,r,n)=>{let i=[];for(let o=uB(r),{length:s}=o,a=0;a<s;a++){let s=o[a],l=r[s];if(l instanceof uz){let o=e[l];typeof o!==uH||t.has(o)?r[s]=n.call(r,s,o):(t.add(o),r[s]=uV,i.push({k:s,a:[e,t,o,n]}))}else r[s]!==uV&&(r[s]=n.call(r,s,l))}for(let{length:e}=i,t=0;t<e;t++){let{k:e,a:o}=i[t];r[e]=n.call(r,e,uG.apply(null,o))}return r},uJ=(e,t,r)=>{let n=uz(t.push(r)-1);return e.set(r,n),n};function uY(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}let uX=e=>{var t;let r,n,i,o,s={},a=(n=(r=uL(((e,t,r)=>{let n=t&&typeof t===uH?(e,r)=>""===e||-1<t.indexOf(e)?r:void 0:t||uU,i=new Map,o=[],s=[],a=+uJ(i,o,n.call({"":e},"",e)),l=!a;for(;a<o.length;)l=!0,s[a]=uF(o[a++],c,r);return"["+s.join(",")+"]";function c(e,t){if(l)return l=!l,t;let r=n.call(this,e,t);switch(typeof r){case uH:if(null===r)break;case uW:return i.get(r)||uJ(i,o,r)}return r}})(e),uK).map(uq))[0],i=t||uU,o=typeof n===uH&&n?uG(r,new Set,n,i):n,i.call({"":o},"",o));return!function e(t,r){if(!uY(t))return;let{properties:n,items:i,anyOf:o,oneOf:s,allOf:a,dependencies:l,then:c,else:u}=t;for(let e in t)t.hasOwnProperty(e)&&e.startsWith("ui:")&&(r[e]=t[e],delete t[e]);if(uY(n))for(let t in n){if(!n.hasOwnProperty(t))continue;let i=n[t];if(uY(i)){if(!uY(r[t])){let e={};r[t]=e}e(i,r[t])}}if(uY(i)){let t={};r.items=t,e(i,t)}if(Array.isArray(o))for(let t of o)uY(t)&&e(t,r);if(Array.isArray(s))for(let t of s)uY(t)&&e(t,r);if(Array.isArray(a))for(let t of a)uY(t)&&e(t,r);if(uY(l))for(let t of Object.keys(l)){let n=l[t];uY(n)&&e(n,r)}uY(c)&&e(c,r),uY(u)&&e(u,r)}(a,s),{uiSchema:s,schema:a}};var uZ=lk(function(e,t){return null==e?{}:ux(e,t,function(t,r){return lW(e,r)})}),uQ=0;let u0=function(e){var t=++uQ;return ak(e)+t};function u1(){return u0("rjsf-array-item-")}function u2(e){return Array.isArray(e)?e.map(e=>({key:u1(),item:e})):[]}function u4(e){return Array.isArray(e)?e.map(e=>e.item):[]}class u3 extends tZ.Component{constructor(e){super(e);const{formData:t=[]}=e,r=u2(t);this.state={keyedFormData:r,updatedKeyedFormData:!1}}static getDerivedStateFromProps(e,t){if(t.updatedKeyedFormData)return{updatedKeyedFormData:!1};let r=Array.isArray(e.formData)?e.formData:[],n=t.keyedFormData||[];return{keyedFormData:r.length===n.length?n.map((e,t)=>({key:e.key,item:r[t]})):u2(r)}}get itemTitle(){let{schema:e,registry:t}=this.props,{translateString:r}=t;return aE(e,["items","title"],aE(e,["items","description"],r(mm.ArrayItemTitle)))}isItemRequired(e){return Array.isArray(e.type)?!e.type.includes("null"):"null"!==e.type}canAddItem(e){let{schema:t,uiSchema:r,registry:n}=this.props,{addable:i}=of(r,n.globalUiOptions);return!1!==i&&(i=void 0===t.maxItems||e.length<t.maxItems),i}_getNewFormDataRow=()=>{let{schema:e,registry:t}=this.props,{schemaUtils:r}=t,n=e.items;return c$(e)&&(!0===e.additionalItems&&console.warn("additionalItems=true is currently not supported"),ot(e.additionalItems))&&(n=e.additionalItems),r.getDefaultFormState(n)};_handleAddClick(e,t){let r;e&&e.preventDefault();let{onChange:n,errorSchema:i}=this.props,{keyedFormData:o}=this.state;if(i)for(let e in r={},i){let n=parseInt(e);void 0===t||n<t?ce(r,[n],i[e]):n>=t&&ce(r,[n+1],i[e])}let s={key:u1(),item:this._getNewFormDataRow()},a=[...o];void 0!==t?a.splice(t,0,s):a.push(s),this.setState({keyedFormData:a,updatedKeyedFormData:!0},()=>n(u4(a),r))}onAddClick=e=>{this._handleAddClick(e)};onAddIndexClick=e=>t=>{this._handleAddClick(t,e)};onCopyIndexClick=e=>t=>{let r;t&&t.preventDefault();let{onChange:n,errorSchema:i}=this.props,{keyedFormData:o}=this.state;if(i)for(let t in r={},i){let n=parseInt(t);n<=e?ce(r,[n],i[t]):n>e&&ce(r,[n+1],i[t])}let s={key:u1(),item:ug(o[e].item)},a=[...o];void 0!==e?a.splice(e+1,0,s):a.push(s),this.setState({keyedFormData:a,updatedKeyedFormData:!0},()=>n(u4(a),r))};onDropIndexClick=e=>t=>{let r;t&&t.preventDefault();let{onChange:n,errorSchema:i}=this.props,{keyedFormData:o}=this.state;if(i)for(let t in r={},i){let n=parseInt(t);n<e?ce(r,[n],i[t]):n>e&&ce(r,[n-1],i[t])}let s=o.filter((t,r)=>r!==e);this.setState({keyedFormData:s,updatedKeyedFormData:!0},()=>n(u4(s),r))};onReorderClick=(e,t)=>r=>{let n,i;r&&(r.preventDefault(),r.currentTarget.blur());let{onChange:o,errorSchema:s}=this.props;if(s)for(let r in n={},s){let i=parseInt(r);i==e?ce(n,[t],s[e]):i==t?ce(n,[e],s[t]):ce(n,[r],s[i])}let{keyedFormData:a}=this.state,l=((i=a.slice()).splice(e,1),i.splice(t,0,a[e]),i);this.setState({keyedFormData:l},()=>o(u4(l),n))};onChangeForIndex=e=>(t,r,n)=>{let{formData:i,onChange:o,errorSchema:s}=this.props;o((Array.isArray(i)?i:[]).map((r,n)=>e===n?void 0===t?null:t:r),s&&s&&{...s,[e]:r},n)};onSelectChange=e=>{let{onChange:t,idSchema:r}=this.props;t(e,void 0,r&&r.$id)};render(){let{schema:e,uiSchema:t,idSchema:r,registry:n}=this.props,{schemaUtils:i,translateString:o}=n;if(!("items"in e)){let i=c7("UnsupportedFieldTemplate",n,of(t));return(0,v.jsx)(i,{schema:e,idSchema:r,reason:o(mm.MissingItems),registry:n})}return i.isMultiSelect(e)?this.renderMultiSelect():cG(t)?this.renderCustomWidget():c$(e)?this.renderFixedArray():i.isFilesArray(e,t)?this.renderFiles():this.renderNormalArray()}renderNormalArray(){let{schema:e,uiSchema:t={},errorSchema:r,idSchema:n,name:i,title:o,disabled:s=!1,readonly:a=!1,autofocus:l=!1,required:c=!1,registry:u,onBlur:h,onFocus:d,idPrefix:f,idSeparator:p="_",rawErrors:m}=this.props,{keyedFormData:g}=this.state,y=e.title||o||i,{schemaUtils:b,formContext:x}=u,w=of(t),k=oB(e.items)?e.items:{},A=b.retrieveSchema(k),S=u4(this.state.keyedFormData),j=this.canAddItem(S),C={canAdd:j,items:g.map((e,o)=>{let{key:s,item:a}=e,c=b.retrieveSchema(k,a),u=r?r[o]:void 0,v=n.$id+p+o,x=b.toIdSchema(c,v,a,f,p);return this.renderArrayFieldItem({key:s,index:o,name:i&&`${i}-${o}`,title:y?`${y}-${o+1}`:void 0,canAdd:j,canMoveUp:o>0,canMoveDown:o<S.length-1,itemSchema:c,itemIdSchema:x,itemErrorSchema:u,itemData:a,itemUiSchema:t.items,autofocus:l&&0===o,onBlur:h,onFocus:d,rawErrors:m,totalItems:g.length})}),className:`field field-array field-array-of-${A.type}`,disabled:s,idSchema:n,uiSchema:t,onAddClick:this.onAddClick,readonly:a,required:c,schema:e,title:y,formContext:x,formData:S,rawErrors:m,registry:u},E=c7("ArrayFieldTemplate",u,w);return(0,v.jsx)(E,{...C})}renderCustomWidget(){let{schema:e,idSchema:t,uiSchema:r,disabled:n=!1,readonly:i=!1,autofocus:o=!1,required:s=!1,hideError:a,placeholder:l,onBlur:c,onFocus:u,formData:h=[],registry:d,rawErrors:f,name:p}=this.props,{widgets:m,formContext:g,globalUiOptions:y,schemaUtils:b}=d,{widget:x,title:w,...k}=of(r,y),A=ur(e,x,m),S=w??e.title??p,j=b.getDisplayLabel(e,r,y);return(0,v.jsx)(A,{id:t.$id,name:p,multiple:!0,onChange:this.onSelectChange,onBlur:c,onFocus:u,options:k,schema:e,uiSchema:r,registry:d,value:h,disabled:n,readonly:i,hideError:a,required:s,label:S,hideLabel:!j,placeholder:l,formContext:g,autofocus:o,rawErrors:f})}renderMultiSelect(){let{schema:e,idSchema:t,uiSchema:r,formData:n=[],disabled:i=!1,readonly:o=!1,autofocus:s=!1,required:a=!1,placeholder:l,onBlur:c,onFocus:u,registry:h,rawErrors:d,name:f}=this.props,{widgets:p,schemaUtils:m,formContext:g,globalUiOptions:y}=h,b=cz(m.retrieveSchema(e.items,n),r),{widget:x="select",title:w,...k}=of(r,y),A=ur(e,x,p),S=w??e.title??f,j=m.getDisplayLabel(e,r,y);return(0,v.jsx)(A,{id:t.$id,name:f,multiple:!0,onChange:this.onSelectChange,onBlur:c,onFocus:u,options:{...k,enumOptions:b},schema:e,uiSchema:r,registry:h,value:n,disabled:i,readonly:o,required:a,label:S,hideLabel:!j,placeholder:l,formContext:g,autofocus:s,rawErrors:d})}renderFiles(){let{schema:e,uiSchema:t,idSchema:r,name:n,disabled:i=!1,readonly:o=!1,autofocus:s=!1,required:a=!1,onBlur:l,onFocus:c,registry:u,formData:h=[],rawErrors:d}=this.props,{widgets:f,formContext:p,globalUiOptions:m,schemaUtils:g}=u,{widget:y="files",title:b,...x}=of(t,m),w=ur(e,y,f),k=b??e.title??n,A=g.getDisplayLabel(e,t,m);return(0,v.jsx)(w,{options:x,id:r.$id,name:n,multiple:!0,onChange:this.onSelectChange,onBlur:l,onFocus:c,schema:e,uiSchema:t,value:h,disabled:i,readonly:o,required:a,registry:u,formContext:p,autofocus:s,rawErrors:d,label:k,hideLabel:!A})}renderFixedArray(){let{schema:e,uiSchema:t={},formData:r=[],errorSchema:n,idPrefix:i,idSeparator:o="_",idSchema:s,name:a,title:l,disabled:c=!1,readonly:u=!1,autofocus:h=!1,required:d=!1,registry:f,onBlur:p,onFocus:m,rawErrors:g}=this.props,{keyedFormData:y}=this.state,{formData:b=[]}=this.props,x=e.title||l||a,w=of(t),{schemaUtils:k,formContext:A}=f,S=(oB(e.items)?e.items:[]).map((e,t)=>k.retrieveSchema(e,r[t])),j=oB(e.additionalItems)?k.retrieveSchema(e.additionalItems,r):null;(!b||b.length<S.length)&&(b=(b=b||[]).concat(Array(S.length-b.length)));let C=this.canAddItem(b)&&!!j,E={canAdd:C,className:"field field-array field-array-fixed-items",disabled:c,idSchema:s,formData:r,items:y.map((r,l)=>{let{key:c,item:u}=r,d=l>=S.length,f=(d&&oB(e.additionalItems)?k.retrieveSchema(e.additionalItems,u):S[l])||{},v=s.$id+o+l,w=k.toIdSchema(f,v,u,i,o),A=d?t.additionalItems||{}:Array.isArray(t.items)?t.items[l]:t.items||{},j=n?n[l]:void 0;return this.renderArrayFieldItem({key:c,index:l,name:a&&`${a}-${l}`,title:x?`${x}-${l+1}`:void 0,canAdd:C,canRemove:d,canMoveUp:l>=S.length+1,canMoveDown:d&&l<b.length-1,itemSchema:f,itemData:u,itemUiSchema:A,itemIdSchema:w,itemErrorSchema:j,autofocus:h&&0===l,onBlur:p,onFocus:m,rawErrors:g,totalItems:y.length})}),onAddClick:this.onAddClick,readonly:u,required:d,registry:f,schema:e,uiSchema:t,title:x,formContext:A,errorSchema:n,rawErrors:g},O=c7("ArrayFieldTemplate",f,w);return(0,v.jsx)(O,{...E})}renderArrayFieldItem(e){let{key:t,index:r,name:n,canAdd:i,canRemove:o=!0,canMoveUp:s,canMoveDown:a,itemSchema:l,itemData:c,itemUiSchema:u,itemIdSchema:h,itemErrorSchema:d,autofocus:f,onBlur:p,onFocus:m,rawErrors:g,totalItems:y,title:b}=e,{disabled:x,hideError:w,idPrefix:k,idSeparator:A,readonly:S,uiSchema:j,registry:C,formContext:E}=this.props,{fields:{ArraySchemaField:O,SchemaField:M},globalUiOptions:P}=C,{orderable:T=!0,removable:I=!0,copyable:$=!1}=of(j,P),D={moveUp:T&&s,moveDown:T&&a,copy:$&&i,remove:I&&o,toolbar:!1};return D.toolbar=Object.keys(D).some(e=>D[e]),{children:(0,v.jsx)(O||M,{name:n,title:b,index:r,schema:l,uiSchema:u,formData:c,formContext:E,errorSchema:d,idPrefix:k,idSeparator:A,idSchema:h,required:this.isItemRequired(l),onChange:this.onChangeForIndex(r),onBlur:p,onFocus:m,registry:C,disabled:x,readonly:S,hideError:w,autofocus:f,rawErrors:g}),className:"array-item",disabled:x,canAdd:i,hasCopy:D.copy,hasToolbar:D.toolbar,hasMoveUp:D.moveUp,hasMoveDown:D.moveDown,hasRemove:D.remove,index:r,totalItems:y,key:t,onAddIndexClick:this.onAddIndexClick,onCopyIndexClick:this.onCopyIndexClick,onDropIndexClick:this.onDropIndexClick,onReorderClick:this.onReorderClick,readonly:S,registry:C,schema:l,uiSchema:u}}}let u5=function(e){let t,{schema:r,name:n,uiSchema:i,idSchema:o,formData:s,registry:a,required:l,disabled:c,readonly:u,hideError:h,autofocus:d,title:f,onChange:p,onFocus:m,onBlur:g,rawErrors:y}=e,{title:b}=r,{widgets:x,formContext:w,translateString:k,globalUiOptions:A}=a,{widget:S="checkbox",title:j,label:C=!0,...E}=of(i,A),O=ur(r,S,x),M=k(mm.YesLabel),P=k(mm.NoLabel),T=j??b??f??n;if(Array.isArray(r.oneOf))t=cz({oneOf:r.oneOf.map(e=>{if(oB(e))return{...e,title:e.title||(!0===e.const?M:P)}}).filter(e=>e)},i);else{let e=r.enum??[!0,!1];t=!r.enumNames&&2===e.length&&e.every(e=>"boolean"==typeof e)?[{value:e[0],label:e[0]?M:P},{value:e[1],label:e[1]?M:P}]:cz({enum:e,enumNames:r.enumNames},i)}return(0,v.jsx)(O,{options:{...E,enumOptions:t},schema:r,uiSchema:i,id:o.$id,name:n,onChange:p,onFocus:m,onBlur:g,label:T,hideLabel:!C,value:s,required:l,disabled:c,readonly:u,hideError:h,registry:a,formContext:w,autofocus:d,rawErrors:y})};class u6 extends tZ.Component{constructor(e){super(e);const{formData:t,options:r,registry:{schemaUtils:n}}=this.props,i=r.map(e=>n.retrieveSchema(e,t));this.state={retrievedOptions:i,selectedOption:this.getMatchingOption(0,t,i)}}componentDidUpdate(e,t){let{formData:r,options:n,idSchema:i}=this.props,{selectedOption:o}=this.state,s=this.state;if(!al(e.options,n)){let{registry:{schemaUtils:e}}=this.props;s={selectedOption:o,retrievedOptions:n.map(t=>e.retrieveSchema(t,r))}}if(!al(r,e.formData)&&i.$id===e.idSchema.$id){let{retrievedOptions:e}=s,n=this.getMatchingOption(o,r,e);t&&n!==o&&(s={selectedOption:n,retrievedOptions:e})}s!==this.state&&this.setState(s)}getMatchingOption(e,t,r){let{schema:n,registry:{schemaUtils:i}}=this.props,o=cx(n);return i.getClosestMatchingOption(t,r,e,o)}onOptionChange=e=>{let{selectedOption:t,retrievedOptions:r}=this.state,{formData:n,onChange:i,registry:o}=this.props,{schemaUtils:s}=o,a=void 0!==e?parseInt(e,10):-1;if(a===t)return;let l=a>=0?r[a]:void 0,c=t>=0?r[t]:void 0,u=s.sanitizeDataForNewSchema(l,c,n);l&&(u=s.getDefaultFormState(l,u,"excludeObjectChildren")),this.setState({selectedOption:a},()=>{i(u,void 0,this.getFieldId())})};getFieldId(){let{idSchema:e,schema:t}=this.props;return`${e.$id}${t.oneOf?"__oneof_select":"__anyof_select"}`}render(){let e,{name:t,disabled:r=!1,errorSchema:n={},formContext:i,onBlur:o,onFocus:s,readonly:a,registry:l,schema:c,uiSchema:u}=this.props,{widgets:h,fields:d,translateString:f,globalUiOptions:p,schemaUtils:m}=l,{SchemaField:g}=d,{selectedOption:y,retrievedOptions:b}=this.state,{widget:x="select",placeholder:w,autofocus:k,autocomplete:A,title:S=c.title,...j}=of(u,p),C=ur({type:"number"},x,h),E=aE(n,os,[]),O=lA(n,[os]),M=m.getDisplayLabel(c,u,p),P=y>=0&&b[y]||null;if(P){let{required:t}=c;e=t?cS({required:t},P):P}let T=[];"oneOf"in c&&u&&"oneOf"in u?Array.isArray(u.oneOf)?T=u.oneOf:console.warn(`uiSchema.oneOf is not an array for "${S||t}"`):"anyOf"in c&&u&&"anyOf"in u&&(Array.isArray(u.anyOf)?T=u.anyOf:console.warn(`uiSchema.anyOf is not an array for "${S||t}"`));let I=u;y>=0&&T.length>y&&(I=T[y]);let $=S?mm.TitleOptionPrefix:mm.OptionPrefix,D=S?[S]:[],R=b.map((e,t)=>{let{title:r=e.title}=of(T[t]);return{label:r||f($,D.concat(String(t+1))),value:t}});return(0,v.jsxs)("div",{className:"panel panel-default panel-body",children:[(0,v.jsx)("div",{className:"form-group",children:(0,v.jsx)(C,{id:this.getFieldId(),name:`${t}${c.oneOf?"__oneof_select":"__anyof_select"}`,schema:{type:"number",default:0},onChange:this.onOptionChange,onBlur:o,onFocus:s,disabled:r||aM(R),multiple:!1,rawErrors:E,errorSchema:O,value:y>=0?y:void 0,options:{enumOptions:R,...j},registry:l,formContext:i,placeholder:w,autocomplete:A,autofocus:k,label:S??t,hideLabel:!M,readonly:a})}),e&&"null"!==e.type&&(0,v.jsx)(g,{...this.props,schema:e,uiSchema:I})]})}}let u9=/\.([0-9]*0)*$/,u8=/[0.]0*$/,u7=function(e){let{registry:t,onChange:r,formData:n,value:i}=e,[o,s]=(0,tZ.useState)(i),{StringField:a}=t.fields,l=n,c=(0,tZ.useCallback)((e,t,n)=>{s(e),"."===`${e}`.charAt(0)&&(e=`0${e}`),r("string"==typeof e&&e.match(u9)?or(e.replace(u8,"")):or(e),t,n)},[r]);if("string"==typeof o&&"number"==typeof l){let e=RegExp(`^(${String(l).replace(".","\\.")})?\\.?0*$`);o.match(e)&&(l=o)}return(0,v.jsx)(a,{...e,formData:l,onChange:c})};function he(){return(he=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}let ht=["children","options"],hr=["allowFullScreen","allowTransparency","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","charSet","classId","colSpan","contentEditable","contextMenu","crossOrigin","encType","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","hrefLang","inputMode","keyParams","keyType","marginHeight","marginWidth","maxLength","mediaGroup","minLength","noValidate","radioGroup","readOnly","rowSpan","spellCheck","srcDoc","srcLang","srcSet","tabIndex","useMap"].reduce((e,t)=>(e[t.toLowerCase()]=t,e),{class:"className",for:"htmlFor"}),hn={amp:"&",apos:"'",gt:">",lt:"<",nbsp:"\xa0",quot:""},hi=["style","script","pre"],ho=["src","href","data","formAction","srcDoc","action"],hs=/([-A-Z0-9_:]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|(?:\{((?:\\.|{[^}]*?}|[^}])*)\})))?/gi,ha=/\n{2,}$/,hl=/^(\s*>[\s\S]*?)(?=\n\n|$)/,hc=/^ *> ?/gm,hu=/^(?:\[!([^\]]*)\]\n)?([\s\S]*)/,hh=/^ {2,}\n/,hd=/^(?:([-*_])( *\1){2,}) *(?:\n *)+\n/,hf=/^(?: {1,3})?(`{3,}|~{3,}) *(\S+)? *([^\n]*?)?\n([\s\S]*?)(?:\1\n?|$)/,hp=/^(?: {4}[^\n]+\n*)+(?:\n *)+\n?/,hm=/^(`+)((?:\\`|(?!\1)`|[^`])+)\1/,hg=/^(?:\n *)*\n/,hy=/\r\n?/g,hv=/^\[\^([^\]]+)](:(.*)((\n+ {4,}.*)|(\n(?!\[\^).+))*)/,hb=/^\[\^([^\]]+)]/,hx=/\f/g,hw=/^---[ \t]*\n(.|\n)*\n---[ \t]*\n/,hk=/^\s*?\[(x|\s)\]/,hA=/^ *(#{1,6}) *([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,hS=/^ *(#{1,6}) +([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,hj=/^([^\n]+)\n *(=|-)\2{2,} *\n/,hC=/^ *(?!<[a-z][^ >/]* ?\/>)<([a-z][^ >/]*) ?((?:[^>]*[^/])?)>\n?(\s*(?:<\1[^>]*?>[\s\S]*?<\/\1>|(?!<\1\b)[\s\S])*?)<\/\1>(?!<\/\1>)\n*/i,hE=/&([a-z0-9]+|#[0-9]{1,6}|#x[0-9a-fA-F]{1,6});/gi,hO=/^<!--[\s\S]*?(?:-->)/,hM=/^(data|aria|x)-[a-z_][a-z\d_.-]*$/,hP=/^ *<([a-z][a-z0-9:]*)(?:\s+((?:<.*?>|[^>])*))?\/?>(?!<\/\1>)(\s*\n)?/i,hT=/^\{.*\}$/,hI=/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,h$=/^<([^ >]+[:@\/][^ >]+)>/,hD=/-([a-z])?/gi,hR=/^(\|.*)\n(?: *(\|? *[-:]+ *\|[-| :]*)\n((?:.*\|.*\n)*))?\n?/,hN=/^[^\n]+(?:  \n|\n{2,})/,h_=/^\[([^\]]*)\]:\s+<?([^\s>]+)>?\s*("([^"]*)")?/,hL=/^!\[([^\]]*)\] ?\[([^\]]*)\]/,hF=/^\[([^\]]*)\] ?\[([^\]]*)\]/,hB=/(\n|^[-*]\s|^#|^ {2,}|^-{2,}|^>\s)/,hz=/\t/g,hW=/(^ *\||\| *$)/g,hV=/^ *:-+: *$/,hH=/^ *:-+ *$/,hU=/^ *-+: *$/,hq=e=>`(?=[\\s\\S]+?\\1${e?"\\1":""})`,hK="((?:\\[.*?\\][([].*?[)\\]]|<.*?>(?:.*?<.*?>)?|`.*?`|\\\\\\1|[\\s\\S])+?)",hG=RegExp(`^([*_])\\1${hq(1)}${hK}\\1\\1(?!\\1)`),hJ=RegExp(`^([*_])${hq(0)}${hK}\\1(?!\\1)`),hY=RegExp(`^(==)${hq(0)}${hK}\\1`),hX=RegExp(`^(~~)${hq(0)}${hK}\\1`),hZ=/^(:[a-zA-Z0-9-_]+:)/,hQ=/^\\([^0-9A-Za-z\s])/,h0=/\\([^0-9A-Za-z\s])/g,h1=/^[\s\S](?:(?!  \n|[0-9]\.|http)[^=*_~\-\n:<`\\\[!])*/,h2=/^\n+/,h4=/^([ \t]*)/,h3=/(?:^|\n)( *)$/,h5="(?:\\d+\\.)",h6="(?:[*+-])";function h9(e){return"( *)("+(1===e?h5:h6)+") +"}let h8=h9(1),h7=h9(2);function de(e){return RegExp("^"+(1===e?h8:h7))}let dt=de(1),dr=de(2);function dn(e){return RegExp("^"+(1===e?h8:h7)+"[^\\n]*(?:\\n(?!\\1"+(1===e?h5:h6)+" )[^\\n]*)*(\\n|$)","gm")}let di=dn(1),ds=dn(2);function da(e){let t=1===e?h5:h6;return RegExp("^( *)("+t+") [\\s\\S]+?(?:\\n{2,}(?! )(?!\\1"+t+" (?!"+t+" ))\\n*|\\s*\\n*$)")}let dl=da(1),dc=da(2);function du(e,t){let r=1===t,n=r?dl:dc,i=r?di:ds,o=r?dt:dr;return{t:e=>o.test(e),o:dw(function(e,t){let r=h3.exec(t.prevCapture);return r&&(t.list||!t.inline&&!t.simple)?n.exec(e=r[1]+e):null}),i:1,u(e,t,n){let s=r?+e[2]:void 0,a=e[0].replace(ha,"\n").match(i),l=!1;return{items:a.map(function(e,r){let i,s=RegExp("^ {1,"+o.exec(e)[0].length+"}","gm"),c=e.replace(s,"").replace(o,""),u=r===a.length-1,h=-1!==c.indexOf("\n\n")||u&&l;l=h;let d=n.inline,f=n.list;n.list=!0,h?(n.inline=!1,i=dp(c)+"\n\n"):(n.inline=!0,i=dp(c));let p=t(i,n);return n.inline=d,n.list=f,p}),ordered:r,start:s}},l:(t,r,n)=>e(t.ordered?"ol":"ul",{key:n.key,start:"20"===t.type?t.start:void 0},t.items.map(function(t,i){return e("li",{key:i},r(t,n))}))}}let dh=RegExp("^\\[((?:\\[[^\\[\\]]*(?:\\[[^\\[\\]]*\\][^\\[\\]]*)*\\]|[^\\[\\]])*)\\]\\(\\s*<?((?:\\([^)]*\\)|[^\\s\\\\]|\\\\.)*?)>?(?:\\s+['\"]([\\s\\S]*?)['\"])?\\s*\\)"),dd=/^!\[(.*?)\]\( *((?:\([^)]*\)|[^() ])*) *"?([^)"]*)?"?\)/;function df(e){return"string"==typeof e}function dp(e){let t=e.length;for(;t>0&&e[t-1]<=" ";)t--;return e.slice(0,t)}function dm(e,t){return e.startsWith(t)}function dg(e){return e.replace(/[]/g,"a").replace(/[]/g,"c").replace(/[]/g,"d").replace(/[]/g,"e").replace(/[]/g,"i").replace(/[]/g,"n").replace(/[]/g,"o").replace(/[]/g,"u").replace(/[]/g,"y").replace(/[^a-z0-9- ]/gi,"").replace(/ /gi,"-").toLowerCase()}function dy(e){return hU.test(e)?"right":hV.test(e)?"center":hH.test(e)?"left":null}function dv(e,t,r,n){let i=r.inTable;r.inTable=!0;let o=[[]],s="";function a(){if(!s)return;let e=o[o.length-1];e.push.apply(e,t(s,r)),s=""}return e.trim().split(/(`[^`]*`|\\\||\|)/).filter(Boolean).forEach((e,t,r)=>{"|"===e.trim()&&(a(),n)?0!==t&&t!==r.length-1&&o.push([]):s+=e}),a(),r.inTable=i,o}function db(e,t,r){var n;r.inline=!0;let i=e[2]?e[2].replace(hW,"").split("|").map(dy):[],o=e[3]?(n=e[3],n.trim().split("\n").map(function(e){return dv(e,t,r,!0)})):[],s=dv(e[1],t,r,!!o.length);return r.inline=!1,o.length?{align:i,cells:o,header:s,type:"25"}:{children:s,type:"21"}}function dx(e,t){return null==e.align[t]?{}:{textAlign:e.align[t]}}function dw(e){return e.inline=1,e}function dk(e){return dw(function(t,r){return r.inline?e.exec(t):null})}function dA(e){return dw(function(t,r){return r.inline||r.simple?e.exec(t):null})}function dS(e){return function(t,r){return r.inline||r.simple?null:e.exec(t)}}function dj(e){return dw(function(t){return e.exec(t)})}let dC=/(javascript|vbscript|data(?!:image)):/i;function dE(e){try{let t=decodeURIComponent(e).replace(/[^A-Za-z0-9/:]/g,"");if(dC.test(t))return null}catch(e){return null}return e}function dO(e){return e?e.replace(h0,"$1"):e}function dM(e,t,r){let n=r.inline||!1,i=r.simple||!1;r.inline=!0,r.simple=!0;let o=e(t,r);return r.inline=n,r.simple=i,o}function dP(e,t,r){let n=r.inline||!1;r.inline=!1;let i=e(t,r);return r.inline=n,i}let dT=(e,t,r)=>({children:dM(t,e[2],r)});function dI(){return{}}function d$(){return null}function dD(e,t,r){let n=e,i=t.split(".");for(;i.length&&void 0!==(n=n[i[0]]);)i.shift();return n||r}let dR=e=>{let{children:t,options:r}=e,n=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)t.indexOf(r=o[n])>=0||(i[r]=e[r]);return i}(e,ht);return tZ.cloneElement(function(e="",t={}){var r,n;t.overrides=t.overrides||{},t.namedCodesToUnicode=t.namedCodesToUnicode?he({},hn,t.namedCodesToUnicode):hn;let i=t.slugify||dg,o=t.sanitizer||dE,s=t.createElement||tZ.createElement,a=[hl,hf,hp,t.enforceAtxHeadings?hS:hA,hj,hR,dl,dc],l=[...a,hN,hC,hO,hP];function c(e,t){for(let r=0;r<e.length;r++)if(e[r].test(t))return!0;return!1}function u(e,r,...n){var i;let o,a=dD(t.overrides,e+".props",{});return s((o=dD(i=t.overrides,e))?"function"==typeof o||"object"==typeof o&&"render"in o?o:dD(i,e+".component",e):e,he({},r,a,{className:function(...e){return e.filter(Boolean).join(" ")}(null==r?void 0:r.className,a.className)||void 0}),...n)}function h(e){let r;e=e.replace(hw,"");let n=!1;t.forceInline?n=!0:t.forceBlock||(n=!1===hB.test(e));let i=y(g(n?e:dp(e).replace(h2,"")+"\n\n",{inline:n}));for(;df(i[i.length-1])&&!i[i.length-1].trim();)i.pop();if(null===t.wrapper)return i;let o=t.wrapper||(n?"span":"div");if(i.length>1||t.forceWrapper)r=i;else{if(1===i.length)return"string"==typeof(r=i[0])?u("span",{key:"outer"},r):r;r=null}return s(o,{key:"outer"},r)}function d(e,t){if(!t||!t.trim())return null;let r=t.match(hs);return r?r.reduce(function(t,r){let n=r.indexOf("=");if(-1!==n){var i,s,a;let l,c=(-1!==(i=r.slice(0,n)).indexOf("-")&&null===i.match(hM)&&(i=i.replace(hD,function(e,t){return t.toUpperCase()})),i).trim(),u=('"'===(l=(s=r.slice(n+1).trim())[0])||"'"===l)&&s.length>=2&&s[s.length-1]===l?s.slice(1,-1):s,d=hr[c]||c;if("ref"===d)return t;let f=t[d]=(a=u,"style"===c?(function(e){let t=[],r="",n=!1,i=!1,o="";if(!e)return t;for(let s=0;s<e.length;s++){let a=e[s];if('"'!==a&&"'"!==a||n||(i?a===o&&(i=!1,o=""):(i=!0,o=a)),"("===a&&r.endsWith("url")?n=!0:")"===a&&n&&(n=!1),";"!==a||i||n)r+=a;else{let e=r.trim();if(e){let r=e.indexOf(":");if(r>0){let n=e.slice(0,r).trim(),i=e.slice(r+1).trim();t.push([n,i])}}r=""}}let s=r.trim();if(s){let e=s.indexOf(":");if(e>0){let r=s.slice(0,e).trim(),n=s.slice(e+1).trim();t.push([r,n])}}return t})(a).reduce(function(t,[r,n]){return t[r.replace(/(-[a-z])/g,e=>e[1].toUpperCase())]=o(n,e,r),t},{}):-1!==ho.indexOf(c)?o(dO(a),e,c):(a.match(hT)&&(a=dO(a.slice(1,a.length-1))),"true"===a||"false"!==a&&a));"string"==typeof f&&(hC.test(f)||hP.test(f))&&(t[d]=h(f.trim()))}else"style"!==r&&(t[hr[r]||r]=!0);return t},{}):null}let f=[],p={},m={0:{t:[">"],o:dS(hl),i:1,u(e,t,r){let[,n,i]=e[0].replace(hc,"").match(hu);return{alert:n,children:t(i,r)}},l(e,t,r){let n={key:r.key};return e.alert&&(n.className="markdown-alert-"+i(e.alert.toLowerCase(),dg),e.children.unshift({attrs:{},children:[{type:"27",text:e.alert}],noInnerParse:!0,type:"11",tag:"header"})),u("blockquote",n,t(e.children,r))}},1:{t:["  "],o:dj(hh),i:1,u:dI,l:(e,t,r)=>u("br",{key:r.key})},2:{t:["--","__","**","- ","* ","_ "],o:dS(hd),i:1,u:dI,l:(e,t,r)=>u("hr",{key:r.key})},3:{t:["    "],o:dS(hp),i:0,u:e=>({lang:void 0,text:dO(dp(e[0].replace(/^ {4}/gm,"")))}),l:(e,t,r)=>u("pre",{key:r.key},u("code",he({},e.attrs,{className:e.lang?"lang-"+e.lang:""}),e.text))},4:{t:["```","~~~"],o:dS(hf),i:0,u:e=>({attrs:d("code",e[3]||""),lang:e[2]||void 0,text:e[4],type:"3"})},5:{t:["`"],o:dA(hm),i:3,u:e=>({text:dO(e[2])}),l:(e,t,r)=>u("code",{key:r.key},e.text)},6:{t:["[^"],o:dS(hv),i:0,u:e=>(f.push({footnote:e[2],identifier:e[1]}),{}),l:d$},7:{t:["[^"],o:dk(hb),i:1,u:e=>({target:"#"+i(e[1],dg),text:e[1]}),l:(e,t,r)=>u("a",{key:r.key,href:o(e.target,"a","href")},u("sup",{key:r.key},e.text))},8:{t:["[ ]","[x]"],o:dk(hk),i:1,u:e=>({completed:"x"===e[1].toLowerCase()}),l:(e,t,r)=>u("input",{checked:e.completed,key:r.key,readOnly:!0,type:"checkbox"})},9:{t:["#"],o:dS(t.enforceAtxHeadings?hS:hA),i:1,u:(e,t,r)=>({children:dM(t,e[2],r),id:i(e[2],dg),level:e[1].length}),l:(e,t,r)=>u("h"+e.level,{id:e.id,key:r.key},t(e.children,r))},10:{t:e=>{let t=e.indexOf("\n");return t>0&&t<e.length-1&&("="===e[t+1]||"-"===e[t+1])},o:dS(hj),i:1,u:(e,t,r)=>({children:dM(t,e[1],r),level:"="===e[2]?1:2,type:"9"})},11:{t:["<"],o:dj(hC),i:1,u(e,t,r){let[,n]=e[3].match(h4),i=RegExp("^"+n,"gm"),o=e[3].replace(i,""),s=c(l,o)?dP:dM,a=e[1].toLowerCase(),u=-1!==hi.indexOf(a),h=(u?a:e[1]).trim(),f={attrs:d(h,e[2]),noInnerParse:u,tag:h};if(r.inAnchor=r.inAnchor||"a"===a,u)f.text=e[3];else{let e=r.inHTML;r.inHTML=!0,f.children=s(t,o,r),r.inHTML=e}return r.inAnchor=!1,f},l:(e,t,r)=>u(e.tag,he({key:r.key},e.attrs),e.text||(e.children?t(e.children,r):""))},13:{t:["<"],o:dj(hP),i:1,u(e){let t=e[1].trim();return{attrs:d(t,e[2]||""),tag:t}},l:(e,t,r)=>u(e.tag,he({},e.attrs,{key:r.key}))},12:{t:["\x3c!--"],o:dj(hO),i:1,u:()=>({}),l:d$},14:{t:["!["],o:dA(dd),i:1,u:e=>({alt:dO(e[1]),target:dO(e[2]),title:dO(e[3])}),l:(e,t,r)=>u("img",{key:r.key,alt:e.alt||void 0,title:e.title||void 0,src:o(e.target,"img","src")})},15:{t:["["],o:dk(dh),i:3,u:(e,t,r)=>{var n;let i,o,s;return{children:(n=e[1],i=r.inline||!1,o=r.simple||!1,r.inline=!1,r.simple=!0,s=t(n,r),r.inline=i,r.simple=o,s),target:dO(e[2]),title:dO(e[3])}},l:(e,t,r)=>u("a",{key:r.key,href:o(e.target,"a","href"),title:e.title},t(e.children,r))},16:{t:["<"],o:dk(h$),i:0,u(e){let t=e[1],r=!1;return -1!==t.indexOf("@")&&-1===t.indexOf("//")&&(r=!0,t=t.replace("mailto:","")),{children:[{text:t,type:"27"}],target:r?"mailto:"+t:t,type:"15"}}},17:{t:(e,r)=>!r.inAnchor&&!t.disableAutoLink&&(dm(e,"http://")||dm(e,"https://")),o:dk(hI),i:0,u:e=>({children:[{text:e[1],type:"27"}],target:e[1],title:void 0,type:"15"})},20:du(u,1),33:du(u,2),19:{t:["\n"],o:dS(hg),i:3,u:dI,l:()=>"\n"},21:{o:dw(function(e,t){if(t.inline||t.simple||t.inHTML&&-1===e.indexOf("\n\n")&&-1===t.prevCapture.indexOf("\n\n"))return null;let r="",n=0;for(;;){let t=e.indexOf("\n",n),i=e.slice(n,-1===t?void 0:t+1);if(c(a,i)||(r+=i,-1===t||!i.trim()))break;n=t+1}let i=dp(r);return""===i?null:[r,,i]}),i:3,u:dT,l:(e,t,r)=>u("p",{key:r.key},t(e.children,r))},22:{t:["["],o:dk(h_),i:0,u:e=>(p[e[1]]={target:e[2],title:e[4]},{}),l:d$},23:{t:["!["],o:dA(hL),i:0,u:e=>({alt:e[1]?dO(e[1]):void 0,ref:e[2]}),l:(e,t,r)=>p[e.ref]?u("img",{key:r.key,alt:e.alt,src:o(p[e.ref].target,"img","src"),title:p[e.ref].title}):null},24:{t:e=>"["===e[0]&&-1===e.indexOf("]("),o:dk(hF),i:0,u:(e,t,r)=>({children:t(e[1],r),fallbackChildren:e[0],ref:e[2]}),l:(e,t,r)=>p[e.ref]?u("a",{key:r.key,href:o(p[e.ref].target,"a","href"),title:p[e.ref].title},t(e.children,r)):u("span",{key:r.key},e.fallbackChildren)},25:{t:["|"],o:dS(hR),i:1,u:db,l:(e,t,r)=>u("table",{key:r.key},u("thead",null,u("tr",null,e.header.map(function(n,i){return u("th",{key:i,style:dx(e,i)},t(n,r))}))),u("tbody",null,e.cells.map(function(n,i){return u("tr",{key:i},n.map(function(n,i){return u("td",{key:i,style:dx(e,i)},t(n,r))}))})))},27:{o:dw(function(e,t){let r;return dm(e,":")&&(r=hZ.exec(e)),r||h1.exec(e)}),i:4,u(e){let r=e[0];return{text:-1===r.indexOf("&")?r:r.replace(hE,(e,r)=>t.namedCodesToUnicode[r]||e)}},l:e=>e.text},28:{t:["**","__"],o:dA(hG),i:2,u:(e,t,r)=>({children:t(e[2],r)}),l:(e,t,r)=>u("strong",{key:r.key},t(e.children,r))},29:{t:e=>{let t=e[0];return("*"===t||"_"===t)&&e[1]!==t},o:dA(hJ),i:3,u:(e,t,r)=>({children:t(e[2],r)}),l:(e,t,r)=>u("em",{key:r.key},t(e.children,r))},30:{t:["\\"],o:dA(hQ),i:1,u:e=>({text:e[1],type:"27"})},31:{t:["=="],o:dA(hY),i:3,u:dT,l:(e,t,r)=>u("mark",{key:r.key},t(e.children,r))},32:{t:["~~"],o:dA(hX),i:3,u:dT,l:(e,t,r)=>u("del",{key:r.key},t(e.children,r))}};!0===t.disableParsingRawHTML&&(delete m[11],delete m[13]);let g=((r=Object.keys(m)).sort(function(e,t){return m[e].i-m[t].i||(e<t?-1:1)}),function(e,t){return function e(t,n){var i=[];if(n.prevCapture=n.prevCapture||"",t.trim())for(;t;)for(var o=0;o<r.length;){var s=r[o],a=m[s];if(!a.t||function(e,t,r){if(Array.isArray(r)){for(let t=0;t<r.length;t++)if(dm(e,r[t]))return!0;return!1}return r(e,t)}(t,n,a.t)){var l=a.o(t,n);if(l&&l[0]){t=t.substring(l[0].length);var c=a.u(l,e,n);n.prevCapture+=l[0],c.type||(c.type=s),i.push(c);break}o++}else o++}return n.prevCapture="",i}(e.replace(hy,"\n").replace(hx,"").replace(hz,"    "),t)}),y=(n=t.renderRule,function e(t,r={}){var i;let o;if(Array.isArray(t)){let n=r.key,i=[],o=!1;for(let n=0;n<t.length;n++){r.key=n;let s=e(t[n],r),a=df(s);a&&o?i[i.length-1]+=s:null!==s&&i.push(s),o=a}return r.key=n,i}return i=e,o=m[t.type].l,n?n(()=>o(t,i,r),t,i,r):o(t,i,r)}),v=h(e);return f.length?u("div",null,v,u("footer",{key:"footer"},f.map(function(e){return u("div",{id:i(e.identifier,dg),key:e.identifier},e.identifier,y(g(e.footnote,{inline:!0})))}))):v}(null==t?"":t,r),n)};class dN extends tZ.Component{state={wasPropertyKeyModified:!1,additionalProperties:{}};isRequired(e){let{schema:t}=this.props;return Array.isArray(t.required)&&-1!==t.required.indexOf(e)}onPropertyChange=(e,t=!1)=>(r,n,i)=>{let{formData:o,onChange:s,errorSchema:a}=this.props;void 0===r&&t&&(r=""),s({...o,[e]:r},a&&a&&{...a,[e]:n},i)};onDropPropertyClick=e=>t=>{t.preventDefault();let{onChange:r,formData:n}=this.props,i={...n};null==i||lu(i,e),r(i)};getAvailableKey=(e,t)=>{let{uiSchema:r,registry:n}=this.props,{duplicateKeySuffixSeparator:i="-"}=of(r,n.globalUiOptions),o=0,s=e;for(;lM(t,s);)s=`${e}${i}${++o}`;return s};onKeyChange=e=>(t,r)=>{if(e===t)return;let{formData:n,onChange:i,errorSchema:o}=this.props;t=this.getAvailableKey(t,n);let s={...n},a={[e]:t},l=Object.assign({},...Object.keys(s).map(e=>({[a[e]||e]:s[e]})));this.setState({wasPropertyKeyModified:!0}),i(l,o&&o&&{...o,[t]:r})};getDefaultValue(e){let{registry:{translateString:t}}=this.props;switch(e){case"array":return[];case"boolean":return!1;case"null":return null;case"number":return 0;case"object":return{};default:return t(mm.NewStringDefault)}}handleAddClick=e=>()=>{let t,r,n;if(!e.additionalProperties)return;let{formData:i,onChange:o,registry:s}=this.props,a={...i};if(oB(e.additionalProperties)){t=e.additionalProperties.type,r=e.additionalProperties.const,n=e.additionalProperties.default;let o=e.additionalProperties;if("$ref"in o){let{schemaUtils:e}=s;t=(o=e.retrieveSchema({$ref:o.$ref},i)).type,r=o.const,n=o.default}!t&&("anyOf"in o||"oneOf"in o)&&(t="object")}let l=this.getAvailableKey("newKey",a);ce(a,l,r??n??this.getDefaultValue(t)),o(a)};render(){let e,{schema:t,uiSchema:r={},formData:n,errorSchema:i,idSchema:o,name:s,required:a=!1,disabled:l,readonly:c,hideError:u,idPrefix:h,idSeparator:d,onBlur:f,onFocus:p,registry:m,title:g}=this.props,{fields:y,formContext:b,schemaUtils:x,translateString:w,globalUiOptions:k}=m,{SchemaField:A}=y,S=x.retrieveSchema(t,n),j=of(r,k),{properties:C={}}=S,E=j.title??S.title??g??s,O=j.description??S.description;try{let t=Object.keys(C);e=function(e,t){if(!Array.isArray(t))return e;let r=e=>e.reduce((e,t)=>(e[t]=!0,e),{}),n=r(e),i=t.filter(e=>"*"===e||n[e]),o=r(i),s=e.filter(e=>!o[e]),a=i.indexOf("*");if(-1===a){if(s.length)throw Error(`uiSchema order list does not contain ${s.length>1?`properties '${s.join("', '")}'`:`property '${s[0]}'`}`);return i}if(a!==i.lastIndexOf("*"))throw Error("uiSchema order list contains more than one wildcard item");let l=[...i];return l.splice(a,1,...s),l}(t,j.order)}catch(e){return(0,v.jsxs)("div",{children:[(0,v.jsx)("p",{className:"config-error",style:{color:"red"},children:(0,v.jsx)(dR,{options:{disableParsingRawHTML:!0},children:w(mm.InvalidObjectField,[s||"root",e.message])})}),(0,v.jsx)("pre",{children:JSON.stringify(S)})]})}let M=c7("ObjectFieldTemplate",m,j),P={title:!1===j.label?"":E,description:!1===j.label?void 0:O,properties:e.map(e=>{let t=lM(S,[oa,e,on]),s=t?r.additionalProperties:r[e],g="hidden"===of(s).widget,y=aE(o,[e],{});return{content:(0,v.jsx)(A,{name:e,required:this.isRequired(e),schema:aE(S,[oa,e],{}),uiSchema:s,errorSchema:aE(i,e),idSchema:y,idPrefix:h,idSeparator:d,formData:aE(n,e),formContext:b,wasPropertyKeyModified:this.state.wasPropertyKeyModified,onKeyChange:this.onKeyChange(e),onChange:this.onPropertyChange(e,t),onBlur:f,onFocus:p,registry:m,disabled:l,readonly:c,hideError:u,onDropPropertyClick:this.onDropPropertyClick},e),name:e,readonly:c,disabled:l,required:a,hidden:g}}),readonly:c,disabled:l,required:a,idSchema:o,uiSchema:r,errorSchema:i,schema:S,formData:n,formContext:b,registry:m};return(0,v.jsx)(M,{...P,onAddClick:this.handleAddClick})}}let d_={array:"ArrayField",boolean:"BooleanField",integer:"NumberField",number:"NumberField",object:"ObjectField",string:"StringField",null:"NullField"};function dL(e){let t,{schema:r,idSchema:n,uiSchema:i,formData:o,errorSchema:s,idPrefix:a,idSeparator:l,name:c,onChange:u,onKeyChange:h,onDropPropertyClick:d,required:f,registry:p,wasPropertyKeyModified:m=!1}=e,{formContext:g,schemaUtils:y,globalUiOptions:b}=p,x=of(i,b),w=c7("FieldTemplate",p,x),k=c7("DescriptionFieldTemplate",p,x),A=c7("FieldHelpTemplate",p,x),S=c7("FieldErrorTemplate",p,x),j=y.retrieveSchema(r,o),C=n.$id,E=cN(y.toIdSchema(j,C,o,a,l),n),O=(0,tZ.useCallback)((e,t,r)=>u(e,t,r||C),[C,u]),M=function(e,t,r,n){let i=t.field,{fields:o,translateString:s}=n;if("function"==typeof i)return i;if("string"==typeof i&&i in o)return o[i];let a=cA(e),l=Array.isArray(a)?a[0]:a||"",c=e.$id,u=d_[l];return(c&&c in o&&(u=c),!u&&(e.anyOf||e.oneOf))?()=>null:u in o?o[u]:()=>{let i=c7("UnsupportedFieldTemplate",n,t);return(0,v.jsx)(i,{schema:e,idSchema:r,reason:s(mm.UnknownFieldType,[String(e.type)]),registry:n})}}(j,x,E,p),P=!!(x.disabled??e.disabled),T=!!(x.readonly??(e.readonly||e.schema.readOnly||j.readOnly)),I=x.hideError,$=void 0===I?e.hideError:!!I,D=!!(x.autofocus??e.autofocus);if(0===Object.keys(j).length)return null;let R=y.getDisplayLabel(j,i,b),{__errors:N,..._}=s||{},L=lA(i,["ui:classNames","classNames","ui:style"]);od in L&&(L[od]=lA(L[od],["classNames","style"]));let F=(0,v.jsx)(M,{...e,onChange:O,idSchema:E,schema:j,uiSchema:L,disabled:P,readonly:T,hideError:$,autofocus:D,errorSchema:_,formContext:g,rawErrors:N}),B=E.$id;t=m||on in j?c:x.title||e.schema.title||j.title||e.title||c;let z=x.description||e.schema.description||j.description||"",W=x.enableMarkdownInDescription?(0,v.jsx)(dR,{options:{disableParsingRawHTML:!0},children:z}):z,V=x.help,H="hidden"===x.widget,U=["form-group","field",`field-${cA(j)}`];!$&&N&&N.length>0&&U.push("field-error has-error has-danger"),i?.classNames&&U.push(i.classNames),x.classNames&&U.push(x.classNames);let q=(0,v.jsx)(A,{help:V,idSchema:E,schema:j,uiSchema:i,hasErrors:!$&&N&&N.length>0,registry:p}),K=$||(j.anyOf||j.oneOf)&&!y.isSelect(j)?void 0:(0,v.jsx)(S,{errors:N,errorSchema:s,idSchema:E,schema:j,uiSchema:i,registry:p}),G={description:(0,v.jsx)(k,{id:ui(B),description:W,schema:j,uiSchema:i,registry:p}),rawDescription:z,help:q,rawHelp:"string"==typeof V?V:void 0,errors:K,rawErrors:$?void 0:N,id:B,label:t,hidden:H,onChange:u,onKeyChange:h,onDropPropertyClick:d,required:f,disabled:P,readonly:T,hideError:$,displayLabel:R,classNames:U.join(" ").trim(),style:x.style,formContext:g,formData:o,schema:j,uiSchema:i,registry:p},J=p.fields.AnyOfField,Y=p.fields.OneOfField,X=i?.["ui:field"]&&i?.["ui:fieldReplacesAnyOrOneOf"]===!0;return(0,v.jsx)(w,{...G,children:(0,v.jsxs)(v.Fragment,{children:[F,j.anyOf&&!X&&!y.isSelect(j)&&(0,v.jsx)(J,{name:c,disabled:P,readonly:T,hideError:$,errorSchema:s,formData:o,formContext:g,idPrefix:a,idSchema:E,idSeparator:l,onBlur:e.onBlur,onChange:e.onChange,onFocus:e.onFocus,options:j.anyOf.map(e=>y.retrieveSchema(oB(e)?e:{},o)),registry:p,required:f,schema:j,uiSchema:i}),j.oneOf&&!X&&!y.isSelect(j)&&(0,v.jsx)(Y,{name:c,disabled:P,readonly:T,hideError:$,errorSchema:s,formData:o,formContext:g,idPrefix:a,idSchema:E,idSeparator:l,onBlur:e.onBlur,onChange:e.onChange,onFocus:e.onFocus,options:j.oneOf.map(e=>y.retrieveSchema(oB(e)?e:{},o)),registry:p,required:f,schema:j,uiSchema:i})]})})}class dF extends tZ.Component{shouldComponentUpdate(e){return!al(this.props,e)}render(){return(0,v.jsx)(dL,{...this.props})}}let dB=function(e){let{schema:t,name:r,uiSchema:n,idSchema:i,formData:o,required:s,disabled:a=!1,readonly:l=!1,autofocus:c=!1,onChange:u,onBlur:h,onFocus:d,registry:f,rawErrors:p,hideError:m}=e,{title:g,format:y}=t,{widgets:b,formContext:x,schemaUtils:w,globalUiOptions:k}=f,A=w.isSelect(t)?cz(t,n):void 0,S=A?"select":"text";y&&function(e,t,r={}){try{return ur(e,t,r),!0}catch(e){if(e.message&&(e.message.startsWith("No widget")||e.message.startsWith("Unsupported widget")))return!1;throw e}}(t,y,b)&&(S=y);let{widget:j=S,placeholder:C="",title:E,...O}=of(n),M=w.getDisplayLabel(t,n,k),P=E??g??r,T=ur(t,j,b);return(0,v.jsx)(T,{options:{...O,enumOptions:A},schema:t,uiSchema:n,id:i.$id,name:r,label:P,hideLabel:!M,hideError:m,value:o,onChange:u,onBlur:h,onFocus:d,required:s,disabled:a,readonly:l,formContext:x,autofocus:c,registry:f,placeholder:C,rawErrors:p})},dz=function(e){let{formData:t,onChange:r}=e;return(0,tZ.useEffect)(()=>{void 0===t&&r(null)},[t,r]),null};function dW(e){let{idSchema:t,description:r,registry:n,schema:i,uiSchema:o}=e,s=of(o,n.globalUiOptions),{label:a=!0}=s;if(!r||!a)return null;let l=c7("DescriptionFieldTemplate",n,s);return(0,v.jsx)(l,{id:ui(t),description:r,schema:i,uiSchema:o,registry:n})}function dV(e){let{children:t,className:r,disabled:n,hasToolbar:i,hasMoveDown:o,hasMoveUp:s,hasRemove:a,hasCopy:l,index:c,onCopyIndexClick:u,onDropIndexClick:h,onReorderClick:d,readonly:f,registry:p,uiSchema:m}=e,{CopyButton:g,MoveDownButton:y,MoveUpButton:b,RemoveButton:x}=p.templates.ButtonTemplates,w={flex:1,paddingLeft:6,paddingRight:6,fontWeight:"bold"};return(0,v.jsxs)("div",{className:r,children:[(0,v.jsx)("div",{className:i?"col-xs-9":"col-xs-12",children:t}),i&&(0,v.jsx)("div",{className:"col-xs-3 array-item-toolbox",children:(0,v.jsxs)("div",{className:"btn-group",style:{display:"flex",justifyContent:"space-around"},children:[(s||o)&&(0,v.jsx)(b,{style:w,disabled:n||f||!s,onClick:d(c,c-1),uiSchema:m,registry:p}),(s||o)&&(0,v.jsx)(y,{style:w,disabled:n||f||!o,onClick:d(c,c+1),uiSchema:m,registry:p}),l&&(0,v.jsx)(g,{style:w,disabled:n||f,onClick:u(c),uiSchema:m,registry:p}),a&&(0,v.jsx)(x,{style:w,disabled:n||f,onClick:h(c),uiSchema:m,registry:p})]})})]})}function dH(e){let{canAdd:t,className:r,disabled:n,idSchema:i,uiSchema:o,items:s,onAddClick:a,readonly:l,registry:c,required:u,schema:h,title:d}=e,f=of(o),p=c7("ArrayFieldDescriptionTemplate",c,f),m=c7("ArrayFieldItemTemplate",c,f),g=c7("ArrayFieldTitleTemplate",c,f),{ButtonTemplates:{AddButton:y}}=c.templates;return(0,v.jsxs)("fieldset",{className:r,id:i.$id,children:[(0,v.jsx)(g,{idSchema:i,title:f.title||d,required:u,schema:h,uiSchema:o,registry:c}),(0,v.jsx)(p,{idSchema:i,description:f.description||h.description,schema:h,uiSchema:o,registry:c}),(0,v.jsx)("div",{className:"row array-item-list",children:s&&s.map(({key:e,...t})=>(0,v.jsx)(m,{...t},e))}),t&&(0,v.jsx)(y,{className:"array-item-add",onClick:a,disabled:n||l,uiSchema:o,registry:c})]})}function dU(e){let{idSchema:t,title:r,schema:n,uiSchema:i,required:o,registry:s}=e,a=of(i,s.globalUiOptions),{label:l=!0}=a;if(!r||!l)return null;let c=c7("TitleFieldTemplate",s,a);return(0,v.jsx)(c,{id:ul(t),title:r,required:o,schema:n,uiSchema:i,registry:s})}function dq(e){let t,{id:r,name:n,value:i,readonly:o,disabled:s,autofocus:a,onBlur:l,onFocus:c,onChange:u,onChangeOverride:h,options:d,schema:f,uiSchema:p,formContext:m,registry:g,rawErrors:y,type:b,hideLabel:x,hideError:w,...k}=e;if(!r)throw console.log("No id for",e),Error(`no id for props ${JSON.stringify(e)}`);let A={...k,...c6(f,b,d)};t="number"===A.type||"integer"===A.type?i||0===i?i:"":null==i?"":i;let S=(0,tZ.useCallback)(({target:{value:e}})=>u(""===e?d.emptyValue:e),[u,d]),j=(0,tZ.useCallback)(({target:e})=>l(r,e&&e.value),[l,r]),C=(0,tZ.useCallback)(({target:e})=>c(r,e&&e.value),[c,r]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("input",{id:r,name:r,className:"form-control",readOnly:o,disabled:s,autoFocus:a,value:t,...A,list:f.examples?us(r):void 0,onChange:h||S,onBlur:j,onFocus:C,"aria-describedby":uc(r,!!f.examples)}),Array.isArray(f.examples)&&(0,v.jsx)("datalist",{id:us(r),children:f.examples.concat(f.default&&!f.examples.includes(f.default)?[f.default]:[]).map(e=>(0,v.jsx)("option",{value:e},e))},`datalist_${r}`)]})}function dK({uiSchema:e}){let{submitText:t,norender:r,props:n={}}=c8(e);return r?null:(0,v.jsx)("div",{children:(0,v.jsx)("button",{type:"submit",...n,className:`btn btn-info ${n.className||""}`,children:t})})}function dG(e){let{iconType:t="default",icon:r,className:n,uiSchema:i,registry:o,...s}=e;return(0,v.jsx)("button",{type:"button",className:`btn btn-${t} ${n}`,...s,children:(0,v.jsx)("i",{className:`glyphicon glyphicon-${r}`})})}function dJ(e){let{registry:{translateString:t}}=e;return(0,v.jsx)(dG,{title:t(mm.CopyButton),className:"array-item-copy",...e,icon:"copy"})}function dY(e){let{registry:{translateString:t}}=e;return(0,v.jsx)(dG,{title:t(mm.MoveDownButton),className:"array-item-move-down",...e,icon:"arrow-down"})}function dX(e){let{registry:{translateString:t}}=e;return(0,v.jsx)(dG,{title:t(mm.MoveUpButton),className:"array-item-move-up",...e,icon:"arrow-up"})}function dZ(e){let{registry:{translateString:t}}=e;return(0,v.jsx)(dG,{title:t(mm.RemoveButton),className:"array-item-remove",...e,iconType:"danger",icon:"remove"})}function dQ({className:e,onClick:t,disabled:r,registry:n}){let{translateString:i}=n;return(0,v.jsx)("div",{className:"row",children:(0,v.jsx)("p",{className:`col-xs-3 col-xs-offset-9 text-right ${e}`,children:(0,v.jsx)(dG,{iconType:"info",icon:"plus",className:"btn-add col-xs-12",title:i(mm.AddButton),onClick:t,disabled:r,registry:n})})})}function d0(e){let{id:t,description:r}=e;return r?"string"==typeof r?(0,v.jsx)("p",{id:t,className:"field-description",children:r}):(0,v.jsx)("div",{id:t,className:"field-description",children:r}):null}function d1({errors:e,registry:t}){let{translateString:r}=t;return(0,v.jsxs)("div",{className:"panel panel-danger errors",children:[(0,v.jsx)("div",{className:"panel-heading",children:(0,v.jsx)("h3",{className:"panel-title",children:r(mm.ErrorsLabel)})}),(0,v.jsx)("ul",{className:"list-group",children:e.map((e,t)=>(0,v.jsx)("li",{className:"list-group-item text-danger",children:e.stack},t))})]})}function d2(e){let{label:t,required:r,id:n}=e;return t?(0,v.jsxs)("label",{className:"control-label",htmlFor:n,children:[t,r&&(0,v.jsx)("span",{className:"required",children:"*"})]}):null}let d4=function(e){let{id:t,label:r,children:n,errors:i,help:o,description:s,hidden:a,required:l,displayLabel:c,registry:u,uiSchema:h}=e,d=c7("WrapIfAdditionalTemplate",u,of(h));return a?(0,v.jsx)("div",{className:"hidden",children:n}):(0,v.jsxs)(d,{...e,children:[c&&(0,v.jsx)(d2,{label:r,required:l,id:t}),c&&s?s:null,n,i,o]})};function d3(e){let{errors:t=[],idSchema:r}=e;if(0===t.length)return null;let n=uo(r);return(0,v.jsx)("div",{children:(0,v.jsx)("ul",{id:n,className:"error-detail bs-callout bs-callout-info",children:t.filter(e=>!!e).map((e,t)=>(0,v.jsx)("li",{className:"text-danger",children:e},t))})})}function d5(e){let{idSchema:t,help:r}=e;if(!r)return null;let n=ua(t);return"string"==typeof r?(0,v.jsx)("p",{id:n,className:"help-block",children:r}):(0,v.jsx)("div",{id:n,className:"help-block",children:r})}function d6(e){let{description:t,disabled:r,formData:n,idSchema:i,onAddClick:o,properties:s,readonly:a,registry:l,required:c,schema:u,title:h,uiSchema:d}=e,f=of(d),p=c7("TitleFieldTemplate",l,f),m=c7("DescriptionFieldTemplate",l,f),{ButtonTemplates:{AddButton:g}}=l.templates;return(0,v.jsxs)("fieldset",{id:i.$id,children:[h&&(0,v.jsx)(p,{id:ul(i),title:h,required:c,schema:u,uiSchema:d,registry:l}),t&&(0,v.jsx)(m,{id:ui(i),description:t,schema:u,uiSchema:d,registry:l}),s.map(e=>e.content),op(u,d,n)&&(0,v.jsx)(g,{className:"object-property-expand",onClick:o(u),disabled:r||a,uiSchema:d,registry:l})]})}function d9(e){let{id:t,title:r,required:n}=e;return(0,v.jsxs)("legend",{id:t,children:[r,n&&(0,v.jsx)("span",{className:"required",children:"*"})]})}let d8=function(e){let{schema:t,idSchema:r,reason:n,registry:i}=e,{translateString:o}=i,s=mm.UnsupportedField,a=[];return r&&r.$id&&(s=mm.UnsupportedFieldWithId,a.push(r.$id)),n&&(s=s===mm.UnsupportedField?mm.UnsupportedFieldWithReason:mm.UnsupportedFieldWithIdAndReason,a.push(n)),(0,v.jsxs)("div",{className:"unsupported-field",children:[(0,v.jsx)("p",{children:(0,v.jsx)(dR,{options:{disableParsingRawHTML:!0},children:o(s,a)})}),t&&(0,v.jsx)("pre",{children:JSON.stringify(t,null,2)})]})};function d7(e){let{id:t,classNames:r,style:n,disabled:i,label:o,onKeyChange:s,onDropPropertyClick:a,readonly:l,required:c,schema:u,children:h,uiSchema:d,registry:f}=e,{templates:p,translateString:m}=f,{RemoveButton:g}=p.ButtonTemplates,y=m(mm.KeyLabel,[o]);return on in u?(0,v.jsx)("div",{className:r,style:n,children:(0,v.jsxs)("div",{className:"row",children:[(0,v.jsx)("div",{className:"col-xs-5 form-additional",children:(0,v.jsxs)("div",{className:"form-group",children:[(0,v.jsx)(d2,{label:y,required:c,id:`${t}-key`}),(0,v.jsx)("input",{className:"form-control",type:"text",id:`${t}-key`,onBlur:({target:e})=>s(e&&e.value),defaultValue:o})]})}),(0,v.jsx)("div",{className:"form-additional form-group col-xs-5",children:h}),(0,v.jsx)("div",{className:"col-xs-2",children:(0,v.jsx)(g,{className:"array-item-remove btn-block",style:{border:"0"},disabled:i||l,onClick:a(o),uiSchema:d,registry:f})})]})}):(0,v.jsx)("div",{className:r,style:n,children:h})}function fe({type:e,range:t,value:r,select:n,rootId:i,name:o,disabled:s,readonly:a,autofocus:l,registry:c,onBlur:u,onFocus:h}){let d=i+"_"+e,{SelectWidget:f}=c.widgets;return(0,v.jsx)(f,{schema:{type:"integer"},id:d,name:o,className:"form-control",options:{enumOptions:function e(t,r){if(t<=0&&r<=0)t=new Date().getFullYear()+t,r=new Date().getFullYear()+r;else if(t<0||r<0)throw Error(`Both start (${t}) and stop (${r}) must both be <= 0 or > 0, got one of each`);if(t>r)return e(r,t).reverse();let n=[];for(let e=t;e<=r;e++)n.push({value:e,label:cZ(e,2)});return n}(t[0],t[1])},placeholder:e,value:r,disabled:s,readonly:a,autofocus:l,onChange:t=>n(e,t),onBlur:u,onFocus:h,registry:c,label:"","aria-describedby":uc(i)})}let ft=function({time:e=!1,disabled:t=!1,readonly:r=!1,autofocus:n=!1,options:i,id:o,name:s,registry:a,onBlur:l,onFocus:c,onChange:u,value:h}){let{translateString:d}=a,[f,p]=(0,tZ.useState)(h),[m,g]=(0,tZ.useReducer)((e,t)=>({...e,...t}),uh(h,e));(0,tZ.useEffect)(()=>{let t=uf(m,e);Object.values(m).every(e=>-1!==e)&&t!==h?u(t):f!==h&&(p(h),g(uh(h,e)))},[e,h,u,m,f]);let y=(0,tZ.useCallback)((e,t)=>{g({[e]:t})},[]),b=(0,tZ.useCallback)(n=>{n.preventDefault(),t||r||u(uf(uh(new Date().toJSON(),e),e))},[t,r,e]),x=(0,tZ.useCallback)(e=>{e.preventDefault(),t||r||u(void 0)},[t,r,u]);return(0,v.jsxs)("ul",{className:"list-inline",children:[(function(e,t,r=[1900,new Date().getFullYear()+2],n="YMD"){let{day:i,month:o,year:s,hour:a,minute:l,second:c}=e,u={type:"day",range:[1,31],value:i},h={type:"month",range:[1,12],value:o},d={type:"year",range:r,value:s},f=[];switch(n){case"MDY":f.push(h,u,d);break;case"DMY":f.push(u,h,d);break;default:f.push(d,h,u)}return t&&f.push({type:"hour",range:[0,23],value:a},{type:"minute",range:[0,59],value:l},{type:"second",range:[0,59],value:c}),f})(m,e,i.yearsRange,i.format).map((e,i)=>(0,v.jsx)("li",{className:"list-inline-item",children:(0,v.jsx)(fe,{rootId:o,name:s,select:y,...e,disabled:t,readonly:r,registry:a,onBlur:l,onFocus:c,autofocus:n&&0===i})},i)),("undefined"===i.hideNowButton||!i.hideNowButton)&&(0,v.jsx)("li",{className:"list-inline-item",children:(0,v.jsx)("a",{href:"#",className:"btn btn-info btn-now",onClick:b,children:d(mm.NowLabel)})}),("undefined"===i.hideClearButton||!i.hideClearButton)&&(0,v.jsx)("li",{className:"list-inline-item",children:(0,v.jsx)("a",{href:"#",className:"btn btn-warning btn-clear",onClick:x,children:d(mm.ClearLabel)})})]})},fr=function({time:e=!0,...t}){let{AltDateWidget:r}=t.registry.widgets;return(0,v.jsx)(r,{time:e,...t})},fn=function({schema:e,uiSchema:t,options:r,id:n,value:i,disabled:o,readonly:s,label:a,hideLabel:l,autofocus:c=!1,onBlur:u,onFocus:h,onChange:d,registry:f}){var p;let m=c7("DescriptionFieldTemplate",f,r),g=ud(e),y=(0,tZ.useCallback)(e=>d(e.target.checked),[d]),b=(0,tZ.useCallback)(e=>u(n,e.target.checked),[u,n]),x=(0,tZ.useCallback)(e=>h(n,e.target.checked),[h,n]),w=r.description??e.description;return(0,v.jsxs)("div",{className:`checkbox ${o||s?"disabled":""}`,children:[!l&&!!w&&(0,v.jsx)(m,{id:ui(n),description:w,schema:e,uiSchema:t,registry:f}),(0,v.jsxs)("label",{children:[(0,v.jsx)("input",{type:"checkbox",id:n,name:n,checked:void 0!==i&&i,required:g,disabled:o||s,autoFocus:c,onChange:y,onBlur:b,onFocus:x,"aria-describedby":uc(n)}),(p=(0,v.jsx)("span",{children:a}),l?void 0:p)]})]})},fi=function({id:e,disabled:t,options:{inline:r=!1,enumOptions:n,enumDisabled:i,emptyValue:o},value:s,autofocus:a=!1,readonly:l,onChange:c,onBlur:u,onFocus:h}){let d=Array.isArray(s)?s:[s],f=(0,tZ.useCallback)(({target:t})=>u(e,c0(t&&t.value,n,o)),[u,e]),p=(0,tZ.useCallback)(({target:t})=>h(e,c0(t&&t.value,n,o)),[h,e]);return(0,v.jsx)("div",{className:"checkboxes",id:e,children:Array.isArray(n)&&n.map((o,s)=>{let u=c2(o.value,d),h=Array.isArray(i)&&-1!==i.indexOf(o.value),m=t||h||l?"disabled":"",g=(0,v.jsxs)("span",{children:[(0,v.jsx)("input",{type:"checkbox",id:uu(e,s),name:e,checked:u,value:String(s),disabled:t||h||l,autoFocus:a&&0===s,onChange:e=>{e.target.checked?c(c3(s,d,n)):c(c1(s,d,n))},onBlur:f,onFocus:p,"aria-describedby":uc(e)}),(0,v.jsx)("span",{children:o.label})]});return r?(0,v.jsx)("label",{className:`checkbox-inline ${m}`,children:g},s):(0,v.jsx)("div",{className:`checkbox ${m}`,children:(0,v.jsx)("label",{children:g})},s)})})};function fo(e){let{disabled:t,readonly:r,options:n,registry:i}=e,o=c7("BaseInputTemplate",i,n);return(0,v.jsx)(o,{type:"color",...e,disabled:t||r})}function fs(e){let{onChange:t,options:r,registry:n}=e,i=c7("BaseInputTemplate",n,r),o=(0,tZ.useCallback)(e=>t(e||void 0),[t]);return(0,v.jsx)(i,{type:"date",...e,onChange:o})}function fa(e){let{onChange:t,value:r,options:n,registry:i}=e,o=c7("BaseInputTemplate",i,n);return(0,v.jsx)(o,{type:"datetime-local",...e,value:function(e){if(!e)return"";let t=new Date(e),r=cZ(t.getFullYear(),4),n=cZ(t.getMonth()+1,2),i=cZ(t.getDate(),2),o=cZ(t.getHours(),2),s=cZ(t.getMinutes(),2),a=cZ(t.getSeconds(),2),l=cZ(t.getMilliseconds(),3);return`${r}-${n}-${i}T${o}:${s}:${a}.${l}`}(r),onChange:e=>t(e?new Date(e).toJSON():void 0)})}function fl(e){let{options:t,registry:r}=e,n=c7("BaseInputTemplate",r,t);return(0,v.jsx)(n,{type:"email",...e})}function fc(e){let{name:t,size:r,type:n}=e;return new Promise((i,o)=>{let s=new window.FileReader;s.onerror=o,s.onload=e=>{if("string"==typeof e.target?.result){var o;i({dataURL:(o=e.target.result,null===o?null:o.replace(";base64",`;name=${encodeURIComponent(t)};base64`)),name:t,size:r,type:n})}else i({dataURL:null,name:t,size:r,type:n})},s.readAsDataURL(e)})}function fu({fileInfo:e,registry:t}){let{translateString:r}=t,{dataURL:n,type:i,name:o}=e;return n?["image/jpeg","image/png"].includes(i)?(0,v.jsx)("img",{src:n,style:{maxWidth:"100%"},className:"file-preview"}):(0,v.jsxs)(v.Fragment,{children:[" ",(0,v.jsx)("a",{download:`preview-${o}`,href:n,className:"file-download",children:r(mm.PreviewLabel)})]}):null}function fh({filesInfo:e,registry:t,preview:r,onRemove:n,options:i}){if(0===e.length)return null;let{translateString:o}=t,{RemoveButton:s}=c7("ButtonTemplates",t,i);return(0,v.jsx)("ul",{className:"file-info",children:e.map((e,i)=>{let{name:a,size:l,type:c}=e;return(0,v.jsxs)("li",{children:[(0,v.jsx)(dR,{children:o(mm.FilesInfo,[a,c,String(l)])}),r&&(0,v.jsx)(fu,{fileInfo:e,registry:t}),(0,v.jsx)(s,{onClick:()=>n(i),registry:t})]},i)})})}let fd=function(e){let{disabled:t,readonly:r,required:n,multiple:i,onChange:o,value:s,options:a,registry:l}=e,c=c7("BaseInputTemplate",l,a),u=(0,tZ.useCallback)(e=>{e.target.files&&Promise.all(Array.from(e.target.files).map(fc)).then(e=>{let t=e.map(e=>e.dataURL);i?o(s.concat(t)):o(t[0])})},[i,s,o]),h=(0,tZ.useMemo)(()=>(Array.isArray(s)?s:[s]).reduce((e,t)=>{if(!t)return e;try{let{blob:r,name:n}=function(e){var t;if(-1===e.indexOf("data:"))throw Error("File is invalid: URI must be a dataURI");let r=e.slice(5).split(";base64,");if(2!==r.length)throw Error("File is invalid: dataURI must be base64");let[n,i]=r,[o,...s]=n.split(";"),a=decodeURI((null==(t=s.map(e=>e.split("=")).find(([e])=>"name"===e))?void 0:t[1])||"unknown");try{let e=atob(i),t=Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return{blob:new window.Blob([new Uint8Array(t)],{type:o||""}),name:a}}catch(e){throw Error("File is invalid: "+e.message)}}(t);return[...e,{dataURL:t,name:n,size:r.size,type:r.type}]}catch(t){return e}},[]),[s]),d=(0,tZ.useCallback)(e=>{i?o(s.filter((t,r)=>r!==e)):o(void 0)},[i,s,o]);return(0,v.jsxs)("div",{children:[(0,v.jsx)(c,{...e,disabled:t||r,type:"file",required:!s&&n,onChangeOverride:u,value:"",accept:a.accept?String(a.accept):void 0}),(0,v.jsx)(fh,{filesInfo:h,onRemove:d,registry:l,preview:a.filePreview,options:a})]})},ff=function({id:e,value:t}){return(0,v.jsx)("input",{type:"hidden",id:e,name:e,value:void 0===t?"":t})};function fp(e){let{options:t,registry:r}=e,n=c7("BaseInputTemplate",r,t);return(0,v.jsx)(n,{type:"password",...e})}let fm=function({options:e,value:t,required:r,disabled:n,readonly:i,autofocus:o=!1,onBlur:s,onFocus:a,onChange:l,id:c}){let{enumOptions:u,enumDisabled:h,inline:d,emptyValue:f}=e,p=(0,tZ.useCallback)(({target:e})=>s(c,c0(e&&e.value,u,f)),[s,c]),m=(0,tZ.useCallback)(({target:e})=>a(c,c0(e&&e.value,u,f)),[a,c]);return(0,v.jsx)("div",{className:"field-radio-group",id:c,children:Array.isArray(u)&&u.map((e,s)=>{let a=c2(e.value,t),u=Array.isArray(h)&&-1!==h.indexOf(e.value),f=n||u||i?"disabled":"",g=(0,v.jsxs)("span",{children:[(0,v.jsx)("input",{type:"radio",id:uu(c,s),checked:a,name:c,required:r,value:String(s),disabled:n||u||i,autoFocus:o&&0===s,onChange:()=>l(e.value),onBlur:p,onFocus:m,"aria-describedby":uc(c)}),(0,v.jsx)("span",{children:e.label})]});return d?(0,v.jsx)("label",{className:`radio-inline ${f}`,children:g},s):(0,v.jsx)("div",{className:`radio ${f}`,children:(0,v.jsx)("label",{children:g})},s)})})};function fg(e){let{value:t,registry:{templates:{BaseInputTemplate:r}}}=e;return(0,v.jsxs)("div",{className:"field-range-wrapper",children:[(0,v.jsx)(r,{type:"range",...e}),(0,v.jsx)("span",{className:"range-view",children:t})]})}function fy(e,t){return t?Array.from(e.target.options).slice().filter(e=>e.selected).map(e=>e.value):e.target.value}let fv=function({schema:e,id:t,options:r,value:n,required:i,disabled:o,readonly:s,multiple:a=!1,autofocus:l=!1,onChange:c,onBlur:u,onFocus:h,placeholder:d}){let{enumOptions:f,enumDisabled:p,emptyValue:m}=r,g=a?[]:"",y=(0,tZ.useCallback)(e=>h(t,c0(fy(e,a),f,m)),[h,t,e,a,f,m]),b=(0,tZ.useCallback)(e=>u(t,c0(fy(e,a),f,m)),[u,t,e,a,f,m]),x=(0,tZ.useCallback)(e=>c(c0(fy(e,a),f,m)),[c,e,a,f,m]),w=c4(n,f,a),k=!a&&void 0===e.default;return(0,v.jsxs)("select",{id:t,name:t,multiple:a,className:"form-control",value:void 0===w?g:w,required:i,disabled:o||s,autoFocus:l,onBlur:b,onFocus:y,onChange:x,"aria-describedby":uc(t),children:[k&&(0,v.jsx)("option",{value:"",children:d}),Array.isArray(f)&&f.map(({value:e,label:t},r)=>{let n=p&&-1!==p.indexOf(e);return(0,v.jsx)("option",{value:String(r),disabled:n,children:t},r)})]})};function fb({id:e,options:t={},placeholder:r,value:n,required:i,disabled:o,readonly:s,autofocus:a=!1,onChange:l,onBlur:c,onFocus:u}){let h=(0,tZ.useCallback)(({target:{value:e}})=>l(""===e?t.emptyValue:e),[l,t.emptyValue]),d=(0,tZ.useCallback)(({target:t})=>c(e,t&&t.value),[c,e]),f=(0,tZ.useCallback)(({target:t})=>u(e,t&&t.value),[e,u]);return(0,v.jsx)("textarea",{id:e,name:e,className:"form-control",value:n||"",placeholder:r,required:i,disabled:o,readOnly:s,autoFocus:a,rows:t.rows,onBlur:d,onFocus:f,onChange:h,"aria-describedby":uc(e)})}function fx(e){let{options:t,registry:r}=e,n=c7("BaseInputTemplate",r,t);return(0,v.jsx)(n,{...e})}function fw(e){let{onChange:t,options:r,registry:n}=e,i=c7("BaseInputTemplate",n,r),o=(0,tZ.useCallback)(e=>t(e?`${e}:00`:void 0),[t]);return(0,v.jsx)(i,{type:"time",...e,onChange:o})}function fk(e){let{options:t,registry:r}=e,n=c7("BaseInputTemplate",r,t);return(0,v.jsx)(n,{type:"url",...e})}function fA(e){let{options:t,registry:r}=e,n=c7("BaseInputTemplate",r,t);return(0,v.jsx)(n,{type:"number",...e})}fb.defaultProps={autofocus:!1,options:{}};class fS extends tZ.Component{formElement;constructor(e){if(super(e),!e.validator)throw Error("A validator is required for Form functionality to work");this.state=this.getStateFromProps(e,e.formData),this.props.onChange&&!al(this.state.formData,this.props.formData)&&this.props.onChange(this.state),this.formElement=(0,tZ.createRef)()}getSnapshotBeforeUpdate(e,t){if(!al(this.props,e)){var r,n;let i,o,s=(r=this.props.formData,n=e.formData,i=oD(r),o=oD(n),r!==n&&(i||o)?i&&!o?sU(r):!i&&o?sU(n):[...sU(uw(r,(e,t)=>!al(e,aE(n,t)))),...uA(sU(n),sU(r))]:[]),a=!al(e.schema,this.props.schema),l=s.length>0||!al(e.formData,this.props.formData),c=this.getStateFromProps(this.props,this.props.formData,a||l?void 0:this.state.retrievedSchema,a,s),u=!al(c,t);return{nextState:c,shouldUpdate:u}}return{shouldUpdate:!1}}componentDidUpdate(e,t,r){if(r.shouldUpdate){let{nextState:e}=r;al(e.formData,this.props.formData)||al(e.formData,t.formData)||!this.props.onChange||this.props.onChange(e),this.setState(e)}}getStateFromProps(e,t,r,n=!1,i=[]){let o,s,a=this.state||{},l="schema"in e?e.schema:this.props.schema,c=("uiSchema"in e?e.uiSchema:this.props.uiSchema)||{},u=void 0!==t,h="liveValidate"in e?e.liveValidate:this.props.liveValidate,d=u&&!e.noValidate&&h,f="experimental_defaultFormStateBehavior"in e?e.experimental_defaultFormStateBehavior:this.props.experimental_defaultFormStateBehavior,p="experimental_customMergeAllOf"in e?e.experimental_customMergeAllOf:this.props.experimental_customMergeAllOf,m=a.schemaUtils;(!m||m.doesSchemaUtilsDiffer(e.validator,l,f,p))&&(m=function(e,t,r={},n){return new cX(e,t,r,n)}(e.validator,l,f,p));let g=m.getDefaultFormState(l,t),y=this.updateRetrievedSchema(r??m.retrieveSchema(l,g)),v=a.schemaValidationErrors,b=a.schemaValidationErrorSchema;if(d){let e=this.validate(g,l,m,y);o=e.errors,s=void 0===r?e.errorSchema:cN(this.state?.errorSchema,e.errorSchema,"preventDuplicates"),v=o,b=s}else{let t=e.noValidate||n?{errors:[],errorSchema:{}}:e.liveValidate?{errors:a.errors||[],errorSchema:a.errorSchema||{}}:{errors:a.schemaValidationErrors||[],errorSchema:a.schemaValidationErrorSchema||{}};if(o=t.errors,s=t.errorSchema,i.length>0){let e=i.reduce((e,t)=>(e[t]=void 0,e),{});s=b=cN(t.errorSchema,e,"preventDuplicates")}}if(e.extraErrors){let t=ub({errorSchema:s,errors:o},e.extraErrors);s=t.errorSchema,o=t.errors}let x=m.toIdSchema(y,c["ui:rootFieldId"],g,e.idPrefix,e.idSeparator);return{schemaUtils:m,schema:l,uiSchema:c,idSchema:x,formData:g,edit:u,errors:o,errorSchema:s,schemaValidationErrors:v,schemaValidationErrorSchema:b,retrievedSchema:y}}shouldComponentUpdate(e,t){return function(e,t,r){let{props:n,state:i}=e;return!al(n,t)||!al(i,r)}(this,e,t)}getPreviousCustomValidateErrors(){let{customValidate:e,uiSchema:t}=this.props,r=this.state.formData,n={};return"function"==typeof e&&(n=uv(e(r,oR(r),t))),n}validate(e,t=this.props.schema,r,n){let i=r||this.state.schemaUtils,{customValidate:o,transformErrors:s,uiSchema:a}=this.props,l=n??i.retrieveSchema(t,e);return i.getValidator().validateFormData(e,l,o,s,a)}renderErrors(e){let{errors:t,errorSchema:r,schema:n,uiSchema:i}=this.state,{formContext:o}=this.props,s=c7("ErrorListTemplate",e,of(i));return t&&t.length?(0,v.jsx)(s,{errors:t,errorSchema:r||{},schema:n,uiSchema:i,formContext:o,registry:e}):null}getUsedFormData=(e,t)=>{if(0===t.length&&"object"!=typeof e)return e;let r=uZ(e,t);return Array.isArray(e)?Object.keys(r).map(e=>r[e]):r};getFieldNames=(e,t)=>{let r=(e,n=[],i=[[]])=>(Object.keys(e).forEach(o=>{if("object"==typeof e[o]){let t=i.map(e=>[...e,o]);e[o][oc]&&""!==e[o].$name?n.push(e[o].$name):r(e[o],n,t)}else"$name"===o&&""!==e[o]&&i.forEach(e=>{let r=aE(t,e);("object"!=typeof r||aM(r)||Array.isArray(r)&&r.every(e=>"object"!=typeof e))&&n.push(e)})}),n);return r(e)};omitExtraData=e=>{let{schema:t,schemaUtils:r}=this.state,n=r.retrieveSchema(t,e),i=r.toPathSchema(n,"",e),o=this.getFieldNames(i,e);return this.getUsedFormData(e,o)};filterErrorsBasedOnSchema(e,t,r){let{retrievedSchema:n,schemaUtils:i}=this.state,o=t??n,s=i.toPathSchema(o,"",r),a=uZ(e,this.getFieldNames(s,r));t?.type!=="object"&&t?.type!=="array"&&(a.__errors=e.__errors);let l=this.getPreviousCustomValidateErrors(),c=(e,t={})=>{var r;return r=(r,n)=>{let i=t[n];cD(r)||Array.isArray(r)&&0===r.length?delete e[n]:ot(r)&&ot(i)&&Array.isArray(i?.__errors)?e[n]=((e=[],t)=>0===e.length?e:e.filter(e=>!t.includes(e)))(r.__errors,i.__errors):"object"!=typeof r||Array.isArray(r.__errors)||c(r,t[n])},(sc(e)?aT:lR)(e,lK(r)),e};return c(a,l)}onChange=(e,t,r)=>{let{extraErrors:n,omitExtraData:i,liveOmit:o,noValidate:s,liveValidate:a,onChange:l}=this.props,{schemaUtils:c,schema:u}=this.state,h=this.state.retrievedSchema;if(ot(e)||Array.isArray(e)){let t=this.getStateFromProps(this.props,e);e=t.formData,h=t.retrievedSchema}let d={formData:e,schema:u},f=e;if(!0===i&&!0===o&&(d={formData:f=this.omitExtraData(e)}),!s&&a){let e=this.validate(f,u,c,h),r=e.errors,i=e.errorSchema,o=r,s=i;if(n){let t=ub(e,n);i=t.errorSchema,r=t.errors}t&&(i=cN(i,this.filterErrorsBasedOnSchema(t,h,f),"preventDuplicates")),d={formData:f,errors:r,errorSchema:i,schemaValidationErrors:o,schemaValidationErrorSchema:s}}else if(!s&&t){let e=n?cN(t,n,"preventDuplicates"):t;d={formData:f,errorSchema:e,errors:up(e)}}this.setState(d,()=>l&&l({...this.state,...d},r))};updateRetrievedSchema(e){return al(e,this.state?.retrievedSchema)?this.state.retrievedSchema:e}reset=()=>{let{onChange:e}=this.props,t={formData:this.getStateFromProps(this.props,void 0).formData,errorSchema:{},errors:[],schemaValidationErrors:[],schemaValidationErrorSchema:{}};this.setState(t,()=>e&&e({...this.state,...t}))};onBlur=(e,t)=>{let{onBlur:r}=this.props;r&&r(e,t)};onFocus=(e,t)=>{let{onFocus:r}=this.props;r&&r(e,t)};onSubmit=e=>{if(e.preventDefault(),e.target!==e.currentTarget)return;e.persist();let{omitExtraData:t,extraErrors:r,noValidate:n,onSubmit:i}=this.props,{formData:o}=this.state;if(!0===t&&(o=this.omitExtraData(o)),n||this.validateFormWithFormData(o)){let t=r||{},n=r?up(r):[];this.setState({formData:o,errors:n,errorSchema:t,schemaValidationErrors:[],schemaValidationErrorSchema:{}},()=>{i&&i({...this.state,formData:o,status:"submitted"},e)})}};getRegistry(){let{translateString:e,uiSchema:t={}}=this.props,{schemaUtils:r}=this.state,{fields:n,templates:i,widgets:o,formContext:s,translateString:a}={fields:{AnyOfField:u6,ArrayField:u3,BooleanField:u5,NumberField:u7,ObjectField:dN,OneOfField:u6,SchemaField:dF,StringField:dB,NullField:dz},templates:{ArrayFieldDescriptionTemplate:dW,ArrayFieldItemTemplate:dV,ArrayFieldTemplate:dH,ArrayFieldTitleTemplate:dU,ButtonTemplates:{SubmitButton:dK,AddButton:dQ,CopyButton:dJ,MoveDownButton:dY,MoveUpButton:dX,RemoveButton:dZ},BaseInputTemplate:dq,DescriptionFieldTemplate:d0,ErrorListTemplate:d1,FieldTemplate:d4,FieldErrorTemplate:d3,FieldHelpTemplate:d5,ObjectFieldTemplate:d6,TitleFieldTemplate:d9,UnsupportedFieldTemplate:d8,WrapIfAdditionalTemplate:d7},widgets:{AltDateWidget:ft,AltDateTimeWidget:fr,CheckboxWidget:fn,CheckboxesWidget:fi,ColorWidget:fo,DateWidget:fs,DateTimeWidget:fa,EmailWidget:fl,FileWidget:fd,HiddenWidget:ff,PasswordWidget:fp,RadioWidget:fm,RangeWidget:fg,SelectWidget:fv,TextWidget:fx,TextareaWidget:fb,TimeWidget:fw,UpDownWidget:fA,URLWidget:fk},rootSchema:{},formContext:{},translateString:cQ};return{fields:{...n,...this.props.fields},templates:{...i,...this.props.templates,ButtonTemplates:{...i.ButtonTemplates,...this.props.templates?.ButtonTemplates}},widgets:{...o,...this.props.widgets},rootSchema:this.props.schema,formContext:this.props.formContext||s,schemaUtils:r,translateString:e||a,globalUiOptions:t["ui:globalOptions"]}}submit=()=>{if(this.formElement.current){let e=new CustomEvent("submit",{cancelable:!0});e.preventDefault(),this.formElement.current.dispatchEvent(e),this.formElement.current.requestSubmit()}};focusOnError(e){let{idPrefix:t="root",idSeparator:r="_"}=this.props,{property:n}=e,i=um(n);""===i[0]?i[0]=t:i.unshift(t);let o=i.join(r),s=this.formElement.current.elements[o];s||(s=this.formElement.current.querySelector(`input[id^="${o}"`)),s&&s.length&&(s=s[0]),s&&s.focus()}validateFormWithFormData=e=>{let{extraErrors:t,extraErrorsBlockSubmit:r,focusOnFirstError:n,onError:i}=this.props,{errors:o}=this.state,s=this.validate(e),a=s.errors,l=s.errorSchema,c=a,u=l,h=a.length>0||t&&r;if(h){if(t){let e=ub(s,t);l=e.errorSchema,a=e.errors}n&&("function"==typeof n?n(a[0]):this.focusOnError(a[0])),this.setState({errors:a,errorSchema:l,schemaValidationErrors:c,schemaValidationErrorSchema:u},()=>{i?i(a):console.error("Form validation failed",a)})}else o.length>0&&this.setState({errors:[],errorSchema:{},schemaValidationErrors:[],schemaValidationErrorSchema:{}});return!h};validateForm(){let{omitExtraData:e}=this.props,{formData:t}=this.state;return!0===e&&(t=this.omitExtraData(t)),this.validateFormWithFormData(t)}render(){let{children:e,id:t,idPrefix:r,idSeparator:n,className:i="",tagName:o,name:s,method:a,target:l,action:c,autoComplete:u,enctype:h,acceptcharset:d,acceptCharset:f,noHtml5Validate:p=!1,disabled:m,readonly:g,formContext:y,showErrorList:b="top",_internalFormWrapper:x}=this.props,{schema:w,uiSchema:k,formData:A,errorSchema:S,idSchema:j}=this.state,C=this.getRegistry(),{SchemaField:E}=C.fields,{SubmitButton:O}=C.templates.ButtonTemplates,M=x?o:void 0,P=x||o||"form",{[ol]:T={}}=of(k);m&&(T={...T,props:{...T.props,disabled:!0}});let I={[od]:{[ol]:T}};return(0,v.jsxs)(P,{className:i||"rjsf",id:t,name:s,method:a,target:l,action:c,autoComplete:u,encType:h,acceptCharset:f||d,noValidate:p,onSubmit:this.onSubmit,as:M,ref:this.formElement,children:["top"===b&&this.renderErrors(C),(0,v.jsx)(E,{name:"",schema:w,uiSchema:k,errorSchema:S,idSchema:j,idPrefix:r,idSeparator:n,formContext:y,formData:A,onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,registry:C,disabled:m,readonly:g}),e||(0,v.jsx)(O,{uiSchema:I,registry:C}),"bottom"===b&&this.renderErrors(C)]})}}function fj(e){return(0,tZ.forwardRef)(({fields:t,widgets:r,templates:n,...i},o)=>(t={...e?.fields,...t},r={...e?.widgets,...r},n={...e?.templates,...n,ButtonTemplates:{...e?.templates?.ButtonTemplates,...n?.ButtonTemplates}},(0,v.jsx)(fS,{...e,...i,fields:t,widgets:r,templates:n,ref:o})))}let fC=e=>{let{id:t,children:r,classNames:n,style:i,disabled:o,displayLabel:s,hidden:a,label:l,onDropPropertyClick:c,onKeyChange:u,readonly:h,required:d,rawErrors:f=[],errors:p,help:m,rawDescription:g,schema:y,uiSchema:b,registry:x}=e,w=c7("WrapIfAdditionalTemplate",x,of(b));return a?(0,v.jsx)("div",{style:{display:"none"},children:r}):(0,v.jsx)(w,{classNames:n,style:i,disabled:o,id:t,label:l,onDropPropertyClick:c,onKeyChange:u,readonly:h,required:d,schema:y,uiSchema:b,registry:x,children:(0,v.jsx)(ra.g,{displayLabel:s,rawErrors:f,help:m,disabled:o,rawDescription:g,errors:p,required:d,children:r})})},fE=(0,rI.A)(e=>({markdownDescription:{fontSize:e.typography.caption.fontSize,margin:0,color:e.palette.text.secondary,"& :first-child":{margin:0,marginTop:"3px"}}})),fO=e=>{let{id:t,description:r}=e,n=fE();return r?"string"==typeof r?(0,v.jsx)(rV.h,{content:r,linkTarget:"_blank",className:n.markdownDescription}):(0,v.jsx)(rT.A,{id:t,variant:"subtitle2",style:{marginTop:"5px"},children:r}):null};var fM=r(18466);function fP({uiSchema:e,registry:t,...r}){let{translateString:n}=t;return(0,v.jsx)(rG.A,{title:n(mm.AddItemButton),...r,color:"primary",children:(0,v.jsx)(fM.default,{})})}function fT(e){let{children:t,disabled:r,hasToolbar:n,hasCopy:i,hasMoveDown:o,hasMoveUp:s,hasRemove:a,index:l,onCopyIndexClick:c,onDropIndexClick:u,onReorderClick:h,readonly:d,uiSchema:f,registry:p}=e,{CopyButton:m,MoveDownButton:g,MoveUpButton:y,RemoveButton:b}=p.templates.ButtonTemplates,x={flex:1,paddingLeft:6,paddingRight:6,fontWeight:"bold",minWidth:0};return(0,v.jsxs)(nI.A,{container:!0,alignItems:"center",children:[(0,v.jsx)(nI.A,{item:!0,xs:!0,style:{overflow:"auto"},children:(0,v.jsx)(rP.A,{mb:2,children:(0,v.jsx)(ns.A,{elevation:2,children:(0,v.jsx)(rP.A,{p:2,children:t})})})}),n&&(0,v.jsxs)(nI.A,{item:!0,children:[(s||o)&&(0,v.jsx)(y,{style:x,disabled:r||d||!s,onClick:h(l,l-1),uiSchema:f,registry:p}),(s||o)&&(0,v.jsx)(g,{style:x,disabled:r||d||!o,onClick:h(l,l+1),uiSchema:f,registry:p}),i&&(0,v.jsx)(m,{style:x,disabled:r||d,onClick:c(l),uiSchema:f,registry:p}),a&&(0,v.jsx)(b,{style:x,disabled:r||d,onClick:u(l),uiSchema:f,registry:p})]})]})}function fI(e){let{canAdd:t,disabled:r,idSchema:n,uiSchema:i,items:o,onAddClick:s,readonly:a,registry:l,required:c,schema:u,title:h}=e,d=of(i),f=c7("ArrayFieldDescriptionTemplate",l,d),p=c7("ArrayFieldItemTemplate",l,d),m=c7("ArrayFieldTitleTemplate",l,d),{ButtonTemplates:{AddButton:g}}=l.templates;return(0,v.jsx)(ns.A,{elevation:2,children:(0,v.jsxs)(rP.A,{p:2,children:[(0,v.jsx)(m,{idSchema:n,title:d.title||h,schema:u,uiSchema:i,required:c,registry:l}),(0,v.jsx)(f,{idSchema:n,description:d.description||u.description,schema:u,uiSchema:i,registry:l}),o&&o.map(({key:e,...t})=>(0,v.jsx)(p,{...t},e)),t&&(0,v.jsx)(nI.A,{container:!0,justifyContent:"flex-end",children:(0,v.jsx)(nI.A,{item:!0,children:(0,v.jsx)(rP.A,{mt:2,children:(0,v.jsx)(g,{className:"array-item-add",onClick:s,disabled:r||a,uiSchema:i,registry:l})})})})]})})}let f$=["date","datetime-local","file","time"];function fD(e){var t;let{id:r,name:n,placeholder:i,required:o,readonly:s,disabled:a,type:l,label:c,hideLabel:u,hideError:h,value:d,onChange:f,onChangeOverride:p,onBlur:m,onFocus:g,autofocus:y,options:b,schema:x,uiSchema:w,rawErrors:k=[],formContext:A,registry:S,InputLabelProps:j,...C}=e,{step:E,min:O,max:M,...P}=c6(x,l,b),T={inputProps:{step:E,min:O,max:M,...x.examples?{list:us(r)}:void 0},...P},I=f$.includes(l)?{...j,shrink:!0}:j;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(rl.A,{id:r,name:r,placeholder:i,label:(t=c||void 0,!u&&t),autoFocus:y,required:o,disabled:a||s,...T,value:d||0===d?d:"",error:k.length>0,onChange:p||(({target:{value:e}})=>f(""===e?b.emptyValue:e)),onBlur:({target:e})=>m(r,e&&e.value),onFocus:({target:e})=>g(r,e&&e.value),InputLabelProps:I,...C,"aria-describedby":uc(r,!!x.examples)}),Array.isArray(x.examples)&&(0,v.jsx)("datalist",{id:us(r),children:x.examples.concat(x.default&&!x.examples.includes(x.default)?[x.default]:[]).map(e=>(0,v.jsx)("option",{value:e},e))})]})}function fR(e){let{id:t,description:r}=e;return r?(0,v.jsx)(rT.A,{id:t,variant:"subtitle2",style:{marginTop:"5px"},children:r}):null}var fN=r(7147);function f_({errors:e,registry:t}){let{translateString:r}=t;return(0,v.jsx)(ns.A,{elevation:2,children:(0,v.jsxs)(rP.A,{mb:2,p:2,children:[(0,v.jsx)(rT.A,{variant:"h6",children:r(mm.ErrorsLabel)}),(0,v.jsx)(ni.A,{dense:!0,children:e.map((e,t)=>(0,v.jsxs)(no.A,{children:[(0,v.jsx)(rJ.A,{children:(0,v.jsx)(fN.default,{color:"error"})}),(0,v.jsx)(rY.A,{primary:e.stack})]},t))})]})})}var fL=r(89019),fF=r(68594),fB=r(99594),fz=r(80113);function fW(e){let{icon:t,color:r,uiSchema:n,registry:i,...o}=e;return(0,v.jsx)(rG.A,{...o,size:"small",color:r,children:t})}function fV(e){let{registry:{translateString:t}}=e;return(0,v.jsx)(fW,{title:t(mm.CopyButton),...e,icon:(0,v.jsx)(fB.default,{fontSize:"small"})})}function fH(e){let{registry:{translateString:t}}=e;return(0,v.jsx)(fW,{title:t(mm.MoveDownButton),...e,icon:(0,v.jsx)(fF.default,{fontSize:"small"})})}function fU(e){let{registry:{translateString:t}}=e;return(0,v.jsx)(fW,{title:t(mm.MoveUpButton),...e,icon:(0,v.jsx)(fL.default,{fontSize:"small"})})}function fq(e){let{iconType:t,...r}=e,{registry:{translateString:n}}=r;return(0,v.jsx)(fW,{title:n(mm.RemoveButton),...r,color:"secondary",icon:(0,v.jsx)(fz.default,{fontSize:"default"===t?"medium":"small"})})}var fK=r(51253);function fG(e){let{errors:t=[],idSchema:r}=e;if(0===t.length)return null;let n=uo(r);return(0,v.jsx)(ni.A,{dense:!0,disablePadding:!0,children:t.map((e,t)=>(0,v.jsx)(no.A,{disableGutters:!0,children:(0,v.jsx)(fK.A,{id:n,children:e})},t))})}function fJ(e){let{idSchema:t,help:r}=e;if(!r)return null;let n=ua(t);return(0,v.jsx)(fK.A,{id:n,children:r})}var fY=r(95061);function fX(e){let{id:t,children:r,classNames:n,style:i,disabled:o,displayLabel:s,hidden:a,label:l,onDropPropertyClick:c,onKeyChange:u,readonly:h,required:d,rawErrors:f=[],errors:p,help:m,description:g,rawDescription:y,schema:b,uiSchema:x,registry:w}=e,k=c7("WrapIfAdditionalTemplate",w,of(x));return a?(0,v.jsx)("div",{style:{display:"none"},children:r}):(0,v.jsx)(k,{classNames:n,style:i,disabled:o,id:t,label:l,onDropPropertyClick:c,onKeyChange:u,readonly:h,required:d,schema:b,uiSchema:x,registry:w,children:(0,v.jsxs)(fY.A,{fullWidth:!0,error:!!f.length,required:d,children:[r,s&&y?(0,v.jsx)(rT.A,{variant:"caption",color:"textSecondary",children:g}):null,p,m]})})}function fZ(e){let{description:t,title:r,properties:n,required:i,disabled:o,readonly:s,uiSchema:a,idSchema:l,schema:c,formData:u,onAddClick:h,registry:d}=e,f=of(a),p=c7("TitleFieldTemplate",d,f),m=c7("DescriptionFieldTemplate",d,f),{ButtonTemplates:{AddButton:g}}=d.templates;return(0,v.jsxs)(v.Fragment,{children:[r&&(0,v.jsx)(p,{id:ul(l),title:r,required:i,schema:c,uiSchema:a,registry:d}),t&&(0,v.jsx)(m,{id:ui(l),description:t,schema:c,uiSchema:a,registry:d}),(0,v.jsxs)(nI.A,{container:!0,spacing:2,style:{marginTop:"10px"},children:[n.map((e,t)=>e.hidden?e.content:(0,v.jsx)(nI.A,{item:!0,xs:12,style:{marginBottom:"10px"},children:e.content},t)),op(c,a,u)&&(0,v.jsx)(nI.A,{container:!0,justifyContent:"flex-end",children:(0,v.jsx)(nI.A,{item:!0,children:(0,v.jsx)(g,{className:"object-property-expand",onClick:h(c),disabled:o||s,uiSchema:a,registry:d})})})]})]})}function fQ({uiSchema:e}){let{submitText:t,norender:r,props:n={}}=c8(e);return r?null:(0,v.jsx)(rP.A,{marginTop:3,children:(0,v.jsx)(iB.A,{type:"submit",variant:"contained",color:"primary",...n,children:t})})}function f0({id:e,title:t}){return(0,v.jsxs)(rP.A,{id:e,mb:1,mt:1,children:[(0,v.jsx)(rT.A,{variant:"h5",children:t}),(0,v.jsx)(iA.A,{})]})}function f1(e){let{children:t,classNames:r,style:n,disabled:i,id:o,label:s,onDropPropertyClick:a,onKeyChange:l,readonly:c,required:u,schema:h,uiSchema:d,registry:f}=e,{templates:p,translateString:m}=f,{RemoveButton:g}=p.ButtonTemplates,y=m(mm.KeyLabel,[s]);return on in h?(0,v.jsxs)(nI.A,{container:!0,alignItems:"center",spacing:2,className:r,style:n,children:[(0,v.jsx)(nI.A,{item:!0,xs:!0,children:(0,v.jsx)(rl.A,{fullWidth:!0,required:u,label:y,defaultValue:s,disabled:i||c,id:`${o}-key`,name:`${o}-key`,onBlur:c?void 0:({target:e})=>l(e.value),type:"text"})}),(0,v.jsx)(nI.A,{item:!0,xs:!0,children:t}),(0,v.jsx)(nI.A,{item:!0,children:(0,v.jsx)(g,{iconType:"default",style:{flex:1,paddingLeft:6,paddingRight:6,fontWeight:"bold"},disabled:i||c,onClick:a(s),uiSchema:d,registry:f})})]},`${o}-key`):(0,v.jsx)("div",{className:r,style:n,children:t})}function f2(){return{ArrayFieldItemTemplate:fT,ArrayFieldTemplate:fI,BaseInputTemplate:fD,ButtonTemplates:{AddButton:fP,CopyButton:fV,MoveDownButton:fH,MoveUpButton:fU,RemoveButton:fq,SubmitButton:fQ},DescriptionFieldTemplate:fR,ErrorListTemplate:f_,FieldErrorTemplate:fG,FieldHelpTemplate:fJ,FieldTemplate:fX,ObjectFieldTemplate:fZ,TitleFieldTemplate:f0,WrapIfAdditionalTemplate:f1}}function f4(e){var t;let{schema:r,id:n,value:i,disabled:o,readonly:s,label:a="",hideLabel:l,autofocus:c,onChange:u,onBlur:h,onFocus:d,registry:f,options:p,uiSchema:m}=e,g=c7("DescriptionFieldTemplate",f,p),y=ud(r),b=null!=(t=p.description)?t:r.description;return(0,v.jsxs)(v.Fragment,{children:[!l&&!!b&&(0,v.jsx)(g,{id:ui(n),description:b,schema:r,uiSchema:m,registry:f}),(0,v.jsx)(io.A,{control:(0,v.jsx)(ii.A,{id:n,name:n,checked:void 0!==i&&!!i,required:y,disabled:o||s,autoFocus:c,onChange:(e,t)=>u(t),onBlur:({target:{value:e}})=>h(n,e),onFocus:({target:{value:e}})=>d(n,e),"aria-describedby":uc(n)}),label:!l&&a})]})}f2();var f3=r(12981),f5=r(91761);function f6({label:e,hideLabel:t,id:r,disabled:n,options:i,value:o,autofocus:s,readonly:a,required:l,onChange:c,onBlur:u,onFocus:h}){var d;let{enumOptions:f,enumDisabled:p,inline:m,emptyValue:g}=i,y=Array.isArray(o)?o:[o],b=({target:{value:e}})=>u(r,c0(e,f,g)),x=({target:{value:e}})=>h(r,c0(e,f,g));return(0,v.jsxs)(v.Fragment,{children:[(d=(0,v.jsx)(f5.A,{required:l,htmlFor:r,children:e||void 0}),t?void 0:d),(0,v.jsx)(f3.A,{id:r,row:!!m,children:Array.isArray(f)&&f.map((e,t)=>{let i=c2(e.value,y),o=Array.isArray(p)&&-1!==p.indexOf(e.value),l=(0,v.jsx)(ii.A,{id:uu(r,t),name:r,checked:i,disabled:n||o||a,autoFocus:s&&0===t,onChange:({target:{checked:e}})=>{e?c(c3(t,y,f)):c(c1(t,y,f))},onBlur:b,onFocus:x,"aria-describedby":uc(r)});return(0,v.jsx)(io.A,{control:l,label:e.label},t)})})]})}var f9=r(15492),f8=r(29635);function f7({id:e,options:t,value:r,required:n,disabled:i,readonly:o,label:s,hideLabel:a,onChange:l,onBlur:c,onFocus:u}){var h,d;let{enumOptions:f,enumDisabled:p,emptyValue:m}=t,g=!!t&&t.inline,y=null!=(h=c4(r,f))?h:null;return(0,v.jsxs)(v.Fragment,{children:[(d=(0,v.jsx)(f5.A,{required:n,htmlFor:e,children:s||void 0}),a?void 0:d),(0,v.jsx)(f8.A,{id:e,name:e,value:y,row:g,onChange:(e,t)=>l(c0(t,f,m)),onBlur:({target:{value:t}})=>c(e,c0(t,f,m)),onFocus:({target:{value:t}})=>u(e,c0(t,f,m)),"aria-describedby":uc(e),children:Array.isArray(f)&&f.map((t,r)=>{let n=Array.isArray(p)&&-1!==p.indexOf(t.value);return(0,v.jsx)(io.A,{control:(0,v.jsx)(f9.A,{name:e,id:uu(e,r),color:"primary"}),label:t.label,value:String(r),disabled:i||n||o},r)})})]})}var pe=r(34453);function pt(e){var t;let{value:r,readonly:n,disabled:i,onBlur:o,onFocus:s,options:a,schema:l,onChange:c,required:u,label:h,hideLabel:d,id:f}=e,p={value:r,label:h,id:f,name:f,...c5(l)};return(0,v.jsxs)(v.Fragment,{children:[(t=(0,v.jsx)(f5.A,{required:u,htmlFor:f,children:h||void 0}),d?void 0:t),(0,v.jsx)(pe.A,{disabled:i||n,onChange:(e,t)=>{c(null!=t?t:a.emptyValue)},onBlur:({target:{value:e}})=>o(f,e),onFocus:({target:{value:e}})=>s(f,e),valueLabelDisplay:"auto",...p,"aria-describedby":uc(f)})]})}function pr({schema:e,id:t,name:r,options:n,label:i,hideLabel:o,required:s,disabled:a,readonly:l,placeholder:c,value:u,multiple:h,autofocus:d,onChange:f,onBlur:p,onFocus:m,rawErrors:g=[],registry:y,uiSchema:b,hideError:x,formContext:w,...k}){let{enumOptions:A,enumDisabled:S,emptyValue:j}=n,C=(h=void 0!==h&&!!h)?[]:"",E=void 0===u||h&&u.length<1||!h&&u===C,O=c4(u,A,h),M=!h&&void 0===e.default;return(0,v.jsxs)(rl.A,{id:t,name:t,label:!o&&!!i&&i,value:E||void 0===O?C:O,required:s,disabled:a||l,autoFocus:d,placeholder:c,error:g.length>0,onChange:({target:{value:e}})=>f(c0(e,A,j)),onBlur:({target:e})=>p(t,c0(e&&e.value,A,j)),onFocus:({target:e})=>m(t,c0(e&&e.value,A,j)),...k,select:!0,InputLabelProps:{...k.InputLabelProps,shrink:!E},SelectProps:{...k.SelectProps,multiple:h},"aria-describedby":uc(t),children:[M&&(0,v.jsx)(rX.A,{value:"",children:c}),Array.isArray(A)&&A.map(({value:e,label:t},r)=>{let n=Array.isArray(S)&&-1!==S.indexOf(e);return(0,v.jsx)(rX.A,{value:String(r),disabled:n,children:t},r)})]})}function pn(e){let{options:t,registry:r}=e,n=c7("BaseInputTemplate",r,t),i=5;return("string"==typeof t.rows||"number"==typeof t.rows)&&(i=t.rows),(0,v.jsx)(n,{...e,multiline:!0,rows:i})}function pi(){return{CheckboxWidget:f4,CheckboxesWidget:f6,RadioWidget:f7,RangeWidget:pt,SelectWidget:pr,TextareaWidget:pn}}function po(){return{templates:f2(),widgets:pi()}}pi();let ps=po();fj(po());let pa=fj(ps),pl=e=>{let t=(0,tZ.useMemo)(()=>Object.fromEntries(Object.entries(e.fields??{}).map(([e,t])=>[e,e=>(0,v.jsx)(t,{...e,uiSchema:e.uiSchema??{},formData:e.formData,rawErrors:e.rawErrors??[],disabled:e.disabled??!1,readonly:e.readonly??!1})])),[e.fields]),r=(0,tZ.useMemo)(()=>({FieldTemplate:fC,DescriptionFieldTemplate:fO,...e.templates}),[e.templates]);return(0,v.jsx)(pa,{...e,templates:r,fields:t})},pc=e=>{let{t}=(0,rK.i)(r8),{value:r,onChange:n,schema:{title:i}}=e;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(rl.A,{id:i,label:i,"aria-describedby":i,onChange:e=>{n(e.target.value)},value:r,autoComplete:"off"}),(0,v.jsx)(fK.A,{error:!0,children:(0,v.jsx)(rV.h,{content:t("passwordWidget.content")})})]})};var pu=r(92881);function ph(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function pd(e){return e.split("/").filter(Boolean).map(e=>(0,tX.startCase)(e)).join(" > ")}let pf=e=>{let t=Object.fromEntries(Object.entries(e.formState).flatMap(([t,r])=>{let n=function(e,t,r){for(let n of t){let t=n.mergedSchema,i={};if(t.dependencies&&ph(t.dependencies))for(let e in t.dependencies)r.hasOwnProperty(e)&&(i[e]=r[e]);if(new tY(t).getSchema({pointer:`#/${e}`,data:i}))return n}return null}(t,e.schemas,e.formState);return n?function e(t,r,n,i){let o=new tY(n.mergedSchema).getSchema({pointer:`#/${t}`,data:i}),s=o?.["ui:backstage"]?.review?.name??o?.title??pd(t);if(o){let a=o["ui:backstage"]?.review;if(a){if(a.mask)return[[s,a.mask]];if(!1===a.show)return[]}if("password"===o["ui:widget"]||o["ui:field"]?.toLocaleLowerCase("en-us")==="secret")return[[s,"******"]];if(o.enum&&o.enumNames)return[[s,o.enumNames[o.enum.indexOf(r)]||r]];if(a?.explode!==!1&&ph(r))return Object.entries(r).flatMap(([r,o])=>e(`${t}/${r}`,o,n,i))}return[[s,r]]}(t,r,n,e.formState):[[pd(t),r]]}).filter(e=>e.length>0));return(0,v.jsx)(pu.t,{metadata:t,options:{titleFormat:e=>e}})};function pp(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}let pm=e=>"type"in e&&"error"===e.type,pg=(e,t,r)=>{async function n(i,o="#",s=i){let a=new tY(e),l={},c=async(e,n,o,s,a)=>{let c=t[e];if(c){let e,t=e={__errors:[],addError:t=>{e.__errors?.push(t)}};try{await c(o,t,{...r,formData:i,schema:s,uiSchema:a})}catch(e){t.addError(e.message)}l[n]=t}};for(let[e,t]of Object.entries(s)){let r=`${o}/${e}`,s=a.getSchema({pointer:r,data:i});if(!s)continue;if(pm(s))throw Error(s.message);let{schema:u,uiSchema:h}=uX(s),d=s&&s.items,f=async(r,n,i)=>{await c(r["ui:field"],e,t,n,i)},p=async e=>{if("ui:field"in e){let{schema:t,uiSchema:r}=uX(s.items);await f(e,t,r)}},m=async e=>{let{schema:r,uiSchema:n}=uX(e);for(let i of(await f(e,r,n),Array.isArray(t)?t:[t]))if(i&&pp(i))for(let e of Object.keys(i))n[e]&&"ui:field"in n[e]&&await c(n[e]["ui:field"],e,i[e],r,n)};if("ui:field"in s)await f(s,u,h);else if(d&&"ui:field"in s.items)await p(s.items);else if(d&&"object"===s.items.type){for(let[,e]of Object.entries(s.items?.properties??[]))await p(e);for(let[,e]of Object.entries(s.items?.dependencies??[]))await m(e)}else pp(t)&&(l[e]=await n(i,r,t))}return l}return async e=>await n(e)};var py=r(99703),pv=r(95479),pb=r.n(pv);let px=(0,rI.A)(e=>(0,py.A)({list:{width:"100%"},text:{textWrap:"wrap"}})),pw=({errors:e,schema:t})=>{let r=px();return(0,v.jsx)(ns.A,{children:(0,v.jsx)(ni.A,{dense:!0,className:r.list,children:e.map((e,n)=>(0,v.jsxs)(no.A,{children:[(0,v.jsx)(rJ.A,{children:(0,v.jsx)(fN.default,{color:"error"})}),(0,v.jsx)(rY.A,{classes:{primary:r.text},primary:function(e){if(e.property&&e.message){let r=e.property.startsWith(".")?e.property.substring(1):e.property;if(t.properties&&r in t.properties){let n=t.properties[r];if("object"==typeof n&&"title"in n)return`'${n.title}' ${e.message}`}return`'${pb()(r)}' ${e.message}`}return e.stack}(e)})]},n))})})},pk=({description:e})=>e&&(0,v.jsx)(rV.h,{content:e,linkTarget:"_blank"}),pA=uI();uR()(pA.ajv);let pS=(0,rI.A)(e=>({backButton:{marginRight:e.spacing(1)},footer:{display:"flex",flexDirection:"row",justifyContent:"right",marginTop:e.spacing(2)},formWrapper:{padding:e.spacing(2)}}),{name:"BackstageTemplateStepper"}),pj=e=>{var t;let r,n,i,{t:o}=(0,rK.i)(r8),{layouts:s=[],components:a={},onCreate:l,...c}=e,{ReviewStateComponent:u=pf,ReviewStepComponent:h,backButtonText:d=o("stepper.backButtonText"),createButtonText:f=o("stepper.createButtonText"),reviewButtonText:p=o("stepper.reviewButtonText")}=a,m=(0,ib.s)(),{presentation:g,steps:b}=(t=c.manifest,r=(0,k.gf)(i5.B),n=t.steps.map(({title:e,description:t,schema:r})=>({title:e,description:t,mergedSchema:r,...uX(r)})).filter(e=>{let t=e.uiSchema["ui:backstage"]?.featureFlag;return!t||r.isActive(t)}).map(e=>{let{title:t,...n}=e.schema,i={...e,schema:{...n}};return(e.schema?.properties||!e.schema?.dependencies)&&(i.schema.properties=Object.fromEntries(Object.entries(e.schema?.properties??{}).filter(([t])=>{let n=e.uiSchema[t]?.["ui:backstage"]?.featureFlag;return!n||r.isActive(n)}))),i}),{presentation:t.presentation,steps:n}),x=(0,k.Q2)(),[w,A]=(0,tZ.useState)(0),[S,j]=(0,tZ.useState)(!1),[C]=(i=c.initialState,(0,tZ.useState)(()=>{if(i)return i;let e=u_().parse(window.location.search,{ignoreQueryPrefix:!0});try{return JSON.parse(e.formData)}catch(e){return{}}})),[E,O]=(0,tZ.useState)(C),[M,P]=(0,tZ.useState)(),T=pS(),I=g?.buttonLabels?.backButtonText??d,$=g?.buttonLabels?.createButtonText??f,D=g?.buttonLabels?.reviewButtonText??p,R=(0,tZ.useMemo)(()=>Object.fromEntries(c.extensions.map(({name:e,component:t})=>[e,t])),[c.extensions]),N=(0,tZ.useMemo)(()=>({...y,...R}),[R]),_=(0,tZ.useMemo)(()=>Object.fromEntries(c.extensions.map(({name:e,validation:t})=>[e,t])),[c.extensions]),L=(0,tZ.useMemo)(()=>pg(b[w]?.mergedSchema,_,{apiHolder:x}),[b,w,_,x]),F=(0,tZ.useCallback)(()=>{A(e=>e-1)},[A]),B=((e,t={})=>{let{layouts:r=[]}=t,n=e?.uiSchema["ui:ObjectFieldTemplate"];return(0,tZ.useMemo)(()=>{if("string"!=typeof n)return e;let t=r.find(e=>e.name===n)?.component;return t?{...e,uiSchema:{...e.uiSchema,"ui:ObjectFieldTemplate":t}}:e},[r,n,e])})(b[w],{layouts:s}),{formContext:z,uiSchema:W,liveOmit:V,omitExtraData:H,...U}=c.formProps??{},q=(0,tZ.useCallback)(e=>{O(t=>({...t,...e.formData}))},[O]),K=(0,tZ.useCallback)(async({formData:e={}})=>{P(void 0),j(!0);let t=await L(e);O(t=>({...t,...e})),j(!1),function e(t){if(!t)return!1;for(let r of Object.values(t)){if(r&&"__errors"in r){if((r.__errors??[]).length>0)return!0;continue}if(e(r))return!0}return!1}(t)?P(t):(P(void 0),A(e=>{let t=e+1;return m.captureEvent("click",`Next Step (${t})`),t}))},[L,m]);(0,tZ.useEffect)(()=>{let e=document.querySelector("main");e&&"function"==typeof e.scrollTo&&e.scrollTo({top:0,behavior:"auto"})},[w]);let G=(0,tX.merge)({},W,B?.uiSchema),[J,Y]=(0,tZ.useState)(!1),X=(0,tZ.useCallback)(async()=>{Y(!0),m.captureEvent("click",`${$}`);try{await l(E)}finally{Y(!1)}},[m,$,l,E]);return(0,v.jsxs)(v.Fragment,{children:[S&&(0,v.jsx)(i9.A,{variant:"indeterminate"}),(0,v.jsxs)(oe.A,{activeStep:w,alternativeLabel:!0,variant:"elevation",style:{overflowX:"auto"},children:[b.map((e,t)=>{let r=w>t;return(0,v.jsx)(i8.A,{children:(0,v.jsx)(i7.A,{"aria-label":o("stepper.stepIndexLabel",{index:t+1}),style:{cursor:r?"pointer":"default"},onClick:()=>{r&&A(t)},children:e.title})},t)}),(0,v.jsx)(i8.A,{children:(0,v.jsx)(i7.A,{children:D})})]}),(0,v.jsx)("div",{className:T.formWrapper,children:w<b.length?(0,v.jsx)(pl,{validator:pA,extraErrors:M,formData:E,formContext:{...z,formData:E},schema:B.schema,uiSchema:G,onSubmit:K,fields:N,showErrorList:"top",templates:{ErrorListTemplate:pw},onChange:q,widgets:{password:pc},experimental_defaultFormStateBehavior:{allOf:"populateDefaults"},...U,children:(0,v.jsxs)("div",{className:T.footer,children:[(0,v.jsx)(iB.A,{onClick:F,className:T.backButton,disabled:w<1||S,children:I}),(0,v.jsx)(iB.A,{variant:"contained",color:"primary",type:"submit",disabled:S,children:w===b.length-1?D:o("stepper.nextButtonText")})]})},w):h?(0,v.jsx)(h,{disableButtons:S,formData:E,handleBack:F,handleReset:()=>{},steps:b,handleCreate:X}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(u,{formState:E,schemas:b}),(0,v.jsxs)("div",{className:T.footer,children:[(0,v.jsx)(iB.A,{onClick:F,className:T.backButton,disabled:w<1,children:I}),(0,v.jsx)(iB.A,{disabled:J,variant:"contained",color:"primary",onClick:X,children:$})]})]})})]})},pC=(0,rI.A)({markdown:{"& :first-child":{marginTop:0},"& :last-child":{marginBottom:0}}}),pE=e=>{let t,r,{t:n}=(0,rK.i)(r8),{title:i,description:o,namespace:s,templateName:a,onCreate:l,...c}=e,u=(0,ib.s)(),h=pC(),d=(0,nG.U2)({kind:"Template",namespace:s,name:a}),f=(0,k.gf)(im.m),{loading:p,manifest:m,error:g}=i4(d),y=(t="backstage:featureFlag",r=(0,k.gf)(i5.B),(0,tZ.useMemo)(()=>{if(!m)return;let e=m?.steps.filter(e=>{let n=e.schema[t];return"string"!=typeof n||r.isActive(n)}).map(e=>{let n=t5()(e),i=[];return n.schema.properties&&(n.schema.properties=Object.fromEntries(Object.entries(n.schema.properties).filter(([e,n])=>!n[t]||!!r.isActive(n[t])||(i.push(e),!1))),n.schema.required=Array.isArray(n.schema.required)?n.schema.required?.filter(e=>!i.includes(e)):n.schema.required),n});return{...m,steps:e}},[m,r])),b=(e=>{let t=(0,k.gf)(nq.v),{value:r}=(0,i6.default)(async()=>{let r=await t.getEntityByRef(e),n=r?.metadata.annotations?.["backstage.io/time-saved"];if(!r||!n)return;let i=nH.dw.fromISO(n).as("minutes");if(!Number.isNaN(i))return i},[t,e]);return r})(d),x=(0,tZ.useCallback)(async e=>{await l(e),u.captureEvent("create","Task has been created",{value:b,attributes:{templateSteps:y?.steps?.length??0}})},[l,u,b,y]);return((0,tZ.useEffect)(()=>{g&&f.post(Error(`Failed to load template, ${g}`))},[g,f]),g)?c.onError(g):(0,v.jsxs)(rq.U,{children:[p&&(0,v.jsx)(rF.k,{}),y&&(0,v.jsx)(i3.n,{title:i??y.title,subheader:(0,v.jsx)(rV.h,{className:h.markdown,linkTarget:"_blank",content:o??y.description??n("workflow.noDescription")}),noPadding:!0,titleTypographyProps:{component:"h2"},children:(0,v.jsx)(pj,{manifest:y,onCreate:x,...c})})]})},pO=(0,rI.A)(e=>({button:{color:e.page.fontColor}}));function pM(e){let{editUrl:t}=e,r=pO(),[n,i]=(0,tZ.useState)(),{t:o}=(0,rK.i)(nt.W);return t?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(rG.A,{id:"long-menu","aria-label":"more","aria-controls":"long-menu","aria-expanded":!!n,"aria-haspopup":"true",role:"button",onClick:e=>{i(e.currentTarget)},"data-testid":"menu-button",color:"inherit",className:r.button,children:(0,v.jsx)(r5.default,{})}),(0,v.jsx)(rQ.Ay,{"aria-labelledby":"long-menu",open:!!n,onClose:()=>{i(void 0)},anchorEl:n,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:(0,v.jsx)(rZ.A,{children:(0,v.jsxs)(rX.A,{component:rW.N_,to:t,children:[(0,v.jsx)(rJ.A,{children:(0,v.jsx)(r2.default,{fontSize:"small"})}),(0,v.jsx)(rY.A,{primary:o("templateWizardPage.pageContextMenu.editConfigurationTitle")})]})})})]}):null}var pP=r(31766);class pT{static create(e){return new pT(e.type,new Set(e.versions))}#e;#t;constructor(e,t){this.#e=e,this.#t=t}TPublic=void 0;TInternal=void 0;isType=e=>this.#r(e);toInternal=e=>{if(!this.#r(e))throw TypeError(`Invalid opaque type, expected '${this.#e}', but got '${this.#n(e)}'`);if(!this.#t.has(e.version)){let t=Array.from(this.#t).map(this.#i);t.length>1&&(t[t.length-1]=`or ${t[t.length-1]}`);let r=t.length>2?t.join(", "):t.join(" ");throw TypeError(`Invalid opaque type instance, got version ${this.#i(e.version)}, expected ${r}`)}return e};createInstance(e,t){return Object.assign(t,{$$type:this.#e,...e&&{version:e}})}#r(e){return null!==e&&"object"==typeof e&&e.$$type===this.#e}#n(e){return"object"!=typeof e?`<${typeof e}>`:null===e?"<null>":"$$type"in e?String(e.$$type):String(e)}#i=e=>e?`'${e}'`:"undefined"}let pI=pT.create({type:"@backstage/scaffolder/FormDecorator",versions:["v1"]}),p$=()=>{let e=(0,k.gf)(pP.S),t=(0,k.gf)(im.m),{value:r}=(0,rj.A)(()=>e.getFormDecorators(),[]),n=(0,k.Q2)(),i=(0,tZ.useMemo)(()=>{let e=new Map;for(let i of r??[])try{let{decorator:t,deps:r}=pI.toInternal(i),o=Object.entries(r??{}).map(([e,t])=>{let r=n.get(t);if(!r)throw Error(`Failed to resolve apiRef ${t.id} for form decorator ${i.id} it will be disabled`);return[e,r]});e.set(i.id,{decorator:e=>t(e,Object.fromEntries(o))})}catch(e){t.post(e);return}return e},[n,r,t]),o=(0,tZ.useCallback)(async e=>{let r={...e.formState},n={...e.secrets},o=e.manifest?.EXPERIMENTAL_formDecorators;return o&&await Promise.all(o.map(async e=>{let o=i?.get(e.id);o?await o.decorator({setSecrets:e=>{n={...e(n)}},setFormState:e=>{r={...e(r)}},formState:r,input:e.input??{}}):t.post(Error(`Failed to find form decorator ${e.id}`))})),{formState:r,secrets:n}},[i,t]);return(0,tZ.useMemo)(()=>({run:o}),[o])},pD=e=>{let t=(0,rL.S)(rS.rQ),r=(0,rL.S)(rS.bW),{secrets:n}=(0,t9.Z)(),i=(0,k.gf)(rC.z),o=(0,k.gf)(nq.v),[s,a]=(0,tZ.useState)(!1),l=(0,b.Zp)(),{templateName:c,namespace:u}=(0,i2.K)(rS.sP),{t:h}=(0,rK.i)(nt.W),d=(0,nG.U2)({kind:"Template",namespace:u,name:c}),{manifest:f}=i4(d),p=p$(),{value:m}=(0,rj.A)(async()=>{let e=await o.getEntityByRef(d);return e?.metadata.annotations?.[i1.P]},[d,o]),g=(0,tZ.useCallback)(async e=>{if(s)return;a(!0);let{formState:t,secrets:o}=await p.run({formState:e,secrets:n,manifest:f}),{taskId:c}=await i.scaffold({templateRef:d,values:t,secrets:o});l(r({taskId:c}))},[n,p,s,f,l,i,r,d]),y=(0,tZ.useCallback)(()=>(0,v.jsx)(b.C5,{to:t()}),[t]);return(0,v.jsx)(iU.I,{attributes:{entityRef:d},children:(0,v.jsxs)(rH.Y,{themeId:"website",children:[(0,v.jsx)(rU.Y,{pageTitleOverride:h("templateWizardPage.pageTitle"),title:h("templateWizardPage.title"),subtitle:h("templateWizardPage.subtitle"),...e.headerOptions,children:(0,v.jsx)(pM,{editUrl:m})}),s&&(0,v.jsx)(rF.k,{}),(0,v.jsx)(pE,{namespace:u,templateName:c,onCreate:g,components:e.components,onError:y,extensions:e.customFieldExtensions,formProps:e.formProps,layouts:e.layouts})]})})};function pR(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.map(function(e){return"'"+e+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function pN(e){return!!e&&!!e[mS]}function p_(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===mj}(e)||Array.isArray(e)||!!e[mA]||!!(null==(t=e.constructor)?void 0:t[mA])||pW(e)||pV(e))}function pL(e,t,r){void 0===r&&(r=!1),0===pF(e)?(r?Object.keys:mC)(e).forEach(function(n){r&&"symbol"==typeof n||t(n,e[n],e)}):e.forEach(function(r,n){return t(n,r,e)})}function pF(e){var t=e[mS];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:pW(e)?2:3*!!pV(e)}function pB(e,t){return 2===pF(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function pz(e,t,r){var n=pF(e);2===n?e.set(t,r):3===n?e.add(r):e[t]=r}function pW(e){return mb&&e instanceof Map}function pV(e){return mx&&e instanceof Set}function pH(e){return e.o||e.t}function pU(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=mE(e);delete t[mS];for(var r=mC(t),n=0;n<r.length;n++){var i=r[n],o=t[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function pq(e,t){return void 0===t&&(t=!1),pG(e)||pN(e)||!p_(e)||(pF(e)>1&&(e.set=e.add=e.clear=e.delete=pK),Object.freeze(e),t&&pL(e,function(e,t){return pq(t,!0)},!0)),e}function pK(){pR(2)}function pG(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function pJ(e){var t=mO[e];return t||pR(18,e),t}function pY(e,t){t&&(pJ("Patches"),e.u=[],e.s=[],e.v=t)}function pX(e){pZ(e),e.p.forEach(p0),e.p=null}function pZ(e){e===my&&(my=e.l)}function pQ(e){return my={p:[],l:my,h:e,m:!0,_:0}}function p0(e){var t=e[mS];0===t.i||1===t.i?t.j():t.g=!0}function p1(e,t){t._=t.p.length;var r=t.p[0],n=void 0!==e&&e!==r;return t.h.O||pJ("ES5").S(t,e,n),n?(r[mS].P&&(pX(t),pR(4)),p_(e)&&(e=p2(t,e),t.l||p3(t,e)),t.u&&pJ("Patches").M(r[mS].t,e,t.u,t.s)):e=p2(t,r,[]),pX(t),t.u&&t.v(t.u,t.s),e!==mk?e:void 0}function p2(e,t,r){if(pG(t))return t;var n=t[mS];if(!n)return pL(t,function(i,o){return p4(e,n,t,i,o,r)},!0),t;if(n.A!==e)return t;if(!n.P)return p3(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var i=4===n.i||5===n.i?n.o=pU(n.k):n.o,o=i,s=!1;3===n.i&&(o=new Set(i),i.clear(),s=!0),pL(o,function(t,o){return p4(e,n,i,t,o,r,s)}),p3(e,i,!1),r&&e.u&&pJ("Patches").N(n,r,e.u,e.s)}return n.o}function p4(e,t,r,n,i,o,s){if(pN(i)){var a=p2(e,i,o&&t&&3!==t.i&&!pB(t.R,n)?o.concat(n):void 0);if(pz(r,n,a),!pN(a))return;e.m=!1}else s&&r.add(i);if(p_(i)&&!pG(i)){if(!e.h.D&&e._<1)return;p2(e,i),t&&t.A.l||p3(e,i)}}function p3(e,t,r){void 0===r&&(r=!1),!e.l&&e.h.D&&e.m&&pq(t,r)}function p5(e,t){var r=e[mS];return(r?pH(r):e)[t]}function p6(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function p9(e){e.P||(e.P=!0,e.l&&p9(e.l))}function p8(e){e.o||(e.o=pU(e.t))}function p7(e,t,r){var n,i,o,s,a,l,c,u=pW(t)?pJ("MapSet").F(t,r):pV(t)?pJ("MapSet").T(t,r):e.O?(o=i={i:+!!(n=Array.isArray(t)),A:r?r.A:my,P:!1,I:!1,R:{},l:r,t:t,k:null,o:null,j:null,C:!1},s=mM,n&&(o=[i],s=mP),l=(a=Proxy.revocable(o,s)).revoke,i.k=c=a.proxy,i.j=l,c):pJ("ES5").J(t,r);return(r?r.A:my).p.push(u),u}function me(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return pU(e)}var mt,mr,mn,mi,mo,ms,ma,ml,mc,mu,mh,md,mf,mp,mm,mg,my,mv="u">typeof Symbol&&"symbol"==typeof Symbol("x"),mb="u">typeof Map,mx="u">typeof Set,mw="u">typeof Proxy&&void 0!==Proxy.revocable&&"u">typeof Reflect,mk=mv?Symbol.for("immer-nothing"):((mg={})["immer-nothing"]=!0,mg),mA=mv?Symbol.for("immer-draftable"):"__$immer_draftable",mS=mv?Symbol.for("immer-state"):"__$immer_state",mj=""+Object.prototype.constructor,mC="u">typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,mE=Object.getOwnPropertyDescriptors||function(e){var t={};return mC(e).forEach(function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)}),t},mO={},mM={get:function(e,t){if(t===mS)return e;var r,n,i=pH(e);if(!pB(i,t))return(n=p6(i,t))?"value"in n?n.value:null==(r=n.get)?void 0:r.call(e.k):void 0;var o=i[t];return e.I||!p_(o)?o:o===p5(e.t,t)?(p8(e),e.o[t]=p7(e.A.h,o,e)):o},has:function(e,t){return t in pH(e)},ownKeys:function(e){return Reflect.ownKeys(pH(e))},set:function(e,t,r){var n=p6(pH(e),t);if(null==n?void 0:n.set)return n.set.call(e.k,r),!0;if(!e.P){var i=p5(pH(e),t),o=null==i?void 0:i[mS];if(o&&o.t===r)return e.o[t]=r,e.R[t]=!1,!0;if((r===i?0!==r||1/r==1/i:r!=r&&i!=i)&&(void 0!==r||pB(e.t,t)))return!0;p8(e),p9(e)}return e.o[t]===r&&(void 0!==r||t in e.o)||Number.isNaN(r)&&Number.isNaN(e.o[t])||(e.o[t]=r,e.R[t]=!0),!0},deleteProperty:function(e,t){return void 0!==p5(e.t,t)||t in e.t?(e.R[t]=!1,p8(e),p9(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var r=pH(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},defineProperty:function(){pR(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){pR(12)}},mP={};pL(mM,function(e,t){mP[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),mP.deleteProperty=function(e,t){return mP.set.call(this,e,t,void 0)},mP.set=function(e,t,r){return mM.set.call(this,e[0],t,r,e[0])};var mT=new(function(){function e(e){var t=this;this.O=mw,this.D=!0,this.produce=function(e,r,n){if("function"==typeof e&&"function"!=typeof r){var i,o=r;return r=e,function(e){var n=this;void 0===e&&(e=o);for(var i=arguments.length,s=Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];return t.produce(e,function(e){var t;return(t=r).call.apply(t,[n,e].concat(s))})}}if("function"!=typeof r&&pR(6),void 0!==n&&"function"!=typeof n&&pR(7),p_(e)){var s=pQ(t),a=p7(t,e,void 0),l=!0;try{i=r(a),l=!1}finally{l?pX(s):pZ(s)}return"u">typeof Promise&&i instanceof Promise?i.then(function(e){return pY(s,n),p1(e,s)},function(e){throw pX(s),e}):(pY(s,n),p1(i,s))}if(!e||"object"!=typeof e){if(void 0===(i=r(e))&&(i=e),i===mk&&(i=void 0),t.D&&pq(i,!0),n){var c=[],u=[];pJ("Patches").M(e,i,c,u),n(c,u)}return i}pR(21,e)},this.produceWithPatches=function(e,r){if("function"==typeof e)return function(r){for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return t.produceWithPatches(r,function(t){return e.apply(void 0,[t].concat(i))})};var n,i,o=t.produce(e,r,function(e,t){n=e,i=t});return"u">typeof Promise&&o instanceof Promise?o.then(function(e){return[e,n,i]}):[o,n,i]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){p_(e)||pR(8),pN(e)&&(pN(t=e)||pR(22,t),e=function e(t){if(!p_(t))return t;var r,n=t[mS],i=pF(t);if(n){if(!n.P&&(n.i<4||!pJ("ES5").K(n)))return n.t;n.I=!0,r=me(t,i),n.I=!1}else r=me(t,i);return pL(r,function(t,i){var o;n&&(o=n.t,(2===pF(o)?o.get(t):o[t])===i)||pz(r,t,e(i))}),3===i?new Set(r):r}(t));var t,r=pQ(this),n=p7(this,e,void 0);return n[mS].C=!0,pZ(r),n},t.finishDraft=function(e,t){var r=(e&&e[mS]).A;return pY(r,t),p1(void 0,r)},t.setAutoFreeze=function(e){this.D=e},t.setUseProxies=function(e){e&&!mw&&pR(20),this.O=e},t.applyPatches=function(e,t){for(r=t.length-1;r>=0;r--){var r,n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}r>-1&&(t=t.slice(r+1));var i=pJ("Patches").$;return pN(e)?i(e,t):this.produce(e,function(e){return i(e,t)})},e}()),mI=mT.produce;function m$(e,t){switch(t.type){case"INIT":e.steps=t.data.spec.steps.reduce((e,t)=>(e[t.id]={status:"open",id:t.id},e),{}),e.stepLogs=t.data.spec.steps.reduce((e,t)=>(e[t.id]=[],e),{}),e.error=void 0,e.completed=!1,e.task=t.data;return;case"LOGS":{let r=t.data;for(let t of(e.loading&&r.length>0&&(e.loading=!1),r)){let r=`${t.createdAt} ${t.body.message}`;if(!t.body.stepId||!e.steps?.[t.body.stepId])continue;let n=e.stepLogs?.[t.body.stepId],i=e.steps?.[t.body.stepId];i&&t.body.status&&t.body.status!==i.status&&(i.status=t.body.status,"processing"===i.status&&(i.startedAt=t.createdAt),["cancelled","completed","failed"].includes(i.status)&&(i.endedAt=t.createdAt)),n?.push(r)}return}case"COMPLETED":e.completed=!0,e.output=t.data.body.output,e.error=t.data.body.error;return;case"CANCELLED":e.cancelled=!0;return;case"RECOVERED":for(let t in e.cancelled=!1,e.completed=!1,e.output=void 0,e.error=void 0,e.steps)e.steps.hasOwnProperty(t)&&(e.steps[t].startedAt=void 0,e.steps[t].endedAt=void 0,e.steps[t].status="open");return;case"ERROR":e.error=t.data,e.loading=!1,e.completed=!0;return;default:return}}mT.produceWithPatches.bind(mT),mT.setAutoFreeze.bind(mT),mT.setUseProxies.bind(mT),mT.applyPatches.bind(mT),mT.createDraft.bind(mT),mT.finishDraft.bind(mT);let mD=e=>{var t,r;let n=(0,k.gf)(rC.z),[i,o]=(t={cancelled:!1,loading:!0,completed:!1,stepLogs:{},steps:{}},r=(0,tZ.useMemo)(function(){return mI(m$)},[m$]),(0,tZ.useReducer)(r,t,void 0));return(0,tZ.useEffect)(()=>{let t,r,i=!1,s=1,a=!1,l=()=>n.getTask(e).then(c=>{if(i)return;a=c.spec.EXPERIMENTAL_recovery?.EXPERIMENTAL_strategy==="startOver",o({type:"INIT",data:c});let u=n.streamLogs({isTaskRecoverable:a,taskId:e}),h=[];function d(){h.length&&o({type:"LOGS",data:h.splice(0,h.length)})}r=setInterval(d,500),t=u.subscribe({next:e=>{switch(s=1,e.type){case"log":return h.push(e);case"cancelled":o({type:"CANCELLED"});return;case"completion":d(),o({type:"COMPLETED",data:e});return;case"recovered":o({type:"RECOVERED",data:e});return;default:throw Error(`Unhandled event type ${e.type} in observer`)}},error:e=>{d(),e.message||(e.message=`We cannot connect at the moment, trying again in some seconds... Retrying (${s>3?3:s}/3 retries)`),setTimeout(()=>{s+=1,l()},15e3),o({type:"ERROR",data:e})}})},e=>{i||o({type:"ERROR",data:e})});return l(),()=>{!a&&(i=!0,t&&t.unsubscribe(),r&&clearInterval(r))}},[n,o,e]),i};var mR=r(92399),mN=r(55534),m_=r(64118),mL=r(25283),mF=r(86868);let mB=(0,rI.A)(()=>({button:{color:({fontColor:e})=>e}})),mz=e=>{let{cancelEnabled:t,canRetry:r,isRetryableTask:n,logsVisible:i,buttonBarVisible:o,onRetry:s,onStartOver:a,onToggleLogs:l,onToggleButtonBar:c,taskId:u}=e,{getPageTheme:h}=(0,iS.A)(),d=mB({fontColor:h({themeId:"website"}).fontColor}),[f,p]=(0,tZ.useState)(),{t:m}=(0,rK.i)(nt.W),{allowed:g}=(0,r6.J)({permission:r9.Xw,resourceRef:u}),{allowed:y}=(0,r6.J)({permission:r9.X6});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(rG.A,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:e=>{p(e.currentTarget)},"data-testid":"menu-button",className:d.button,children:(0,v.jsx)(r5.default,{})}),(0,v.jsx)(rQ.Ay,{open:!!f,onClose:()=>p(void 0),anchorEl:f,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:(0,v.jsxs)(rZ.A,{children:[(0,v.jsxs)(rX.A,{onClick:()=>l?.(!i),children:[(0,v.jsx)(rJ.A,{children:(0,v.jsx)(mL.default,{fontSize:"small"})}),(0,v.jsx)(rY.A,{primary:m(i?"ongoingTask.contextMenu.hideLogs":"ongoingTask.contextMenu.showLogs")})]}),(0,v.jsxs)(rX.A,{onClick:()=>c?.(!o),children:[(0,v.jsx)(rJ.A,{children:(0,v.jsx)(mF.default,{fontSize:"small"})}),(0,v.jsx)(rY.A,{primary:m(o?"ongoingTask.contextMenu.hideButtonBar":"ongoingTask.contextMenu.showButtonBar")})]}),(0,v.jsxs)(rX.A,{onClick:a,disabled:t||!(g&&y),"data-testid":"start-over-task",children:[(0,v.jsx)(rJ.A,{children:(0,v.jsx)(mN.default,{fontSize:"small"})}),(0,v.jsx)(rY.A,{primary:m("ongoingTask.contextMenu.startOver")})]}),n&&(0,v.jsxs)(rX.A,{onClick:s,disabled:t||!r,"data-testid":"retry-task",children:[(0,v.jsx)(rJ.A,{children:(0,v.jsx)(m_.default,{fontSize:"small"})}),(0,v.jsx)(rY.A,{primary:m("ongoingTask.contextMenu.retry")})]}),(0,v.jsxs)(rX.A,{onClick:e.onCancel,disabled:e.isCancelButtonDisabled,"data-testid":"cancel-task",children:[(0,v.jsx)(rJ.A,{children:(0,v.jsx)(mR.default,{fontSize:"small"})}),(0,v.jsx)(rY.A,{primary:m("ongoingTask.contextMenu.cancel")})]})]})})]})},mW=(0,rI.A)({root:{"&:hover":{textDecoration:"none"}}}),mV=e=>{let{links:t=[]}=e.output,r=mW(),n=(0,n1.n)(),i=(0,rL.S)(iE.s);return(0,v.jsx)(v.Fragment,{children:t.filter(({url:e,entityRef:t})=>e||t).map(({url:e,entityRef:t,title:r,icon:n})=>t?{title:r,icon:n,url:i((0,nG.KU)(t))}:{title:r,icon:n,url:e}).map(({url:e,title:t,icon:i},o)=>{let s=n.getSystemIcon(i)??rD.default;return(0,v.jsx)(rW.N_,{to:e,classes:{root:r.root},children:(0,v.jsx)(iB.A,{startIcon:(0,v.jsx)(s,{}),component:"div",color:"primary",children:t})},o)})})},mH=e=>{let{output:{text:t=[]},index:r,setIndex:n}=e,i=(0,n1.n)();return(0,v.jsx)(v.Fragment,{children:t.filter(({content:e})=>void 0!==e).map(({title:e,icon:t},o)=>{let s=i.getSystemIcon(t)??r1.default;return(0,v.jsx)(iB.A,{startIcon:(0,v.jsx)(s,{}),component:"div",color:"primary",onClick:()=>{r!==o&&n?.(o)},variant:r===o?"outlined":void 0,children:e},o)})})},mU=e=>{let{t}=(0,rK.i)(r8),{output:r}=e,[n,i]=(0,tZ.useState)(void 0);(0,tZ.useEffect)(()=>{if(void 0===n&&r?.text){let e=r.text.findIndex(e=>e.default);i(e>=0?e:0)}},[n,r]);let o=(0,tZ.useMemo)(()=>void 0!==n?r?.text?.[n]:null,[r,n]);if(!r)return null;let s=(r.text||[]).length>1,a=0===(r.links||[]).length&&!s;return(0,v.jsxs)(v.Fragment,{children:[a?null:(0,v.jsx)(rP.A,{paddingBottom:2,"data-testid":"output-box",children:(0,v.jsx)(ns.A,{children:(0,v.jsxs)(rP.A,{padding:2,justifyContent:"center",display:"flex",gridGap:16,flexWrap:"wrap",children:[s&&(0,v.jsx)(mH,{"data-testid":"text-outputs",output:r,index:n,setIndex:i}),(0,v.jsx)(mV,{output:r})]})})}),o?(0,v.jsx)(rP.A,{paddingBottom:2,"data-testid":"text-output-box",children:(0,v.jsx)(i3.n,{title:o.title??t("templateOutputs.title"),noPadding:!0,titleTypographyProps:{component:"h2"},children:(0,v.jsx)(rP.A,{padding:2,height:"100%",children:(0,v.jsx)(rV.h,{content:o.content??""})})})}):null]})};var mq=r(54819),mK=r(78467),mG=r(51767),mJ=r(25711),mY=r(7707),mX=r(9181);let mZ=(0,rI.A)(e=>({root:{color:e.palette.text.disabled},completed:{color:e.palette.status.ok},error:{color:e.palette.status.error}})),mQ=e=>{let t=mZ(),{active:r,completed:n,error:i,skipped:o}=e;return(0,v.jsx)("div",{className:ny()(t.root,{[t.completed]:n,[t.error]:i}),children:r?(0,v.jsx)(mK.A,{size:"20px"}):n?(0,v.jsx)(mY.default,{}):i?(0,v.jsx)(mX.default,{}):o?(0,v.jsx)(mG.default,{}):(0,v.jsx)(mJ.default,{})})};var m0=r(45313);let m1=e=>{let[t,r]=(0,tZ.useState)(""),{step:n}=e,i=(0,tZ.useCallback)(()=>{if(!n.startedAt)return void r("");let e=n.endedAt?nH.c9.fromISO(n.endedAt):nH.c9.local(),t=nH.c9.fromISO(n.startedAt),i=nH.IX.fromDateTimes(t,e).toDuration().valueOf();r(t1()(i,{round:!0}))},[n.endedAt,n.startedAt]);return(0,w.u)(i),(0,m0.A)(i,n.startedAt&&n.endedAt&&t?null:n.startedAt&&n.endedAt?1:1e3),(0,v.jsx)(rT.A,{variant:"caption",children:t})},m2=(0,rI.A)(e=>({failed:{backgroundColor:e.palette.error.main},success:{backgroundColor:e.palette.success.main}})),m4=e=>{let t=m2();return e.isComplete?(0,v.jsx)(i9.A,{variant:"determinate",classes:{bar:e.isError?t.failed:t.success},value:100}):(0,v.jsx)(i9.A,{variant:"indeterminate"})},m3=e=>(0,v.jsxs)(ns.A,{style:{position:"relative",overflow:"hidden"},children:[(0,v.jsx)(m4,{isComplete:e.isComplete??!1,isError:e.isError??!1}),(0,v.jsx)(rP.A,{padding:2,children:(0,v.jsx)(oe.A,{activeStep:e.activeStep,alternativeLabel:!0,variant:"elevation",style:{overflowX:"auto"},children:e.steps.map(e=>{let t="completed"===e.status,r="failed"===e.status,n="processing"===e.status,i="skipped"===e.status;return(0,v.jsx)(i8.A,{children:(0,v.jsx)(mq.A,{children:(0,v.jsxs)(i7.A,{StepIconProps:{completed:t,error:r,active:n,skipped:i},StepIconComponent:mQ,"data-testid":"step-label",children:[(0,v.jsx)(rP.A,{children:e.name}),!i&&(0,v.jsx)(m1,{step:e})]})})},e.id)})})})]});var m5=r(67296);let m6=(0,rI.A)({root:{width:"100%",height:"100%",position:"relative",minHeight:240}}),m9=e=>{let t=m6();return(0,v.jsx)("div",{className:t.root,children:(0,v.jsx)(m5.r,{text:Object.values(e.logs).map(e=>e.join("\n")).filter(Boolean).join("\n")})})};var m8=r(91072);let m7=(0,rI.A)(e=>({contentWrapper:{display:"flex",flexDirection:"column"},buttonBar:{display:"flex",flexDirection:"row",justifyContent:"right"},cancelButton:{marginRight:e.spacing(1)},retryButton:{marginRight:e.spacing(1)},logsVisibilityButton:{marginRight:e.spacing(1)}})),ge=e=>{let{taskId:t}=(0,b.g)(),r=mD(t),{namespace:n,name:i}=r.task?.spec.templateInfo?.entity?.metadata??{};return(0,v.jsx)(iU.I,{attributes:{entityRef:i&&(0,nG.U2)({kind:"template",namespace:n,name:i}),taskId:t},children:(0,v.jsx)(rH.Y,{themeId:"website",children:(0,v.jsx)(gt,{...e})})})};function gt(e){let{taskId:t}=(0,b.g)(),r=(0,rL.S)(rS.sP),n=(0,b.Zp)(),i=(0,ib.s)(),o=(0,k.gf)(rC.z),s=(0,k.gf)(m8.n),a=mD(t),l=m7(),c=(0,tZ.useMemo)(()=>a.task?.spec.steps.map(e=>({...e,...a?.steps?.[e.id]}))??[],[a]),{t:u}=(0,rK.i)(nt.W),[h,d]=(0,tZ.useState)(!1),[f,p]=(0,tZ.useState)(!0),{allowed:m}=(0,r6.J)({permission:r9.lu,resourceRef:t}),{allowed:g}=(0,r6.J)({permission:r9.Xw,resourceRef:t}),{allowed:y}=(0,r6.J)({permission:r9.X6}),w=g&&y;(0,tZ.useEffect)(()=>{a.error&&d(!0)},[a.error]),(0,tZ.useEffect)(()=>{a.completed&&!a.error&&(d(!0),p(!1))},[a.error,a.completed]);let{value:A}=(0,rj.A)(async()=>{let e=a.task?.spec.templateInfo?.entityRef;if(e)return s.forEntity(e).promise},[s,a.task?.spec.templateInfo?.entityRef]),S=(0,tZ.useMemo)(()=>{for(let e=c.length-1;e>=0;e--)if("open"!==c[e].status)return e;return 0},[c]),j=a.task?.spec.EXPERIMENTAL_recovery?.EXPERIMENTAL_strategy==="startOver",C=g&&y&&j,E=(0,tZ.useCallback)(()=>{let{namespace:e,name:t}=a.task?.spec.templateInfo?.entity?.metadata??{},o=a.task?.spec.parameters??{};e&&t&&(i.captureEvent("click","Task has been started over"),n({pathname:r({namespace:e,templateName:t}),search:`?${u_().stringify({formData:JSON.stringify(o)})}`}))},[i,n,a.task?.spec.parameters,a.task?.spec.templateInfo?.entity?.metadata,r]),[,{execute:O}]=(0,x.Y)(async()=>{t&&(i.captureEvent("retried","Template has been retried"),await o.retry?.(t))}),[{status:M},{execute:P}]=(0,x.Y)(async()=>{t&&(i.captureEvent("cancelled","Template has been cancelled"),await o.cancelTask(t))}),T=e.TemplateOutputsComponent??mU,I=!(a.cancelled||a.completed),$=!I||"not-executed"!==M||!m;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(rU.Y,{pageTitleOverride:A?u("ongoingTask.pageTitle.hasTemplateName",{templateName:A.primaryTitle}):u("ongoingTask.pageTitle.noTemplateName"),title:(0,v.jsxs)("div",{children:[u("ongoingTask.title")," ",(0,v.jsx)("code",{children:A?A.primaryTitle:""})]}),subtitle:u("ongoingTask.subtitle",{taskId:t}),children:(0,v.jsx)(mz,{cancelEnabled:I,canRetry:C,isRetryableTask:j,logsVisible:h,buttonBarVisible:f,onStartOver:E,onRetry:O,onToggleLogs:d,onToggleButtonBar:p,taskId:t,onCancel:P,isCancelButtonDisabled:$})}),(0,v.jsxs)(rq.U,{className:l.contentWrapper,children:[a.error?(0,v.jsx)(rP.A,{paddingBottom:2,children:(0,v.jsx)(rB.b,{error:a.error,titleFormat:"markdown",title:a.error.message})}):null,(0,v.jsx)(rP.A,{paddingBottom:2,children:(0,v.jsx)(m3,{steps:c,activeStep:S,isComplete:a.completed,isError:!!a.error})}),(0,v.jsx)(T,{output:a.output}),f?(0,v.jsx)(rP.A,{paddingBottom:2,children:(0,v.jsx)(ns.A,{children:(0,v.jsx)(rP.A,{padding:2,children:(0,v.jsxs)("div",{className:l.buttonBar,children:[(0,v.jsx)(iB.A,{className:l.cancelButton,disabled:!I||"not-executed"!==M&&!j||!m,onClick:P,"data-testid":"cancel-button",children:u("ongoingTask.cancelButtonTitle")}),j&&(0,v.jsx)(iB.A,{className:l.retryButton,disabled:I||!C,onClick:O,"data-testid":"retry-button",children:u("ongoingTask.retryButtonTitle")}),(0,v.jsx)(iB.A,{className:l.logsVisibilityButton,color:"primary",variant:"outlined",onClick:()=>d(!h),children:u(h?"ongoingTask.hideLogsButtonTitle":"ongoingTask.showLogsButtonTitle")}),(0,v.jsx)(iB.A,{variant:"contained",color:"primary",disabled:I||!w,onClick:E,"data-testid":"start-over-button",children:u("ongoingTask.startOverButtonTitle")})]})})})}):null,h?(0,v.jsx)(ns.A,{style:{height:"100%"},children:(0,v.jsx)(rP.A,{padding:2,height:"100%",children:(0,v.jsx)(m9,{logs:a.stepLogs})})}):null]})]})}var gr=r(28966);let gn={"template.yaml":`
apiVersion: scaffolder.backstage.io/v1beta3
# https://backstage.io/docs/features/software-catalog/descriptor-format#kind-template
kind: Template
metadata:
  name: generated-example-template
  title: Scaffolder Example Template
  description: An example template for the scaffolder
spec:
  owner: user:guest
  type: service
  # These parameters are used to generate the input form in the frontend, and are
  # used to gather input data for the execution of the template.
  parameters:
    - title: Fill in some steps
      required:
        - name
      properties:
        name:
          title: Name
          type: string
          description: Unique name of the component
        owner:
          title: Owner
          type: string
          description: Owner of the component
          ui:field: OwnerPicker
          ui:options:
            catalogFilter:
              kind: Group
    - title: Choose a location
      required:
        - repoUrl
      properties:
        repoUrl:
          title: Repository Location
          type: string
          ui:field: RepoUrlPicker
          ui:options:
            allowedHosts:
              - github.com
  steps:
    - id: fetch-base
      name: Fetch Base
      action: fetch:template
      input:
        url: ./skeleton
        values:
          name: \${{parameters.name}}
          owner: \${{parameters.owner}}
          destination: \${{ parameters.repoUrl | parseRepoUrl }}`,"skeleton/README.md":"# This service is named ${{values.name}}!","skeleton/catalog-info.yaml":`apiVersion: backstage.io/v1alpha1
kind: Component
metadata:
  name: \${{values.component_id | dump}}
  {%- if values.description %}
  description: \${{values.description | dump}}
  {%- endif %}
  annotations:
    github.com/project-slug: \${{values.destination.owner + "/" + values.destination.repo}}
    backstage.io/techdocs-ref: dir:.
spec:
  type: service
  lifecycle: experimental
  owner: \${{values.owner | dump}}`};async function gi(e){for(let[t,r]of Object.entries(gn))await e.createFile({name:t,data:r});return e}let go=function(){let e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(t=>{let r=()=>indexedDB.databases().finally(t);e=setInterval(r,100),r()}).finally(()=>clearInterval(e)):Promise.resolve()};function gs(e){return new Promise((t,r)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>r(e.error)})}function ga(){var e;let t;return i||(e="keyval",t=go().then(()=>{let t=indexedDB.open("keyval-store");return t.onupgradeneeded=()=>t.result.createObjectStore(e),gs(t)}),i=(r,n)=>t.then(t=>n(t.transaction(e,r).objectStore(e)))),i}class gl{static key="scalfolder-template-editor-directory";static async getDirectory(){return(await function(e,t=ga()){return t("readonly",t=>gs(t.get(e)))}(gl.key)).handle}static async setDirectory(e){return function(e,t,r=ga()){return r("readwrite",r=>(r.put(t,e),gs(r.transaction)))}(gl.key,e)}}let gc=window.showDirectoryPicker;class gu{path;handle;constructor(e,t){this.path=e,this.handle=t}file(){return this.handle.getFile()}async save(e){let t=await this.handle.createWritable();await t.write(e),await t.close()}}class gh{handle;constructor(e){this.handle=e}async listFiles(){let e=[];for await(let t of this.listDirectoryContents(this.handle))e.push(t);return e}async *listDirectoryContents(e,t=[]){for await(let r of e.values())if("file"===r.kind)yield new gu([...t,r.name].join("/"),r);else if("directory"===r.kind){if(".git"===r.name)continue;yield*this.listDirectoryContents(r,[...t,r.name])}}async createFile(e){let t,{name:r,data:n}=e;if(r.includes("/")){let[e,n]=r.split("/"),i=await this.handle.getDirectoryHandle(e,{create:!0});t=await i.getFileHandle(n,{create:!0})}else t=await this.handle.getFileHandle(r,{create:!0});let i=await t.createWritable();await i.write(n),await i.close()}}class gd{static isSupported(){return!!gc}static fromHandle(e){return new gh(e)}static async requestDirectoryAccess(){if(!gc)throw Error("File system access is not supported");return new gh(await gc())}}function gf(){let{value:e,loading:t,error:r,retry:n}=(0,gr.A)(async()=>{let e=await gl.getDirectory();if(e)return gd.fromHandle(e)},[]),i=(0,tZ.useCallback)(()=>gd.requestDirectoryAccess().then(gl.setDirectory).then(n),[n]);return{directory:e,loading:t,error:r,openDirectory:i,createDirectory:(0,tZ.useCallback)(()=>gd.requestDirectoryAccess().then(gi).then(gl.setDirectory).then(n),[n]),closeDirectory:(0,tZ.useCallback)(()=>gl.setDirectory(void 0).then(n),[n])}}let gp=e=>(e+1)%Number.MAX_SAFE_INTEGER;class gm{#o;#s;#a;#l;constructor(e,t){this.#o=e,this.#s=t}get path(){return this.#o.path}get content(){return this.#a??"This file is too large to be displayed"}updateContent(e){void 0!==this.#a&&(this.#a=e,this.#s())}get dirty(){return this.#a!==this.#l}async save(){void 0!==this.#a&&(await this.#o.save(this.#a),this.#l=this.#a,this.#s())}async reload(){let e=await this.#o.file();if(e.size>1048576){void 0!==this.#a&&(this.#a=void 0,this.#l=void 0,this.#s());return}let t=await e.text();this.#a!==t&&(this.#a=t,this.#l=t,this.#s())}}class gg{#o;#c=new Set;#u=[];#h;constructor(e){this.#o=e}get files(){return this.#u}get selectedFile(){return this.#h}setSelectedFile=e=>{let t=this.#h,r=this.#u.find(t=>t.path===e);t!==r&&(this.#h=r,this.#s())};get dirty(){return this.#u.some(e=>e.dirty)}async save(){await Promise.all(this.#u.map(e=>e.save()))}async reload(){let e=this.#h?.path,t=await this.#o.listFiles(),r=await Promise.all(t.map(async e=>{let t=new gm(e,this.#s);return await t.reload(),t}));this.#u.length=0,this.#u.push(...r),this.setSelectedFile(e),this.#s()}subscribe(e){return this.#c.add(e),()=>{this.#c.delete(e)}}#s=()=>{this.#c.forEach(e=>e())}}let gy=(0,tZ.createContext)(void 0);function gv(){let e=(0,tZ.useContext)(gy),t=function(){let[,e]=(0,tZ.useState)(0);return(0,tZ.useCallback)(()=>{e(gp)},[])}();return(0,tZ.useEffect)(()=>e?.subscribe(t),[e,t]),e}function gb(e){let{directory:t}=e,[{result:r,error:n},{execute:i}]=(0,x.Y)(async e=>{if(!e)return;let t=new gg(e);await t.reload();let r=t.files.find(e=>e.path.match(/\.ya?ml$/));return r&&t.setSelectedFile(r.path),t});return((0,tZ.useEffect)(()=>{i(t)},[i,t]),n)?(0,v.jsx)(rB.b,{error:n}):(0,v.jsx)(gy.Provider,{value:r,children:e.children})}var gx=r(7031);let gw=(0,tZ.createContext)(null);gw.displayName="PanelGroupContext";let gk="data-panel-group-direction",gA="data-panel-group-id",gS="data-resize-handle",gj="data-panel-resize-handle-id",gC=tZ.useLayoutEffect,gE=tQ["useId".toString()],gO="function"==typeof gE?gE:()=>null,gM=0;function gP(e=null){let t=gO(),r=(0,tZ.useRef)(e||t||null);return null===r.current&&(r.current=""+gM++),null!=e?e:r.current}function gT({children:e,className:t="",collapsedSize:r,collapsible:n,defaultSize:i,forwardedRef:o,id:s,maxSize:a,minSize:l,onCollapse:c,onExpand:u,onResize:h,order:d,style:f,tagName:p="div",...m}){let g=(0,tZ.useContext)(gw);if(null===g)throw Error("Panel components must be rendered within a PanelGroup container");let{collapsePanel:y,expandPanel:v,getPanelSize:b,getPanelStyle:x,groupId:w,isPanelCollapsed:k,reevaluatePanelConstraints:A,registerPanel:S,resizePanel:j,unregisterPanel:C}=g,E=gP(s),O=(0,tZ.useRef)({callbacks:{onCollapse:c,onExpand:u,onResize:h},constraints:{collapsedSize:r,collapsible:n,defaultSize:i,maxSize:a,minSize:l},id:E,idIsFromProps:void 0!==s,order:d});(0,tZ.useRef)({didLogMissingDefaultSizeWarning:!1}),gC(()=>{let{callbacks:e,constraints:t}=O.current,o={...t};O.current.id=E,O.current.idIsFromProps=void 0!==s,O.current.order=d,e.onCollapse=c,e.onExpand=u,e.onResize=h,t.collapsedSize=r,t.collapsible=n,t.defaultSize=i,t.maxSize=a,t.minSize=l,(o.collapsedSize!==t.collapsedSize||o.collapsible!==t.collapsible||o.maxSize!==t.maxSize||o.minSize!==t.minSize)&&A(O.current,o)}),gC(()=>{let e=O.current;return S(e),()=>{C(e)}},[d,E,S,C]),(0,tZ.useImperativeHandle)(o,()=>({collapse:()=>{y(O.current)},expand:e=>{v(O.current,e)},getId:()=>E,getSize:()=>b(O.current),isCollapsed:()=>k(O.current),isExpanded:()=>!k(O.current),resize:e=>{j(O.current,e)}}),[y,v,b,k,E,j]);let M=x(O.current,i);return(0,tZ.createElement)(p,{...m,children:e,className:t,id:E,style:{...M,...f},[gA]:w,"data-panel":"","data-panel-collapsible":n||void 0,"data-panel-id":E,"data-panel-size":parseFloat(""+M.flexGrow).toFixed(1)})}let gI=(0,tZ.forwardRef)((e,t)=>(0,tZ.createElement)(gT,{...e,forwardedRef:t}));gT.displayName="Panel",gI.displayName="forwardRef(Panel)";let g$=null,gD=-1,gR=null;function gN(e,t,r){var n,i,s;let a=function(e,t,r){let n=(t&gq)!=0,i=(t&gK)!=0,o=(t&gG)!=0,s=(t&gJ)!=0;if(t){if(n)if(o)return"se-resize";else if(s)return"ne-resize";else return"e-resize";else if(i)if(o)return"sw-resize";else if(s)return"nw-resize";else return"w-resize";else if(o)return"s-resize";else if(s)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}(e,t,0);g$!==a&&(g$=a,null===gR&&(gR=document.createElement("style"),o&&gR.setAttribute("nonce",o),document.head.appendChild(gR)),gD>=0&&(null==(s=gR.sheet)||s.removeRule(gD)),gD=null!=(n=null==(i=gR.sheet)?void 0:i.insertRule(`*{cursor: ${a} !important;}`))?n:-1)}function g_(e){return"keydown"===e.type}function gL(e){return e.type.startsWith("pointer")}function gF(e){return e.type.startsWith("mouse")}function gB(e){if(gL(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(gF(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}let gz=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function gW(e){let t=e.length;for(;t--;){let r=e[t];if(ye(r,"Missing node"),function(e){var t;let r,n=getComputedStyle(e);return"fixed"===n.position||!!("auto"!==n.zIndex&&("static"!==n.position||"flex"===(r=getComputedStyle(null!=(t=gU(e))?t:e).display)||"inline-flex"===r)||1>+n.opacity||"transform"in n&&"none"!==n.transform||"webkitTransform"in n&&"none"!==n.webkitTransform||"mixBlendMode"in n&&"normal"!==n.mixBlendMode||"filter"in n&&"none"!==n.filter||"webkitFilter"in n&&"none"!==n.webkitFilter||"isolation"in n&&"isolate"===n.isolation||gz.test(n.willChange))||"touch"===n.webkitOverflowScrolling}(r))return r}return null}function gV(e){return e&&Number(getComputedStyle(e).zIndex)||0}function gH(e){let t=[];for(;e;)t.push(e),e=gU(e);return t}function gU(e){let{parentNode:t}=e;return t&&t instanceof ShadowRoot?t.host:t}let gq=1,gK=2,gG=4,gJ=8,gY="coarse"===function(){if("function"==typeof matchMedia)return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}(),gX=[],gZ=!1,gQ=new Map,g0=new Map,g1=new Set;function g2(e){let{target:t}=e,{x:r,y:n}=gB(e);gZ=!0,g6({target:t,x:r,y:n}),g8(),gX.length>0&&(g7("down",e),g9(),e.preventDefault(),g5(t)||e.stopImmediatePropagation())}function g4(e){let{x:t,y:r}=gB(e);if(gZ&&"pointerleave"!==e.type&&0===e.buttons&&(gZ=!1,g7("up",e)),!gZ){let{target:n}=e;g6({target:n,x:t,y:r})}g7("move",e),g9(),gX.length>0&&e.preventDefault()}function g3(e){let{target:t}=e,{x:r,y:n}=gB(e);g0.clear(),gZ=!1,gX.length>0&&(e.preventDefault(),g5(t)||e.stopImmediatePropagation()),g7("up",e),g6({target:t,x:r,y:n}),g9(),g8()}function g5(e){let t=e;for(;t;){if(t.hasAttribute(gS))return!0;t=t.parentElement}return!1}function g6({target:e,x:t,y:r}){gX.splice(0);let n=null;(e instanceof HTMLElement||e instanceof SVGElement)&&(n=e),g1.forEach(e=>{let{element:i,hitAreaMargins:o}=e,s=i.getBoundingClientRect(),{bottom:a,left:l,right:c,top:u}=s,h=gY?o.coarse:o.fine;if(t>=l-h&&t<=c+h&&r>=u-h&&r<=a+h){if(null!==n&&document.contains(n)&&i!==n&&!i.contains(n)&&!n.contains(i)&&function(e,t){let r;if(e===t)throw Error("Cannot compare node with itself");let n={a:gH(e),b:gH(t)};for(;n.a.at(-1)===n.b.at(-1);)e=n.a.pop(),t=n.b.pop(),r=e;ye(r,"Stacking order can only be calculated for elements with a common ancestor");let i={a:gV(gW(n.a)),b:gV(gW(n.b))};if(i.a===i.b){let e=r.childNodes,t={a:n.a.at(-1),b:n.b.at(-1)},i=e.length;for(;i--;){let r=e[i];if(r===t.a)return 1;if(r===t.b)return -1}}return Math.sign(i.a-i.b)}(n,i)>0){let e=n,t=!1;for(;e;){var d;if(e.contains(i))break;if(d=e.getBoundingClientRect(),d.x<s.x+s.width&&d.x+d.width>s.x&&d.y<s.y+s.height&&d.y+d.height>s.y){t=!0;break}e=e.parentElement}if(t)return}gX.push(e)}})}function g9(){let e=!1,t=!1;gX.forEach(r=>{let{direction:n}=r;"horizontal"===n?e=!0:t=!0});let r=0;g0.forEach(e=>{r|=e}),e&&t?gN("intersection",r,gZ):e?gN("horizontal",r,gZ):t?gN("vertical",r,gZ):null!==gR&&(document.head.removeChild(gR),g$=null,gR=null,gD=-1)}function g8(){var e;null==(e=s)||e.abort();let t={capture:!0,signal:(s=new AbortController).signal};g1.size&&(gZ?(gX.length>0&&gQ.forEach((e,r)=>{let{body:n}=r;e>0&&(n.addEventListener("contextmenu",g3,t),n.addEventListener("pointerleave",g4,t),n.addEventListener("pointermove",g4,t))}),gQ.forEach((e,r)=>{let{body:n}=r;n.addEventListener("pointerup",g3,t),n.addEventListener("pointercancel",g3,t)})):gQ.forEach((e,r)=>{let{body:n}=r;e>0&&(n.addEventListener("pointerdown",g2,t),n.addEventListener("pointermove",g4,t))}))}function g7(e,t){g1.forEach(r=>{let{setResizeHandlerState:n}=r;n(e,gX.includes(r),t)})}function ye(e,t){if(!e)throw console.error(t),Error(t)}function yt(e,t,r=10){return e.toFixed(r)===t.toFixed(r)?0:e>t?1:-1}function yr(e,t,r=10){return 0===yt(e,t,r)}function yn(e,t,r){return 0===yt(e,t,r)}function yi({panelConstraints:e,panelIndex:t,size:r}){let n=e[t];ye(null!=n,`Panel constraints not found for index ${t}`);let{collapsedSize:i=0,collapsible:o,maxSize:s=100,minSize:a=0}=n;return 0>yt(r,a)&&(r=o&&0>yt(r,(i+a)/2)?i:a),r=parseFloat((r=Math.min(s,r)).toFixed(10))}function yo({delta:e,initialLayout:t,panelConstraints:r,pivotIndices:n,prevLayout:i,trigger:o}){if(yn(e,0))return t;let s=[...t],[a,l]=n;ye(null!=a,"Invalid first pivot index"),ye(null!=l,"Invalid second pivot index");let c=0;if("keyboard"===o){{let n=e<0?l:a,i=r[n];ye(i,`Panel constraints not found for index ${n}`);let{collapsedSize:o=0,collapsible:s,minSize:c=0}=i;if(s){let r=t[n];if(ye(null!=r,`Previous layout not found for panel index ${n}`),yn(r,o)){let t=c-r;yt(t,Math.abs(e))>0&&(e=e<0?0-t:t)}}}{let n=e<0?a:l,i=r[n];ye(i,`No panel constraints found for index ${n}`);let{collapsedSize:o=0,collapsible:s,minSize:c=0}=i;if(s){let r=t[n];if(ye(null!=r,`Previous layout not found for panel index ${n}`),yn(r,c)){let t=r-o;yt(t,Math.abs(e))>0&&(e=e<0?0-t:t)}}}}{let n=e<0?1:-1,i=e<0?l:a,o=0;for(;;){let e=t[i];if(ye(null!=e,`Previous layout not found for panel index ${i}`),o+=yi({panelConstraints:r,panelIndex:i,size:100})-e,(i+=n)<0||i>=r.length)break}let s=Math.min(Math.abs(e),Math.abs(o));e=e<0?0-s:s}{let n=e<0?a:l;for(;n>=0&&n<r.length;){let i=Math.abs(e)-Math.abs(c),o=t[n];ye(null!=o,`Previous layout not found for panel index ${n}`);let a=yi({panelConstraints:r,panelIndex:n,size:o-i});if(!yn(o,a)&&(c+=o-a,s[n]=a,c.toFixed(3).localeCompare(Math.abs(e).toFixed(3),void 0,{numeric:!0})>=0))break;e<0?n--:n++}}if(function(e,t,r){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!yn(e[r],t[r],void 0))return!1;return!0}(i,s))return i;{let n=e<0?l:a,i=t[n];ye(null!=i,`Previous layout not found for panel index ${n}`);let o=i+c,u=yi({panelConstraints:r,panelIndex:n,size:o});if(s[n]=u,!yn(u,o)){let t=o-u,n=e<0?l:a;for(;n>=0&&n<r.length;){let i=s[n];ye(null!=i,`Previous layout not found for panel index ${n}`);let o=yi({panelConstraints:r,panelIndex:n,size:i+t});if(yn(i,o)||(t-=o-i,s[n]=o),yn(t,0))break;e>0?n--:n++}}}return yn(s.reduce((e,t)=>t+e,0),100)?s:i}function ys(e,t=document){return Array.from(t.querySelectorAll(`[${gj}][data-panel-group-id="${e}"]`))}function ya(e,t,r=document){let n=ys(e,r).findIndex(e=>e.getAttribute(gj)===t);return null!=n?n:null}function yl(e,t,r){let n=ya(e,t,r);return null!=n?[n,n+1]:[-1,-1]}function yc(e,t=document){if((t instanceof HTMLElement||"object"==typeof t&&null!==t&&"tagName"in t&&"getAttribute"in t)&&t.dataset.panelGroupId==e)return t;let r=t.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return r||null}function yu(e,t=document){let r=t.querySelector(`[${gj}="${e}"]`);return r||null}function yh(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function yd(e,t){let{x:r,y:n}=gB(t);return"horizontal"===e?r:n}function yf(e,t,r){t.forEach((t,n)=>{let i=e[n];ye(i,`Panel data not found for index ${n}`);let{callbacks:o,constraints:s,id:a}=i,{collapsedSize:l=0,collapsible:c}=s,u=r[a];if(null==u||t!==u){r[a]=t;let{onCollapse:e,onExpand:n,onResize:i}=o;i&&i(t,u),c&&(e||n)&&(n&&(null==u||yr(u,l))&&!yr(t,l)&&n(),e&&(null==u||!yr(u,l))&&yr(t,l)&&e())}})}function yp(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0}function ym(e){try{if("u">typeof localStorage)e.getItem=e=>localStorage.getItem(e),e.setItem=(e,t)=>{localStorage.setItem(e,t)};else throw Error("localStorage not supported in this environment")}catch(t){console.error(t),e.getItem=()=>null,e.setItem=()=>{}}}function yg(e){return`react-resizable-panels:${e}`}function yy(e){return e.map(e=>{let{constraints:t,id:r,idIsFromProps:n,order:i}=e;return n?r:i?`${i}:${JSON.stringify(t)}`:JSON.stringify(t)}).sort((e,t)=>e.localeCompare(t)).join(",")}function yv(e,t){try{let r=yg(e),n=t.getItem(r);if(n){let e=JSON.parse(n);if("object"==typeof e&&null!=e)return e}}catch(e){}return null}function yb(e,t,r,n,i){var o;let s=yg(e),a=yy(t),l=null!=(o=yv(e,i))?o:{};l[a]={expandToSizes:Object.fromEntries(r.entries()),layout:n};try{i.setItem(s,JSON.stringify(l))}catch(e){console.error(e)}}function yx({layout:e,panelConstraints:t}){let r=[...e],n=r.reduce((e,t)=>e+t,0);if(r.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${r.map(e=>`${e}%`).join(", ")}`);if(!yn(n,100)&&r.length>0)for(let e=0;e<t.length;e++){let t=r[e];ye(null!=t,`No layout data found for index ${e}`);let i=100/n*t;r[e]=i}let i=0;for(let e=0;e<t.length;e++){let n=r[e];ye(null!=n,`No layout data found for index ${e}`);let o=yi({panelConstraints:t,panelIndex:e,size:n});n!=o&&(i+=n-o,r[e]=o)}if(!yn(i,0))for(let e=0;e<t.length;e++){let n=r[e];ye(null!=n,`No layout data found for index ${e}`);let o=yi({panelConstraints:t,panelIndex:e,size:n+i});if(n!==o&&(i-=o-n,r[e]=o,yn(i,0)))break}return r}let yw={getItem:e=>(ym(yw),yw.getItem(e)),setItem:(e,t)=>{ym(yw),yw.setItem(e,t)}},yk={};function yA({autoSaveId:e=null,children:t,className:r="",direction:n,forwardedRef:i,id:o=null,onLayout:s=null,keyboardResizeBy:a=null,storage:l=yw,style:c,tagName:u="div",...h}){let d=gP(o),f=(0,tZ.useRef)(null),[p,m]=(0,tZ.useState)(null),[g,y]=(0,tZ.useState)([]),v=function(){let[e,t]=(0,tZ.useState)(0);return(0,tZ.useCallback)(()=>t(e=>e+1),[])}(),b=(0,tZ.useRef)({}),x=(0,tZ.useRef)(new Map),w=(0,tZ.useRef)(0),k=(0,tZ.useRef)({autoSaveId:e,direction:n,dragState:p,id:d,keyboardResizeBy:a,onLayout:s,storage:l}),A=(0,tZ.useRef)({layout:g,panelDataArray:[],panelDataArrayChanged:!1});(0,tZ.useRef)({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),(0,tZ.useImperativeHandle)(i,()=>({getId:()=>k.current.id,getLayout:()=>{let{layout:e}=A.current;return e},setLayout:e=>{let{onLayout:t}=k.current,{layout:r,panelDataArray:n}=A.current,i=yx({layout:e,panelConstraints:n.map(e=>e.constraints)});yh(r,i)||(y(i),A.current.layout=i,t&&t(i),yf(n,i,b.current))}}),[]),gC(()=>{k.current.autoSaveId=e,k.current.direction=n,k.current.dragState=p,k.current.id=d,k.current.onLayout=s,k.current.storage=l}),function({committedValuesRef:e,eagerValuesRef:t,groupId:r,layout:n,panelDataArray:i,panelGroupElement:o,setLayout:s}){(0,tZ.useRef)({didWarnAboutMissingResizeHandle:!1}),gC(()=>{if(!o)return;let e=ys(r,o);for(let t=0;t<i.length-1;t++){let{valueMax:r,valueMin:o,valueNow:s}=function({layout:e,panelsArray:t,pivotIndices:r}){let n=0,i=100,o=0,s=0,a=r[0];return ye(null!=a,"No pivot index found"),t.forEach((e,t)=>{let{constraints:r}=e,{maxSize:l=100,minSize:c=0}=r;t===a?(n=c,i=l):(o+=c,s+=l)}),{valueMax:Math.min(i,100-o),valueMin:Math.max(n,100-s),valueNow:e[a]}}({layout:n,panelsArray:i,pivotIndices:[t,t+1]}),a=e[t];if(null==a);else{let e=i[t];ye(e,`No panel data found for index "${t}"`),a.setAttribute("aria-controls",e.id),a.setAttribute("aria-valuemax",""+Math.round(r)),a.setAttribute("aria-valuemin",""+Math.round(o)),a.setAttribute("aria-valuenow",null!=s?""+Math.round(s):"")}}return()=>{e.forEach((e,t)=>{e.removeAttribute("aria-controls"),e.removeAttribute("aria-valuemax"),e.removeAttribute("aria-valuemin"),e.removeAttribute("aria-valuenow")})}},[r,n,i,o]),(0,tZ.useEffect)(()=>{if(!o)return;let e=t.current;ye(e,"Eager values not found");let{panelDataArray:i}=e;ye(null!=yc(r,o),`No group found for id "${r}"`);let a=ys(r,o);ye(a,`No resize handles found for group id "${r}"`);let l=a.map(e=>{let t=e.getAttribute(gj);ye(t,"Resize handle element has no handle id attribute");let[a,l]=function(e,t,r,n=document){var i,o,s,a;let l=yu(t,n),c=ys(e,n),u=l?c.indexOf(l):-1;return[null!=(i=null==(o=r[u])?void 0:o.id)?i:null,null!=(s=null==(a=r[u+1])?void 0:a.id)?s:null]}(r,t,i,o);if(null==a||null==l)return()=>{};let c=e=>{if(!e.defaultPrevented&&"Enter"===e.key){e.preventDefault();let l=i.findIndex(e=>e.id===a);if(l>=0){let e=i[l];ye(e,`No panel data found for index ${l}`);let a=n[l],{collapsedSize:c=0,collapsible:u,minSize:h=0}=e.constraints;if(null!=a&&u){let e=yo({delta:yn(a,c)?h-c:c-a,initialLayout:n,panelConstraints:i.map(e=>e.constraints),pivotIndices:yl(r,t,o),prevLayout:n,trigger:"keyboard"});n!==e&&s(e)}}}};return e.addEventListener("keydown",c),()=>{e.removeEventListener("keydown",c)}});return()=>{l.forEach(e=>e())}},[o,e,t,r,n,i,s])}({committedValuesRef:k,eagerValuesRef:A,groupId:d,layout:g,panelDataArray:A.current.panelDataArray,setLayout:y,panelGroupElement:f.current}),(0,tZ.useEffect)(()=>{let{panelDataArray:t}=A.current;if(e){if(0===g.length||g.length!==t.length)return;let r=yk[e];null==r&&(r=function(e,t=10){let r=null;return(...n)=>{null!==r&&clearTimeout(r),r=setTimeout(()=>{e(...n)},t)}}(yb,100),yk[e]=r),r(e,[...t],new Map(x.current),g,l)}},[e,g,l]),(0,tZ.useEffect)(()=>{});let S=(0,tZ.useCallback)(e=>{let{onLayout:t}=k.current,{layout:r,panelDataArray:n}=A.current;if(e.constraints.collapsible){let i=n.map(e=>e.constraints),{collapsedSize:o=0,panelSize:s,pivotIndices:a}=yC(n,e,r);if(ye(null!=s,`Panel size not found for panel "${e.id}"`),!yr(s,o)){x.current.set(e.id,s);let l=yo({delta:yj(n,e)===n.length-1?s-o:o-s,initialLayout:r,panelConstraints:i,pivotIndices:a,prevLayout:r,trigger:"imperative-api"});yp(r,l)||(y(l),A.current.layout=l,t&&t(l),yf(n,l,b.current))}}},[]),j=(0,tZ.useCallback)((e,t)=>{let{onLayout:r}=k.current,{layout:n,panelDataArray:i}=A.current;if(e.constraints.collapsible){let o=i.map(e=>e.constraints),{collapsedSize:s=0,panelSize:a=0,minSize:l=0,pivotIndices:c}=yC(i,e,n),u=null!=t?t:l;if(yr(a,s)){let t=x.current.get(e.id),s=null!=t&&t>=u?t:u,l=yo({delta:yj(i,e)===i.length-1?a-s:s-a,initialLayout:n,panelConstraints:o,pivotIndices:c,prevLayout:n,trigger:"imperative-api"});yp(n,l)||(y(l),A.current.layout=l,r&&r(l),yf(i,l,b.current))}}},[]),C=(0,tZ.useCallback)(e=>{let{layout:t,panelDataArray:r}=A.current,{panelSize:n}=yC(r,e,t);return ye(null!=n,`Panel size not found for panel "${e.id}"`),n},[]),E=(0,tZ.useCallback)((e,t)=>{let{panelDataArray:r}=A.current,n=yj(r,e);return function({defaultSize:e,dragState:t,layout:r,panelData:n,panelIndex:i,precision:o=3}){let s=r[i];return{flexBasis:0,flexGrow:null==s?void 0!=e?e.toFixed(o):"1":1===n.length?"1":s.toFixed(o),flexShrink:1,overflow:"hidden",pointerEvents:null!==t?"none":void 0}}({defaultSize:t,dragState:p,layout:g,panelData:r,panelIndex:n})},[p,g]),O=(0,tZ.useCallback)(e=>{let{layout:t,panelDataArray:r}=A.current,{collapsedSize:n=0,collapsible:i,panelSize:o}=yC(r,e,t);return ye(null!=o,`Panel size not found for panel "${e.id}"`),!0===i&&yr(o,n)},[]),M=(0,tZ.useCallback)(e=>{let{layout:t,panelDataArray:r}=A.current,{collapsedSize:n=0,collapsible:i,panelSize:o}=yC(r,e,t);return ye(null!=o,`Panel size not found for panel "${e.id}"`),!i||yt(o,n)>0},[]),P=(0,tZ.useCallback)(e=>{let{panelDataArray:t}=A.current;t.push(e),t.sort((e,t)=>{let r=e.order,n=t.order;return null==r&&null==n?0:null==r?-1:null==n?1:r-n}),A.current.panelDataArrayChanged=!0,v()},[v]);gC(()=>{if(A.current.panelDataArrayChanged){A.current.panelDataArrayChanged=!1;let{autoSaveId:r,onLayout:n,storage:i}=k.current,{layout:o,panelDataArray:s}=A.current,a=null;if(r){var e,t;let n=null!=(t=(null!=(e=yv(r,i))?e:{})[yy(s)])?t:null;n&&(x.current=new Map(Object.entries(n.expandToSizes)),a=n.layout)}null==a&&(a=function({panelDataArray:e}){let t=Array(e.length),r=e.map(e=>e.constraints),n=0,i=100;for(let o=0;o<e.length;o++){let e=r[o];ye(e,`Panel constraints not found for index ${o}`);let{defaultSize:s}=e;null!=s&&(n++,t[o]=s,i-=s)}for(let o=0;o<e.length;o++){let s=r[o];ye(s,`Panel constraints not found for index ${o}`);let{defaultSize:a}=s;if(null!=a)continue;let l=i/(e.length-n);n++,t[o]=l,i-=l}return t}({panelDataArray:s}));let l=yx({layout:a,panelConstraints:s.map(e=>e.constraints)});yh(o,l)||(y(l),A.current.layout=l,n&&n(l),yf(s,l,b.current))}}),gC(()=>{let e=A.current;return()=>{e.layout=[]}},[]);let T=(0,tZ.useCallback)(e=>{let t=!1,r=f.current;return r&&"rtl"===window.getComputedStyle(r,null).getPropertyValue("direction")&&(t=!0),function(r){var n,i;r.preventDefault();let o=f.current;if(!o)return()=>null;let{direction:s,dragState:a,id:l,keyboardResizeBy:c,onLayout:u}=k.current,{layout:h,panelDataArray:d}=A.current,{initialLayout:p}=null!=a?a:{},m=yl(l,e,o),g=function(e,t,r,n,i,o){if(g_(e)){let t="horizontal"===r,n=0;n=e.shiftKey?100:null!=i?i:10;let o=0;switch(e.key){case"ArrowDown":o=t?0:n;break;case"ArrowLeft":o=t?-n:0;break;case"ArrowRight":o=t?n:0;break;case"ArrowUp":o=t?0:-n;break;case"End":o=100;break;case"Home":o=-100}return o}return null==n?0:function(e,t,r,n,i){let o="horizontal"===r,s=yu(t,i);ye(s,`No resize handle element found for id "${t}"`);let a=s.getAttribute(gA);ye(a,"Resize handle element has no group id attribute");let{initialCursorPosition:l}=n,c=yd(r,e),u=yc(a,i);ye(u,`No group element found for id "${a}"`);let h=u.getBoundingClientRect();return(c-l)/(o?h.width:h.height)*100}(e,t,r,n,o)}(r,e,s,a,c,o),v="horizontal"===s;v&&t&&(g=-g);let x=yo({delta:g,initialLayout:null!=p?p:h,panelConstraints:d.map(e=>e.constraints),pivotIndices:m,prevLayout:h,trigger:g_(r)?"keyboard":"mouse-or-touch"}),S=!yp(h,x);(gL(r)||gF(r))&&w.current!=g&&((w.current=g,S||0===g)?g0.set(e,0):v?(n=g<0?gq:gK,g0.set(e,n)):(i=g<0?gG:gJ,g0.set(e,i))),S&&(y(x),A.current.layout=x,u&&u(x),yf(d,x,b.current))}},[]),I=(0,tZ.useCallback)((e,t)=>{let{onLayout:r}=k.current,{layout:n,panelDataArray:i}=A.current,o=i.map(e=>e.constraints),{panelSize:s,pivotIndices:a}=yC(i,e,n);ye(null!=s,`Panel size not found for panel "${e.id}"`);let l=yo({delta:yj(i,e)===i.length-1?s-t:t-s,initialLayout:n,panelConstraints:o,pivotIndices:a,prevLayout:n,trigger:"imperative-api"});yp(n,l)||(y(l),A.current.layout=l,r&&r(l),yf(i,l,b.current))},[]),$=(0,tZ.useCallback)((e,t)=>{let{layout:r,panelDataArray:n}=A.current,{collapsedSize:i=0,collapsible:o}=t,{collapsedSize:s=0,collapsible:a,maxSize:l=100,minSize:c=0}=e.constraints,{panelSize:u}=yC(n,e,r);null!=u&&(o&&a&&yr(u,i)?yr(i,s)||I(e,s):u<c?I(e,c):u>l&&I(e,l))},[I]),D=(0,tZ.useCallback)((e,t)=>{let{direction:r}=k.current,{layout:n}=A.current;if(!f.current)return;let i=yu(e,f.current);ye(i,`Drag handle element not found for id "${e}"`);let o=yd(r,t);m({dragHandleId:e,dragHandleRect:i.getBoundingClientRect(),initialCursorPosition:o,initialLayout:n})},[]),R=(0,tZ.useCallback)(()=>{m(null)},[]),N=(0,tZ.useCallback)(e=>{let{panelDataArray:t}=A.current,r=yj(t,e);r>=0&&(t.splice(r,1),delete b.current[e.id],A.current.panelDataArrayChanged=!0,v())},[v]),_=(0,tZ.useMemo)(()=>({collapsePanel:S,direction:n,dragState:p,expandPanel:j,getPanelSize:C,getPanelStyle:E,groupId:d,isPanelCollapsed:O,isPanelExpanded:M,reevaluatePanelConstraints:$,registerPanel:P,registerResizeHandle:T,resizePanel:I,startDragging:D,stopDragging:R,unregisterPanel:N,panelGroupElement:f.current}),[S,p,n,j,C,E,d,O,M,$,P,T,I,D,R,N]);return(0,tZ.createElement)(gw.Provider,{value:_},(0,tZ.createElement)(u,{...h,children:t,className:r,id:o,ref:f,style:{display:"flex",flexDirection:"horizontal"===n?"row":"column",height:"100%",overflow:"hidden",width:"100%",...c},"data-panel-group":"",[gk]:n,[gA]:d}))}let yS=(0,tZ.forwardRef)((e,t)=>(0,tZ.createElement)(yA,{...e,forwardedRef:t}));function yj(e,t){return e.findIndex(e=>e===t||e.id===t.id)}function yC(e,t,r){let n=yj(e,t),i=n===e.length-1,o=r[n];return{...t.constraints,panelSize:o,pivotIndices:i?[n-1,n]:[n,n+1]}}function yE({children:e=null,className:t="",disabled:r=!1,hitAreaMargins:n,id:i,onBlur:o,onClick:s,onDragging:a,onFocus:l,onPointerDown:c,onPointerUp:u,style:h={},tabIndex:d=0,tagName:f="div",...p}){var m,g;let y=(0,tZ.useRef)(null),v=(0,tZ.useRef)({onClick:s,onDragging:a,onPointerDown:c,onPointerUp:u});(0,tZ.useEffect)(()=>{v.current.onClick=s,v.current.onDragging=a,v.current.onPointerDown=c,v.current.onPointerUp=u});let b=(0,tZ.useContext)(gw);if(null===b)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");let{direction:x,groupId:w,registerResizeHandle:k,startDragging:A,stopDragging:S,panelGroupElement:j}=b,C=gP(i),[E,O]=(0,tZ.useState)("inactive"),[M,P]=(0,tZ.useState)(!1),[T,I]=(0,tZ.useState)(null),$=(0,tZ.useRef)({state:E});gC(()=>{$.current.state=E}),(0,tZ.useEffect)(()=>{if(r)I(null);else{let e=k(C);I(()=>e)}},[r,C,k]);let D=null!=(m=null==n?void 0:n.coarse)?m:15,R=null!=(g=null==n?void 0:n.fine)?g:5;return(0,tZ.useEffect)(()=>{if(r||null==T)return;let e=y.current;ye(e,"Element ref not attached");let t=!1;return function(e,t,r,n,i){var o;let{ownerDocument:s}=t,a={direction:r,element:t,hitAreaMargins:n,setResizeHandlerState:i},l=null!=(o=gQ.get(s))?o:0;return gQ.set(s,l+1),g1.add(a),g8(),function(){var t;g0.delete(e),g1.delete(a);let r=null!=(t=gQ.get(s))?t:1;if(gQ.set(s,r-1),g8(),1===r&&gQ.delete(s),gX.includes(a)){let e=gX.indexOf(a);e>=0&&gX.splice(e,1),g9(),i("up",!0,null)}}}(C,e,x,{coarse:D,fine:R},(e,r,n)=>{if(!r)return void O("inactive");switch(e){case"down":{O("drag"),t=!1,ye(n,'Expected event to be defined for "down" action'),A(C,n);let{onDragging:e,onPointerDown:r}=v.current;null==e||e(!0),null==r||r();break}case"move":{let{state:e}=$.current;t=!0,"drag"!==e&&O("hover"),ye(n,'Expected event to be defined for "move" action'),T(n);break}case"up":{O("hover"),S();let{onClick:e,onDragging:r,onPointerUp:n}=v.current;null==r||r(!1),null==n||n(),t||null==e||e()}}})},[D,x,r,R,k,C,T,A,S]),!function({disabled:e,handleId:t,resizeHandler:r,panelGroupElement:n}){(0,tZ.useEffect)(()=>{if(e||null==r||null==n)return;let i=yu(t,n);if(null==i)return;let o=e=>{if(!e.defaultPrevented)switch(e.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":e.preventDefault(),r(e);break;case"F6":{e.preventDefault();let r=i.getAttribute(gA);ye(r,`No group element found for id "${r}"`);let o=ys(r,n),s=ya(r,t,n);ye(null!==s,`No resize element found for id "${t}"`);let a=e.shiftKey?s>0?s-1:o.length-1:s+1<o.length?s+1:0;o[a].focus()}}};return i.addEventListener("keydown",o),()=>{i.removeEventListener("keydown",o)}},[n,e,t,r])}({disabled:r,handleId:C,resizeHandler:T,panelGroupElement:j}),(0,tZ.createElement)(f,{...p,children:e,className:t,id:i,onBlur:()=>{P(!1),null==o||o()},onFocus:()=>{P(!0),null==l||l()},ref:y,role:"separator",style:{touchAction:"none",userSelect:"none",...h},tabIndex:d,[gk]:x,[gA]:w,[gS]:"","data-resize-handle-active":"drag"===E?"pointer":M?"keyboard":void 0,"data-panel-resize-handle-enabled":!r,[gj]:C,"data-resize-handle-state":E})}yA.displayName="PanelGroup",yS.displayName="forwardRef(PanelGroup)",yE.displayName="PanelResizeHandle";let yO=(0,gx.A)(e=>({root:{height:"100%",gridArea:"pageContent",display:"grid",gridTemplateAreas:`
      "toolbar"
      "browser"
      "editor"
      "preview"
      "results"
    `,[e.breakpoints.up("md")]:{gridTemplateAreas:`
      "toolbar toolbar toolbar"
      "browser editor preview"
      "results results results"
    `,gridTemplateColumns:"1fr 5fr",gridTemplateRows:"auto 1fr auto"}}}),{name:"ScaffolderTemplateEditorLayout"})(({children:e,classes:t})=>(0,v.jsx)("main",{className:t.root,children:e})),yM=(0,gx.A)({root:{gridArea:"toolbar"}},{name:"ScaffolderTemplateEditorLayoutToolbar"})(({children:e,classes:t})=>(0,v.jsx)("section",{className:t.root,children:e})),yP=(0,gx.A)(e=>({root:{gridArea:"browser",overflow:"auto",[e.breakpoints.up("md")]:{borderRight:`1px solid ${e.palette.divider}`}}}),{name:"ScaffolderTemplateEditorLayoutBrowser"})(({children:e,classes:t})=>(0,v.jsx)("section",{className:t.root,children:e})),yT=(0,gx.A)(e=>({root:{gridArea:"editor",overflow:"auto",[e.breakpoints.up("md")]:{height:"100%"}}}),{name:"ScaffolderTemplateEditorLayoutFiles"})(({children:e,classes:t})=>(0,v.jsx)("section",{className:t.root,children:e})),yI=(0,gx.A)(e=>({root:{gridArea:"preview",position:"relative",backgroundColor:e.palette.background.default,[e.breakpoints.up("md")]:{height:"100%"}},scroll:{height:"100%",padding:e.spacing(1),[e.breakpoints.up("md")]:{position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"auto"}}}),{name:"ScaffolderTemplateEditorLayoutPreview"})(({children:e,classes:t})=>(0,v.jsx)("section",{className:t.root,children:(0,v.jsx)("div",{className:t.scroll,children:e})})),y$=(0,gx.A)({root:{gridArea:"results"}},{name:"ScaffolderTemplateEditorLayoutConsole"})(({children:e,classes:t})=>(0,v.jsx)("section",{className:t.root,children:e})),yD=(0,gx.A)({root:{width:8,cursor:"col-resize",background:"rgba(0,0,0,0.04)"}},{name:"ScaffolderTemplateEditorPanelResizeHandle"})(({classes:e})=>(0,v.jsx)(yE,{className:e.root}));function yR({files:e,preview:t,autoSaveId:r="template-editor-panels"}){let n=(0,iS.A)();return(0,iG.A)(n.breakpoints.up("md"))?(0,v.jsxs)(yS,{direction:"horizontal",autoSaveId:r,children:[(0,v.jsx)(gI,{minSize:15,defaultSize:50,children:e}),(0,v.jsx)(yD,{}),(0,v.jsx)(gI,{minSize:15,defaultSize:50,children:t})]}):(0,v.jsxs)(v.Fragment,{children:[e,t]})}var yN=r(16679),y_=r(75173),yL=r(91413),yF=r(73845),yB=r(76891),yz=r(61477),yW=r(46805),yV=r(59461),yH=r(93453),yU=r(17400),yq=r(64402),yK=r(89575),yG=r(17502);let yJ=[],yY=[],yX="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<yX.length;e++)(e%2?yY:yJ).push(t+=yX[e]);function yZ(e){return e>=127462&&e<=127487}function yQ(e,t,r){if(t==e.length)return t;t&&y1(e.charCodeAt(t))&&y2(e.charCodeAt(t-1))&&t--;let n=y0(e,t);for(t+=y4(n);t<e.length;){let i=y0(e,t);if(8205==n||8205==i||r&&function(e){if(e<768)return!1;for(let t=0,r=yJ.length;;){let n=t+r>>1;if(e<yJ[n])r=n;else{if(!(e>=yY[n]))return!0;t=n+1}if(t==r)return!1}}(i))t+=y4(i),n=i;else if(yZ(i)){let r=0,n=t-2;for(;n>=0&&yZ(y0(e,n));)r++,n-=2;if(r%2==0)break;t+=2}else break}return t}function y0(e,t){let r=e.charCodeAt(t);if(!y2(r)||t+1==e.length)return r;let n=e.charCodeAt(t+1);return y1(n)?(r-55296<<10)+(n-56320)+65536:r}function y1(e){return e>=56320&&e<57344}function y2(e){return e>=55296&&e<56320}function y4(e){return e<65536?1:2}class y3{lineAt(e){if(e<0||e>this.length)throw RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,r){[e,t]=vr(this,e,t);let n=[];return this.decompose(0,e,n,2),r.length&&r.decompose(0,r.length,n,3),this.decompose(t,this.length,n,1),y6.from(n,this.length-(t-e)+r.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=vr(this,e,t);let r=[];return this.decompose(e,t,r,0),y6.from(r,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),r=this.length-this.scanIdentical(e,-1),n=new y8(this),i=new y8(e);for(let e=t,o=t;;){if(n.next(e),i.next(e),e=0,n.lineBreak!=i.lineBreak||n.done!=i.done||n.value!=i.value)return!1;if(o+=n.value.length,n.done||o>=r)return!0}}iter(e=1){return new y8(this,e)}iterRange(e,t=this.length){return new y7(this,e,t)}iterLines(e,t){let r;if(null==e)r=this.iter();else{null==t&&(t=this.lines+1);let n=this.line(e).from;r=this.iterRange(n,Math.max(n,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new ve(r)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}static of(e){if(0==e.length)throw RangeError("A document must have at least one line");return 1!=e.length||e[0]?e.length<=32?new y5(e):y6.from(y5.split(e,[])):y3.empty}}class y5 extends y3{constructor(e,t=function(e){let t=-1;for(let r of e)t+=r.length+1;return t}(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,r,n){for(let i=0;;i++){let o=this.text[i],s=n+o.length;if((t?r:s)>=e)return new vt(n,s,r,o);n=s+1,r++}}decompose(e,t,r,n){var i;let o=e<=0&&t>=this.length?this:new y5((i=this.text,y9(i,[""],e,t)),Math.min(t,this.length)-Math.max(0,e));if(1&n){let e=r.pop(),t=y9(o.text,e.text.slice(),0,o.length);if(t.length<=32)r.push(new y5(t,e.length+o.length));else{let e=t.length>>1;r.push(new y5(t.slice(0,e)),new y5(t.slice(e)))}}else r.push(o)}replace(e,t,r){var n;if(!(r instanceof y5))return super.replace(e,t,r);[e,t]=vr(this,e,t);let i=y9(this.text,y9(r.text,(n=this.text,y9(n,[""],0,e))),t),o=this.length+r.length-(t-e);return i.length<=32?new y5(i,o):y6.from(y5.split(i,[]),o)}sliceString(e,t=this.length,r="\n"){[e,t]=vr(this,e,t);let n="";for(let i=0,o=0;i<=t&&o<this.text.length;o++){let s=this.text[o],a=i+s.length;i>e&&o&&(n+=r),e<a&&t>i&&(n+=s.slice(Math.max(0,e-i),t-i)),i=a+1}return n}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let r=[],n=-1;for(let i of e)r.push(i),n+=i.length+1,32==r.length&&(t.push(new y5(r,n)),r=[],n=-1);return n>-1&&t.push(new y5(r,n)),t}}class y6 extends y3{constructor(e,t){for(let r of(super(),this.children=e,this.length=t,this.lines=0,e))this.lines+=r.lines}lineInner(e,t,r,n){for(let i=0;;i++){let o=this.children[i],s=n+o.length,a=r+o.lines-1;if((t?a:s)>=e)return o.lineInner(e,t,r,n);n=s+1,r=a+1}}decompose(e,t,r,n){for(let i=0,o=0;o<=t&&i<this.children.length;i++){let s=this.children[i],a=o+s.length;if(e<=a&&t>=o){let i=n&(o<=e|2*(a>=t));o>=e&&a<=t&&!i?r.push(s):s.decompose(e-o,t-o,r,i)}o=a+1}}replace(e,t,r){if([e,t]=vr(this,e,t),r.lines<this.lines)for(let n=0,i=0;n<this.children.length;n++){let o=this.children[n],s=i+o.length;if(e>=i&&t<=s){let a=o.replace(e-i,t-i,r),l=this.lines-o.lines+a.lines;if(a.lines<l>>4&&a.lines>l>>6){let i=this.children.slice();return i[n]=a,new y6(i,this.length-(t-e)+r.length)}return super.replace(i,s,a)}i=s+1}return super.replace(e,t,r)}sliceString(e,t=this.length,r="\n"){[e,t]=vr(this,e,t);let n="";for(let i=0,o=0;i<this.children.length&&o<=t;i++){let s=this.children[i],a=o+s.length;o>e&&i&&(n+=r),e<a&&t>o&&(n+=s.sliceString(e-o,t-o,r)),o=a+1}return n}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof y6))return 0;let r=0,[n,i,o,s]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;n+=t,i+=t){if(n==o||i==s)return r;let a=this.children[n],l=e.children[i];if(a!=l)return r+a.scanIdentical(l,t);r+=a.length+1}}static from(e,t=e.reduce((e,t)=>e+t.length+1,-1)){let r=0;for(let t of e)r+=t.lines;if(r<32){let r=[];for(let t of e)t.flatten(r);return new y5(r,t)}let n=Math.max(32,r>>5),i=n<<1,o=n>>1,s=[],a=0,l=-1,c=[];function u(){0!=a&&(s.push(1==c.length?c[0]:y6.from(c,l)),l=-1,a=c.length=0)}for(let t of e)!function e(t){let r;if(t.lines>i&&t instanceof y6)for(let r of t.children)e(r);else t.lines>o&&(a>o||!a)?(u(),s.push(t)):t instanceof y5&&a&&(r=c[c.length-1])instanceof y5&&t.lines+r.lines<=32?(a+=t.lines,l+=t.length+1,c[c.length-1]=new y5(r.text.concat(t.text),r.length+1+t.length)):(a+t.lines>n&&u(),a+=t.lines,l+=t.length+1,c.push(t))}(t);return u(),1==s.length?s[0]:new y6(s,t)}}function y9(e,t,r=0,n=1e9){for(let i=0,o=0,s=!0;o<e.length&&i<=n;o++){let a=e[o],l=i+a.length;l>=r&&(l>n&&(a=a.slice(0,n-i)),i<r&&(a=a.slice(r-i)),s?(t[t.length-1]+=a,s=!1):t.push(a)),i=l+1}return t}y3.empty=new y5([""],0);class y8{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof y5?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let r=this.nodes.length-1,n=this.nodes[r],i=this.offsets[r],o=i>>1,s=n instanceof y5?n.text.length:n.children.length;if(o==(t>0?s:0)){if(0==r)return this.done=!0,this.value="",this;t>0&&this.offsets[r-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&i)==(t>0?0:1)){if(this.offsets[r]+=t,0==e)return this.lineBreak=!0,this.value="\n",this;e--}else if(n instanceof y5){let i=n.text[o+(t<0?-1:0)];if(this.offsets[r]+=t,i.length>Math.max(0,e))return this.value=0==e?i:t>0?i.slice(e):i.slice(0,i.length-e),this;e-=i.length}else{let i=n.children[o+(t<0?-1:0)];e>i.length?(e-=i.length,this.offsets[r]+=t):(t<0&&this.offsets[r]--,this.nodes.push(i),this.offsets.push(t>0?1:(i instanceof y5?i.text.length:i.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class y7{constructor(e,t,r){this.value="",this.done=!1,this.cursor=new y8(e,t>r?-1:1),this.pos=t>r?e.length:0,this.from=Math.min(t,r),this.to=Math.max(t,r)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let r=t<0?this.pos-this.from:this.to-this.pos;e>r&&(e=r),r-=e;let{value:n}=this.cursor.next(e);return this.pos+=(n.length+e)*t,this.value=n.length<=r?n:t<0?n.slice(n.length-r):n.slice(0,r),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class ve{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:r,value:n}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):r?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}"u">typeof Symbol&&(y3.prototype[Symbol.iterator]=function(){return this.iter()},y8.prototype[Symbol.iterator]=y7.prototype[Symbol.iterator]=ve.prototype[Symbol.iterator]=function(){return this});class vt{constructor(e,t,r,n){this.from=e,this.to=t,this.number=r,this.text=n}get length(){return this.to-this.from}}function vr(e,t,r){return[t=Math.max(0,Math.min(e.length,t)),Math.max(t,Math.min(e.length,r))]}function vn(e,t,r=!0,n=!0){return function(e,t,r=!0,n=!0){return(r?yQ:function(e,t,r){for(;t>0;){let n=yQ(e,t-2,r);if(n<t)return n;t--}return 0})(e,t,n)}(e,t,r,n)}function vi(e,t){let r=e.charCodeAt(t);if(!(r>=55296&&r<56320)||t+1==e.length)return r;let n=e.charCodeAt(t+1);return n>=56320&&n<57344?(r-55296<<10)+(n-56320)+65536:r}function vo(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(((e-=65536)>>10)+55296,(1023&e)+56320)}function vs(e){return e<65536?1:2}let va=/\r\n?|\n/;var vl=((c=vl||(vl={}))[c.Simple=0]="Simple",c[c.TrackDel=1]="TrackDel",c[c.TrackBefore=2]="TrackBefore",c[c.TrackAfter=3]="TrackAfter",c);class vc{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t+1];e+=r<0?this.sections[t]:r}return e}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(e){for(let t=0,r=0,n=0;t<this.sections.length;){let i=this.sections[t++],o=this.sections[t++];o<0?(e(r,n,i),n+=i):n+=o,r+=i}}iterChangedRanges(e,t=!1){vf(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let r=this.sections[t++],n=this.sections[t++];n<0?e.push(r,n):e.push(n,r)}return new vc(e)}composeDesc(e){return this.empty?e:e.empty?this:vm(this,e)}mapDesc(e,t=!1){return e.empty?this:vp(this,e,t)}mapPos(e,t=-1,r=vl.Simple){let n=0,i=0;for(let o=0;o<this.sections.length;){let s=this.sections[o++],a=this.sections[o++],l=n+s;if(a<0){if(l>e)return i+(e-n);i+=s}else{if(r!=vl.Simple&&l>=e&&(r==vl.TrackDel&&n<e&&l>e||r==vl.TrackBefore&&n<e||r==vl.TrackAfter&&l>e))return null;if(l>e||l==e&&t<0&&!s)return e==n||t<0?i:i+a;i+=a}n=l}if(e>n)throw RangeError(`Position ${e} is out of range for changeset of length ${n}`);return i}touchesRange(e,t=e){for(let r=0,n=0;r<this.sections.length&&n<=t;){let i=this.sections[r++],o=this.sections[r++],s=n+i;if(o>=0&&n<=t&&s>=e)return!(n<e)||!(s>t)||"cover";n=s}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let r=this.sections[t++],n=this.sections[t++];e+=(e?" ":"")+r+(n>=0?":"+n:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(e=>"number"!=typeof e))throw RangeError("Invalid JSON representation of ChangeDesc");return new vc(e)}static create(e){return new vc(e)}}class vu extends vc{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw RangeError("Applying change set to a document with the wrong length");return vf(this,(t,r,n,i,o)=>e=e.replace(n,n+(r-t),o),!1),e}mapDesc(e,t=!1){return vp(this,e,t,!0)}invert(e){let t=this.sections.slice(),r=[];for(let n=0,i=0;n<t.length;n+=2){let o=t[n],s=t[n+1];if(s>=0){t[n]=s,t[n+1]=o;let a=n>>1;for(;r.length<a;)r.push(y3.empty);r.push(o?e.slice(i,i+o):y3.empty)}i+=o}return new vu(t,r)}compose(e){return this.empty?e:e.empty?this:vm(this,e,!0)}map(e,t=!1){return e.empty?this:vp(this,e,t,!0)}iterChanges(e,t=!1){vf(this,e,t)}get desc(){return vc.create(this.sections)}filter(e){let t=[],r=[],n=[],i=new vg(this);t:for(let o=0,s=0;;){let a=o==e.length?1e9:e[o++];for(;s<a||s==a&&0==i.len;){if(i.done)break t;let e=Math.min(i.len,a-s);vh(n,e,-1);let o=-1==i.ins?-1:0==i.off?i.ins:0;vh(t,e,o),o>0&&vd(r,t,i.text),i.forward(e),s+=e}let l=e[o++];for(;s<l;){if(i.done)break t;let e=Math.min(i.len,l-s);vh(t,e,-1),vh(n,e,-1==i.ins?-1:0==i.off?i.ins:0),i.forward(e),s+=e}}return{changes:new vu(t,r),filtered:vc.create(n)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t],n=this.sections[t+1];n<0?e.push(r):0==n?e.push([r]):e.push([r].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,r){let n=[],i=[],o=0,s=null;function a(e=!1){if(!e&&!n.length)return;o<t&&vh(n,t-o,-1);let r=new vu(n,i);s=s?s.compose(r.map(s)):r,n=[],i=[],o=0}return!function e(l){if(Array.isArray(l))for(let t of l)e(t);else if(l instanceof vu){if(l.length!=t)throw RangeError(`Mismatched change set length (got ${l.length}, expected ${t})`);a(),s=s?s.compose(l.map(s)):l}else{let{from:e,to:s=e,insert:c}=l;if(e>s||e<0||s>t)throw RangeError(`Invalid change range ${e} to ${s} (in doc of length ${t})`);let u=c?"string"==typeof c?y3.of(c.split(r||va)):c:y3.empty,h=u.length;if(e==s&&0==h)return;e<o&&a(),e>o&&vh(n,e-o,-1),vh(n,s-e,h),vd(i,n,u),o=s}}(e),a(!s),s}static empty(e){return new vu(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw RangeError("Invalid JSON representation of ChangeSet");let t=[],r=[];for(let n=0;n<e.length;n++){let i=e[n];if("number"==typeof i)t.push(i,-1);else if(!Array.isArray(i)||"number"!=typeof i[0]||i.some((e,t)=>t&&"string"!=typeof e))throw RangeError("Invalid JSON representation of ChangeSet");else if(1==i.length)t.push(i[0],0);else{for(;r.length<n;)r.push(y3.empty);r[n]=y3.of(i.slice(1)),t.push(i[0],r[n].length)}}return new vu(t,r)}static createSet(e,t){return new vu(e,t)}}function vh(e,t,r,n=!1){if(0==t&&r<=0)return;let i=e.length-2;i>=0&&r<=0&&r==e[i+1]?e[i]+=t:i>=0&&0==t&&0==e[i]?e[i+1]+=r:n?(e[i]+=t,e[i+1]+=r):e.push(t,r)}function vd(e,t,r){if(0==r.length)return;let n=t.length-2>>1;if(n<e.length)e[e.length-1]=e[e.length-1].append(r);else{for(;e.length<n;)e.push(y3.empty);e.push(r)}}function vf(e,t,r){let n=e.inserted;for(let i=0,o=0,s=0;s<e.sections.length;){let a=e.sections[s++],l=e.sections[s++];if(l<0)i+=a,o+=a;else{let c=i,u=o,h=y3.empty;for(;c+=a,u+=l,l&&n&&(h=h.append(n[s-2>>1])),!r&&s!=e.sections.length&&!(e.sections[s+1]<0);)a=e.sections[s++],l=e.sections[s++];t(i,c,o,u,h),i=c,o=u}}}function vp(e,t,r,n=!1){let i=[],o=n?[]:null,s=new vg(e),a=new vg(t);for(let e=-1;;)if(s.done&&a.len||a.done&&s.len)throw Error("Mismatched change set lengths");else if(-1==s.ins&&-1==a.ins){let e=Math.min(s.len,a.len);vh(i,e,-1),s.forward(e),a.forward(e)}else if(a.ins>=0&&(s.ins<0||e==s.i||0==s.off&&(a.len<s.len||a.len==s.len&&!r))){let t=a.len;for(vh(i,a.ins,-1);t;){let r=Math.min(s.len,t);s.ins>=0&&e<s.i&&s.len<=r&&(vh(i,0,s.ins),o&&vd(o,i,s.text),e=s.i),s.forward(r),t-=r}a.next()}else if(s.ins>=0){let t=0,r=s.len;for(;r;)if(-1==a.ins){let e=Math.min(r,a.len);t+=e,r-=e,a.forward(e)}else if(0==a.ins&&a.len<r)r-=a.len,a.next();else break;vh(i,t,e<s.i?s.ins:0),o&&e<s.i&&vd(o,i,s.text),e=s.i,s.forward(s.len-r)}else if(s.done&&a.done)return o?vu.createSet(i,o):vc.create(i);else throw Error("Mismatched change set lengths")}function vm(e,t,r=!1){let n=[],i=r?[]:null,o=new vg(e),s=new vg(t);for(let e=!1;;)if(o.done&&s.done)return i?vu.createSet(n,i):vc.create(n);else if(0==o.ins)vh(n,o.len,0,e),o.next();else if(0!=s.len||s.done)if(o.done||s.done)throw Error("Mismatched change set lengths");else{let t=Math.min(o.len2,s.len),r=n.length;if(-1==o.ins){let r=-1==s.ins?-1:s.off?0:s.ins;vh(n,t,r,e),i&&r&&vd(i,n,s.text)}else -1==s.ins?(vh(n,o.off?0:o.len,t,e),i&&vd(i,n,o.textBit(t))):(vh(n,o.off?0:o.len,s.off?0:s.ins,e),i&&!s.off&&vd(i,n,s.text));e=(o.ins>t||s.ins>=0&&s.len>t)&&(e||n.length>r),o.forward2(t),s.forward(t)}else vh(n,0,s.ins,e),i&&vd(i,n,s.text),s.next()}class vg{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return -2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?y3.empty:e[t]}textBit(e){let{inserted:t}=this.set,r=this.i-2>>1;return r>=t.length&&!e?y3.empty:t[r].slice(this.off,null==e?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){-1==this.ins?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class vy{constructor(e,t,r){this.from=e,this.to=t,this.flags=r}get anchor(){return 32&this.flags?this.to:this.from}get head(){return 32&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 8&this.flags?-1:16&this.flags?1:0}get bidiLevel(){let e=7&this.flags;return 7==e?null:e}get goalColumn(){let e=this.flags>>6;return 0xffffff==e?void 0:e}map(e,t=-1){let r,n;return this.empty?r=n=e.mapPos(this.from,t):(r=e.mapPos(this.from,1),n=e.mapPos(this.to,-1)),r==this.from&&n==this.to?this:new vy(r,n,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return vv.range(e,t);let r=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return vv.range(this.anchor,r)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&this.goalColumn==e.goalColumn&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||"number"!=typeof e.anchor||"number"!=typeof e.head)throw RangeError("Invalid JSON representation for SelectionRange");return vv.range(e.anchor,e.head)}static create(e,t,r){return new vy(e,t,r)}}class vv{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:vv.create(this.ranges.map(r=>r.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let r=0;r<this.ranges.length;r++)if(!this.ranges[r].eq(e.ranges[r],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new vv([this.main],0)}addRange(e,t=!0){return vv.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let r=this.ranges.slice();return r[t]=e,vv.create(r,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||"number"!=typeof e.main||e.main>=e.ranges.length)throw RangeError("Invalid JSON representation for EditorSelection");return new vv(e.ranges.map(e=>vy.fromJSON(e)),e.main)}static single(e,t=e){return new vv([vv.range(e,t)],0)}static create(e,t=0){if(0==e.length)throw RangeError("A selection needs at least one range");for(let r=0,n=0;n<e.length;n++){let i=e[n];if(i.empty?i.from<=r:i.from<r)return vv.normalized(e.slice(),t);r=i.to}return new vv(e,t)}static cursor(e,t=0,r,n){return vy.create(e,e,(0==t?0:t<0?8:16)|(null==r?7:Math.min(6,r))|(null!=n?n:0xffffff)<<6)}static range(e,t,r,n){let i=(null!=r?r:0xffffff)<<6|(null==n?7:Math.min(6,n));return t<e?vy.create(t,e,48|i):vy.create(e,t,8*(t>e)|i)}static normalized(e,t=0){let r=e[t];e.sort((e,t)=>e.from-t.from),t=e.indexOf(r);for(let r=1;r<e.length;r++){let n=e[r],i=e[r-1];if(n.empty?n.from<=i.to:n.from<i.to){let o=i.from,s=Math.max(n.to,i.to);r<=t&&t--,e.splice(--r,2,n.anchor>n.head?vv.range(s,o):vv.range(o,s))}}return new vv(e,t)}}function vb(e,t){for(let r of e.ranges)if(r.to>t)throw RangeError("Selection points outside of document")}let vx=0;class vw{constructor(e,t,r,n,i){this.combine=e,this.compareInput=t,this.compare=r,this.isStatic=n,this.id=vx++,this.default=e([]),this.extensions="function"==typeof i?i(this):i}get reader(){return this}static define(e={}){return new vw(e.combine||(e=>e),e.compareInput||((e,t)=>e===t),e.compare||(!e.combine?vk:(e,t)=>e===t),!!e.static,e.enables)}of(e){return new vA([],this,0,e)}compute(e,t){if(this.isStatic)throw Error("Can't compute a static facet");return new vA(e,this,1,t)}computeN(e,t){if(this.isStatic)throw Error("Can't compute a static facet");return new vA(e,this,2,t)}from(e,t){return t||(t=e=>e),this.compute([e],r=>t(r.field(e)))}}function vk(e,t){return e==t||e.length==t.length&&e.every((e,r)=>e===t[r])}class vA{constructor(e,t,r,n){this.dependencies=e,this.facet=t,this.type=r,this.value=n,this.id=vx++}dynamicSlot(e){var t;let r=this.value,n=this.facet.compareInput,i=this.id,o=e[i]>>1,s=2==this.type,a=!1,l=!1,c=[];for(let r of this.dependencies)"doc"==r?a=!0:"selection"==r?l=!0:((null!=(t=e[r.id])?t:1)&1)==0&&c.push(e[r.id]);return{create:e=>(e.values[o]=r(e),1),update(e,t){if(a&&t.docChanged||l&&(t.docChanged||t.selection)||vj(e,c)){let t=r(e);if(s?!vS(t,e.values[o],n):!n(t,e.values[o]))return e.values[o]=t,1}return 0},reconfigure:(e,t)=>{let a,l=t.config.address[i];if(null!=l){let i=vR(t,l);if(this.dependencies.every(r=>r instanceof vw?t.facet(r)===e.facet(r):!(r instanceof vE)||t.field(r,!1)==e.field(r,!1))||(s?vS(a=r(e),i,n):n(a=r(e),i)))return e.values[o]=i,0}else a=r(e);return e.values[o]=a,1}}}}function vS(e,t,r){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1;return!0}function vj(e,t){let r=!1;for(let n of t)1&vD(e,n)&&(r=!0);return r}let vC=vw.define({static:!0});class vE{constructor(e,t,r,n,i){this.id=e,this.createF=t,this.updateF=r,this.compareF=n,this.spec=i,this.provides=void 0}static define(e){let t=new vE(vx++,e.create,e.update,e.compare||((e,t)=>e===t),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(vC).find(e=>e.field==this);return((null==t?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:e=>(e.values[t]=this.create(e),1),update:(e,r)=>{let n=e.values[t],i=this.updateF(n,r);return this.compareF(n,i)?0:(e.values[t]=i,1)},reconfigure:(e,r)=>{let n=e.facet(vC),i=r.facet(vC),o;return(o=n.find(e=>e.field==this))&&o!=i.find(e=>e.field==this)?(e.values[t]=o.create(e),1):null!=r.config.address[this.id]?(e.values[t]=r.field(this),0):(e.values[t]=this.create(e),1)}}}init(e){return[this,vC.of({field:this,create:e})]}get extension(){return this}}function vO(e){return t=>new vP(t,e)}let vM={highest:vO(0),high:vO(1),default:vO(2),low:vO(3),lowest:vO(4)};class vP{constructor(e,t){this.inner=e,this.prec=t}}class vT{of(e){return new vI(this,e)}reconfigure(e){return vT.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class vI{constructor(e,t){this.compartment=e,this.inner=t}}class v${constructor(e,t,r,n,i,o){for(this.base=e,this.compartments=t,this.dynamicSlots=r,this.address=n,this.staticValues=i,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<r.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return null==t?e.default:this.staticValues[t>>1]}static resolve(e,t,r){var n,i,o;let s,a,l=[],c=Object.create(null),u=new Map;for(let r of(n=e,i=t,o=u,s=[[],[],[],[],[]],a=new Map,!function e(t,r){let n=a.get(t);if(null!=n){if(n<=r)return;let e=s[n].indexOf(t);e>-1&&s[n].splice(e,1),t instanceof vI&&o.delete(t.compartment)}if(a.set(t,r),Array.isArray(t))for(let n of t)e(n,r);else if(t instanceof vI){if(o.has(t.compartment))throw RangeError("Duplicate use of compartment in extensions");let n=i.get(t.compartment)||t.inner;o.set(t.compartment,n),e(n,r)}else if(t instanceof vP)e(t.inner,t.prec);else if(t instanceof vE)s[r].push(t),t.provides&&e(t.provides,r);else if(t instanceof vA)s[r].push(t),t.facet.extensions&&e(t.facet.extensions,2);else{let n=t.extension;if(!n)throw Error(`Unrecognized extension value in extension set (${t}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);e(n,r)}}(n,2),s.reduce((e,t)=>e.concat(t))))r instanceof vE?l.push(r):(c[r.facet.id]||(c[r.facet.id]=[])).push(r);let h=Object.create(null),d=[],f=[];for(let e of l)h[e.id]=f.length<<1,f.push(t=>e.slot(t));let p=null==r?void 0:r.config.facets;for(let e in c){let t=c[e],n=t[0].facet,i=p&&p[e]||[];if(t.every(e=>0==e.type))if(h[n.id]=d.length<<1|1,vk(i,t))d.push(r.facet(n));else{let e=n.combine(t.map(e=>e.value));d.push(r&&n.compare(e,r.facet(n))?r.facet(n):e)}else{for(let e of t)0==e.type?(h[e.id]=d.length<<1|1,d.push(e.value)):(h[e.id]=f.length<<1,f.push(t=>e.dynamicSlot(t)));h[n.id]=f.length<<1,f.push(e=>(function(e,t,r){let n=r.map(t=>e[t.id]),i=r.map(e=>e.type),o=n.filter(e=>!(1&e)),s=e[t.id]>>1;function a(e){let r=[];for(let t=0;t<n.length;t++){let o=vR(e,n[t]);if(2==i[t])for(let e of o)r.push(e);else r.push(o)}return t.combine(r)}return{create(e){for(let t of n)vD(e,t);return e.values[s]=a(e),1},update(e,r){if(!vj(e,o))return 0;let n=a(e);return t.compare(n,e.values[s])?0:(e.values[s]=n,1)},reconfigure(e,i){let o=vj(e,n),l=i.config.facets[t.id],c=i.facet(t);if(l&&!o&&vk(r,l))return e.values[s]=c,0;let u=a(e);return t.compare(u,c)?(e.values[s]=c,0):(e.values[s]=u,1)}}})(e,n,t))}}return new v$(e,u,f.map(e=>e(h)),h,d,c)}}function vD(e,t){if(1&t)return 2;let r=t>>1,n=e.status[r];if(4==n)throw Error("Cyclic dependency between fields and/or facets");if(2&n)return n;e.status[r]=4;let i=e.computeSlot(e,e.config.dynamicSlots[r]);return e.status[r]=2|i}function vR(e,t){return 1&t?e.config.staticValues[t>>1]:e.values[t>>1]}let vN=vw.define(),v_=vw.define({combine:e=>e.some(e=>e),static:!0}),vL=vw.define({combine:e=>e.length?e[0]:void 0,static:!0}),vF=vw.define(),vB=vw.define(),vz=vw.define(),vW=vw.define({combine:e=>!!e.length&&e[0]});class vV{constructor(e,t){this.type=e,this.value=t}static define(){return new vH}}class vH{of(e){return new vV(this,e)}}class vU{constructor(e){this.map=e}of(e){return new vq(this,e)}}class vq{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return void 0===t?void 0:t==this.value?this:new vq(this.type,t)}is(e){return this.type==e}static define(e={}){return new vU(e.map||(e=>e))}static mapEffects(e,t){if(!e.length)return e;let r=[];for(let n of e){let e=n.map(t);e&&r.push(e)}return r}}vq.reconfigure=vq.define(),vq.appendConfig=vq.define();class vK{constructor(e,t,r,n,i,o){this.startState=e,this.changes=t,this.selection=r,this.effects=n,this.annotations=i,this.scrollIntoView=o,this._doc=null,this._state=null,r&&vb(r,t.newLength),i.some(e=>e.type==vK.time)||(this.annotations=i.concat(vK.time.of(Date.now())))}static create(e,t,r,n,i,o){return new vK(e,t,r,n,i,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(vK.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&"."==t[e.length]))}}function vG(e,t,r){var n;let i,o,s;return r?(i=t.changes,o=vu.empty(t.changes.length),s=e.changes.compose(t.changes)):(i=t.changes.map(e.changes),o=e.changes.mapDesc(t.changes,!0),s=e.changes.compose(i)),{changes:s,selection:t.selection?t.selection.map(o):null==(n=e.selection)?void 0:n.map(i),effects:vq.mapEffects(e.effects,i).concat(vq.mapEffects(t.effects,o)),annotations:e.annotations.length?e.annotations.concat(t.annotations):t.annotations,scrollIntoView:e.scrollIntoView||t.scrollIntoView}}function vJ(e,t,r){let n=t.selection,i=vX(t.annotations);return t.userEvent&&(i=i.concat(vK.userEvent.of(t.userEvent))),{changes:t.changes instanceof vu?t.changes:vu.of(t.changes||[],r,e.facet(vL)),selection:n&&(n instanceof vv?n:vv.single(n.anchor,n.head)),effects:vX(t.effects),annotations:i,scrollIntoView:!!t.scrollIntoView}}vK.time=vV.define(),vK.userEvent=vV.define(),vK.addToHistory=vV.define(),vK.remote=vV.define();let vY=[];function vX(e){return null==e?vY:Array.isArray(e)?e:[e]}var vZ=((u=vZ||(vZ={}))[u.Word=0]="Word",u[u.Space=1]="Space",u[u.Other=2]="Other",u);let vQ=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;try{a=RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(e){}class v0{constructor(e,t,r,n,i,o){this.config=e,this.doc=t,this.selection=r,this.values=n,this.status=e.statusTemplate.slice(),this.computeSlot=i,o&&(o._state=this);for(let e=0;e<this.config.dynamicSlots.length;e++)vD(this,e<<1);this.computeSlot=null}field(e,t=!0){let r=this.config.address[e.id];if(null==r){if(t)throw RangeError("Field is not present in this state");return}return vD(this,r),vR(this,r)}update(...e){return function e(t,r,n){let i=vJ(t,r.length?r[0]:{},t.doc.length);r.length&&!1===r[0].filter&&(n=!1);for(let e=1;e<r.length;e++){!1===r[e].filter&&(n=!1);let o=!!r[e].sequential;i=vG(i,vJ(t,r[e],o?i.changes.newLength:t.doc.length),o)}let o=vK.create(t,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return function(e){let t=e.startState,r=t.facet(vz),n=e;for(let i=r.length-1;i>=0;i--){let o=r[i](e);o&&Object.keys(o).length&&(n=vG(n,vJ(t,o,e.changes.newLength),!0))}return n==e?e:vK.create(t,e.changes,e.selection,n.effects,n.annotations,n.scrollIntoView)}(n?function(t){let r=t.startState,n=!0;for(let e of r.facet(vF)){let r=e(t);if(!1===r){n=!1;break}Array.isArray(r)&&(n=!0===n?r:function(e,t){let r=[];for(let n=0,i=0;;){let o,s;if(n<e.length&&(i==t.length||t[i]>=e[n]))o=e[n++],s=e[n++];else{if(!(i<t.length))return r;o=t[i++],s=t[i++]}!r.length||r[r.length-1]<o?r.push(o,s):r[r.length-1]<s&&(r[r.length-1]=s)}}(n,r))}if(!0!==n){let e,i;if(!1===n)i=t.changes.invertedDesc,e=vu.empty(r.doc.length);else{let r=t.changes.filter(n);e=r.changes,i=r.filtered.mapDesc(r.changes).invertedDesc}t=vK.create(r,e,t.selection&&t.selection.map(i),vq.mapEffects(t.effects,i),t.annotations,t.scrollIntoView)}let i=r.facet(vB);for(let n=i.length-1;n>=0;n--){let o=i[n](t);t=o instanceof vK?o:Array.isArray(o)&&1==o.length&&o[0]instanceof vK?o[0]:e(r,vX(o),!1)}return t}(o):o)}(this,e,!0)}applyTransaction(e){let t,r=this.config,{base:n,compartments:i}=r;for(let t of e.effects)t.is(vT.reconfigure)?(r&&(i=new Map,r.compartments.forEach((e,t)=>i.set(t,e)),r=null),i.set(t.value.compartment,t.value.extension)):t.is(vq.reconfigure)?(r=null,n=t.value):t.is(vq.appendConfig)&&(r=null,n=vX(n).concat(t.value));t=r?e.startState.values.slice():new v0(r=v$.resolve(n,i,this),this.doc,this.selection,r.dynamicSlots.map(()=>null),(e,t)=>t.reconfigure(e,this),null).values;let o=e.startState.facet(v_)?e.newSelection:e.newSelection.asSingle();new v0(r,e.newDoc,o,t,(t,r)=>r.update(t,e),e)}replaceSelection(e){return"string"==typeof e&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:vv.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,r=e(t.ranges[0]),n=this.changes(r.changes),i=[r.range],o=vX(r.effects);for(let r=1;r<t.ranges.length;r++){let s=e(t.ranges[r]),a=this.changes(s.changes),l=a.map(n);for(let e=0;e<r;e++)i[e]=i[e].map(l);let c=n.mapDesc(a,!0);i.push(s.range.map(c)),n=n.compose(l),o=vq.mapEffects(o,l).concat(vq.mapEffects(vX(s.effects),c))}return{changes:n,selection:vv.create(i,t.mainIndex),effects:o}}changes(e=[]){return e instanceof vu?e:vu.of(e,this.doc.length,this.facet(v0.lineSeparator))}toText(e){return y3.of(e.split(this.facet(v0.lineSeparator)||va))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return null==t?e.default:(vD(this,t),vR(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let r in e){let n=e[r];n instanceof vE&&null!=this.config.address[n.id]&&(t[r]=n.spec.toJSON(this.field(e[r]),this))}return t}static fromJSON(e,t={},r){if(!e||"string"!=typeof e.doc)throw RangeError("Invalid JSON representation for EditorState");let n=[];if(r){for(let t in r)if(Object.prototype.hasOwnProperty.call(e,t)){let i=r[t],o=e[t];n.push(i.init(e=>i.spec.fromJSON(o,e)))}}return v0.create({doc:e.doc,selection:vv.fromJSON(e.selection),extensions:t.extensions?n.concat([t.extensions]):n})}static create(e={}){let t=v$.resolve(e.extensions||[],new Map),r=e.doc instanceof y3?e.doc:y3.of((e.doc||"").split(t.staticFacet(v0.lineSeparator)||va)),n=e.selection?e.selection instanceof vv?e.selection:vv.single(e.selection.anchor,e.selection.head):vv.single(0);return vb(n,r.length),t.staticFacet(v_)||(n=n.asSingle()),new v0(t,r,n,t.dynamicSlots.map(()=>null),(e,t)=>t.create(e),null)}get tabSize(){return this.facet(v0.tabSize)}get lineBreak(){return this.facet(v0.lineSeparator)||"\n"}get readOnly(){return this.facet(vW)}phrase(e,...t){for(let t of this.facet(v0.phrases))if(Object.prototype.hasOwnProperty.call(t,e)){e=t[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(e,r)=>{if("$"==r)return"$";let n=+(r||1);return!n||n>t.length?e:t[n-1]})),e}languageDataAt(e,t,r=-1){let n=[];for(let i of this.facet(vN))for(let o of i(this,t,r))Object.prototype.hasOwnProperty.call(o,e)&&n.push(o[e]);return n}charCategorizer(e){var t;let r=this.languageDataAt("wordChars",e);return t=r.length?r[0]:"",e=>{if(!/\S/.test(e))return vZ.Space;if(function(e){if(a)return a.test(e);for(let t=0;t<e.length;t++){let r=e[t];if(/\w/.test(r)||r>"\x80"&&(r.toUpperCase()!=r.toLowerCase()||vQ.test(r)))return!0}return!1}(e))return vZ.Word;for(let r=0;r<t.length;r++)if(e.indexOf(t[r])>-1)return vZ.Word;return vZ.Other}}wordAt(e){let{text:t,from:r,length:n}=this.doc.lineAt(e),i=this.charCategorizer(e),o=e-r,s=e-r;for(;o>0;){let e=vn(t,o,!1);if(i(t.slice(e,o))!=vZ.Word)break;o=e}for(;s<n;){let e=vn(t,s);if(i(t.slice(s,e))!=vZ.Word)break;s=e}return o==s?null:vv.range(o+r,s+r)}}function v1(e,t,r={}){let n={};for(let t of e)for(let e of Object.keys(t)){let i=t[e],o=n[e];if(void 0===o)n[e]=i;else if(o===i||void 0===i);else if(Object.hasOwnProperty.call(r,e))n[e]=r[e](o,i);else throw Error("Config merge conflict for field "+e)}for(let e in t)void 0===n[e]&&(n[e]=t[e]);return n}v0.allowMultipleSelections=v_,v0.tabSize=vw.define({combine:e=>e.length?e[0]:4}),v0.lineSeparator=vL,v0.readOnly=vW,v0.phrases=vw.define({compare(e,t){let r=Object.keys(e),n=Object.keys(t);return r.length==n.length&&r.every(r=>e[r]==t[r])}}),v0.languageData=vN,v0.changeFilter=vF,v0.transactionFilter=vB,v0.transactionExtender=vz,vT.reconfigure=vq.define();class v2{eq(e){return this==e}range(e,t=e){return v3.create(e,t,this)}}function v4(e,t){return e==t||e.constructor==t.constructor&&e.eq(t)}v2.prototype.startSide=v2.prototype.endSide=0,v2.prototype.point=!1,v2.prototype.mapMode=vl.TrackDel;class v3{constructor(e,t,r){this.from=e,this.to=t,this.value=r}static create(e,t,r){return new v3(e,t,r)}}function v5(e,t){return e.from-t.from||e.value.startSide-t.value.startSide}class v6{constructor(e,t,r,n){this.from=e,this.to=t,this.value=r,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(e,t,r,n=0){let i=r?this.to:this.from;for(let o=n,s=i.length;;){if(o==s)return o;let n=o+s>>1,a=i[n]-e||(r?this.value[n].endSide:this.value[n].startSide)-t;if(n==o)return a>=0?o:s;a>=0?s=n:o=n+1}}between(e,t,r,n){for(let i=this.findIndex(t,-1e9,!0),o=this.findIndex(r,1e9,!1,i);i<o;i++)if(!1===n(this.from[i]+e,this.to[i]+e,this.value[i]))return!1}map(e,t){let r=[],n=[],i=[],o=-1,s=-1;for(let a=0;a<this.value.length;a++){let l=this.value[a],c=this.from[a]+e,u=this.to[a]+e,h,d;if(c==u){let e=t.mapPos(c,l.startSide,l.mapMode);if(null==e||(h=d=e,l.startSide!=l.endSide&&(d=t.mapPos(c,l.endSide))<h))continue}else if((h=t.mapPos(c,l.startSide))>(d=t.mapPos(u,l.endSide))||h==d&&l.startSide>0&&l.endSide<=0)continue;0>(d-h||l.endSide-l.startSide)||(o<0&&(o=h),l.point&&(s=Math.max(s,d-h)),r.push(l),n.push(h-o),i.push(d-o))}return{mapped:r.length?new v6(n,i,r,s):null,pos:o}}}class v9{constructor(e,t,r,n){this.chunkPos=e,this.chunk=t,this.nextLayer=r,this.maxPoint=n}static create(e,t,r,n){return new v9(e,t,r,n)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:r=!1,filterFrom:n=0,filterTo:i=this.length}=e,o=e.filter;if(0==t.length&&!o)return this;if(r&&(t=t.slice().sort(v5)),this.isEmpty)return t.length?v9.of(t):this;let s=new be(this,null,-1).goto(0),a=0,l=[],c=new v8;for(;s.value||a<t.length;)if(a<t.length&&(s.from-t[a].from||s.startSide-t[a].value.startSide)>=0){let e=t[a++];c.addInner(e.from,e.to,e.value)||l.push(e)}else 1==s.rangeIndex&&s.chunkIndex<this.chunk.length&&(a==t.length||this.chunkEnd(s.chunkIndex)<t[a].from)&&(!o||n>this.chunkEnd(s.chunkIndex)||i<this.chunkPos[s.chunkIndex])&&c.addChunk(this.chunkPos[s.chunkIndex],this.chunk[s.chunkIndex])?s.nextChunk():((!o||n>s.to||i<s.from||o(s.from,s.to,s.value))&&!c.addInner(s.from,s.to,s.value)&&l.push(v3.create(s.from,s.to,s.value)),s.next());return c.finishInner(this.nextLayer.isEmpty&&!l.length?v9.empty:this.nextLayer.update({add:l,filter:o,filterFrom:n,filterTo:i}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],r=[],n=-1;for(let i=0;i<this.chunk.length;i++){let o=this.chunkPos[i],s=this.chunk[i],a=e.touchesRange(o,o+s.length);if(!1===a)n=Math.max(n,s.maxPoint),t.push(s),r.push(e.mapPos(o));else if(!0===a){let{mapped:i,pos:a}=s.map(o,e);i&&(n=Math.max(n,i.maxPoint),t.push(i),r.push(a))}}let i=this.nextLayer.map(e);return 0==t.length?i:new v9(r,t,i||v9.empty,n)}between(e,t,r){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let i=this.chunkPos[n],o=this.chunk[n];if(t>=i&&e<=i+o.length&&!1===o.between(i,e-i,t-i,r))return}this.nextLayer.between(e,t,r)}}iter(e=0){return bt.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return bt.from(e).goto(t)}static compare(e,t,r,n,i=-1){let o=e.filter(e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=i),s=t.filter(e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=i),a=v7(o,s,r),l=new bn(o,a,i),c=new bn(s,a,i);r.iterGaps((e,t,r)=>bi(l,e,c,t,r,n)),r.empty&&0==r.length&&bi(l,0,c,0,0,n)}static eq(e,t,r=0,n){null==n&&(n=0x3b9ac9ff);let i=e.filter(e=>!e.isEmpty&&0>t.indexOf(e)),o=t.filter(t=>!t.isEmpty&&0>e.indexOf(t));if(i.length!=o.length)return!1;if(!i.length)return!0;let s=v7(i,o),a=new bn(i,s,0).goto(r),l=new bn(o,s,0).goto(r);for(;;){if(a.to!=l.to||!bo(a.active,l.active)||a.point&&(!l.point||!v4(a.point,l.point)))return!1;if(a.to>n)return!0;a.next(),l.next()}}static spans(e,t,r,n,i=-1){let o=new bn(e,null,i).goto(t),s=t,a=o.openStart;for(;;){let e=Math.min(o.to,r);if(o.point){let r=o.activeForPoint(o.to),i=o.pointFrom<t?r.length+1:o.point.startSide<0?r.length:Math.min(r.length,a);n.point(s,e,o.point,r,i,o.pointRank),a=Math.min(o.openEnd(e),r.length)}else e>s&&(n.span(s,e,o.active,a),a=o.openEnd(e));if(o.to>r)return a+(o.point&&o.to>r?1:0);s=o.to,o.next()}}static of(e,t=!1){let r=new v8;for(let n of e instanceof v3?[e]:t?function(e){if(e.length>1)for(let t=e[0],r=1;r<e.length;r++){let n=e[r];if(v5(t,n)>0)return e.slice().sort(v5);t=n}return e}(e):e)r.add(n.from,n.to,n.value);return r.finish()}static join(e){if(!e.length)return v9.empty;let t=e[e.length-1];for(let r=e.length-2;r>=0;r--)for(let n=e[r];n!=v9.empty;n=n.nextLayer)t=new v9(n.chunkPos,n.chunk,t,Math.max(n.maxPoint,t.maxPoint));return t}}v9.empty=new v9([],[],null,-1),v9.empty.nextLayer=v9.empty;class v8{finishChunk(e){this.chunks.push(new v6(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,r){this.addInner(e,t,r)||(this.nextLayer||(this.nextLayer=new v8)).add(e,t,r)}addInner(e,t,r){let n=e-this.lastTo||r.startSide-this.last.endSide;if(n<=0&&0>(e-this.lastFrom||r.startSide-this.last.startSide))throw Error("Ranges must be added sorted by `from` position and `startSide`");return!(n<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=r,this.lastFrom=e,this.lastTo=t,this.value.push(r),r.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if(0>(e-this.lastTo||t.value[0].startSide-this.last.endSide))return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let r=t.value.length-1;return this.last=t.value[r],this.lastFrom=t.from[r]+e,this.lastTo=t.to[r]+e,!0}finish(){return this.finishInner(v9.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return e;let t=v9.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function v7(e,t,r){let n=new Map;for(let t of e)for(let e=0;e<t.chunk.length;e++)t.chunk[e].maxPoint<=0&&n.set(t.chunk[e],t.chunkPos[e]);let i=new Set;for(let e of t)for(let t=0;t<e.chunk.length;t++){let o=n.get(e.chunk[t]);null==o||(r?r.mapPos(o):o)!=e.chunkPos[t]||(null==r?void 0:r.touchesRange(o,o+e.chunk[t].length))||i.add(e.chunk[t])}return i}class be{constructor(e,t,r,n=0){this.layer=e,this.skip=t,this.minPoint=r,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,r){for(;this.chunkIndex<this.layer.chunk.length;){let t=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(t)||this.layer.chunkEnd(this.chunkIndex)<e||t.maxPoint<this.minPoint))break;this.chunkIndex++,r=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!r||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(e,t){0>(this.to-e||this.endSide-t)&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],r=e+t.from[this.rangeIndex];if(this.from=r,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class bt{constructor(e){this.heap=e}static from(e,t=null,r=-1){let n=[];for(let i=0;i<e.length;i++)for(let o=e[i];!o.isEmpty;o=o.nextLayer)o.maxPoint>=r&&n.push(new be(o,t,r,i));return 1==n.length?n[0]:new bt(n)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let r of this.heap)r.goto(e,t);for(let e=this.heap.length>>1;e>=0;e--)br(this.heap,e);return this.next(),this}forward(e,t){for(let r of this.heap)r.forward(e,t);for(let e=this.heap.length>>1;e>=0;e--)br(this.heap,e);0>(this.to-e||this.value.endSide-t)&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),br(this.heap,0)}}}function br(e,t){for(let r=e[t];;){let n=(t<<1)+1;if(n>=e.length)break;let i=e[n];if(n+1<e.length&&i.compare(e[n+1])>=0&&(i=e[n+1],n++),0>r.compare(i))break;e[n]=r,e[t]=i,t=n}}class bn{constructor(e,t,r){this.minPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=bt.from(e,t,r)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&0>(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t);)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){bs(this.active,e),bs(this.activeTo,e),bs(this.activeRank,e),this.minActive=bl(this.active,this.activeTo)}addActive(e){let t=0,{value:r,to:n,rank:i}=this.cursor;for(;t<this.activeRank.length&&(i-this.activeRank[t]||n-this.activeTo[t])>0;)t++;ba(this.active,t,r),ba(this.activeTo,t,n),ba(this.activeRank,t,i),e&&ba(e,t,this.cursor.from),this.minActive=bl(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let r=this.openStart<0?[]:null;for(;;){let n=this.minActive;if(n>-1&&0>(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)){if(this.activeTo[n]>e){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),r&&bs(r,n)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let e=this.cursor.value;if(e.point)if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=e,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=e.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}else this.addActive(r),this.cursor.next()}else{this.to=this.endSide=1e9;break}}if(r){this.openStart=0;for(let t=r.length-1;t>=0&&r[t]<e;t--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let r=this.active.length-1;r>=0&&!(this.activeRank[r]<this.pointRank);r--)(this.activeTo[r]>e||this.activeTo[r]==e&&this.active[r].endSide>=this.point.endSide)&&t.push(this.active[r]);return t.reverse()}openEnd(e){let t=0;for(let r=this.activeTo.length-1;r>=0&&this.activeTo[r]>e;r--)t++;return t}}function bi(e,t,r,n,i,o){e.goto(t),r.goto(n);let s=n+i,a=n,l=n-t,c=!!o.boundChange;for(let t=!1;;){let n=e.to+l-r.to,i=n||e.endSide-r.endSide,u=i<0?e.to+l:r.to,h=Math.min(u,s);if(e.point||r.point?(e.point&&r.point&&v4(e.point,r.point)&&bo(e.activeForPoint(e.to),r.activeForPoint(r.to))||o.comparePoint(a,h,e.point,r.point),t=!1):(t&&o.boundChange(a),h>a&&!bo(e.active,r.active)&&o.compareRange(a,h,e.active,r.active),c&&h<s&&(n||e.openEnd(u)!=r.openEnd(u))&&(t=!0)),u>s)break;a=u,i<=0&&e.next(),i>=0&&r.next()}}function bo(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!=t[r]&&!v4(e[r],t[r]))return!1;return!0}function bs(e,t){for(let r=t,n=e.length-1;r<n;r++)e[r]=e[r+1];e.pop()}function ba(e,t,r){for(let r=e.length-1;r>=t;r--)e[r+1]=e[r];e[t]=r}function bl(e,t){let r=-1,n=1e9;for(let i=0;i<t.length;i++)0>(t[i]-n||e[i].endSide-e[r].endSide)&&(r=i,n=t[i]);return r}function bc(e,t,r=e.length){let n=0;for(let i=0;i<r&&i<e.length;)9==e.charCodeAt(i)?(n+=t-n%t,i++):(n++,i=vn(e,i));return n}function bu(e,t,r,n){for(let n=0,i=0;;){if(i>=t)return n;if(n==e.length)break;i+=9==e.charCodeAt(n)?r-i%r:1,n=vn(e,n)}return!0===n?-1:e.length}let bh="u"<typeof Symbol?"__":Symbol.for(""),bd="u"<typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),bf="u">typeof globalThis?globalThis:"u">typeof window?window:{};class bp{constructor(e,t){this.rules=[];let{finish:r}=t||{};function n(e){return/^@/.test(e)?[e]:e.split(/,\s*/)}for(let t in e)!function e(t,i,o,s){let a=[],l=/^@(\w+)\b/.exec(t[0]),c=l&&"keyframes"==l[1];if(l&&null==i)return o.push(t[0]+";");for(let r in i){let s=i[r];if(/&/.test(r))e(r.split(/,\s*/).map(e=>t.map(t=>e.replace(/&/,t))).reduce((e,t)=>e.concat(t)),s,o);else if(s&&"object"==typeof s){if(!l)throw RangeError("The value of a property ("+r+") should be a primitive value.");e(n(r),s,a,c)}else null!=s&&a.push(r.replace(/_.*/,"").replace(/[A-Z]/g,e=>"-"+e.toLowerCase())+": "+s+";")}(a.length||c)&&o.push((r&&!l&&!s?t.map(r):t).join(", ")+" {"+a.join(" ")+"}")}(n(t),e[t],this.rules)}getRules(){return this.rules.join("\n")}static newName(){let e=bf[bh]||1;return bf[bh]=e+1,""+e.toString(36)}static mount(e,t,r){let n=e[bd],i=r&&r.nonce;n?i&&n.setNonce(i):n=new bg(e,i),n.mount(Array.isArray(t)?t:[t],e)}}let bm=new Map;class bg{constructor(e,t){let r=e.ownerDocument||e,n=r.defaultView;if(!e.head&&e.adoptedStyleSheets&&n.CSSStyleSheet){let t=bm.get(r);if(t)return e[bd]=t;this.sheet=new n.CSSStyleSheet,bm.set(r,this)}else this.styleTag=r.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[bd]=this}mount(e,t){let r=this.sheet,n=0,i=0;for(let t=0;t<e.length;t++){let o=e[t],s=this.modules.indexOf(o);if(s<i&&s>-1&&(this.modules.splice(s,1),i--,s=-1),-1==s){if(this.modules.splice(i++,0,o),r)for(let e=0;e<o.rules.length;e++)r.insertRule(o.rules[e],n++)}else{for(;i<s;)n+=this.modules[i++].rules.length;n+=o.rules.length,i++}}if(r)0>t.adoptedStyleSheets.indexOf(this.sheet)&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let e="";for(let t=0;t<this.modules.length;t++)e+=this.modules[t].getRules()+"\n";this.styleTag.textContent=e;let r=t.head||t;this.styleTag.parentNode!=r&&r.insertBefore(this.styleTag,r.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}for(var by={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},bv={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},bb="u">typeof navigator&&/Mac/.test(navigator.platform),bx="u">typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),bw=0;bw<10;bw++)by[48+bw]=by[96+bw]=String(bw);for(var bw=1;bw<=24;bw++)by[bw+111]="F"+bw;for(var bw=65;bw<=90;bw++)by[bw]=String.fromCharCode(bw+32),bv[bw]=String.fromCharCode(bw);for(var bk in by)bv.hasOwnProperty(bk)||(bv[bk]=by[bk]);function bA(){var e=arguments[0];"string"==typeof e&&(e=document.createElement(e));var t=1,r=arguments[1];if(r&&"object"==typeof r&&null==r.nodeType&&!Array.isArray(r)){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var i=r[n];"string"==typeof i?e.setAttribute(n,i):null!=i&&(e[n]=i)}t++}for(;t<arguments.length;t++)!function e(t,r){if("string"==typeof r)t.appendChild(document.createTextNode(r));else if(null==r);else if(null!=r.nodeType)t.appendChild(r);else if(Array.isArray(r))for(var n=0;n<r.length;n++)e(t,r[n]);else throw RangeError("Unsupported child node: "+r)}(e,arguments[t]);return e}let bS="u">typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},bj="u">typeof document?document:{documentElement:{style:{}}},bC=/Edge\/(\d+)/.exec(bS.userAgent),bE=/MSIE \d/.test(bS.userAgent),bO=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(bS.userAgent),bM=!!(bE||bO||bC),bP=!bM&&/gecko\/(\d+)/i.test(bS.userAgent),bT=!bM&&/Chrome\/(\d+)/.exec(bS.userAgent),bI="webkitFontSmoothing"in bj.documentElement.style,b$=!bM&&/Apple Computer/.test(bS.vendor),bD=b$&&(/Mobile\/\w+/.test(bS.userAgent)||bS.maxTouchPoints>2);var bR={mac:bD||/Mac/.test(bS.platform),windows:/Win/.test(bS.platform),linux:/Linux|X11/.test(bS.platform),ie:bM,ie_version:bE?bj.documentMode||6:bO?+bO[1]:bC?+bC[1]:0,gecko:bP,gecko_version:bP?+(/Firefox\/(\d+)/.exec(bS.userAgent)||[0,0])[1]:0,chrome:!!bT,chrome_version:bT?+bT[1]:0,ios:bD,android:/Android\b/.test(bS.userAgent),webkit:bI,webkit_version:bI?+(/\bAppleWebKit\/(\d+)/.exec(bS.userAgent)||[0,0])[1]:0,safari:b$,safari_version:b$?+(/\bVersion\/(\d+(\.\d+)?)/.exec(bS.userAgent)||[0,0])[1]:0,tabSize:null!=bj.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};function bN(e,t){for(let r in e)"class"==r&&t.class?t.class+=" "+e.class:"style"==r&&t.style?t.style+=";"+e.style:t[r]=e[r];return t}let b_=Object.create(null);function bL(e,t,r){if(e==t)return!0;e||(e=b_),t||(t=b_);let n=Object.keys(e),i=Object.keys(t);if(n.length-(r&&n.indexOf(r)>-1?1:0)!=i.length-(r&&i.indexOf(r)>-1?1:0))return!1;for(let o of n)if(o!=r&&(-1==i.indexOf(o)||e[o]!==t[o]))return!1;return!0}function bF(e,t,r){let n=!1;if(t)for(let i in t)r&&i in r||(n=!0,"style"==i?e.style.cssText="":e.removeAttribute(i));if(r)for(let i in r)t&&t[i]==r[i]||(n=!0,"style"==i?e.style.cssText=r[i]:e.setAttribute(i,r[i]));return n}class bB{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return -1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,r){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var bz=((h=bz||(bz={}))[h.Text=0]="Text",h[h.WidgetBefore=1]="WidgetBefore",h[h.WidgetAfter=2]="WidgetAfter",h[h.WidgetRange=3]="WidgetRange",h);class bW extends v2{constructor(e,t,r,n){super(),this.startSide=e,this.endSide=t,this.widget=r,this.spec=n}get heightRelevant(){return!1}static mark(e){return new bV(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),r=!!e.block;return t+=r&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new bU(e,t,t,r,e.widget||null,!1)}static replace(e){let t=!!e.block,r,n;if(e.isBlockGap)r=-5e8,n=4e8;else{let{start:i,end:o}=bq(e,t);r=(i?t?-3e8:-1:5e8)-1,n=(o?t?2e8:1:-6e8)+1}return new bU(e,r,n,t,e.widget||null,!0)}static line(e){return new bH(e)}static set(e,t=!1){return v9.of(e,t)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}bW.none=v9.empty;class bV extends bW{constructor(e){let{start:t,end:r}=bq(e);super(t?-1:5e8,r?1:-6e8,null,e),this.tagName=e.tagName||"span",this.attrs=e.class&&e.attributes?bN(e.attributes,{class:e.class}):e.class?{class:e.class}:e.attributes||b_}eq(e){return this==e||e instanceof bV&&this.tagName==e.tagName&&bL(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw RangeError("Mark decorations may not be empty");return super.range(e,t)}}bV.prototype.point=!1;class bH extends bW{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof bH&&this.spec.class==e.spec.class&&bL(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}bH.prototype.mapMode=vl.TrackBefore,bH.prototype.point=!0;class bU extends bW{constructor(e,t,r,n,i,o){super(t,r,i,e),this.block=n,this.isReplace=o,this.mapMode=n?t<=0?vl.TrackBefore:vl.TrackAfter:vl.TrackDel}get type(){return this.startSide!=this.endSide?bz.WidgetRange:this.startSide<=0?bz.WidgetBefore:bz.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){var t,r;return e instanceof bU&&(t=this.widget,t==(r=e.widget)||!!(t&&r&&t.compare(r)))&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}function bq(e,t=!1){let{inclusiveStart:r,inclusiveEnd:n}=e;return null==r&&(r=e.inclusive),null==n&&(n=e.inclusive),{start:null!=r?r:t,end:null!=n?n:t}}function bK(e,t,r,n=0){let i=r.length-1;i>=0&&r[i]+n>=e?r[i]=Math.max(r[i],t):r.push(e,t)}bU.prototype.point=!0;class bG extends v2{constructor(e,t){super(),this.tagName=e,this.attributes=t}eq(e){return e==this||e instanceof bG&&this.tagName==e.tagName&&bL(this.attributes,e.attributes)}static create(e){return new bG(e.tagName,e.attributes||b_)}static set(e,t=!1){return v9.of(e,t)}}function bJ(e){return(11==e.nodeType?e.getSelection?e:e.ownerDocument:e).getSelection()}function bY(e,t){return!!t&&(e==t||e.contains(1!=t.nodeType?t.parentNode:t))}function bX(e,t){if(!t.anchorNode)return!1;try{return bY(e,t.anchorNode)}catch(e){return!1}}function bZ(e){return 3==e.nodeType?b7(e,0,e.nodeValue.length).getClientRects():1==e.nodeType?e.getClientRects():[]}function bQ(e,t,r,n){return!!r&&(b2(e,t,r,n,-1)||b2(e,t,r,n,1))}function b0(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t}function b1(e){return 1==e.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(e.nodeName)}function b2(e,t,r,n,i){for(;;){if(e==r&&t==n)return!0;if(t==(i<0?0:b4(e))){if("DIV"==e.nodeName)return!1;let r=e.parentNode;if(!r||1!=r.nodeType)return!1;t=b0(e)+(i<0?0:1),e=r}else{if(1!=e.nodeType||1==(e=e.childNodes[t+(i<0?-1:0)]).nodeType&&"false"==e.contentEditable)return!1;t=i<0?b4(e):0}}}function b4(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function b3(e,t){let r=t?e.left:e.right;return{left:r,right:r,top:e.top,bottom:e.bottom}}function b5(e,t){let r=t.width/e.offsetWidth,n=t.height/e.offsetHeight;return(r>.995&&r<1.005||!isFinite(r)||1>Math.abs(t.width-e.offsetWidth))&&(r=1),(n>.995&&n<1.005||!isFinite(n)||1>Math.abs(t.height-e.offsetHeight))&&(n=1),{scaleX:r,scaleY:n}}bG.prototype.startSide=bG.prototype.endSide=-1;class b6{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:r}=e;this.set(t,Math.min(e.anchorOffset,t?b4(t):0),r,Math.min(e.focusOffset,r?b4(r):0))}set(e,t,r,n){this.anchorNode=e,this.anchorOffset=t,this.focusNode=r,this.focusOffset=n}}let b9=null;function b8(e){if(e.setActive)return e.setActive();if(b9)return e.focus(b9);let t=[];for(let r=e;r&&(t.push(r,r.scrollTop,r.scrollLeft),r!=r.ownerDocument);r=r.parentNode);if(e.focus(null==b9?{get preventScroll(){return b9={preventScroll:!0},!0}}:void 0),!b9){b9=!1;for(let e=0;e<t.length;){let r=t[e++],n=t[e++],i=t[e++];r.scrollTop!=n&&(r.scrollTop=n),r.scrollLeft!=i&&(r.scrollLeft=i)}}}function b7(e,t,r=t){let n=l||(l=document.createRange());return n.setEnd(e,r),n.setStart(e,t),n}function xe(e,t,r,n){let i={key:t,code:t,keyCode:r,which:r,cancelable:!0};n&&({altKey:i.altKey,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,metaKey:i.metaKey}=n);let o=new KeyboardEvent("keydown",i);o.synthetic=!0,e.dispatchEvent(o);let s=new KeyboardEvent("keyup",i);return s.synthetic=!0,e.dispatchEvent(s),o.defaultPrevented||s.defaultPrevented}function xt(e){return e.scrollTop>Math.max(1,e.scrollHeight-e.clientHeight-4)}function xr(e,t){for(let r=e,n=t;;)if(3==r.nodeType&&n>0)return{node:r,offset:n};else if(1==r.nodeType&&n>0){if("false"==r.contentEditable)return null;n=b4(r=r.childNodes[n-1])}else{if(!r.parentNode||b1(r))return null;n=b0(r),r=r.parentNode}}function xn(e,t){for(let r=e,n=t;;)if(3==r.nodeType&&n<r.nodeValue.length)return{node:r,offset:n};else if(1==r.nodeType&&n<r.childNodes.length){if("false"==r.contentEditable)return null;r=r.childNodes[n],n=0}else{if(!r.parentNode||b1(r))return null;n=b0(r)+1,r=r.parentNode}}bR.safari&&bR.safari_version>=26&&(b9=!1);class xi{constructor(e,t,r=!0){this.node=e,this.offset=t,this.precise=r}static before(e,t){return new xi(e.parentNode,b0(e),t)}static after(e,t){return new xi(e.parentNode,b0(e)+1,t)}}var xo=((d=xo||(xo={}))[d.LTR=0]="LTR",d[d.RTL=1]="RTL",d);let xs=xo.LTR,xa=xo.RTL;function xl(e){let t=[];for(let r=0;r<e.length;r++)t.push(1<<e[r]);return t}let xc=xl("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),xu=xl("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),xh=Object.create(null),xd=[];for(let e of["()","[]","{}"]){let t=e.charCodeAt(0),r=e.charCodeAt(1);xh[t]=r,xh[r]=-t}function xf(e){return e<=247?xc[e]:1424<=e&&e<=1524?2:1536<=e&&e<=1785?xu[e-1536]:1774<=e&&e<=2220?4:8192<=e&&e<=8204?256:64336<=e&&e<=65023?4:1}let xp=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class xm{get dir(){return this.level%2?xa:xs}constructor(e,t,r){this.from=e,this.to=t,this.level=r}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,r,n){let i=-1;for(let o=0;o<e.length;o++){let s=e[o];if(s.from<=t&&s.to>=t){if(s.level==r)return o;(i<0||(0!=n?n<0?s.from<t:s.to>t:e[i].level>s.level))&&(i=o)}}if(i<0)throw RangeError("Index out of range");return i}}let xg=[];function xy(e){return[new xm(0,e,0)]}let xv="",xb=vw.define(),xx=vw.define(),xw=vw.define(),xk=vw.define(),xA=vw.define(),xS=vw.define(),xj=vw.define(),xC=vw.define(),xE=vw.define(),xO=vw.define({combine:e=>e.some(e=>e)}),xM=vw.define({combine:e=>e.some(e=>e)}),xP=vw.define();class xT{constructor(e,t="nearest",r="nearest",n=5,i=5,o=!1){this.range=e,this.y=t,this.x=r,this.yMargin=n,this.xMargin=i,this.isSnapshot=o}map(e){return e.empty?this:new xT(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new xT(vv.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}let xI=vq.define({map:(e,t)=>e.map(t)}),x$=vq.define();function xD(e,t,r){let n=e.facet(xk);n.length?n[0](t):window.onerror&&window.onerror(String(t),r,void 0,void 0,t)||(r?console.error(r+":",t):console.error(t))}let xR=vw.define({combine:e=>!e.length||e[0]}),xN=0,x_=vw.define({combine:e=>e.filter((t,r)=>{for(let n=0;n<r;n++)if(e[n].plugin==t.plugin)return!1;return!0})});class xL{constructor(e,t,r,n,i){this.id=e,this.create=t,this.domEventHandlers=r,this.domEventObservers=n,this.baseExtensions=i(this),this.extension=this.baseExtensions.concat(x_.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(x_.of({plugin:this,arg:e}))}static define(e,t){let{eventHandlers:r,eventObservers:n,provide:i,decorations:o}=t||{};return new xL(xN++,e,r,n,e=>{let t=[];return o&&t.push(xW.of(t=>{let r=t.plugin(e);return r?o(r):bW.none})),i&&t.push(i(e)),t})}static fromClass(e,t){return xL.define((t,r)=>new e(t,r),t)}}class xF{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(t){if(xD(e.state,t,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(e){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(t){xD(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(null==(t=this.value)?void 0:t.destroy)try{this.value.destroy()}catch(t){xD(e.state,t,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}let xB=vw.define(),xz=vw.define(),xW=vw.define(),xV=vw.define(),xH=vw.define(),xU=vw.define(),xq=vw.define();function xK(e,t){let r=e.state.facet(xq);if(!r.length)return r;let n=r.map(t=>t instanceof Function?t(e):t),i=[];return v9.spans(n,t.from,t.to,{point(){},span(e,r,n,o){let s=e-t.from,a=r-t.from,l=i;for(let e=n.length-1;e>=0;e--,o--){let r=n[e].spec.bidiIsolate,i;if(null==r&&(r=function(e,t,r){for(let n=t;n<r;n++){let t=xf(e.charCodeAt(n));if(1==t)break;if(2==t||4==t)return xa}return xs}(t.text,s,a)),o>0&&l.length&&(i=l[l.length-1]).to==s&&i.direction==r)i.to=a,l=i.inner;else{let e={from:s,to:a,direction:r,inner:[]};l.push(e),l=e.inner}}}}),i}let xG=vw.define();function xJ(e){let t=0,r=0,n=0,i=0;for(let o of e.state.facet(xG)){let s=o(e);s&&(null!=s.left&&(t=Math.max(t,s.left)),null!=s.right&&(r=Math.max(r,s.right)),null!=s.top&&(n=Math.max(n,s.top)),null!=s.bottom&&(i=Math.max(i,s.bottom)))}return{left:t,right:r,top:n,bottom:i}}let xY=vw.define();class xX{constructor(e,t,r,n){this.fromA=e,this.toA=t,this.fromB=r,this.toB=n}join(e){return new xX(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,r=this;for(;t>0;t--){let n=e[t-1];if(!(n.fromA>r.toA)){if(n.toA<r.fromA)break;r=r.join(n),e.splice(t-1,1)}}return e.splice(t,0,r),e}static extendWithRanges(e,t){if(0==t.length)return e;let r=[];for(let n=0,i=0,o=0;;){let s=Math.min(n<e.length?e[n].fromB:1e9,i<t.length?t[i]:1e9);if(1e9==s)break;let a=s+o,l=s,c=a;for(;;)if(i<t.length&&t[i]<=l){let r=t[i+1];i+=2,l=Math.max(l,r);for(let t=n;t<e.length&&e[t].fromB<=l;t++)o=e[t].toA-e[t].toB;c=Math.max(c,r+o)}else if(n<e.length&&e[n].fromB<=l){let t=e[n++];l=Math.max(l,t.toB),c=Math.max(c,t.toA),o=t.toA-t.toB}else break;r.push(new xX(a,c,s,l))}return r}}class xZ{constructor(e,t,r){for(let n of(this.view=e,this.state=t,this.transactions=r,this.flags=0,this.startState=e.state,this.changes=vu.empty(this.startState.doc.length),r))this.changes=this.changes.compose(n.changes);let n=[];this.changes.iterChangedRanges((e,t,r,i)=>n.push(new xX(e,t,r,i))),this.changedRanges=n}static create(e,t,r){return new xZ(e,t,r)}get viewportChanged(){return(4&this.flags)>0}get viewportMoved(){return(8&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(18&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return 0==this.flags&&0==this.transactions.length}}let xQ=[];class x0{constructor(e,t,r=0){this.dom=e,this.length=t,this.flags=r,this.parent=null,e.cmTile=this}get breakAfter(){return 1&this.flags}get children(){return xQ}isWidget(){return!1}get isHidden(){return!1}isComposite(){return!1}isLine(){return!1}isText(){return!1}isBlock(){return!1}get domAttrs(){return null}sync(e){if(this.flags|=2,4&this.flags){this.flags&=-5;let e=this.domAttrs;e&&function(e,t){for(let r=e.attributes.length-1;r>=0;r--){let n=e.attributes[r].name;null==t[n]&&e.removeAttribute(n)}for(let r in t){let n=t[r];"style"==r?e.style.cssText=n:e.getAttribute(r)!=n&&e.setAttribute(r,n)}}(this.dom,e)}}toString(){return this.constructor.name+(this.children.length?`(${this.children})`:"")+(this.breakAfter?"#":"")}destroy(){this.parent=null}setDOM(e){this.dom=e,e.cmTile=this}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e,t=this.posAtStart){let r=t;for(let t of this.children){if(t==e)return r;r+=t.length+t.breakAfter}throw RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}covers(e){return!0}coordsIn(e,t){return null}domPosFor(e,t){let r=b0(this.dom),n=this.length?e>0:t>0;return new xi(this.parent.dom,r+ +!!n,0==e||e==this.length)}markDirty(e){this.flags&=-3,e&&(this.flags|=4),this.parent&&2&this.parent.flags&&this.parent.markDirty(!1)}get overrideDOMText(){return null}get root(){for(let e=this;e;e=e.parent)if(e instanceof x4)return e;return null}static get(e){return e.cmTile}}class x1 extends x0{constructor(e){super(e,0),this._children=[]}isComposite(){return!0}get children(){return this._children}get lastChild(){return this.children.length?this.children[this.children.length-1]:null}append(e){this.children.push(e),e.parent=this}sync(e){if(2&this.flags)return;super.sync(e);let t=this.dom,r=null,n,i=(null==e?void 0:e.node)==t?e:null,o=0;for(let s of this.children){if(s.sync(e),o+=s.length+s.breakAfter,n=r?r.nextSibling:t.firstChild,i&&n!=s.dom&&(i.written=!0),s.dom.parentNode==t)for(;n&&n!=s.dom;)n=x2(n);else t.insertBefore(s.dom,n);r=s.dom}for(n=r?r.nextSibling:t.firstChild,i&&n&&(i.written=!0);n;)n=x2(n);this.length=o}}function x2(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class x4 extends x1{constructor(e,t){super(t),this.view=e}owns(e){for(;e;e=e.parent)if(e==this)return!0;return!1}isBlock(){return!0}nearest(e){for(;;){if(!e)return null;let t=x0.get(e);if(t&&this.owns(t))return t;e=e.parentNode}}blockTiles(e){for(let t=[],r=this,n=0,i=0;;)if(n==r.children.length){if(!t.length)return;(r=r.parent).breakAfter&&i++,n=t.pop()}else{let o=r.children[n++];if(o instanceof x3)t.push(n),r=o,n=0;else{let t=i+o.length,r=e(o,i);if(void 0!==r)return r;i=t+o.breakAfter}}}resolveBlock(e,t){let r,n=-1,i,o=-1;if(this.blockTiles((s,a)=>{let l=a+s.length;if(e>=a&&e<=l){if(s.isWidget()&&t>=-1&&t<=1){if(32&s.flags)return!0;16&s.flags&&(r=void 0)}(a<e||e==l&&(t<-1?s.length:s.covers(1)))&&(!r||!s.isWidget()&&r.isWidget())&&(r=s,n=e-a),(l>e||e==a&&(t>1?s.length:s.covers(-1)))&&(!i||!s.isWidget()&&i.isWidget())&&(i=s,o=e-a)}}),!r&&!i)throw Error("No tile at position "+e);return r&&t<0||!i?{tile:r,offset:n}:{tile:i,offset:o}}}class x3 extends x1{constructor(e,t){super(e),this.wrapper=t}isBlock(){return!0}covers(e){return!!this.children.length&&(e<0?this.children[0].covers(-1):this.lastChild.covers(1))}get domAttrs(){return this.wrapper.attributes}static of(e,t){let r=new x3(t||document.createElement(e.tagName),e);return t||(r.flags|=4),r}}class x5 extends x1{constructor(e,t){super(e),this.attrs=t}isLine(){return!0}static start(e,t,r){let n=new x5(t||document.createElement("div"),e);return t&&r||(n.flags|=4),n}get domAttrs(){return this.attrs}resolveInline(e,t,r){let n=null,i=-1,o=null,s=-1;!function e(a,l){for(let c=0,u=0;c<a.children.length&&u<=l;c++){let h=a.children[c],d=u+h.length;d>=l&&(h.isComposite()?e(h,l-u):(!o||o.isHidden&&(t>0||r&&function(e,t){let r=e.coordsIn(0,1),n=t.coordsIn(0,1);return r&&n&&n.top<r.bottom}(o,h)))&&(d>l||32&h.flags)?(o=h,s=l-u):(u<l||16&h.flags&&!h.isHidden)&&(n=h,i=l-u)),u=d}}(this,e);let a=(t<0?n:o)||n||o;return a?{tile:a,offset:a==n?i:s}:null}coordsIn(e,t){let r=this.resolveInline(e,t,!0);return r?r.tile.coordsIn(Math.max(0,r.offset),t):function(e){let t=e.dom.lastChild;if(!t)return e.dom.getBoundingClientRect();let r=bZ(t);return r[r.length-1]||null}(this)}domIn(e,t){let r=this.resolveInline(e,t);if(r){let{tile:e,offset:n}=r;if(this.dom.contains(e.dom))return e.isText()?new xi(e.dom,Math.min(e.dom.nodeValue.length,n)):e.domPosFor(n,16&e.flags?1:32&e.flags?-1:t);let i=r.tile.parent,o=!1;for(let e of i.children){if(o)return new xi(e.dom,0);e==r.tile&&(o=!0)}}return new xi(this.dom,0)}}class x6 extends x1{constructor(e,t){super(e),this.mark=t}get domAttrs(){return this.mark.attrs}static of(e,t){let r=new x6(t||document.createElement(e.tagName),e);return t||(r.flags|=4),r}}class x9 extends x0{constructor(e,t){super(e,t.length),this.text=t}sync(e){2&this.flags||(super.sync(e),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text))}isText(){return!0}toString(){return JSON.stringify(this.text)}coordsIn(e,t){let r=this.dom.nodeValue.length;e>r&&(e=r);let n=e,i=e,o=0;0==e&&t<0||e==r&&t>=0?!(bR.chrome||bR.gecko)&&(e?(n--,o=1):i<r&&(i++,o=-1)):t<0?n--:i<r&&i++;let s=b7(this.dom,n,i).getClientRects();if(!s.length)return null;let a=s[(o?o<0:t>=0)?0:s.length-1];return bR.safari&&!o&&0==a.width&&(a=Array.prototype.find.call(s,e=>e.width)||a),o?b3(a,o<0):a||null}static of(e,t){let r=new x9(t||document.createTextNode(e),e);return t||(r.flags|=2),r}}class x8 extends x0{constructor(e,t,r,n){super(e,t,n),this.widget=r}isWidget(){return!0}get isHidden(){return this.widget.isHidden}covers(e){return!(48&this.flags)&&(this.flags&(e<0?64:128))>0}coordsIn(e,t){return this.coordsInWidget(e,t,!1)}coordsInWidget(e,t,r){let n=this.widget.coordsAt(this.dom,e,t);if(n)return n;if(r)return b3(this.dom.getBoundingClientRect(),this.length?0==e:t<=0);{let t=this.dom.getClientRects(),r=null;if(!t.length)return null;let n=!!(16&this.flags)||!(32&this.flags)&&e>0;for(let i=n?t.length-1:0;r=t[i],e>0?0!=i:i!=t.length-1&&!(r.top<r.bottom);i+=n?-1:1);return b3(r,!n)}}get overrideDOMText(){if(!this.length)return y3.empty;let{root:e}=this;if(!e)return y3.empty;let t=this.posAtStart;return e.view.state.doc.slice(t,t+this.length)}destroy(){super.destroy(),this.widget.destroy(this.dom)}static of(e,t,r,n,i){return!i&&(i=e.toDOM(t),e.editable||(i.contentEditable="false")),new x8(i,r,e,n)}}class x7 extends x0{constructor(e){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),super(t,0,e)}get isHidden(){return!0}get overrideDOMText(){return y3.empty}coordsIn(e){return this.dom.getBoundingClientRect()}}class we{constructor(e){this.index=0,this.beforeBreak=!1,this.parents=[],this.tile=e}advance(e,t,r){let{tile:n,index:i,beforeBreak:o,parents:s}=this;for(;e||t>0;)if(n.isComposite())if(o){if(!e)break;r&&r.break(),e--,o=!1}else if(i==n.children.length){if(!e&&!s.length)break;r&&r.leave(n),o=!!n.breakAfter,({tile:n,index:i}=s.pop()),i++}else{let a=n.children[i],l=a.breakAfter;(t>0?a.length<=e:a.length<e)&&(!r||!1!==r.skip(a,0,a.length)||!a.isComposite)?(o=!!l,i++,e-=a.length):(s.push({tile:n,index:i}),n=a,i=0,r&&a.isComposite()&&r.enter(a))}else if(i==n.length)o=!!n.breakAfter,({tile:n,index:i}=s.pop()),i++;else if(e){let t=Math.min(e,n.length-i);r&&r.skip(n,i,i+t),e-=t,i+=t}else break;return this.tile=n,this.index=i,this.beforeBreak=o,this}get root(){return this.parents.length?this.parents[0].tile:this.tile}}class wt{constructor(e,t,r,n){this.from=e,this.to=t,this.wrapper=r,this.rank=n}}class wr{constructor(e,t,r){this.cache=e,this.root=t,this.blockWrappers=r,this.curLine=null,this.lastBlock=null,this.afterWidget=null,this.pos=0,this.wrappers=[],this.wrapperPos=0}addText(e,t,r,n){var i;this.flushBuffer();let o=this.ensureMarks(t,r),s=o.lastChild;s&&s.isText()&&!(8&s.flags)&&s.length+e.length<512?(this.cache.reused.set(s,2),(o.children[o.children.length-1]=new x9(s.dom,s.text+e)).parent=o):o.append(n||x9.of(e,null==(i=this.cache.find(x9))?void 0:i.dom)),this.pos+=e.length,this.afterWidget=null}addComposition(e,t){let r=this.curLine;r.dom!=t.line.dom&&(r.setDOM(this.cache.reused.has(t.line)?wc(t.line.dom):t.line.dom),this.cache.reused.set(t.line,2));let n=r;for(let e=t.marks.length-1;e>=0;e--){let r=t.marks[e],i=n.lastChild;if(i instanceof x6&&i.mark.eq(r.mark))i.dom!=r.dom&&i.setDOM(wc(r.dom)),n=i;else{if(this.cache.reused.get(r)){let e=x0.get(r.dom);e&&e.setDOM(wc(r.dom))}let e=x6.of(r.mark,r.dom);n.append(e),n=e}this.cache.reused.set(r,2)}let i=x0.get(e.text);i&&this.cache.reused.set(i,2);let o=new x9(e.text,e.text.nodeValue);o.flags|=8,n.append(o)}addInlineWidget(e,t,r){let n=this.afterWidget&&48&e.flags&&(48&this.afterWidget.flags)==(48&e.flags);n||this.flushBuffer();let i=this.ensureMarks(t,r);n||16&e.flags||i.append(this.getBuffer(1)),i.append(e),this.pos+=e.length,this.afterWidget=e}addMark(e,t,r){this.flushBuffer(),this.ensureMarks(t,r).append(e),this.pos+=e.length,this.afterWidget=null}addBlockWidget(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}continueWidget(e){let t=this.afterWidget||this.lastBlock;t.length+=e,this.pos+=e}addLineStart(e,t){var r;e||(e=wl);let n=x5.start(e,t||(null==(r=this.cache.find(x5))?void 0:r.dom),!!t);this.getBlockPos().append(this.lastBlock=this.curLine=n)}addLine(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}addBreak(){this.lastBlock.flags|=1,this.endLine(),this.pos++}addLineStartIfNotCovered(e){this.blockPosCovered()||this.addLineStart(e)}ensureLine(e){this.curLine||this.addLineStart(e)}ensureMarks(e,t){var r;let n=this.curLine;for(let i=e.length-1;i>=0;i--){let o=e[i],s;if(t>0&&(s=n.lastChild)&&s instanceof x6&&s.mark.eq(o))n=s,t--;else{let e=x6.of(o,null==(r=this.cache.find(x6,e=>e.mark.eq(o)))?void 0:r.dom);n.append(e),n=e,t=0}}return n}endLine(){if(this.curLine){this.flushBuffer();let e=this.curLine.lastChild;(!e||!wa(this.curLine,!1)||"BR"!=e.dom.nodeName&&e.isWidget()&&!(bR.ios&&wa(this.curLine,!0)))&&this.curLine.append(this.cache.findWidget(wh,0,32)||new x8(wh.toDOM(),0,wh,32)),this.curLine=this.afterWidget=null}}updateBlockWrappers(){this.wrapperPos>this.pos+1e4&&(this.blockWrappers.goto(this.pos),this.wrappers.length=0);for(let e=this.wrappers.length-1;e>=0;e--)this.wrappers[e].to<this.pos&&this.wrappers.splice(e,1);for(let e=this.blockWrappers;e.value&&e.from<=this.pos;e.next())if(e.to>=this.pos){let t=new wt(e.from,e.to,e.value,e.rank),r=this.wrappers.length;for(;r>0&&0>(this.wrappers[r-1].rank-t.rank||this.wrappers[r-1].to-t.to);)r--;this.wrappers.splice(r,0,t)}this.wrapperPos=this.pos}getBlockPos(){var e;this.updateBlockWrappers();let t=this.root;for(let r of this.wrappers){let n=t.lastChild;if(r.from<this.pos&&n instanceof x3&&n.wrapper.eq(r.wrapper))t=n;else{let n=x3.of(r.wrapper,null==(e=this.cache.find(x3,e=>e.wrapper.eq(r.wrapper)))?void 0:e.dom);t.append(n),t=n}}return t}blockPosCovered(){let e=this.lastBlock;return null!=e&&!e.breakAfter&&(!e.isWidget()||(160&e.flags)>0)}getBuffer(e){let t=2|(e<0?16:32),r=this.cache.find(x7,void 0,1);return r&&(r.flags=t),r||new x7(t)}flushBuffer(){this.afterWidget&&!(32&this.afterWidget.flags)&&(this.afterWidget.parent.append(this.getBuffer(-1)),this.afterWidget=null)}}class wn{constructor(e){this.skipCount=0,this.text="",this.textOff=0,this.cursor=e.iter()}skip(e){this.textOff+e<=this.text.length?this.textOff+=e:(this.skipCount+=e-(this.text.length-this.textOff),this.text="",this.textOff=0)}next(e){if(this.textOff==this.text.length){let{value:t,lineBreak:r,done:n}=this.cursor.next(this.skipCount);if(this.skipCount=0,n)throw Error("Ran out of text content when drawing inline views");this.text=t;let i=this.textOff=Math.min(e,t.length);return r?null:t.slice(0,i)}let t=Math.min(this.text.length,this.textOff+e),r=this.text.slice(this.textOff,t);return this.textOff=t,r}}let wi=[x8,x5,x9,x6,x7,x3,x4];for(let e=0;e<wi.length;e++)wi[e].bucket=e;class wo{constructor(e){this.view=e,this.buckets=wi.map(()=>[]),this.index=wi.map(()=>0),this.reused=new Map}add(e){let t=e.constructor.bucket,r=this.buckets[t];r.length<6?r.push(e):r[this.index[t]=(this.index[t]+1)%6]=e}find(e,t,r=2){let n=e.bucket,i=this.buckets[n],o=this.index[n];for(let e=i.length-1;e>=0;e--){let s=(e+o)%i.length,a=i[s];if((!t||t(a))&&!this.reused.has(a))return i.splice(s,1),s<o&&this.index[n]--,this.reused.set(a,r),a}return null}findWidget(e,t,r){let n=this.buckets[0];if(n.length)for(let i=0,o=0;;i++){if(i==n.length){if(o)return null;o=1,i=0}let s=n[i];if(!this.reused.has(s)&&(0==o?s.widget.compare(e):s.widget.constructor==e.constructor&&e.updateDOM(s.dom,this.view))){if(n.splice(i,1),i<this.index[0]&&this.index[0]--,s.widget==e&&s.length==t&&(497&s.flags)==r)return this.reused.set(s,1),s;return this.reused.set(s,2),new x8(s.dom,t,e,-498&s.flags|r)}}}reuse(e){return this.reused.set(e,1),e}maybeReuse(e,t=2){if(!this.reused.has(e))return this.reused.set(e,t),e.dom}clear(){for(let e=0;e<this.buckets.length;e++)this.buckets[e].length=this.index[e]=0}}class ws{constructor(e,t,r,n,i){this.view=e,this.decorations=n,this.disallowBlockEffectsFor=i,this.openWidget=!1,this.openMarks=0,this.cache=new wo(e),this.text=new wn(e.state.doc),this.builder=new wr(this.cache,new x4(e,e.contentDOM),v9.iter(r)),this.cache.reused.set(t,2),this.old=new we(t),this.reuseWalker={skip:(e,t,r)=>{if(this.cache.add(e),e.isComposite())return!1},enter:e=>this.cache.add(e),leave:()=>{},break:()=>{}}}run(e,t){let r=t&&this.getCompositionContext(t.text);for(let n=0,i=0,o=0;;){let s=o<e.length?e[o++]:null,a=s?s.fromA:this.old.root.length;if(a>n){let e=a-n;this.preserve(e,!o,!s),n=a,i+=e}if(!s)break;t&&s.fromA<=t.range.fromA&&s.toA>=t.range.toA?(this.forward(s.fromA,t.range.fromA,t.range.fromA<t.range.toA?1:-1),this.emit(i,t.range.fromB),this.cache.clear(),this.builder.addComposition(t,r),this.text.skip(t.range.toB-t.range.fromB),this.forward(t.range.fromA,s.toA),this.emit(t.range.toB,s.toB)):(this.forward(s.fromA,s.toA),this.emit(i,s.toB)),i=s.toB,n=s.toA}return this.builder.curLine&&this.builder.endLine(),this.builder.root}preserve(e,t,r){let n=function(e){let t=[];for(let r=e.parents.length;r>1;r--){let n=r==e.parents.length?e.tile:e.parents[r].tile;n instanceof x6&&t.push(n.mark)}return t}(this.old),i=this.openMarks;this.old.advance(e,r?1:-1,{skip:(e,t,r)=>{if(e.isWidget())if(this.openWidget)this.builder.continueWidget(r-t);else{let o=r>0||t<e.length?x8.of(e.widget,this.view,r-t,496&e.flags,this.cache.maybeReuse(e)):this.cache.reuse(e);256&o.flags?(o.flags&=-2,this.builder.addBlockWidget(o)):(this.builder.ensureLine(null),this.builder.addInlineWidget(o,n,i),i=n.length)}else if(e.isText())this.builder.ensureLine(null),t||r!=e.length?(this.cache.add(e),this.builder.addText(e.text.slice(t,r),n,i)):this.builder.addText(e.text,n,i,this.cache.reuse(e)),i=n.length;else if(e.isLine())e.flags&=-2,this.cache.reused.set(e,1),this.builder.addLine(e);else if(e instanceof x7)this.cache.add(e);else{if(!(e instanceof x6))return!1;this.builder.ensureLine(null),this.builder.addMark(e,n,i),this.cache.reused.set(e,1),i=n.length}this.openWidget=!1},enter:e=>{e.isLine()?this.builder.addLineStart(e.attrs,this.cache.maybeReuse(e)):(this.cache.add(e),e instanceof x6&&n.unshift(e.mark)),this.openWidget=!1},leave:e=>{e.isLine()?n.length&&(n.length=i=0):e instanceof x6&&(n.shift(),i=Math.min(i,n.length))},break:()=>{this.builder.addBreak(),this.openWidget=!1}}),this.text.skip(e)}emit(e,t){let r=null,n=this.builder,i=0,o=v9.spans(this.decorations,e,t,{point:(e,t,o,s,a,l)=>{var c,u,h;if(o instanceof bU){if(this.disallowBlockEffectsFor[l]){if(o.block)throw RangeError("Block decorations may not be specified via plugins");if(t>this.view.state.doc.lineAt(e).to)throw RangeError("Decorations that replace line breaks may not be specified via plugins")}if(i=s.length,a>s.length)n.continueWidget(t-e);else{let i,l=o.widget||(o.block?wu.block:wu.inline),u=(i=(c=o).isReplace?64*(c.startSide<0)|128*(c.endSide>0):c.startSide>0?32:16,c.block&&(i|=256),i),h=this.cache.findWidget(l,t-e,u)||x8.of(l,this.view,t-e,u);o.block?(o.startSide>0&&n.addLineStartIfNotCovered(r),n.addBlockWidget(h)):(n.ensureLine(r),n.addInlineWidget(h,s,a))}r=null}else{let e,t;u=r,e=(h=o).spec.attributes,t=h.spec.class,(e||t)&&(u||(u={class:"cm-line"}),e&&bN(e,u),t&&(u.class+=" "+t)),r=u}t>e&&this.text.skip(t-e)},span:(e,t,i,o)=>{for(let s=e;s<t;){let a=this.text.next(Math.min(512,t-s));null==a?(n.addLineStartIfNotCovered(r),n.addBreak(),s++):(n.ensureLine(r),n.addText(a,i,s==e?o:i.length),s+=a.length),r=null}}});n.addLineStartIfNotCovered(r),this.openWidget=o>i,this.openMarks=o}forward(e,t,r=1){t-e<=10?this.old.advance(t-e,r,this.reuseWalker):(this.old.advance(5,-1,this.reuseWalker),this.old.advance(t-e-10,-1),this.old.advance(5,r,this.reuseWalker))}getCompositionContext(e){let t=[],r=null;for(let n=e.parentNode;;n=n.parentNode){let e=x0.get(n);if(n==this.view.contentDOM)break;e instanceof x6?t.push(e):(null==e?void 0:e.isLine())?r=e:"DIV"!=n.nodeName||r||n==this.view.contentDOM?t.push(x6.of(new bV({tagName:n.nodeName.toLowerCase(),attributes:function(e){let t=Object.create(null);for(let r=0;r<e.attributes.length;r++){let n=e.attributes[r];t[n.name]=n.value}return t}(n)}),n)):r=new x5(n,wl)}return{line:r,marks:t}}}function wa(e,t){let r=e=>{for(let n of e.children)if((t?n.isText():n.length)||r(n))return!0;return!1};return r(e)}let wl={class:"cm-line"};function wc(e){let t=x0.get(e);return t&&t.setDOM(e.cloneNode()),e}class wu extends bB{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}wu.inline=new wu("span"),wu.block=new wu("div");let wh=new class extends bB{toDOM(){return document.createElement("br")}get isHidden(){return!0}get editable(){return!0}};class wd{constructor(e){this.view=e,this.decorations=[],this.blockWrappers=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.editContextFormatting=bW.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.updateDeco(),this.tile=new x4(e,e.contentDOM),this.updateInner([new xX(0,0,0,e.state.doc.length)],null)}update(e){var t,r,n,i,o,s,a,l,c;let u,h,d,f=e.changedRanges;this.minWidth>0&&f.length&&(f.every(({fromA:e,toA:t})=>t<this.minWidthFrom||e>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let p=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&((null==(t=this.domChanged)?void 0:t.newSel)?p=this.domChanged.newSel.head:(r=e.changes,n=this.hasComposition,u=!1,n&&r.iterChangedRanges((e,t)=>{e<n.to&&t>n.from&&(u=!0)}),u||e.selectionSet||(p=e.state.selection.main.head)));let m=p>-1?function(e,t,r){let n=wp(e,r);if(!n)return null;let{node:i,from:o,to:s}=n,a=i.nodeValue;if(/[\n\r]/.test(a)||e.state.doc.sliceString(n.from,n.to)!=a)return null;let l=t.invertedDesc;return{range:new xX(l.mapPos(o),l.mapPos(s),o,s),text:i}}(this.view,e.changes,p):null;if(this.domChanged=null,this.hasComposition){let{from:t,to:r}=this.hasComposition;f=new xX(t,r,e.changes.mapPos(t,-1),e.changes.mapPos(r,1)).addToSet(f.slice())}this.hasComposition=m?{from:m.range.fromB,to:m.range.toB}:null,(bR.ie||bR.chrome)&&!m&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let g=this.decorations,y=this.blockWrappers;this.updateDeco();let v=(i=g,o=this.decorations,s=e.changes,h=new wm,v9.compare(i,o,s,h),h.changes);v.length&&(f=xX.extendWithRanges(f,v));let b=(a=y,l=this.blockWrappers,c=e.changes,d=new wg,v9.compare(a,l,c,d),d.changes);return b.length&&(f=xX.extendWithRanges(f,b)),m&&!f.some(e=>e.fromA<=m.range.fromA&&e.toA>=m.range.toA)&&(f=m.range.addToSet(f.slice())),(!(2&this.tile.flags)||0!=f.length)&&(this.updateInner(f,m),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0;let{observer:r}=this.view;r.ignore(()=>{if(t||e.length){let r=this.tile,n=new ws(this.view,r,this.blockWrappers,this.decorations,this.dynamicDecorationMap);this.tile=n.run(e,t),wf(r,n.cache.reused)}this.tile.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.tile.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let n=bR.chrome||bR.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.tile.sync(n),n&&(n.written||r.selectionRange.focusNode!=n.node||!this.tile.dom.contains(n.node))&&(this.forceSelection=!0),this.tile.dom.style.height=""});let n=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let e of this.tile.children)e.isWidget()&&e.widget instanceof wy&&n.push(e.dom);r.updateGaps(n)}updateEditContextFormatting(e){for(let t of(this.editContextFormatting=this.editContextFormatting.map(e.changes),e.transactions))for(let e of t.effects)e.is(x$)&&(this.editContextFormatting=e.value)}updateSelection(e=!1,t=!1){var r;(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let{dom:n}=this.tile,i=this.view.root.activeElement,o=i==n,s=!o&&!(this.view.state.facet(xR)||n.tabIndex>-1)&&bX(n,this.view.observer.selectionRange)&&!(i&&n.contains(i));if(!(o||t||s))return;let a=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,c,u;if(l.empty?u=c=this.inlineDOMNearPos(l.anchor,l.assoc||1):(u=this.inlineDOMNearPos(l.head,l.head==l.from?1:-1),c=this.inlineDOMNearPos(l.anchor,l.anchor==l.from?1:-1)),bR.gecko&&l.empty&&!this.hasComposition&&1==(r=c).node.nodeType&&r.node.firstChild&&(0==r.offset||"false"==r.node.childNodes[r.offset-1].contentEditable)&&(r.offset==r.node.childNodes.length||"false"==r.node.childNodes[r.offset].contentEditable)){let e=document.createTextNode("");this.view.observer.ignore(()=>c.node.insertBefore(e,c.node.childNodes[c.offset]||null)),c=u=new xi(e,0),a=!0}let h=this.view.observer.selectionRange;!a&&h.focusNode&&(bQ(c.node,c.offset,h.anchorNode,h.anchorOffset)&&bQ(u.node,u.offset,h.focusNode,h.focusOffset)||this.suppressWidgetCursorChange(h,l))||(this.view.observer.ignore(()=>{bR.android&&bR.chrome&&n.contains(h.focusNode)&&function(e,t){for(let r=e;r&&r!=t;r=r.assignedSlot||r.parentNode)if(1==r.nodeType&&"false"==r.contentEditable)return!0;return!1}(h.focusNode,n)&&(n.blur(),n.focus({preventScroll:!0}));let e=bJ(this.view.root);if(e)if(l.empty){if(bR.gecko){var t,r;let e=(t=c.node,r=c.offset,1!=t.nodeType?0:(r&&"false"==t.childNodes[r-1].contentEditable?1:0)|2*(r<t.childNodes.length&&"false"==t.childNodes[r].contentEditable));if(e&&3!=e){let t=(1==e?xr:xn)(c.node,c.offset);t&&(c=new xi(t.node,t.offset))}}e.collapse(c.node,c.offset),null!=l.bidiLevel&&void 0!==e.caretBidiLevel&&(e.caretBidiLevel=l.bidiLevel)}else if(e.extend){e.collapse(c.node,c.offset);try{e.extend(u.node,u.offset)}catch(e){}}else{let t=document.createRange();l.anchor>l.head&&([c,u]=[u,c]),t.setEnd(u.node,u.offset),t.setStart(c.node,c.offset),e.removeAllRanges(),e.addRange(t)}s&&this.view.root.activeElement==n&&(n.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(c,u)),this.impreciseAnchor=c.precise?null:new xi(h.anchorNode,h.anchorOffset),this.impreciseHead=u.precise?null:new xi(h.focusNode,h.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&bQ(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,r=bJ(e.root),{anchorNode:n,anchorOffset:i}=e.observer.selectionRange;if(!r||!t.empty||!t.assoc||!r.modify)return;let o=this.lineAt(t.head,t.assoc);if(!o)return;let s=o.posAtStart;if(t.head==s||t.head==s+o.length)return;let a=this.coordsAt(t.head,-1),l=this.coordsAt(t.head,1);if(!a||!l||a.bottom>l.top)return;let c=this.domAtPos(t.head+t.assoc,t.assoc);r.collapse(c.node,c.offset),r.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let u=e.observer.selectionRange;e.docView.posFromDOM(u.anchorNode,u.anchorOffset)!=t.from&&r.collapse(n,i)}posFromDOM(e,t){let r=this.tile.nearest(e);if(!r)return 2&this.tile.dom.compareDocumentPosition(e)?0:this.view.state.doc.length;let n=r.posAtStart;if(r.isComposite()){let i;if(e==r.dom)i=r.dom.childNodes[t];else{let n=0==b4(e)?0:0==t?-1:1;for(;;){let t=e.parentNode;if(t==r.dom)break;0==n&&t.firstChild!=t.lastChild&&(n=e==t.firstChild?-1:1),e=t}i=n<0?e:e.nextSibling}if(i==r.dom.firstChild)return n;for(;i&&!x0.get(i);)i=i.nextSibling;if(!i)return n+r.length;for(let e=0,t=n;;e++){let n=r.children[e];if(n.dom==i)return t;t+=n.length+n.breakAfter}}else if(r.isText())return e==r.dom?n+t:n+(t?r.length:0);else return n}domAtPos(e,t){let{tile:r,offset:n}=this.tile.resolveBlock(e,t);return r.isWidget()?r.domPosFor(e,t):r.domIn(n,t)}inlineDOMNearPos(e,t){let r,n=-1,i=!1,o,s=-1,a=!1;return(this.tile.blockTiles((t,l)=>{if(t.isWidget()){if(32&t.flags&&l>=e)return!0;16&t.flags&&(i=!0)}else{let c=l+t.length;if(l<=e&&(r=t,n=e-l,i=c<e),c>=e&&!o&&(o=t,s=e-l,a=l>e),l>e&&o)return!0}}),r||o)?(i&&o?r=null:a&&r&&(o=null),r&&t<0||!o?r.domIn(n,t):o.domIn(s,t)):this.domAtPos(e,t)}coordsAt(e,t){let{tile:r,offset:n}=this.tile.resolveBlock(e,t);return r.isWidget()?r.widget instanceof wy?null:r.coordsInWidget(n,t,!0):r.coordsIn(n,t)}lineAt(e,t){let{tile:r}=this.tile.resolveBlock(e,t);return r.isLine()?r:null}coordsForChar(e){let{tile:t,offset:r}=this.tile.resolveBlock(e,1);return t.isLine()?function e(t,r){if(t.isComposite())for(let n of t.children){if(n.length>=r){let t=e(n,r);if(t)return t}if((r-=n.length)<0)break}else if(t.isText()&&r<t.length){let e=vn(t.text,r);if(e==r)return null;let n=b7(t.dom,r,e).getClientRects();for(let e=0;e<n.length;e++){let t=n[e];if(e==n.length-1||t.top<t.bottom&&t.left<t.right)return t}}return null}(t,r):null}measureVisibleLineHeights(e){let t=[],{from:r,to:n}=e,i=this.view.contentDOM.clientWidth,o=i>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,s=-1,a=this.view.textDirection==xo.LTR,l=0,c=(e,u,h)=>{for(let d=0;d<e.children.length&&!(u>n);d++){let n=e.children[d],f=u+n.length,p=n.dom.getBoundingClientRect(),{height:m}=p;if(h&&!d&&(l+=p.top-h.top),n instanceof x3)f>r&&c(n,u,p);else if(u>=r&&(l>0&&t.push(-l),t.push(m+l),l=0,o)){let e=n.dom.lastChild,t=e?bZ(e):[];if(t.length){let e=t[t.length-1],r=a?e.right-p.left:p.right-e.left;r>s&&(s=r,this.minWidth=i,this.minWidthFrom=u,this.minWidthTo=f)}}h&&d==e.children.length-1&&(l+=h.bottom-p.bottom),u=f+n.breakAfter}};return c(this.tile,0,null),t}textDirectionAt(e){let{tile:t}=this.tile.resolveBlock(e,1);return"rtl"==getComputedStyle(t.dom).direction?xo.RTL:xo.LTR}measureTextSize(){let e=this.tile.blockTiles(e=>{if(e.isLine()&&e.children.length&&e.length<=20){let t=0,r;for(let n of e.children){if(!n.isText()||/[^ -~]/.test(n.text))return;let e=bZ(n.dom);if(1!=e.length)return;t+=e[0].width,r=e[0].height}if(t)return{lineHeight:e.dom.getBoundingClientRect().height,charWidth:t/e.length,textHeight:r}}});if(e)return e;let t=document.createElement("div"),r,n,i;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.tile.dom.appendChild(t);let e=bZ(t.firstChild)[0];r=t.getBoundingClientRect().height,n=e&&e.width?e.width/27:7,i=e&&e.height?e.height:r,t.remove()}),{lineHeight:r,charWidth:n,textHeight:i}}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let r=0,n=0;;n++){let i=n==t.viewports.length?null:t.viewports[n],o=i?i.from-1:this.view.state.doc.length;if(o>r){let n=(t.lineBlockAt(o).bottom-t.lineBlockAt(r).top)/this.view.scaleY;e.push(bW.replace({widget:new wy(n),block:!0,inclusive:!0,isBlockGap:!0}).range(r,o))}if(!i)break;r=i.to+1}return bW.set(e)}updateDeco(){let e=1,t=this.view.state.facet(xW).map(t=>(this.dynamicDecorationMap[e++]="function"==typeof t)?t(this.view):t),r=!1,n=this.view.state.facet(xH).map((e,t)=>{let n="function"==typeof e;return n&&(r=!0),n?e(this.view):e});for(n.length&&(this.dynamicDecorationMap[e++]=r,t.push(v9.join(n))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;this.blockWrappers=this.view.state.facet(xV).map(e=>"function"==typeof e?e(this.view):e)}scrollIntoView(e){if(e.isSnapshot){let t=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=t.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let t of this.view.state.facet(xP))try{if(t(this.view,e.range,e))return!0}catch(e){xD(this.view.state,e,"scroll handler")}let{range:t}=e,r=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),n;if(!r)return;!t.empty&&(n=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(r={left:Math.min(r.left,n.left),top:Math.min(r.top,n.top),right:Math.max(r.right,n.right),bottom:Math.max(r.bottom,n.bottom)});let i=xJ(this.view),o={left:r.left-i.left,top:r.top-i.top,right:r.right+i.right,bottom:r.bottom+i.bottom},{offsetWidth:s,offsetHeight:a}=this.view.scrollDOM;!function(e,t,r,n,i,o,s,a){let l=e.ownerDocument,c=l.defaultView||window;for(let u=e,h=!1;u&&!h;)if(1==u.nodeType){let e,d=u==l.body,f=1,p=1;if(d)e=function(e){let t=e.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.innerWidth,top:0,bottom:e.innerHeight}}(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(u).position)&&(h=!0),u.scrollHeight<=u.clientHeight&&u.scrollWidth<=u.clientWidth){u=u.assignedSlot||u.parentNode;continue}let t=u.getBoundingClientRect();({scaleX:f,scaleY:p}=b5(u,t)),e={left:t.left,right:t.left+u.clientWidth*f,top:t.top,bottom:t.top+u.clientHeight*p}}let m=0,g=0;if("nearest"==i)t.top<e.top?(g=t.top-(e.top+s),r>0&&t.bottom>e.bottom+g&&(g=t.bottom-e.bottom+s)):t.bottom>e.bottom&&(g=t.bottom-e.bottom+s,r<0&&t.top-g<e.top&&(g=t.top-(e.top+s)));else{let n=t.bottom-t.top,o=e.bottom-e.top;g=("center"==i&&n<=o?t.top+n/2-o/2:"start"==i||"center"==i&&r<0?t.top-s:t.bottom-o+s)-e.top}if("nearest"==n?t.left<e.left?(m=t.left-(e.left+o),r>0&&t.right>e.right+m&&(m=t.right-e.right+o)):t.right>e.right&&(m=t.right-e.right+o,r<0&&t.left<e.left+m&&(m=t.left-(e.left+o))):m=("center"==n?t.left+(t.right-t.left)/2-(e.right-e.left)/2:"start"==n==a?t.left-o:t.right-(e.right-e.left)+o)-e.left,m||g)if(d)c.scrollBy(m,g);else{let e=0,r=0;if(g){let e=u.scrollTop;u.scrollTop+=g/p,r=(u.scrollTop-e)*p}if(m){let t=u.scrollLeft;u.scrollLeft+=m/f,e=(u.scrollLeft-t)*f}t={left:t.left-e,top:t.top-r,right:t.right-e,bottom:t.bottom-r},e&&1>Math.abs(e-m)&&(n="nearest"),r&&1>Math.abs(r-g)&&(i="nearest")}if(d)break;(t.top<e.top||t.bottom>e.bottom||t.left<e.left||t.right>e.right)&&(t={left:Math.max(t.left,e.left),right:Math.min(t.right,e.right),top:Math.max(t.top,e.top),bottom:Math.min(t.bottom,e.bottom)}),u=u.assignedSlot||u.parentNode}else if(11==u.nodeType)u=u.host;else break}(this.view.scrollDOM,o,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,s),-s),Math.max(Math.min(e.yMargin,a),-a),this.view.textDirection==xo.LTR)}lineHasWidget(e){let t=e=>e.isWidget()||e.children.some(t);return t(this.tile.resolveBlock(e,1).tile)}destroy(){wf(this.tile)}}function wf(e,t){let r=null==t?void 0:t.get(e);if(1!=r)for(let n of(null==r&&e.destroy(),e.children))wf(n,t)}function wp(e,t){let r=e.observer.selectionRange;if(!r.focusNode)return null;let n=xr(r.focusNode,r.focusOffset),i=xn(r.focusNode,r.focusOffset),o=n||i;if(i&&n&&i.node!=n.node){let t=x0.get(i.node);if(!t||t.isText()&&t.text!=i.node.nodeValue)o=i;else if(e.docView.lastCompositionAfterCursor){let e=x0.get(n.node);!e||e.isText()&&e.text!=n.node.nodeValue||(o=i)}}if(e.docView.lastCompositionAfterCursor=o!=n,!o)return null;let s=t-o.offset;return{from:s,to:s+o.node.nodeValue.length,node:o.node}}let wm=class{constructor(){this.changes=[]}compareRange(e,t){bK(e,t,this.changes)}comparePoint(e,t){bK(e,t,this.changes)}boundChange(e){bK(e,e,this.changes)}};class wg{constructor(){this.changes=[]}compareRange(e,t){bK(e,t,this.changes)}comparePoint(){}boundChange(e){bK(e,e,this.changes)}}class wy extends bB{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function wv(e,t,r){let n=e.lineBlockAt(t);if(Array.isArray(n.type)){let e;for(let i of n.type){if(i.from>t)break;if(!(i.to<t)){if(i.from<t&&i.to>t)return i;(!e||i.type==bz.Text&&(e.type!=i.type||(r<0?i.from<t:i.to>t)))&&(e=i)}}return e||n}return n}function wb(e,t,r,n){let i=e.state.doc.lineAt(t.head),o=e.bidiSpans(i),s=e.textDirectionAt(i.from);for(let a=t,l=null;;){let t=function(e,t,r,n,i){var o;let s=n.head-e.from,a=xm.find(t,s,null!=(o=n.bidiLevel)?o:-1,n.assoc),l=t[a],c=l.side(i,r);if(s==c){let e=a+=i?1:-1;if(e<0||e>=t.length)return null;s=(l=t[a=e]).side(!i,r),c=l.side(i,r)}let u=vn(e.text,s,l.forward(i,r));(u<l.from||u>l.to)&&(u=c),xv=e.text.slice(Math.min(s,u),Math.max(s,u));let h=a==(i?t.length-1:0)?null:t[a+(i?1:-1)];return h&&u==c&&h.level+ +!i<l.level?vv.cursor(h.side(!i,r)+e.from,h.forward(i,r)?1:-1,h.level):vv.cursor(u+e.from,l.forward(i,r)?-1:1,l.level)}(i,o,s,a,r),c=xv;if(!t){if(i.number==(r?e.state.doc.lines:1))return a;c="\n",i=e.state.doc.line(i.number+(r?1:-1)),o=e.bidiSpans(i),t=e.visualLineSide(i,!r)}if(l){if(!l(c))return a}else{if(!n)return t;l=n(c)}a=t}}function wx(e,t,r){for(;;){let n=0;for(let i of e)i.between(t-1,t+1,(e,i,o)=>{if(t>e&&t<i){let o=n||r||(t-e<i-t?-1:1);t=o<0?e:i,n=o}});if(!n)return t}}function ww(e,t){let r=null;for(let n=0;n<t.ranges.length;n++){let i=t.ranges[n],o=null;if(i.empty){let t=wx(e,i.from,0);t!=i.from&&(o=vv.cursor(t,-1))}else{let t=wx(e,i.from,-1),r=wx(e,i.to,1);(t!=i.from||r!=i.to)&&(o=vv.range(i.from==i.anchor?t:r,i.from==i.head?t:r))}o&&(r||(r=t.ranges.slice()),r[n]=o)}return r?vv.create(r,t.mainIndex):t}function wk(e,t,r){let n=wx(e.state.facet(xU).map(t=>t(e)),r.from,t.head>r.from?-1:1);return n==r.from?r:vv.cursor(n,n<r.from?1:-1)}class wA{constructor(e,t){this.pos=e,this.assoc=t}}function wS(e,t,r,n){let i=e.contentDOM.getBoundingClientRect(),o=i.top+e.viewState.paddingTop,{x:s,y:a}=t,l=a-o,c;for(;;){if(l<0)return new wA(0,1);if(l>e.viewState.docHeight)return new wA(e.state.doc.length,-1);if(c=e.elementAtHeight(l),null==n)break;if(c.type==bz.Text){if(n<0?c.to<e.viewport.from:c.from>e.viewport.to)break;let t=e.docView.coordsAt(n<0?c.from:c.to,n);if(t&&(n<0?t.top<=l+o:t.bottom>=l+o))break}let t=e.viewState.heightOracle.textHeight/2;l=n>0?c.bottom+t:c.top-t}if(e.viewport.from>=c.to||e.viewport.to<=c.from){if(r)return null;if(c.type==bz.Text){let t=function(e,t,r,n,i){let o=Math.round((n-t.left)*e.defaultCharacterWidth);if(e.lineWrapping&&r.height>1.5*e.defaultLineHeight){let t=e.viewState.heightOracle.textHeight;o+=Math.floor((i-r.top-(e.defaultLineHeight-t)*.5)/t)*e.viewState.heightOracle.lineLength}let s=e.state.sliceDoc(r.from,r.to);return r.from+bu(s,o,e.state.tabSize)}(e,i,c,s,a);return new wA(t,t==c.from?1:-1)}}if(c.type!=bz.Text)return l<(c.top+c.bottom)/2?new wA(c.from,1):new wA(c.to,-1);let u=e.docView.lineAt(c.from,2);return u&&u.length==c.length||(u=e.docView.lineAt(c.from,-2)),function e(t,r,n,i,o){let s=-1,a=null,l=1e9,c=1e9,u=o,h=o,d=(e,t)=>{for(let r=0;r<e.length;r++){let n=e[r];if(n.top==n.bottom)continue;let d=n.left>i?n.left-i:n.right<i?i-n.right:0,f=n.top>o?n.top-o:n.bottom<o?o-n.bottom:0;n.top<=h&&n.bottom>=u&&(u=Math.min(n.top,u),h=Math.max(n.bottom,h),f=0),(s<0||0>(f-c||d-l))&&(s>=0&&c&&l<d&&a.top<=h-2&&a.bottom>=u+2?c=0:(s=t,l=d,c=f,a=n))}};if(r.isText()){for(let e=0;e<r.length;){let t=vn(r.text,e);if(d(b7(r.dom,e,t).getClientRects(),e),!l&&!c)break;e=t}return i>(a.left+a.right)/2==(wj(t,s+n)==xo.LTR)?new wA(n+vn(r.text,s),-1):new wA(n+s,1)}{if(!r.length)return new wA(n,1);for(let e=0;e<r.children.length;e++){let t=r.children[e];if(!(48&t.flags)&&(d((1==t.dom.nodeType?t.dom:b7(t.dom,0,t.length)).getClientRects(),e),!l&&!c))break}let u=r.children[s],h=r.posBefore(u,n);return u.isComposite()||u.isText()?e(t,u,h,Math.max(a.left,Math.min(a.right,i)),o):i>(a.left+a.right)/2==(wj(t,s+n)==xo.LTR)?new wA(h+u.length,-1):new wA(h,1)}}(e,u,c.from,s,a)}function wj(e,t){let r=e.state.doc.lineAt(t);return e.bidiSpans(r)[xm.find(e.bidiSpans(r),t-r.from,-1,1)].dir}class wC{constructor(e,t){this.points=e,this.view=t,this.text="",this.lineSeparator=t.state.facet(v0.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=""}readRange(e,t){if(!e)return this;let r=e.parentNode;for(let n=e;;){this.findPointBefore(r,n);let e=this.text.length;this.readNode(n);let i=x0.get(n),o=n.nextSibling;if(o==t){(null==i?void 0:i.breakAfter)&&!o&&r!=this.view.contentDOM&&this.lineBreak();break}let s=x0.get(o);(i&&s?i.breakAfter:(i?i.breakAfter:b1(n))||b1(o)&&("BR"!=n.nodeName||(null==i?void 0:i.isWidget()))&&this.text.length>e)&&!function(e,t){let r;for(;e!=t&&e;e=e.nextSibling){let t=x0.get(e);if(!(null==t?void 0:t.isWidget()))return!1;t&&(r||(r=[])).push(t)}if(r)for(let e of r){let t=e.overrideDOMText;if(null==t?void 0:t.length)return!1}return!0}(o,t)&&this.lineBreak(),n=o}return this.findPointBefore(r,t),this}readTextNode(e){let t=e.nodeValue;for(let r of this.points)r.node==e&&(r.pos=this.text.length+Math.min(r.offset,t.length));for(let r=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let i=-1,o=1,s;if(this.lineSeparator?(i=t.indexOf(this.lineSeparator,r),o=this.lineSeparator.length):(s=n.exec(t))&&(i=s.index,o=s[0].length),this.append(t.slice(r,i<0?t.length:i)),i<0)break;if(this.lineBreak(),o>1)for(let t of this.points)t.node==e&&t.pos>this.text.length&&(t.pos-=o-1);r=i+o}}readNode(e){let t=x0.get(e),r=t&&t.overrideDOMText;if(null!=r){this.findPointInside(e,r.length);for(let e=r.iter();!e.next().done;)e.lineBreak?this.lineBreak():this.append(e.value)}else 3==e.nodeType?this.readTextNode(e):"BR"==e.nodeName?e.nextSibling&&this.lineBreak():1==e.nodeType&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let r of this.points)r.node==e&&e.childNodes[r.offset]==t&&(r.pos=this.text.length)}findPointInside(e,t){for(let r of this.points)(3==e.nodeType?r.node==e:e.contains(r.node))&&(r.pos=this.text.length+(!function(e,t,r){for(;;){if(!t||r<b4(t))return!1;if(t==e)return!0;r=b0(t)+1,t=t.parentNode}}(e,r.node,r.offset)?0:t))}}class wE{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class wO{constructor(e,t,r,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:i,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=function e(t,r,n,i){if(t.isComposite()){let o=-1,s=-1,a=-1,l=-1;for(let c=0,u=i,h=i;c<t.children.length;c++){let i=t.children[c],d=u+i.length;if(u<r&&d>n)return e(i,r,n,u);if(d>=r&&-1==o&&(o=c,s=u),u>n&&i.dom.parentNode==t.dom){a=c,l=h;break}h=d,u=d+i.breakAfter}return{from:s,to:l<0?i+t.length:l,startDOM:(o?t.children[o-1].dom.nextSibling:null)||t.dom.firstChild,endDOM:a<t.children.length&&a>=0?t.children[a].dom:null}}return t.isText()?{from:i,to:i+t.length,startDOM:t.dom,endDOM:t.dom.nextSibling}:null}(e.docView.tile,t,r,0))){let t=i||o?[]:function(e){let t=[];if(e.root.activeElement!=e.contentDOM)return t;let{anchorNode:r,anchorOffset:n,focusNode:i,focusOffset:o}=e.observer.selectionRange;return r&&(t.push(new wE(r,n)),(i!=r||o!=n)&&t.push(new wE(i,o))),t}(e),r=new wC(t,e);r.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=r.text,this.newSel=function(e,t){if(0==e.length)return null;let r=e[0].pos,n=2==e.length?e[1].pos:r;return r>-1&&n>-1?vv.single(r+t,n+t):null}(t,this.bounds.from)}else{let t=e.observer.selectionRange,r=i&&i.node==t.focusNode&&i.offset==t.focusOffset||!bY(e.contentDOM,t.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(t.focusNode,t.focusOffset),n=o&&o.node==t.anchorNode&&o.offset==t.anchorOffset||!bY(e.contentDOM,t.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(t.anchorNode,t.anchorOffset),s=e.viewport;if((bR.ios||bR.chrome)&&e.state.selection.main.empty&&r!=n&&(s.from>0||s.to<e.state.doc.length)){let t=Math.min(r,n),i=Math.max(r,n),o=s.from-t,a=s.to-i;(0==o||1==o||0==t)&&(0==a||-1==a||i==e.state.doc.length)&&(r=0,n=e.state.doc.length)}e.inputState.composing>-1&&e.state.selection.ranges.length>1?this.newSel=e.state.selection.replaceRange(vv.range(n,r)):this.newSel=vv.single(n,r)}}}function wM(e,t){let r,{newSel:n}=t,i=e.state.selection.main,o=e.inputState.lastKeyTime>Date.now()-100?e.inputState.lastKeyCode:-1;if(t.bounds){let{from:n,to:s}=t.bounds,a=i.from,l=null;(8===o||bR.android&&t.text.length<s-n)&&(a=i.to,l="end");let c=wT(e.state.doc.sliceString(n,s,""),t.text,a-n,l);c&&(bR.chrome&&13==o&&c.toB==c.from+2&&""==t.text.slice(c.from,c.toB)&&c.toB--,r={from:n+c.from,to:n+c.toA,insert:y3.of(t.text.slice(c.from,c.toB).split(""))})}else n&&(!e.hasFocus&&e.state.facet(xR)||wI(n,i))&&(n=null);if(!r&&!n)return!1;if(!r&&t.typeOver&&!i.empty&&n&&n.main.empty?r={from:i.from,to:i.to,insert:e.state.doc.slice(i.from,i.to)}:(bR.mac||bR.android)&&r&&r.from==r.to&&r.from==i.head-1&&/^\. ?$/.test(r.insert.toString())&&"off"==e.contentDOM.getAttribute("autocorrect")?(n&&2==r.insert.length&&(n=vv.single(n.main.anchor-1,n.main.head-1)),r={from:r.from,to:r.to,insert:y3.of([r.insert.toString().replace("."," ")])}):r&&r.from>=i.from&&r.to<=i.to&&(r.from!=i.from||r.to!=i.to)&&i.to-i.from-(r.to-r.from)<=4?r={from:i.from,to:i.to,insert:e.state.doc.slice(i.from,r.from).append(r.insert).append(e.state.doc.slice(r.to,i.to))}:e.state.doc.lineAt(i.from).to<i.to&&e.docView.lineHasWidget(i.to)&&e.inputState.insertingTextAt>Date.now()-50?r={from:i.from,to:i.to,insert:e.state.toText(e.inputState.insertingText)}:bR.chrome&&r&&r.from==r.to&&r.from==i.head&&"\n "==r.insert.toString()&&e.lineWrapping&&(n&&(n=vv.single(n.main.anchor-1,n.main.head-1)),r={from:i.from,to:i.to,insert:y3.of([" "])}),r)return wP(e,r,n,o);if(!n||wI(n,i))return!1;{let t=!1,r="select";return e.inputState.lastSelectionTime>Date.now()-50&&("select"==e.inputState.lastSelectionOrigin&&(t=!0),"select.pointer"==(r=e.inputState.lastSelectionOrigin)&&(n=ww(e.state.facet(xU).map(t=>t(e)),n))),e.dispatch({selection:n,scrollIntoView:t,userEvent:r}),!0}}function wP(e,t,r,n=-1){let i;if(bR.ios&&e.inputState.flushIOSKey(t))return!0;let o=e.state.selection.main;if(bR.android&&(t.to==o.to&&(t.from==o.from||t.from==o.from-1&&" "==e.state.sliceDoc(t.from,o.from))&&1==t.insert.length&&2==t.insert.lines&&xe(e.contentDOM,"Enter",13)||(t.from==o.from-1&&t.to==o.to&&0==t.insert.length||8==n&&t.insert.length<t.to-t.from&&t.to>o.head)&&xe(e.contentDOM,"Backspace",8)||t.from==o.from&&t.to==o.to+1&&0==t.insert.length&&xe(e.contentDOM,"Delete",46)))return!0;let s=t.insert.toString();e.inputState.composing>=0&&e.inputState.composing++;let a=()=>i||(i=function(e,t,r){let n,i=e.state,o=i.selection.main,s=-1;if(t.from==t.to&&t.from<o.from||t.from>o.to){let r=t.from<o.from?-1:1,n=r<0?o.from:o.to,a=wx(i.facet(xU).map(t=>t(e)),n,r);t.from==a&&(s=a)}if(s>-1)n={changes:t,selection:vv.cursor(t.from+t.insert.length,-1)};else if(t.from>=o.from&&t.to<=o.to&&t.to-t.from>=(o.to-o.from)/3&&(!r||r.main.empty&&r.main.from==t.from+t.insert.length)&&e.inputState.composing<0){let r=o.from<t.from?i.sliceDoc(o.from,t.from):"",s=o.to>t.to?i.sliceDoc(t.to,o.to):"";n=i.replaceSelection(e.state.toText(r+t.insert.sliceString(0,void 0,e.state.lineBreak)+s))}else{let s=i.changes(t),a=r&&r.main.to<=s.newLength?r.main:void 0;if(i.selection.ranges.length>1&&(e.inputState.composing>=0||e.inputState.compositionPendingChange)&&t.to<=o.to+10&&t.to>=o.to-10){let l=e.state.sliceDoc(t.from,t.to),c,u=r&&wp(e,r.main.head);if(u){let e=t.insert.length-(t.to-t.from);c={from:u.from,to:u.to-e}}else c=e.state.doc.lineAt(o.head);let h=o.to-t.to;n=i.changeByRange(r=>{if(r.from==o.from&&r.to==o.to)return{changes:s,range:a||r.map(s)};let n=r.to-h,u=n-l.length;if(e.state.sliceDoc(u,n)!=l||n>=c.from&&u<=c.to)return{range:r};let d=i.changes({from:u,to:n,insert:t.insert}),f=r.to-o.to;return{changes:d,range:a?vv.range(Math.max(0,a.anchor+f),Math.max(0,a.head+f)):r.map(d)}})}else n={changes:s,selection:a&&i.selection.replaceRange(a)}}let a="input.type";return(e.composing||e.inputState.compositionPendingChange&&e.inputState.compositionEndedAt>Date.now()-50)&&(e.inputState.compositionPendingChange=!1,a+=".compose",e.inputState.compositionFirstChange&&(a+=".start",e.inputState.compositionFirstChange=!1)),i.update(n,{userEvent:a,scrollIntoView:!0})}(e,t,r));return e.state.facet(xS).some(r=>r(e,t.from,t.to,s,a))||e.dispatch(a()),!0}function wT(e,t,r,n){let i=Math.min(e.length,t.length),o=0;for(;o<i&&e.charCodeAt(o)==t.charCodeAt(o);)o++;if(o==i&&e.length==t.length)return null;let s=e.length,a=t.length;for(;s>0&&a>0&&e.charCodeAt(s-1)==t.charCodeAt(a-1);)s--,a--;if("end"==n){let e=Math.max(0,o-Math.min(s,a));r-=s+e-o}if(s<o&&e.length<t.length){let e=r<=o&&r>=s?o-r:0;o-=e,a=o+(a-s),s=o}else if(a<o){let e=r<=o&&r>=a?o-r:0;o-=e,s=o+(s-a),a=o}return{from:o,toA:s,toB:a}}function wI(e,t){return t.head==e.main.head&&t.anchor==e.main.anchor}class w${setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.insertingText="",this.insertingTextAt=0,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,bR.safari&&e.contentDOM.addEventListener("input",()=>null),bR.gecko&&function(e){w2.has(e)||(w2.add(e),e.addEventListener("copy",()=>{}),e.addEventListener("cut",()=>{}))}(e.contentDOM.ownerDocument)}handleEvent(e){!function(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let r=t.target,n;r!=e.contentDOM;r=r.parentNode)if(!r||11==r.nodeType||(n=x0.get(r))&&n.isWidget()&&!n.isHidden&&n.widget.ignoreEvent(t))return!1;return!0}(this.view,e)||this.ignoreDuringComposition(e)||"keydown"==e.type&&this.keydown(e)||(0!=this.view.updateState?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let r=this.handlers[e];if(r){for(let e of r.observers)e(this.view,t);for(let e of r.handlers){if(t.defaultPrevented)break;if(e(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=function(e){let t=Object.create(null);function r(e){return t[e]||(t[e]={observers:[],handlers:[]})}for(let t of e){let e=t.spec,n=e&&e.plugin.domEventHandlers,i=e&&e.plugin.domEventObservers;if(n)for(let e in n){let i=n[e];i&&r(e).handlers.push(wD(t.value,i))}if(i)for(let e in i){let n=i[e];n&&r(e).observers.push(wD(t.value,n))}}for(let e in wB)r(e).handlers.push(wB[e]);for(let e in wz)r(e).observers.push(wz[e]);return t}(e),r=this.handlers,n=this.view.contentDOM;for(let e in t)if("scroll"!=e){let i=!t[e].handlers.length,o=r[e];o&&!o.handlers.length!=i&&(n.removeEventListener(e,this.handleEvent),o=null),o||n.addEventListener(e,this.handleEvent,{passive:i})}for(let e in r)"scroll"==e||t[e]||n.removeEventListener(e,this.handleEvent);this.handlers=t}keydown(e){let t;return this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),!!(9==e.keyCode&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))||((this.tabFocusMode>0&&27!=e.keyCode&&0>w_.indexOf(e.keyCode)&&(this.tabFocusMode=-1),bR.android&&bR.chrome&&!e.synthetic&&(13==e.keyCode||8==e.keyCode))?(this.view.observer.delayAndroidKey(e.key,e.keyCode),!0):bR.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=wR.find(t=>t.keyCode==e.keyCode))&&!e.ctrlKey||wN.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(229!=e.keyCode&&this.view.observer.forceFlush(),!1))}flushIOSKey(e){let t=this.pendingIOSKey;return!(!t||"Enter"==t.key&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString()))&&(this.pendingIOSKey=void 0,xe(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!!/^key/.test(e.type)&&!e.synthetic&&(this.composing>0||!!(bR.safari&&!bR.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function wD(e,t){return(r,n)=>{try{return t.call(e,n,r)}catch(e){xD(r.state,e)}}}let wR=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],wN="dthko",w_=[16,17,18,20,91,92,224,225];function wL(e){return .7*Math.max(0,e)+8}class wF{constructor(e,t,r,n){this.view=e,this.startEvent=t,this.style=r,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=function(e){let t=e.ownerDocument,r,n;for(let i=e.parentNode;i;)if(i==t.body||r&&n)break;else if(1==i.nodeType)!n&&i.scrollHeight>i.clientHeight&&(n=i),!r&&i.scrollWidth>i.clientWidth&&(r=i),i=i.assignedSlot||i.parentNode;else if(11==i.nodeType)i=i.host;else break;return{x:r,y:n}}(e.contentDOM),this.atoms=e.state.facet(xU).map(t=>t(e));let i=e.contentDOM.ownerDocument;i.addEventListener("mousemove",this.move=this.move.bind(this)),i.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(v0.allowMultipleSelections)&&function(e,t){let r=e.state.facet(xb);return r.length?r[0](t):bR.mac?t.metaKey:t.ctrlKey}(e,t),this.dragging=!!function(e,t){let{main:r}=e.state.selection;if(r.empty)return!1;let n=bJ(e.root);if(!n||0==n.rangeCount)return!0;let i=n.getRangeAt(0).getClientRects();for(let e=0;e<i.length;e++){let r=i[e];if(r.left<=t.clientX&&r.right>=t.clientX&&r.top<=t.clientY&&r.bottom>=t.clientY)return!0}return!1}(e,t)&&1==wY(t)&&null}start(e){!1===this.dragging&&this.select(e)}move(e){var t;if(0==e.buttons)return this.destroy();if(this.dragging||null==this.dragging&&10>(t=this.startEvent,Math.max(Math.abs(t.clientX-e.clientX),Math.abs(t.clientY-e.clientY))))return;this.select(this.lastEvent=e);let r=0,n=0,i=0,o=0,s=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:i,right:s}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:o,bottom:a}=this.scrollParents.y.getBoundingClientRect());let l=xJ(this.view);e.clientX-l.left<=i+6?r=-wL(i-e.clientX):e.clientX+l.right>=s-6&&(r=wL(e.clientX-s)),e.clientY-l.top<=o+6?n=-wL(o-e.clientY):e.clientY+l.bottom>=a-6&&(n=wL(e.clientY-a)),this.setScrollSpeed(r,n)}up(e){null==this.dragging&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),!1===this.dragging&&this.select(this.lastEvent)}select(e){let{view:t}=this,r=ww(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!r.eq(t.state.selection,!1===this.dragging))&&this.view.dispatch({selection:r,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(e=>e.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}let wB=Object.create(null),wz=Object.create(null),wW=bR.ie&&bR.ie_version<15||bR.ios&&bR.webkit_version<604;function wV(e,t,r){for(let n of e.facet(t))r=n(r,e);return r}function wH(e,t){t=wV(e.state,xC,t);let{state:r}=e,n,i=1,o=r.toText(t),s=o.lines==r.selection.ranges.length;if(null!=wZ&&r.selection.ranges.every(e=>e.empty)&&wZ==o.toString()){let e=-1;n=r.changeByRange(n=>{let a=r.doc.lineAt(n.from);if(a.from==e)return{range:n};e=a.from;let l=r.toText((s?o.line(i++).text:t)+r.lineBreak);return{changes:{from:a.from,insert:l},range:vv.cursor(n.from+l.length)}})}else n=s?r.changeByRange(e=>{let t=o.line(i++);return{changes:{from:e.from,to:e.to,insert:t.text},range:vv.cursor(e.from+t.length)}}):r.replaceSelection(o);e.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}function wU(e,t,r,n){if(1==n)return vv.cursor(t,r);{if(2==n)return function(e,t,r=1){let n=e.charCategorizer(t),i=e.doc.lineAt(t),o=t-i.from;if(0==i.length)return vv.cursor(t);0==o?r=1:o==i.length&&(r=-1);let s=o,a=o;r<0?s=vn(i.text,o,!1):a=vn(i.text,o);let l=n(i.text.slice(s,a));for(;s>0;){let e=vn(i.text,s,!1);if(n(i.text.slice(e,s))!=l)break;s=e}for(;a<i.length;){let e=vn(i.text,a);if(n(i.text.slice(a,e))!=l)break;a=e}return vv.range(s+i.from,a+i.from)}(e.state,t,r);let i=e.docView.lineAt(t,r),o=e.state.doc.lineAt(i?i.posAtEnd:t),s=i?i.posAtStart:o.from,a=i?i.posAtEnd:o.to;return a<e.state.doc.length&&a==o.to&&a++,vv.range(s,a)}}wz.scroll=e=>{e.inputState.lastScrollTop=e.scrollDOM.scrollTop,e.inputState.lastScrollLeft=e.scrollDOM.scrollLeft},wB.keydown=(e,t)=>(e.inputState.setSelectionOrigin("select"),27==t.keyCode&&0!=e.inputState.tabFocusMode&&(e.inputState.tabFocusMode=Date.now()+2e3),!1),wz.touchstart=(e,t)=>{e.inputState.lastTouchTime=Date.now(),e.inputState.setSelectionOrigin("select.pointer")},wz.touchmove=e=>{e.inputState.setSelectionOrigin("select.pointer")},wB.mousedown=(e,t)=>{var r,n;let i,o,s;if(e.observer.flush(),e.inputState.lastTouchTime>Date.now()-2e3)return!1;let a=null;for(let r of e.state.facet(xw))if(a=r(e,t))break;if(a||0!=t.button||(r=e,n=t,i=r.posAndSideAtCoords({x:n.clientX,y:n.clientY},!1),o=wY(n),s=r.state.selection,a={update(e){e.docChanged&&(i.pos=e.changes.mapPos(i.pos),s=s.map(e.changes))},get(e,t,n){let a=r.posAndSideAtCoords({x:e.clientX,y:e.clientY},!1),l,c=wU(r,a.pos,a.assoc,o);if(i.pos!=a.pos&&!t){let e=wU(r,i.pos,i.assoc,o),t=Math.min(e.from,c.from),n=Math.max(e.to,c.to);c=t<c.from?vv.range(t,n):vv.range(n,t)}return t?s.replaceRange(s.main.extend(c.from,c.to)):n&&1==o&&s.ranges.length>1&&(l=function(e,t){for(let r=0;r<e.ranges.length;r++){let{from:n,to:i}=e.ranges[r];if(n<=t&&i>=t)return vv.create(e.ranges.slice(0,r).concat(e.ranges.slice(r+1)),e.mainIndex==r?0:e.mainIndex-(e.mainIndex>r))}return null}(s,a.pos))?l:n?s.addRange(c):vv.create([c])}}),a){let r=!e.hasFocus;e.inputState.startMouseSelection(new wF(e,t,a,r)),r&&e.observer.ignore(()=>{b8(e.contentDOM);let t=e.root.activeElement;t&&!t.contains(e.contentDOM)&&t.blur()});let n=e.inputState.mouseSelection;if(n)return n.start(t),!1===n.dragging}else e.inputState.setSelectionOrigin("select.pointer");return!1};let wq=bR.ie&&bR.ie_version<=11,wK=null,wG=0,wJ=0;function wY(e){if(!wq)return e.detail;let t=wK,r=wJ;return wK=e,wJ=Date.now(),wG=!t||r>Date.now()-400&&2>Math.abs(t.clientX-e.clientX)&&2>Math.abs(t.clientY-e.clientY)?(wG+1)%3:1}function wX(e,t,r,n){let i;if(!(r=wV(e.state,xC,r)))return;let o=e.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:s}=e.inputState,a=n&&s&&((i=e.state.facet(xx)).length?i[0](t):bR.mac?!t.altKey:!t.ctrlKey)?{from:s.from,to:s.to}:null,l={from:o,insert:r},c=e.state.changes(a?[a,l]:l);e.focus(),e.dispatch({changes:c,selection:{anchor:c.mapPos(o,-1),head:c.mapPos(o,1)},userEvent:a?"move.drop":"input.drop"}),e.inputState.draggedContent=null}wB.dragstart=(e,t)=>{let{selection:{main:r}}=e.state;if(t.target.draggable){let n=e.docView.tile.nearest(t.target);if(n&&n.isWidget()){let e=n.posAtStart,t=e+n.length;(e>=r.to||t<=r.from)&&(r=vv.range(e,t))}}let{inputState:n}=e;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=r,t.dataTransfer&&(t.dataTransfer.setData("Text",wV(e.state,xE,e.state.sliceDoc(r.from,r.to))),t.dataTransfer.effectAllowed="copyMove"),!1},wB.dragend=e=>(e.inputState.draggedContent=null,!1),wB.drop=(e,t)=>{if(!t.dataTransfer)return!1;if(e.state.readOnly)return!0;let r=t.dataTransfer.files;if(r&&r.length){let n=Array(r.length),i=0,o=()=>{++i==r.length&&wX(e,t,n.filter(e=>null!=e).join(e.state.lineBreak),!1)};for(let e=0;e<r.length;e++){let t=new FileReader;t.onerror=o,t.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(t.result)||(n[e]=t.result),o()},t.readAsText(r[e])}return!0}{let r=t.dataTransfer.getData("Text");if(r)return wX(e,t,r,!0),!0}return!1},wB.paste=(e,t)=>{if(e.state.readOnly)return!0;e.observer.flush();let r=wW?null:t.clipboardData;return r?(wH(e,r.getData("text/plain")||r.getData("text/uri-list")),!0):(!function(e){let t=e.dom.parentNode;if(!t)return;let r=t.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{e.focus(),r.remove(),wH(e,r.value)},50)}(e),!1)};let wZ=null;wB.copy=wB.cut=(e,t)=>{let r=bJ(e.root);if(r&&!bX(e.contentDOM,r))return!1;let{text:n,ranges:i,linewise:o}=function(e){let t=[],r=[],n=!1;for(let n of e.selection.ranges)n.empty||(t.push(e.sliceDoc(n.from,n.to)),r.push(n));if(!t.length){let i=-1;for(let{from:n}of e.selection.ranges){let o=e.doc.lineAt(n);o.number>i&&(t.push(o.text),r.push({from:o.from,to:Math.min(e.doc.length,o.to+1)})),i=o.number}n=!0}return{text:wV(e,xE,t.join(e.lineBreak)),ranges:r,linewise:n}}(e.state);if(!n&&!o)return!1;wZ=o?n:null,"cut"!=t.type||e.state.readOnly||e.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let s=wW?null:t.clipboardData;return s?(s.clearData(),s.setData("text/plain",n),!0):(!function(e,t){let r=e.dom.parentNode;if(!r)return;let n=r.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=t,n.focus(),n.selectionEnd=t.length,n.selectionStart=0,setTimeout(()=>{n.remove(),e.focus()},50)}(e,n),!1)};let wQ=vV.define();function w0(e,t){let r=[];for(let n of e.facet(xj)){let i=n(e,t);i&&r.push(i)}return r.length?e.update({effects:r,annotations:wQ.of(!0)}):null}function w1(e){setTimeout(()=>{let t=e.hasFocus;if(t!=e.inputState.notifiedFocused){let r=w0(e.state,t);r?e.dispatch(r):e.update([])}},10)}wz.focus=e=>{e.inputState.lastFocusTime=Date.now(),!e.scrollDOM.scrollTop&&(e.inputState.lastScrollTop||e.inputState.lastScrollLeft)&&(e.scrollDOM.scrollTop=e.inputState.lastScrollTop,e.scrollDOM.scrollLeft=e.inputState.lastScrollLeft),w1(e)},wz.blur=e=>{e.observer.clearSelectionRange(),w1(e)},wz.compositionstart=wz.compositionupdate=e=>{!e.observer.editContext&&(null==e.inputState.compositionFirstChange&&(e.inputState.compositionFirstChange=!0),e.inputState.composing<0&&(e.inputState.composing=0))},wz.compositionend=e=>{e.observer.editContext||(e.inputState.composing=-1,e.inputState.compositionEndedAt=Date.now(),e.inputState.compositionPendingKey=!0,e.inputState.compositionPendingChange=e.observer.pendingRecords().length>0,e.inputState.compositionFirstChange=null,bR.chrome&&bR.android?e.observer.flushSoon():e.inputState.compositionPendingChange?Promise.resolve().then(()=>e.observer.flush()):setTimeout(()=>{e.inputState.composing<0&&e.docView.hasComposition&&e.update([])},50))},wz.contextmenu=e=>{e.inputState.lastContextMenu=Date.now()},wB.beforeinput=(e,t)=>{var r,n;let i;if(("insertText"==t.inputType||"insertCompositionText"==t.inputType)&&(e.inputState.insertingText=t.data,e.inputState.insertingTextAt=Date.now()),"insertReplacementText"==t.inputType&&e.observer.editContext){let n=null==(r=t.dataTransfer)?void 0:r.getData("text/plain"),i=t.getTargetRanges();if(n&&i.length){let t=i[0],r=e.posAtDOM(t.startContainer,t.startOffset),o=e.posAtDOM(t.endContainer,t.endOffset);return wP(e,{from:r,to:o,insert:e.state.toText(n)},null),!0}}if(bR.chrome&&bR.android&&(i=wR.find(e=>e.inputType==t.inputType))&&(e.observer.delayAndroidKey(i.key,i.keyCode),"Backspace"==i.key||"Delete"==i.key)){let t=(null==(n=window.visualViewport)?void 0:n.height)||0;setTimeout(()=>{var r;((null==(r=window.visualViewport)?void 0:r.height)||0)>t+10&&e.hasFocus&&(e.contentDOM.blur(),e.focus())},100)}return bR.ios&&"deleteContentForward"==t.inputType&&e.observer.flushSoon(),bR.safari&&"insertText"==t.inputType&&e.inputState.composing>=0&&setTimeout(()=>wz.compositionend(e,t),20),!1};let w2=new Set,w4=["pre-wrap","normal","pre-line","break-spaces"],w3=!1;class w5{constructor(e){this.lineWrapping=e,this.doc=y3.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let r=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(r+=Math.max(0,Math.ceil((t-e-r*this.lineLength*.5)/this.lineLength))),this.lineHeight*r}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return w4.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let r=0;r<e.length;r++){let n=e[r];n<0?r++:this.heightSamples[Math.floor(10*n)]||(t=!0,this.heightSamples[Math.floor(10*n)]=!0)}return t}refresh(e,t,r,n,i,o){let s=w4.indexOf(e)>-1,a=Math.abs(t-this.lineHeight)>.3||this.lineWrapping!=s||Math.abs(r-this.charWidth)>.1;if(this.lineWrapping=s,this.lineHeight=t,this.charWidth=r,this.textHeight=n,this.lineLength=i,a){this.heightSamples={};for(let e=0;e<o.length;e++){let t=o[e];t<0?e++:this.heightSamples[Math.floor(10*t)]=!0}}return a}}class w6{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class w9{constructor(e,t,r,n,i){this.from=e,this.length=t,this.top=r,this.height=n,this._content=i}get type(){return"number"==typeof this._content?bz.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof bU?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new w9(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var w8=((f=w8||(w8={}))[f.ByPos=0]="ByPos",f[f.ByHeight=1]="ByHeight",f[f.ByPosNoHeight=2]="ByPosNoHeight",f);class w7{constructor(e,t,r=2){this.length=e,this.height=t,this.flags=r}get outdated(){return(2&this.flags)>0}set outdated(e){this.flags=2*!!e|-3&this.flags}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>.001&&(w3=!0),this.height=e)}replace(e,t,r){return w7.of(r)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,r,n){let i=this,o=r.doc;for(let s=n.length-1;s>=0;s--){let{fromA:a,toA:l,fromB:c,toB:u}=n[s],h=i.lineAt(a,w8.ByPosNoHeight,r.setDoc(t),0,0),d=h.to>=l?h:i.lineAt(l,w8.ByPosNoHeight,r,0,0);for(u+=d.to-l,l=d.to;s>0&&h.from<=n[s-1].toA;)a=n[s-1].fromA,c=n[s-1].fromB,s--,a<h.from&&(h=i.lineAt(a,w8.ByPosNoHeight,r,0,0));c+=h.from-a,a=h.from;let f=ka.build(r.setDoc(o),e,c,u);i=ke(i,i.replace(a,l,f))}return i.updateHeight(r,0)}static empty(){return new kn(0,0,0)}static of(e){if(1==e.length)return e[0];let t=0,r=e.length,n=0,i=0;for(;;)if(t==r)if(n>2*i){let i=e[t-1];i.break?e.splice(--t,1,i.left,null,i.right):e.splice(--t,1,i.left,i.right),r+=1+i.break,n-=i.size}else if(i>2*n){let t=e[r];t.break?e.splice(r,1,t.left,null,t.right):e.splice(r,1,t.left,t.right),r+=2+t.break,i-=t.size}else break;else if(n<i){let r=e[t++];r&&(n+=r.size)}else{let t=e[--r];t&&(i+=t.size)}let o=0;return null==e[t-1]?(o=1,t--):null==e[t]&&(o=1,r++),new ko(w7.of(e.slice(0,t)),o,w7.of(e.slice(r)))}}function ke(e,t){return e==t?e:(e.constructor!=t.constructor&&(w3=!0),t)}w7.prototype.size=1;let kt=bW.replace({});class kr extends w7{constructor(e,t,r){super(e,t),this.deco=r,this.spaceAbove=0}mainBlock(e,t){return new w9(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.deco||0)}blockAt(e,t,r,n){return this.spaceAbove&&e<r+this.spaceAbove?new w9(n,0,r,this.spaceAbove,kt):this.mainBlock(r,n)}lineAt(e,t,r,n,i){let o=this.mainBlock(n,i);return this.spaceAbove?this.blockAt(0,r,n,i).join(o):o}forEachLine(e,t,r,n,i,o){e<=i+this.length&&t>=i&&o(this.lineAt(0,w8.ByPos,r,n,i))}setMeasuredHeight(e){let t=e.heights[e.index++];t<0?(this.spaceAbove=-t,t=e.heights[e.index++]):this.spaceAbove=0,this.setHeight(t)}updateHeight(e,t=0,r=!1,n){return n&&n.from<=t&&n.more&&this.setMeasuredHeight(n),this.outdated=!1,this}toString(){return`block(${this.length})`}}class kn extends kr{constructor(e,t,r){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0,this.spaceAbove=r}mainBlock(e,t){return new w9(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.breaks)}replace(e,t,r){let n=r[0];return 1==r.length&&(n instanceof kn||n instanceof ki&&4&n.flags)&&10>Math.abs(this.length-n.length)?(n instanceof ki?n=new kn(n.length,this.height,this.spaceAbove):n.height=this.height,this.outdated||(n.outdated=!1),n):w7.of(r)}updateHeight(e,t=0,r=!1,n){return n&&n.from<=t&&n.more?this.setMeasuredHeight(n):(r||this.outdated)&&(this.spaceAbove=0,this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight)),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class ki extends w7{constructor(e){super(e,0)}heightMetrics(e,t){let r=e.doc.lineAt(t).number,n=e.doc.lineAt(t+this.length).number,i=n-r+1,o,s=0;if(e.lineWrapping){let t=Math.min(this.height,e.lineHeight*i);o=t/i,this.length>i+1&&(s=(this.height-t)/(this.length-i-1))}else o=this.height/i;return{firstLine:r,lastLine:n,perLine:o,perChar:s}}blockAt(e,t,r,n){let{firstLine:i,lastLine:o,perLine:s,perChar:a}=this.heightMetrics(t,n);if(t.lineWrapping){let i=n+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-r)/this.height))*this.length)),o=t.doc.lineAt(i),l=s+o.length*a,c=Math.max(r,e-l/2);return new w9(o.from,o.length,c,l,0)}{let n=Math.max(0,Math.min(o-i,Math.floor((e-r)/s))),{from:a,length:l}=t.doc.line(i+n);return new w9(a,l,r+s*n,s,0)}}lineAt(e,t,r,n,i){if(t==w8.ByHeight)return this.blockAt(e,r,n,i);if(t==w8.ByPosNoHeight){let{from:t,to:n}=r.doc.lineAt(e);return new w9(t,n-t,0,0,0)}let{firstLine:o,perLine:s,perChar:a}=this.heightMetrics(r,i),l=r.doc.lineAt(e),c=s+l.length*a,u=l.number-o,h=n+s*u+a*(l.from-i-u);return new w9(l.from,l.length,Math.max(n,Math.min(h,n+this.height-c)),c,0)}forEachLine(e,t,r,n,i,o){e=Math.max(e,i),t=Math.min(t,i+this.length);let{firstLine:s,perLine:a,perChar:l}=this.heightMetrics(r,i);for(let c=e,u=n;c<=t;){let t=r.doc.lineAt(c);if(c==e){let r=t.number-s;u+=a*r+l*(e-i-r)}let n=a+l*t.length;o(new w9(t.from,t.length,u,n,0)),u+=n,c=t.to+1}}replace(e,t,r){let n=this.length-t;if(n>0){let e=r[r.length-1];e instanceof ki?r[r.length-1]=new ki(e.length+n):r.push(null,new ki(n-1))}if(e>0){let t=r[0];t instanceof ki?r[0]=new ki(e+t.length):r.unshift(new ki(e-1),null)}return w7.of(r)}decomposeLeft(e,t){t.push(new ki(e-1),null)}decomposeRight(e,t){t.push(null,new ki(this.length-e-1))}updateHeight(e,t=0,r=!1,n){let i=t+this.length;if(n&&n.from<=t+this.length&&n.more){let r=[],o=Math.max(t,n.from),s=-1;for(n.from>t&&r.push(new ki(n.from-t-1).updateHeight(e,t));o<=i&&n.more;){let t=e.doc.lineAt(o).length;r.length&&r.push(null);let i=n.heights[n.index++],a=0;i<0&&(a=-i,i=n.heights[n.index++]),-1==s?s=i:Math.abs(i-s)>=.001&&(s=-2);let l=new kn(t,i,a);l.outdated=!1,r.push(l),o+=t+1}o<=i&&r.push(null,new ki(i-o).updateHeight(e,o));let a=w7.of(r);return(s<0||Math.abs(a.height-this.height)>=.001||Math.abs(s-this.heightMetrics(e,t).perLine)>=.001)&&(w3=!0),ke(this,a)}return(r||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class ko extends w7{constructor(e,t,r){super(e.length+t+r.length,e.height+r.height,t|(e.outdated||r.outdated?2:0)),this.left=e,this.right=r,this.size=e.size+r.size}get break(){return 1&this.flags}blockAt(e,t,r,n){let i=r+this.left.height;return e<i?this.left.blockAt(e,t,r,n):this.right.blockAt(e,t,i,n+this.left.length+this.break)}lineAt(e,t,r,n,i){let o=n+this.left.height,s=i+this.left.length+this.break,a=t==w8.ByHeight?e<o:e<s,l=a?this.left.lineAt(e,t,r,n,i):this.right.lineAt(e,t,r,o,s);if(this.break||(a?l.to<s:l.from>s))return l;let c=t==w8.ByPosNoHeight?w8.ByPosNoHeight:w8.ByPos;return a?l.join(this.right.lineAt(s,c,r,o,s)):this.left.lineAt(s,c,r,n,i).join(l)}forEachLine(e,t,r,n,i,o){let s=n+this.left.height,a=i+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,t,r,n,i,o),t>=a&&this.right.forEachLine(e,t,r,s,a,o);else{let l=this.lineAt(a,w8.ByPos,r,n,i);e<l.from&&this.left.forEachLine(e,l.from-1,r,n,i,o),l.to>=e&&l.from<=t&&o(l),t>l.to&&this.right.forEachLine(l.to+1,t,r,s,a,o)}}replace(e,t,r){let n=this.left.length+this.break;if(t<n)return this.balanced(this.left.replace(e,t,r),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-n,t-n,r));let i=[];e>0&&this.decomposeLeft(e,i);let o=i.length;for(let e of r)i.push(e);if(e>0&&ks(i,o-1),t<this.length){let e=i.length;this.decomposeRight(t,i),ks(i,e)}return w7.of(i)}decomposeLeft(e,t){let r=this.left.length;if(e<=r)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&e>=++r&&t.push(null),e>r&&this.right.decomposeLeft(e-r,t)}decomposeRight(e,t){let r=this.left.length,n=r+this.break;if(e>=n)return this.right.decomposeRight(e-n,t);e<r&&this.left.decomposeRight(e,t),this.break&&e<n&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?w7.of(this.break?[e,null,t]:[e,t]):(this.left=ke(this.left,e),this.right=ke(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,r=!1,n){let{left:i,right:o}=this,s=t+i.length+this.break,a=null;return(n&&n.from<=t+i.length&&n.more?a=i=i.updateHeight(e,t,r,n):i.updateHeight(e,t,r),n&&n.from<=s+o.length&&n.more?a=o=o.updateHeight(e,s,r,n):o.updateHeight(e,s,r),a)?this.balanced(i,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function ks(e,t){let r,n;null==e[t]&&(r=e[t-1])instanceof ki&&(n=e[t+1])instanceof ki&&e.splice(t-1,3,new ki(r.length+1+n.length))}class ka{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let e=Math.min(t,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof kn?r.length+=e-this.pos:(e>this.pos||!this.isCovered)&&this.nodes.push(new kn(e-this.pos,-1,0)),this.writtenTo=e,t>e&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,r){if(e<t||r.heightRelevant){let n=r.widget?r.widget.estimatedHeight:0,i=r.widget?r.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let o=t-e;r.block?this.addBlock(new kr(o,n,r)):(o||i||n>=5)&&this.addLineDeco(n,i,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new kn(this.pos-e,-1,0)),this.writtenTo=this.pos}blankContent(e,t){let r=new ki(t-e);return this.oracle.doc.lineAt(e).to==t&&(r.flags|=4),r}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof kn)return e;let t=new kn(0,-1,0);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,r){let n=this.ensureLine();n.length+=r,n.collapsed+=r,n.widgetHeight=Math.max(n.widgetHeight,e),n.breaks+=t,this.writtenTo=this.pos=this.pos+r}finish(e){let t=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||t instanceof kn||this.isCovered?(this.writtenTo<this.pos||null==t)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new kn(0,-1,0));let r=e;for(let e of this.nodes)e instanceof kn&&e.updateHeight(this.oracle,r),r+=e?e.length:1;return this.nodes}static build(e,t,r,n){let i=new ka(r,e);return v9.spans(t,r,n,i,0),i.finish(r)}}class kl{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,r,n){(e<t||r&&r.heightRelevant||n&&n.heightRelevant)&&bK(e,t,this.changes,5)}}class kc{constructor(e,t,r,n){this.from=e,this.to=t,this.size=r,this.displaySize=n}static same(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++){let n=e[r],i=t[r];if(n.from!=i.from||n.to!=i.to||n.size!=i.size)return!1}return!0}draw(e,t){return bW.replace({widget:new ku(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class ku extends bB{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class kh{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=km,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=xo.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(xz).some(e=>"function"!=typeof e&&"cm-lineWrapping"==e.class);this.heightOracle=new w5(t),this.stateDeco=kg(e),this.heightMap=w7.empty().applyChanges(this.stateDeco,y3.empty,this.heightOracle.setDoc(e.doc),[new xX(0,0,0,e.doc.length)]);for(let e=0;e<2&&(this.viewport=this.getViewport(0,null),this.updateForViewport());e++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=bW.set(this.lineGaps.map(e=>e.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let r=0;r<=1;r++){let n=r?t.head:t.anchor;if(!e.some(({from:e,to:t})=>n>=e&&n<=t)){let{from:t,to:r}=this.lineBlockAt(n);e.push(new kd(t,r))}}return this.viewports=e.sort((e,t)=>e.from-t.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?km:new ky(this.heightOracle,this.heightMap,this.viewports),2*!e.eq(this.scaler)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(kv(e,this.scaler))})}update(e,t=null){var r,n;let i;this.state=e.state;let o=this.stateDeco;this.stateDeco=kg(this.state);let s=e.changedRanges,a=xX.extendWithRanges(s,(r=this.stateDeco,n=e?e.changes:vu.empty(this.state.doc.length),i=new kl,v9.compare(o,r,n,i,0),i.changes)),l=this.heightMap.height,c=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);w3=!1,this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),a),(this.heightMap.height!=l||w3)&&(e.flags|=2),c?(this.scrollAnchorPos=e.changes.mapPos(c.from,-1),this.scrollAnchorHeight=c.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=l);let u=a.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<u.from||t.range.head>u.to)||!this.viewportIsAppropriate(u))&&(u=this.getViewport(0,t));let h=u.from!=this.viewport.from||u.to!=this.viewport.to;this.viewport=u,e.flags|=this.updateForViewport(),(h||!e.changes.empty||2&e.flags)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&(e.selectionSet||e.focusChanged)&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(xM)&&(this.mustEnforceCursorAssoc=!0)}measure(e){var t;let r,n,i=e.contentDOM,o=window.getComputedStyle(i),s=this.heightOracle,a=o.whiteSpace;this.defaultTextDirection="rtl"==o.direction?xo.RTL:xo.LTR;let l=this.heightOracle.mustRefreshForWrapping(a)||this.mustMeasureContent,c=i.getBoundingClientRect(),u=l||this.mustMeasureContent||this.contentDOMHeight!=c.height;this.contentDOMHeight=c.height,this.mustMeasureContent=!1;let h=0,d=0;if(c.width&&c.height){let{scaleX:e,scaleY:t}=b5(i,c);(e>.005&&Math.abs(this.scaleX-e)>.005||t>.005&&Math.abs(this.scaleY-t)>.005)&&(this.scaleX=e,this.scaleY=t,h|=16,l=u=!0)}let f=(parseInt(o.paddingTop)||0)*this.scaleY,p=(parseInt(o.paddingBottom)||0)*this.scaleY;(this.paddingTop!=f||this.paddingBottom!=p)&&(this.paddingTop=f,this.paddingBottom=p,h|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(u=!0),this.editorWidth=e.scrollDOM.clientWidth,h|=16);let m=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=m&&(this.scrollAnchorHeight=-1,this.scrollTop=m),this.scrolledToBottom=xt(e.scrollDOM);let g=(this.printing?function(e,t){let r=e.getBoundingClientRect();return{left:0,right:r.right-r.left,top:t,bottom:r.bottom-(r.top+t)}}:function(e,t){let r=e.getBoundingClientRect(),n=e.ownerDocument,i=n.defaultView||window,o=Math.max(0,r.left),s=Math.min(i.innerWidth,r.right),a=Math.max(0,r.top),l=Math.min(i.innerHeight,r.bottom);for(let t=e.parentNode;t&&t!=n.body;)if(1==t.nodeType){let r=t,n=window.getComputedStyle(r);if((r.scrollHeight>r.clientHeight||r.scrollWidth>r.clientWidth)&&"visible"!=n.overflow){let n=r.getBoundingClientRect();o=Math.max(o,n.left),s=Math.min(s,n.right),a=Math.max(a,n.top),l=Math.min(t==e.parentNode?i.innerHeight:l,n.bottom)}t="absolute"==n.position||"fixed"==n.position?r.offsetParent:r.parentNode}else if(11==t.nodeType)t=t.host;else break;return{left:o-r.left,right:Math.max(o,s)-r.left,top:a-(r.top+t),bottom:Math.max(a,l)-(r.top+t)}})(i,this.paddingTop),y=g.top-this.pixelViewport.top,v=g.bottom-this.pixelViewport.bottom;this.pixelViewport=g;let b=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(b!=this.inView&&(this.inView=b,b&&(u=!0)),!this.inView&&!this.scrollTarget&&(r=(t=e.dom).getBoundingClientRect(),n=t.ownerDocument.defaultView||window,!(r.left<n.innerWidth)||!(r.right>0)||!(r.top<n.innerHeight)||!(r.bottom>0)))return 0;let x=c.width;if((this.contentDOMWidth!=x||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=c.width,this.editorHeight=e.scrollDOM.clientHeight,h|=16),u){let t=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(t)&&(l=!0),l||s.lineWrapping&&Math.abs(x-this.contentDOMWidth)>s.charWidth){let{lineHeight:r,charWidth:n,textHeight:i}=e.docView.measureTextSize();(l=r>0&&s.refresh(a,r,n,i,Math.max(5,x/n),t))&&(e.docView.minWidth=0,h|=16)}for(let r of(y>0&&v>0?d=Math.max(y,v):y<0&&v<0&&(d=Math.min(y,v)),w3=!1,this.viewports)){let n=r.from==this.viewport.from?t:e.docView.measureVisibleLineHeights(r);this.heightMap=(l?w7.empty().applyChanges(this.stateDeco,y3.empty,this.heightOracle,[new xX(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,l,new w6(r.from,n))}w3&&(h|=2)}let w=!this.viewportIsAppropriate(this.viewport,d)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return w&&(2&h&&(h|=this.updateScaler()),this.viewport=this.getViewport(d,this.scrollTarget),h|=this.updateForViewport()),(2&h||w)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(l?[]:this.lineGaps,e)),h|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),h}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let r=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),n=this.heightMap,i=this.heightOracle,{visibleTop:o,visibleBottom:s}=this,a=new kd(n.lineAt(o-1e3*r,w8.ByHeight,i,0,0).from,n.lineAt(s+(1-r)*1e3,w8.ByHeight,i,0,0).to);if(t){let{head:e}=t.range;if(e<a.from||e>a.to){let r=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),o=n.lineAt(e,w8.ByPos,i,0,0),s;s="center"==t.y?(o.top+o.bottom)/2-r/2:"start"==t.y||"nearest"==t.y&&e<a.from?o.top:o.bottom-r,a=new kd(n.lineAt(s-500,w8.ByHeight,i,0,0).from,n.lineAt(s+r+500,w8.ByHeight,i,0,0).to)}}return a}mapViewport(e,t){let r=t.mapPos(e.from,-1),n=t.mapPos(e.to,1);return new kd(this.heightMap.lineAt(r,w8.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,w8.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},r=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(e,w8.ByPos,this.heightOracle,0,0),{bottom:i}=this.heightMap.lineAt(t,w8.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:s}=this;return(0==e||n<=o-Math.max(10,Math.min(-r,250)))&&(t==this.state.doc.length||i>=s+Math.max(10,Math.min(r,250)))&&n>o-2e3&&i<s+2e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let r=[];for(let n of e)t.touchesRange(n.from,n.to)||r.push(new kc(t.mapPos(n.from),t.mapPos(n.to),n.size,n.displaySize));return r}ensureLineGaps(e,t){let r=this.heightOracle.lineWrapping,n=r?1e4:2e3,i=n>>1,o=n<<1;if(this.defaultTextDirection!=xo.LTR&&!r)return[];let s=[],a=(n,o,l,c)=>{if(o-n<i)return;let u=this.state.selection.main,h=[u.from];for(let e of(u.empty||h.push(u.to),h))if(e>n&&e<o){a(n,e-10,l,c),a(e+10,o,l,c);return}let d=function(e,t){for(let r of e)if(t(r))return r}(e,e=>e.from>=l.from&&e.to<=l.to&&Math.abs(e.from-n)<i&&Math.abs(e.to-o)<i&&!h.some(t=>e.from<t&&e.to>t));if(!d){if(o<l.to&&t&&r&&t.visibleRanges.some(e=>e.from<=o&&e.to>=o)){let e=t.moveToLineBoundary(vv.cursor(o),!1,!0).head;e>n&&(o=e)}let e=this.gapSize(l,n,o,c),i=r||e<2e6?e:2e6;d=new kc(n,o,e,i)}s.push(d)},l=t=>{var i,s,l;let c,u,h,d,f;if(t.length<o||t.type!=bz.Text)return;let p=(i=t.from,s=t.to,l=this.stateDeco,h=[],d=i,f=0,v9.spans(l,i,s,{span(){},point(e,t){e>d&&(h.push({from:d,to:e}),f+=e-d),d=t}},20),d<s&&(h.push({from:d,to:s}),f+=s-d),{total:f,ranges:h});if(p.total<o)return;let m=this.scrollTarget?this.scrollTarget.range.head:null;if(r){let e,r,i=n/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=m){let n=kp(p,m),o=((this.visibleBottom-this.visibleTop)/2+i)/t.height;e=n-o,r=n+o}else e=(this.visibleTop-t.top-i)/t.height,r=(this.visibleBottom-t.top+i)/t.height;c=kf(p,e),u=kf(p,r)}else{let r,i,o=p.total*this.heightOracle.charWidth,s=n*this.heightOracle.charWidth,a=0;if(o>2e6)for(let r of e)r.from>=t.from&&r.from<t.to&&r.size!=r.displaySize&&r.from*this.heightOracle.charWidth+a<this.pixelViewport.left&&(a=r.size-r.displaySize);let l=this.pixelViewport.left+a,h=this.pixelViewport.right+a;if(null!=m){let e=kp(p,m),t=((h-l)/2+s)/o;r=e-t,i=e+t}else r=(l-s)/o,i=(h+s)/o;c=kf(p,r),u=kf(p,i)}c>t.from&&a(t.from,c,t,p),u<t.to&&a(u,t.to,t,p)};for(let e of this.viewportLines)Array.isArray(e.type)?e.type.forEach(l):l(e);return s}gapSize(e,t,r,n){let i=kp(n,r)-kp(n,t);return this.heightOracle.lineWrapping?e.height*i:n.total*this.heightOracle.charWidth*i}updateLineGaps(e){kc.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=bW.set(e.map(e=>e.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let r=[];v9.spans(t,this.viewport.from,this.viewport.to,{span(e,t){r.push({from:e,to:t})},point(){}},20);let n=0;if(r.length!=this.visibleRanges.length)n=12;else for(let t=0;t<r.length&&!(8&n);t++){let i=this.visibleRanges[t],o=r[t];(i.from!=o.from||i.to!=o.to)&&(n|=4,e&&e.mapPos(i.from,-1)==o.from&&e.mapPos(i.to,1)==o.to||(n|=8))}return this.visibleRanges=r,n}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||kv(this.heightMap.lineAt(e,w8.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||kv(this.heightMap.lineAt(this.scaler.fromDOM(e),w8.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return kv(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class kd{constructor(e,t){this.from=e,this.to=t}}function kf({total:e,ranges:t},r){if(r<=0)return t[0].from;if(r>=1)return t[t.length-1].to;let n=Math.floor(e*r);for(let e=0;;e++){let{from:r,to:i}=t[e],o=i-r;if(n<=o)return r+n;n-=o}}function kp(e,t){let r=0;for(let{from:n,to:i}of e.ranges){if(t<=i){r+=t-n;break}r+=i-n}return r/e.total}let km={toDOM:e=>e,fromDOM:e=>e,scale:1,eq(e){return e==this}};function kg(e){let t=e.facet(xW).filter(e=>"function"!=typeof e),r=e.facet(xH).filter(e=>"function"!=typeof e);return r.length&&t.push(v9.join(r)),t}class ky{constructor(e,t,r){let n=0,i=0,o=0;for(let s of(this.viewports=r.map(({from:r,to:i})=>{let o=t.lineAt(r,w8.ByPos,e,0,0).top,s=t.lineAt(i,w8.ByPos,e,0,0).bottom;return n+=s-o,{from:r,to:i,top:o,bottom:s,domTop:0,domBottom:0}}),this.scale=(7e6-n)/(t.height-n),this.viewports))s.domTop=o+(s.top-i)*this.scale,o=s.domBottom=s.domTop+(s.bottom-s.top),i=s.bottom}toDOM(e){for(let t=0,r=0,n=0;;t++){let i=t<this.viewports.length?this.viewports[t]:null;if(!i||e<i.top)return n+(e-r)*this.scale;if(e<=i.bottom)return i.domTop+(e-i.top);r=i.bottom,n=i.domBottom}}fromDOM(e){for(let t=0,r=0,n=0;;t++){let i=t<this.viewports.length?this.viewports[t]:null;if(!i||e<i.domTop)return r+(e-n)/this.scale;if(e<=i.domBottom)return i.top+(e-i.domTop);r=i.bottom,n=i.domBottom}}eq(e){return e instanceof ky&&this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,r)=>t.from==e.viewports[r].from&&t.to==e.viewports[r].to)}}function kv(e,t){if(1==t.scale)return e;let r=t.toDOM(e.top),n=t.toDOM(e.bottom);return new w9(e.from,e.length,r,n-r,Array.isArray(e._content)?e._content.map(e=>kv(e,t)):e._content)}let kb=vw.define({combine:e=>e.join(" ")}),kx=vw.define({combine:e=>e.indexOf(!0)>-1}),kw=bp.newName(),kk=bp.newName(),kA=bp.newName(),kS={"&light":"."+kk,"&dark":"."+kA};function kj(e,t,r){return new bp(t,{finish:t=>/&/.test(t)?t.replace(/&\w*/,t=>{if("&"==t)return e;if(!r||!r[t])throw RangeError(`Unsupported selector: ${t}`);return r[t]}):e+" "+t})}let kC=kj("."+kw,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},kS),kE={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},kO=bR.ie&&bR.ie_version<=11;class kM{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new b6,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let e of t)this.queue.push(e);(bR.ie&&bR.ie_version<=11||bR.ios&&e.composing)&&t.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&bR.android&&!1!==e.constructor.EDIT_CONTEXT&&!(bR.chrome&&bR.chrome_version<126)&&(this.editContext=new kI(e),e.state.facet(xR)&&(e.contentDOM.editContext=this.editContext.editContext)),kO&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver(()=>{var e;(null==(e=this.view.docView)?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver(e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){("change"!=e.type&&e.type||e.matches)&&(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,r)=>t!=e[r]))){for(let t of(this.gapIntersection.disconnect(),e))this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:r}=this,n=this.selectionRange;if(r.state.facet(xR)?r.root.activeElement!=this.dom:!bX(this.dom,n))return;let i=n.anchorNode&&r.docView.tile.nearest(n.anchorNode);if(i&&i.isWidget()&&i.widget.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(bR.ie&&bR.ie_version<=11||bR.android&&bR.chrome)&&!r.state.selection.main.empty&&n.focusNode&&bQ(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=bJ(e.root);if(!t)return!1;let r=bR.safari&&11==e.root.nodeType&&e.root.activeElement==this.dom&&function(e,t){if(t.getComposedRanges){let r=t.getComposedRanges(e.root)[0];if(r)return kT(e,r)}let r=null;function n(e){e.preventDefault(),e.stopImmediatePropagation(),r=e.getTargetRanges()[0]}return e.contentDOM.addEventListener("beforeinput",n,!0),e.dom.ownerDocument.execCommand("indent"),e.contentDOM.removeEventListener("beforeinput",n,!0),r?kT(e,r):null}(this.view,t)||t;if(!r||this.selectionRange.eq(r))return!1;let n=bX(this.dom,r);return n&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&function(e,t){let r=t.focusNode,n=t.focusOffset;if(!r||t.anchorNode!=r||t.anchorOffset!=n)return!1;for(n=Math.min(n,b4(r));;)if(n){if(1!=r.nodeType)return!1;let e=r.childNodes[n-1];"false"==e.contentEditable?n--:n=b4(r=e)}else{if(r==e)return!0;n=b0(r),r=r.parentNode}}(this.dom,r)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(r),n&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let r=this.dom;r;)if(1==r.nodeType)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==r?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(r),r=r.assignedSlot||r.parentNode;else if(11==r.nodeType)r=r.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let e of this.scrollTargets)e.removeEventListener("scroll",this.onScroll);for(let e of this.scrollTargets=t)e.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,kE),kO&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),kO&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var r;if(!this.delayedAndroidKey){let e=()=>{let e=this.delayedAndroidKey;e&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=e.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&e.force&&xe(this.dom,e.key,e.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(e)}this.delayedAndroidKey&&"Enter"!=e||(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(null==(r=this.delayedAndroidKey)?void 0:r.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,r=-1,n=!1;for(let i of e){let e=this.readMutation(i);e&&(e.typeOver&&(n=!0),-1==t?{from:t,to:r}=e:(t=Math.min(e.from,t),r=Math.max(e.to,r)))}return{from:t,to:r,typeOver:n}}readChange(){let{from:e,to:t,typeOver:r}=this.processRecords(),n=this.selectionChanged&&bX(this.dom,this.selectionRange);if(e<0&&!n)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let i=new wO(this.view,e,t,r);return this.view.docView.domChanged={newSel:i.newSel?i.newSel.main:null},i}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let r=this.view.state,n=wM(this.view,t);return this.view.state==r&&(t.domChanged||t.newSel&&!wI(this.view.state.selection,t.newSel.main))&&this.view.update([]),n}readMutation(e){let t=this.view.docView.tile.nearest(e.target);if(!t||t.isWidget())return null;if(t.markDirty("attributes"==e.type),"childList"==e.type){let r=kP(t,e.previousSibling||e.target.previousSibling,-1),n=kP(t,e.nextSibling||e.target.nextSibling,1);return{from:r?t.posAfter(r):t.posAtStart,to:n?t.posBefore(n):t.posAtEnd,typeOver:!1}}return"characterData"==e.type?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(xR)!=e.state.facet(xR)&&(e.view.contentDOM.editContext=e.state.facet(xR)?this.editContext.editContext:null))}destroy(){var e,t,r;for(let n of(this.stop(),null==(e=this.intersection)||e.disconnect(),null==(t=this.gapIntersection)||t.disconnect(),null==(r=this.resizeScroll)||r.disconnect(),this.scrollTargets))n.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function kP(e,t,r){for(;t;){let n=x0.get(t);if(n&&n.parent==e)return n;let i=t.parentNode;t=i!=e.dom?i:r>0?t.nextSibling:t.previousSibling}return null}function kT(e,t){let r=t.startContainer,n=t.startOffset,i=t.endContainer,o=t.endOffset,s=e.docView.domAtPos(e.state.selection.main.anchor,1);return bQ(s.node,s.offset,i,o)&&([r,n,i,o]=[i,o,r,n]),{anchorNode:r,anchorOffset:n,focusNode:i,focusOffset:o}}class kI{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});for(let r in this.handlers.textupdate=r=>{let n=e.state.selection.main,{anchor:i,head:o}=n,s=this.toEditorPos(r.updateRangeStart),a=this.toEditorPos(r.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:r.updateRangeStart,editorBase:s,drifted:!1});let l=a-s>r.text.length;s==this.from&&i<this.from?s=i:a==this.to&&i>this.to&&(a=i);let c=wT(e.state.sliceDoc(s,a),r.text,(l?n.from:n.to)-s,l?"end":null);if(!c){let t=vv.single(this.toEditorPos(r.selectionStart),this.toEditorPos(r.selectionEnd));wI(t,n)||e.dispatch({selection:t,userEvent:"select"});return}let u={from:c.from+s,to:c.toA+s,insert:y3.of(r.text.slice(c.from,c.toB).split("\n"))};if((bR.mac||bR.android)&&u.from==o-1&&/^\. ?$/.test(r.text)&&"off"==e.contentDOM.getAttribute("autocorrect")&&(u={from:s,to:a,insert:y3.of([r.text.replace("."," ")])}),this.pendingContextChange=u,!e.state.readOnly){let t=this.to-this.from+(u.to-u.from+u.insert.length);wP(e,u,vv.single(this.toEditorPos(r.selectionStart,t),this.toEditorPos(r.selectionEnd,t)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),u.from<u.to&&!u.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(t.text.slice(Math.max(0,r.updateRangeStart-1),Math.min(t.text.length,r.updateRangeStart+1)))&&this.handlers.compositionend(r)},this.handlers.characterboundsupdate=r=>{let n=[],i=null;for(let t=this.toEditorPos(r.rangeStart),o=this.toEditorPos(r.rangeEnd);t<o;t++){let r=e.coordsForChar(t);i=r&&new DOMRect(r.left,r.top,r.right-r.left,r.bottom-r.top)||i||new DOMRect,n.push(i)}t.updateCharacterBounds(r.rangeStart,n)},this.handlers.textformatupdate=t=>{let r=[];for(let e of t.getTextFormats()){let t=e.underlineStyle,n=e.underlineThickness;if(!/none/i.test(t)&&!/none/i.test(n)){let i=this.toEditorPos(e.rangeStart),o=this.toEditorPos(e.rangeEnd);if(i<o){let e=`text-decoration: underline ${/^[a-z]/.test(t)?t+" ":"Dashed"==t?"dashed ":"Squiggle"==t?"wavy ":""}${/thin/i.test(n)?1:2}px`;r.push(bW.mark({attributes:{style:e}}).range(i,o))}}}e.dispatch({effects:x$.of(bW.set(r))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:t}=this.composing;this.composing=null,t&&this.reset(e.state)}},this.handlers)t.addEventListener(r,this.handlers[r]);this.measureReq={read:e=>{this.editContext.updateControlBounds(e.contentDOM.getBoundingClientRect());let t=bJ(e.root);t&&t.rangeCount&&this.editContext.updateSelectionBounds(t.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,r=!1,n=this.pendingContextChange;return e.changes.iterChanges((i,o,s,a,l)=>{if(r)return;let c=l.length-(o-i);if(n&&o>=n.to)if(n.from==i&&n.to==o&&n.insert.eq(l)){n=this.pendingContextChange=null,t+=c,this.to+=c;return}else n=null,this.revertPending(e.state);if(i+=t,(o+=t)<=this.from)this.from+=c,this.to+=c;else if(i<this.to){if(i<this.from||o>this.to||this.to-this.from+l.length>3e4){r=!0;return}this.editContext.updateText(this.toContextPos(i),this.toContextPos(o),l.toString()),this.to+=c}t+=c}),n&&!r&&this.revertPending(e.state),!r}update(e){let t=this.pendingContextChange,r=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(r.from,r.to)&&e.transactions.some(e=>!e.isUserEvent("input.type")&&e.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):this.applyEdits(e)&&this.rangeIsValid(e.state)?(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state):(this.pendingContextChange=null,this.reset(e.state)),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,r=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),n=this.toContextPos(t.head);(this.editContext.selectionStart!=r||this.editContext.selectionEnd!=n)&&this.editContext.updateSelection(r,n)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>3e4)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let r=this.composing;return r&&r.drifted?r.editorBase+(e-r.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class k${get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:r}=e;for(let t of(this.dispatchTransactions=e.dispatchTransactions||r&&(e=>e.forEach(e=>r(e,this)))||(e=>this.update(e)),this.dispatch=this.dispatch.bind(this),this._root=e.root||function(e){for(;e;){if(e&&(9==e.nodeType||11==e.nodeType&&e.host))return e;e=e.assignedSlot||e.parentNode}return null}(e.parent)||document,this.viewState=new kh(e.state||v0.create(e)),e.scrollTo&&e.scrollTo.is(xI)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(x_).map(e=>new xF(e)),this.plugins))t.update(this);this.observer=new kM(this),this.inputState=new w$(this),this.inputState.ensureHandlers(this.plugins),this.docView=new wd(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),(null==(t=document.fonts)?void 0:t.ready)&&document.fonts.ready.then(()=>{this.viewState.mustMeasureContent=!0,this.requestMeasure()})}dispatch(...e){let t=1==e.length&&e[0]instanceof vK?e:1==e.length&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(0!=this.updateState)throw Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,r=!1,n,i=this.state;for(let t of e){if(t.startState!=i)throw RangeError("Trying to update state with a transaction that doesn't start from the previous state.");i=t.state}if(this.destroyed){this.viewState.state=i;return}let o=this.hasFocus,s=0,a=null;e.some(e=>e.annotation(wQ))?(this.inputState.notifiedFocused=o,s=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,(a=w0(i,o))||(s=1));let l=this.observer.delayedAndroidKey,c=null;if(l?(this.observer.clearDelayedAndroidKey(),((c=this.observer.readChange())&&!this.state.doc.eq(i.doc)||!this.state.selection.eq(i.selection))&&(c=null)):this.observer.clear(),i.facet(v0.phrases)!=this.state.facet(v0.phrases))return this.setState(i);n=xZ.create(this,i,e),n.flags|=s;let u=this.viewState.scrollTarget;try{for(let t of(this.updateState=2,e)){if(u&&(u=u.map(t.changes)),t.scrollIntoView){let{main:e}=t.state.selection;u=new xT(e.empty?e:vv.cursor(e.head,e.head>e.anchor?-1:1))}for(let e of t.effects)e.is(xI)&&(u=e.value.clip(this.state))}this.viewState.update(n,u),this.bidiCache=kN.update(this.bidiCache,n.changes),n.empty||(this.updatePlugins(n),this.inputState.update(n)),t=this.docView.update(n),this.state.facet(xY)!=this.styleModules&&this.mountStyles(),r=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(e=>e.isUserEvent("select.pointer")))}finally{this.updateState=0}if(n.startState.facet(kb)!=n.state.facet(kb)&&(this.viewState.mustMeasureContent=!0),(t||r||u||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!n.empty)for(let e of this.state.facet(xA))try{e(n)}catch(e){xD(this.state,e,"update listener")}(a||c)&&Promise.resolve().then(()=>{a&&this.state==a.startState&&this.dispatch(a),c&&!wM(this,c)&&l.force&&xe(this.contentDOM,l.key,l.keyCode)})}setState(e){if(0!=this.updateState)throw Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let e of this.plugins)e.destroy(this);for(let t of(this.viewState=new kh(e),this.plugins=e.facet(x_).map(e=>new xF(e)),this.pluginMap.clear(),this.plugins))t.update(this);this.docView.destroy(),this.docView=new wd(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(x_),r=e.state.facet(x_);if(t!=r){let n=[];for(let i of r){let r=t.indexOf(i);if(r<0)n.push(new xF(i));else{let t=this.plugins[r];t.mustUpdate=e,n.push(t)}}for(let t of this.plugins)t.mustUpdate!=e&&t.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let t of this.plugins)t.mustUpdate=e;for(let e=0;e<this.plugins.length;e++)this.plugins[e].update(this);t!=r&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(e){xD(this.state,e,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,r=this.scrollDOM,n=r.scrollTop*this.scaleY,{scrollAnchorPos:i,scrollAnchorHeight:o}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let e=0;;e++){if(o<0)if(xt(r))i=-1,o=this.viewState.heightMap.height;else{let e=this.viewState.scrollAnchorAt(n);i=e.from,o=e.top}this.updateState=1;let s=this.viewState.measure(this);if(!s&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(e>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let a=[];4&s||([this.measureRequests,a]=[a,this.measureRequests]);let l=a.map(e=>{try{return e.read(this)}catch(e){return xD(this.state,e),kR}}),c=xZ.create(this,this.state,[]),u=!1;c.flags|=s,t?t.flags|=s:t=c,this.updateState=2,!c.empty&&(this.updatePlugins(c),this.inputState.update(c),this.updateAttrs(),(u=this.docView.update(c))&&this.docViewUpdate());for(let e=0;e<a.length;e++)if(l[e]!=kR)try{let t=a[e];t.write&&t.write(l[e],this)}catch(e){xD(this.state,e)}if(u&&this.docView.updateSelection(!0),!c.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let e=(i<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(i).top)-o;if(e>1||e<-1){r.scrollTop=(n+=e)/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let e of this.state.facet(xA))e(t)}get themeClasses(){return kw+" "+(this.state.facet(kx)?kA:kk)+" "+this.state.facet(kb)}updateAttrs(){let e=k_(this,xB,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(xR)?"true":"false",class:"cm-content",style:`${bR.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),k_(this,xz,t);let r=this.observer.ignore(()=>{let r=bF(this.contentDOM,this.contentAttrs,t),n=bF(this.dom,this.editorAttrs,e);return r||n});return this.editorAttrs=e,this.contentAttrs=t,r}showAnnouncements(e){let t=!0;for(let r of e)for(let e of r.effects)e.is(k$.announce)&&(t&&(this.announceDOM.textContent=""),t=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=e.value)}mountStyles(){this.styleModules=this.state.facet(xY);let e=this.state.facet(k$.cspNonce);bp.mount(this.root,this.styleModules.concat(kC).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(2==this.updateState)throw Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if((this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e)&&!(this.measureRequests.indexOf(e)>-1)){if(null!=e.key){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(void 0===t||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(t=>t.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,r){return wk(this,e,wb(this,e,t,r))}moveByGroup(e,t){return wk(this,e,wb(this,e,t,t=>{var r;let n,i;return r=e.head,i=(n=this.state.charCategorizer(r))(t),e=>{let t=n(e);return i==vZ.Space&&(i=t),i==t}}))}visualLineSide(e,t){let r=this.bidiSpans(e),n=this.textDirectionAt(e.from),i=r[t?r.length-1:0];return vv.cursor(i.side(t,n)+e.from,i.forward(!t,n)?1:-1)}moveToLineBoundary(e,t,r=!0){return function(e,t,r,n){let i=wv(e,t.head,t.assoc||-1),o=n&&i.type==bz.Text&&(e.lineWrapping||i.widgetLineBreaks)?e.coordsAtPos(t.assoc<0&&t.head>i.from?t.head-1:t.head):null;if(o){let t=e.dom.getBoundingClientRect(),n=e.textDirectionAt(i.from),s=e.posAtCoords({x:r==(n==xo.LTR)?t.right-1:t.left+1,y:(o.top+o.bottom)/2});if(null!=s)return vv.cursor(s,r?-1:1)}return vv.cursor(r?i.to:i.from,r?-1:1)}(this,e,t,r)}moveVertically(e,t,r){return wk(this,e,function(e,t,r,n){let i=t.head,o=r?1:-1;if(i==(r?e.state.doc.length:0))return vv.cursor(i,t.assoc);let s=t.goalColumn,a,l=e.contentDOM.getBoundingClientRect(),c=e.coordsAtPos(i,t.assoc||-1),u=e.documentTop;if(c)null==s&&(s=c.left-l.left),a=o<0?c.top:c.bottom;else{let t=e.viewState.lineBlockAt(i);null==s&&(s=Math.min(l.right-l.left,e.defaultCharacterWidth*(i-t.from))),a=(o<0?t.top:t.bottom)+u}let h=l.left+s,d=null!=n?n:e.viewState.heightOracle.textHeight>>1,f=wS(e,{x:h,y:a+d*o},!1,o);return vv.cursor(f.pos,f.assoc,void 0,s)}(this,e,t,r))}domAtPos(e,t=1){return this.docView.domAtPos(e,t)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){this.readMeasured();let r=wS(this,e,t);return r&&r.pos}posAndSideAtCoords(e,t=!0){return this.readMeasured(),wS(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let r=this.docView.coordsAt(e,t);if(!r||r.left==r.right)return r;let n=this.state.doc.lineAt(e),i=this.bidiSpans(n);return b3(r,i[xm.find(i,e-n.from,-1,t)].dir==xo.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(xO)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>kD)return xy(e.length);let t=this.textDirectionAt(e.from),r;for(let n of this.bidiCache)if(n.from==e.from&&n.dir==t&&(n.fresh||function e(t,r){if(t.length!=r.length)return!1;for(let n=0;n<t.length;n++){let i=t[n],o=r[n];if(i.from!=o.from||i.to!=o.to||i.direction!=o.direction||!e(i.inner,o.inner))return!1}return!0}(n.isolates,r=xK(this,e))))return n.order;r||(r=xK(this,e));let n=function(e,t,r){if(!e)return[new xm(0,0,+(t==xa))];if(t==xs&&!r.length&&!xp.test(e))return xy(e.length);if(r.length)for(;e.length>xg.length;)xg[xg.length]=256;let n=[],i=+(t!=xs);return function e(t,r,n,i,o,s,a){let l=r%2?2:1;!function(e,t,r,n,i){for(let o=0;o<=n.length;o++){let s=o?n[o-1].to:t,a=o<n.length?n[o].from:r,l=o?256:i;for(let t=s,r=l,n=l;t<a;t++){let i=xf(e.charCodeAt(t));512==i?i=r:8==i&&4==n&&(i=16),xg[t]=4==i?2:i,7&i&&(n=i),r=i}for(let e=s,t=l,n=l;e<a;e++){let i=xg[e];if(128==i)e<a-1&&t==xg[e+1]&&24&t?i=xg[e]=t:xg[e]=256;else if(64==i){let i=e+1;for(;i<a&&64==xg[i];)i++;let o=e&&8==t||i<r&&8==xg[i]?1==n?1:8:256;for(let t=e;t<i;t++)xg[t]=o;e=i-1}else 8==i&&1==n&&(xg[e]=1);t=i,7&i&&(n=i)}}}(t,o,s,i,l),function(e,t,r,n,i){let o=1==i?2:1;for(let s=0,a=0,l=0;s<=n.length;s++){let c=s?n[s-1].to:t,u=s<n.length?n[s].from:r;for(let t=c,r,n,s;t<u;t++)if(n=xh[r=e.charCodeAt(t)])if(n<0){for(let e=a-3;e>=0;e-=3)if(xd[e+1]==-n){let r=xd[e+2],n=2&r?i:4&r?1&r?o:i:0;n&&(xg[t]=xg[xd[e]]=n),a=e;break}}else if(189==xd.length)break;else xd[a++]=t,xd[a++]=r,xd[a++]=l;else if(2==(s=xg[t])||1==s){let e=s==i;l=+!e;for(let t=a-3;t>=0;t-=3){let r=xd[t+2];if(2&r)break;if(e)xd[t+2]|=2;else{if(4&r)break;xd[t+2]|=4}}}}}(t,o,s,i,l),function(e,t,r,n){for(let i=0,o=n;i<=r.length;i++){let s=i?r[i-1].to:e,a=i<r.length?r[i].from:t;for(let l=s;l<a;){let s=xg[l];if(256==s){let s=l+1;for(;;)if(s==a){if(i==r.length)break;s=r[i++].to,a=i<r.length?r[i].from:t}else if(256==xg[s])s++;else break;let c=1==o,u=c==((s<t?xg[s]:n)==1)?c?1:2:n;for(let t=s,n=i,o=n?r[n-1].to:e;t>l;)t==o&&(t=r[--n].from,o=n?r[n-1].to:e),xg[--t]=u;l=s}else o=s,l++}}}(o,s,i,l),function t(r,n,i,o,s,a,l){let c=o%2?2:1;if(o%2==s%2)for(let u=n,h=0;u<i;){let n=!0,d=!1;if(h==a.length||u<a[h].from){let e=xg[u];e!=c&&(n=!1,d=16==e)}let f=n||1!=c?null:[],p=n?o:o+1,m=u;r:for(;;)if(h<a.length&&m==a[h].from){if(d)break;let t=a[h];if(!n)for(let e=t.to,r=h+1;;){if(e==i)break r;if(r<a.length&&a[r].from==e)e=a[r++].to;else if(xg[e]==c)break r;else break}h++,f?f.push(t):(t.from>u&&l.push(new xm(u,t.from,p)),e(r,t.direction==xs!=!(p%2)?o+1:o,s,t.inner,t.from,t.to,l),u=t.to),m=t.to}else if(m==i||(n?xg[m]!=c:xg[m]==c))break;else m++;f?t(r,u,m,o+1,s,f,l):u<m&&l.push(new xm(u,m,p)),u=m}else for(let u=i,h=a.length;u>n;){let i=!0,d=!1;if(!h||u>a[h-1].to){let e=xg[u-1];e!=c&&(i=!1,d=16==e)}let f=i||1!=c?null:[],p=i?o:o+1,m=u;r:for(;;)if(h&&m==a[h-1].to){if(d)break;let t=a[--h];if(!i)for(let e=t.from,r=h;;){if(e==n)break r;if(r&&a[r-1].to==e)e=a[--r].from;else if(xg[e-1]==c)break r;else break}f?f.push(t):(t.to<u&&l.push(new xm(t.to,u,p)),e(r,t.direction==xs!=!(p%2)?o+1:o,s,t.inner,t.from,t.to,l),u=t.from),m=t.from}else if(m==n||(i?xg[m-1]!=c:xg[m-1]==c))break;else m--;f?t(r,m,u,o+1,s,f,l):m<u&&l.push(new xm(m,u,p)),u=m}}(t,o,s,r,n,i,a)}(e,i,i,r,0,e.length,n),n}(e.text,t,r);return this.bidiCache.push(new kN(e.from,e.to,t,r,!0,n)),n}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||bR.safari&&(null==(e=this.inputState)?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{b8(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((9==e.nodeType?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of(this.root.activeElement==this.contentDOM&&this.contentDOM.blur(),this.plugins))e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return xI.of(new xT("number"==typeof e?vv.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,r=this.viewState.scrollAnchorAt(e);return xI.of(new xT(vv.cursor(r.from),"start","start",r.top-e,t,!0))}setTabFocusMode(e){null==e?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:"boolean"==typeof e?this.inputState.tabFocusMode=e?0:-1:0!=this.inputState.tabFocusMode&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return xL.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return xL.define(()=>({}),{eventObservers:e})}static theme(e,t){let r=bp.newName(),n=[kb.of(r),xY.of(kj(`.${r}`,e))];return t&&t.dark&&n.push(kx.of(!0)),n}static baseTheme(e){return vM.lowest(xY.of(kj("."+kw,e,kS)))}static findFromDOM(e){var t;let r=e.querySelector(".cm-content"),n=r&&x0.get(r)||x0.get(e);return(null==(t=null==n?void 0:n.root)?void 0:t.view)||null}}k$.styleModule=xY,k$.inputHandler=xS,k$.clipboardInputFilter=xC,k$.clipboardOutputFilter=xE,k$.scrollHandler=xP,k$.focusChangeEffect=xj,k$.perLineTextDirection=xO,k$.exceptionSink=xk,k$.updateListener=xA,k$.editable=xR,k$.mouseSelectionStyle=xw,k$.dragMovesSelection=xx,k$.clickAddsSelectionRange=xb,k$.decorations=xW,k$.blockWrappers=xV,k$.outerDecorations=xH,k$.atomicRanges=xU,k$.bidiIsolatedRanges=xq,k$.scrollMargins=xG,k$.darkTheme=kx,k$.cspNonce=vw.define({combine:e=>e.length?e[0]:""}),k$.contentAttributes=xz,k$.editorAttributes=xB,k$.lineWrapping=k$.contentAttributes.of({class:"cm-lineWrapping"}),k$.announce=vq.define();let kD=4096,kR={};class kN{constructor(e,t,r,n,i,o){this.from=e,this.to=t,this.dir=r,this.isolates=n,this.fresh=i,this.order=o}static update(e,t){if(t.empty&&!e.some(e=>e.fresh))return e;let r=[],n=e.length?e[e.length-1].dir:xo.LTR;for(let i=Math.max(0,e.length-10);i<e.length;i++){let o=e[i];o.dir!=n||t.touchesRange(o.from,o.to)||r.push(new kN(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return r}}function k_(e,t,r){for(let n=e.state.facet(t),i=n.length-1;i>=0;i--){let t=n[i],o="function"==typeof t?t(e):t;o&&bN(o,r)}return r}let kL=bR.mac?"mac":bR.windows?"win":bR.linux?"linux":"key";function kF(e,t,r){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),!1!==r&&t.shiftKey&&(e="Shift-"+e),e}let kB=vM.default(k$.domEventHandlers({keydown:(e,t)=>kq(kV(t.state),e,t,"editor")})),kz=vw.define({enables:kB}),kW=new WeakMap;function kV(e){let t=e.facet(kz),r=kW.get(t);return r||kW.set(t,r=function(e,t=kL){let r=Object.create(null),n=Object.create(null),i=(e,t)=>{let r=n[e];if(null==r)n[e]=t;else if(r!=t)throw Error("Key binding "+e+" is used both as a regular binding and as a multi-stroke prefix")},o=(e,n,o,s,a)=>{var l,c;let u=r[e]||(r[e]=Object.create(null)),h=n.split(/ (?!$)/).map(e=>(function(e,t){let r,n,i,o,s=e.split(/-(?!$)/),a=s[s.length-1];"Space"==a&&(a=" ");for(let e=0;e<s.length-1;++e){let a=s[e];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))n=!0;else if(/^s(hift)?$/i.test(a))i=!0;else if(/^mod$/i.test(a))"mac"==t?o=!0:n=!0;else throw Error("Unrecognized modifier name: "+a)}return r&&(a="Alt-"+a),n&&(a="Ctrl-"+a),o&&(a="Meta-"+a),i&&(a="Shift-"+a),a})(e,t));for(let t=1;t<h.length;t++){let r=h.slice(0,t).join(" ");i(r,!0),u[r]||(u[r]={preventDefault:!0,stopPropagation:!1,run:[t=>{let n=kH={view:t,prefix:r,scope:e};return setTimeout(()=>{kH==n&&(kH=null)},4e3),!0}]})}let d=h.join(" ");i(d,!1);let f=u[d]||(u[d]={preventDefault:!1,stopPropagation:!1,run:(null==(c=null==(l=u._any)?void 0:l.run)?void 0:c.slice())||[]});o&&f.run.push(o),s&&(f.preventDefault=!0),a&&(f.stopPropagation=!0)};for(let n of e){let e=n.scope?n.scope.split(" "):["editor"];if(n.any)for(let t of e){let e=r[t]||(r[t]=Object.create(null));e._any||(e._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:i}=n;for(let t in e)e[t].run.push(e=>i(e,kU))}let i=n[t]||n.key;if(i)for(let t of e)o(t,i,n.run,n.preventDefault,n.stopPropagation),n.shift&&o(t,"Shift-"+i,n.shift,n.preventDefault,n.stopPropagation)}return r}(t.reduce((e,t)=>e.concat(t),[]))),r}let kH=null,kU=null;function kq(e,t,r,n){var i;kU=t;let o=("Esc"==(i=!(bb&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||bx&&t.shiftKey&&t.key&&1==t.key.length||"Unidentified"==t.key)&&t.key||(t.shiftKey?bv:by)[t.keyCode]||t.key||"Unidentified")&&(i="Escape"),"Del"==i&&(i="Delete"),"Left"==i&&(i="ArrowLeft"),"Up"==i&&(i="ArrowUp"),"Right"==i&&(i="ArrowRight"),"Down"==i&&(i="ArrowDown"),i),s=vs(vi(o,0))==o.length&&" "!=o,a="",l=!1,c=!1,u=!1;kH&&kH.view==r&&kH.scope==n&&(a=kH.prefix+" ",0>w_.indexOf(t.keyCode)&&(c=!0,kH=null));let h=new Set,d=e=>{if(e){for(let t of e.run)if(!h.has(t)&&(h.add(t),t(r)))return e.stopPropagation&&(u=!0),!0;e.preventDefault&&(e.stopPropagation&&(u=!0),c=!0)}return!1},f=e[n],p,m;return f&&(d(f[a+kF(o,t,!s)])?l=!0:s&&(t.altKey||t.metaKey||t.ctrlKey)&&!(bR.windows&&t.ctrlKey&&t.altKey)&&!(bR.mac&&t.altKey&&!(t.ctrlKey||t.metaKey))&&(p=by[t.keyCode])&&p!=o?d(f[a+kF(p,t,!0)])?l=!0:t.shiftKey&&(m=bv[t.keyCode])!=o&&m!=p&&d(f[a+kF(m,t,!1)])&&(l=!0):s&&t.shiftKey&&d(f[a+kF(o,t,!0)])&&(l=!0),!l&&d(f._any)&&(l=!0)),c&&(l=!0),l&&u&&t.stopPropagation(),kU=null,l}class kK{constructor(e,t,r,n,i){this.className=e,this.left=t,this.top=r,this.width=n,this.height=i}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className==this.className&&(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",null!=this.width&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,r){if(!r.empty)return function(e,t,r){if(r.to<=e.viewport.from||r.from>=e.viewport.to)return[];let n=Math.max(r.from,e.viewport.from),i=Math.min(r.to,e.viewport.to),o=e.textDirection==xo.LTR,s=e.contentDOM,a=s.getBoundingClientRect(),l=kG(e),c=s.querySelector(".cm-line"),u=c&&window.getComputedStyle(c),h=a.left+(u?parseInt(u.paddingLeft)+Math.min(0,parseInt(u.textIndent)):0),d=a.right-(u?parseInt(u.paddingRight):0),f=wv(e,n,1),p=wv(e,i,-1),m=f.type==bz.Text?f:null,g=p.type==bz.Text?p:null;if(m&&(e.lineWrapping||f.widgetLineBreaks)&&(m=kJ(e,n,1,m)),g&&(e.lineWrapping||p.widgetLineBreaks)&&(g=kJ(e,i,-1,g)),m&&g&&m.from==g.from&&m.to==g.to)return v(b(r.from,r.to,m));{let t=m?b(r.from,null,m):x(f,!1),n=g?b(null,r.to,g):x(p,!0),i=[];return(m||f).to<(g||p).from-(m&&g?1:0)||f.widgetLineBreaks>1&&t.bottom+e.defaultLineHeight/2<n.top?i.push(y(h,t.bottom,d,n.top)):t.bottom<n.top&&e.elementAtHeight((t.bottom+n.top)/2).type==bz.Text&&(t.bottom=n.top=(t.bottom+n.top)/2),v(t).concat(i).concat(v(n))}function y(e,r,n,i){return new kK(t,e-l.left,r-l.top,Math.max(0,n-e),i-r)}function v({top:e,bottom:t,horizontal:r}){let n=[];for(let i=0;i<r.length;i+=2)n.push(y(r[i],e,r[i+1],t));return n}function b(t,r,n){let i=1e9,s=-1e9,a=[];function l(t,r,l,c,u){let f=e.coordsAtPos(t,t==n.to?-2:2),p=e.coordsAtPos(l,l==n.from?2:-2);f&&p&&(i=Math.min(f.top,p.top,i),s=Math.max(f.bottom,p.bottom,s),u==xo.LTR?a.push(o&&r?h:f.left,o&&c?d:p.right):a.push(!o&&c?h:p.left,!o&&r?d:f.right))}let c=null!=t?t:n.from,u=null!=r?r:n.to;for(let n of e.visibleRanges)if(n.to>c&&n.from<u)for(let i=Math.max(n.from,c),o=Math.min(n.to,u);;){let n=e.state.doc.lineAt(i);for(let s of e.bidiSpans(n)){let e=s.from+n.from,a=s.to+n.from;if(e>=o)break;a>i&&l(Math.max(e,i),null==t&&e<=c,Math.min(a,o),null==r&&a>=u,s.dir)}if((i=n.to+1)>=o)break}return 0==a.length&&l(c,null==t,u,null==r,e.textDirection),{top:i,bottom:s,horizontal:a}}function x(e,t){let r=a.top+(t?e.top:e.bottom);return{top:r,bottom:r,horizontal:[]}}}(e,t,r);{let n=e.coordsAtPos(r.head,r.assoc||1);if(!n)return[];let i=kG(e);return[new kK(t,n.left-i.left,n.top-i.top,null,n.bottom-n.top)]}}}function kG(e){let t=e.scrollDOM.getBoundingClientRect();return{left:(e.textDirection==xo.LTR?t.left:t.right-e.scrollDOM.clientWidth*e.scaleX)-e.scrollDOM.scrollLeft*e.scaleX,top:t.top-e.scrollDOM.scrollTop*e.scaleY}}function kJ(e,t,r,n){let i=e.coordsAtPos(t,2*r);if(!i)return n;let o=e.dom.getBoundingClientRect(),s=(i.top+i.bottom)/2,a=e.posAtCoords({x:o.left+1,y:s}),l=e.posAtCoords({x:o.right-1,y:s});return null==a||null==l?n:{from:Math.max(n.from,Math.min(a,l)),to:Math.min(n.to,Math.max(a,l))}}class kY{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(kX)!=e.state.facet(kX)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){!1!==this.layer.updateOnDocViewUpdate&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,r=e.facet(kX);for(;t<r.length&&r[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((e,t)=>{var r;return r=this.drawn[t],!(e.constructor==r.constructor&&e.eq(r))})){let t=this.dom.firstChild,r=0;for(let n of e)n.update&&t&&n.constructor&&this.drawn[r].constructor&&n.update(t,this.drawn[r])?(t=t.nextSibling,r++):this.dom.insertBefore(n.draw(),t);for(;t;){let e=t.nextSibling;t.remove(),t=e}this.drawn=e,bR.safari&&bR.safari_version>=26&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}let kX=vw.define();function kZ(e){return[xL.define(t=>new kY(t,e)),kX.of(e)]}let kQ=vw.define({combine:e=>v1(e,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})});function k0(e){return e.startState.facet(kQ)!=e.state.facet(kQ)}let k1=kZ({above:!0,markers(e){let{state:t}=e,r=t.facet(kQ),n=[];for(let i of t.selection.ranges){let o=i==t.selection.main;if(i.empty||r.drawRangeCursor){let t=o?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",r=i.empty?i:vv.cursor(i.head,i.head>i.anchor?-1:1);for(let i of kK.forRange(e,t,r))n.push(i)}}return n},update(e,t){e.transactions.some(e=>e.selection)&&(t.style.animationName="cm-blink"==t.style.animationName?"cm-blink2":"cm-blink");let r=k0(e);return r&&k2(e.state,t),e.docChanged||e.selectionSet||r},mount(e,t){k2(t.state,e)},class:"cm-cursorLayer"});function k2(e,t){t.style.animationDuration=e.facet(kQ).cursorBlinkRate+"ms"}let k4=kZ({above:!1,markers:e=>e.state.selection.ranges.map(t=>t.empty?[]:kK.forRange(e,"cm-selectionBackground",t)).reduce((e,t)=>e.concat(t)),update:(e,t)=>e.docChanged||e.selectionSet||e.viewportChanged||k0(e),class:"cm-selectionLayer"}),k3=vM.highest(k$.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),k5=vq.define({map:(e,t)=>null==e?null:t.mapPos(e)}),k6=vE.define({create:()=>null,update:(e,t)=>(null!=e&&(e=t.changes.mapPos(e)),t.effects.reduce((e,t)=>t.is(k5)?t.value:e,e))}),k9=xL.fromClass(class{constructor(e){this.view=e,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(e){var t;let r=e.state.field(k6);null==r?null!=this.cursor&&(null==(t=this.cursor)||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(e.startState.field(k6)!=r||e.docChanged||e.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:e}=this,t=e.state.field(k6),r=null!=t&&e.coordsAtPos(t);if(!r)return null;let n=e.scrollDOM.getBoundingClientRect();return{left:r.left-n.left+e.scrollDOM.scrollLeft*e.scaleX,top:r.top-n.top+e.scrollDOM.scrollTop*e.scaleY,height:r.bottom-r.top}}drawCursor(e){if(this.cursor){let{scaleX:t,scaleY:r}=this.view;e?(this.cursor.style.left=e.left/t+"px",this.cursor.style.top=e.top/r+"px",this.cursor.style.height=e.height/r+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(e){this.view.state.field(k6)!=e&&this.view.dispatch({effects:k5.of(e)})}},{eventObservers:{dragover(e){this.setDropPos(this.view.posAtCoords({x:e.clientX,y:e.clientY}))},dragleave(e){e.target!=this.view.contentDOM&&this.view.contentDOM.contains(e.relatedTarget)||this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function k8(e,t,r,n,i){t.lastIndex=0;for(let o=e.iterRange(r,n),s=r,a;!o.next().done;s+=o.value.length)if(!o.lineBreak)for(;a=t.exec(o.value);)i(s+a.index,a)}class k7{constructor(e){const{regexp:t,decoration:r,decorate:n,boundary:i,maxLength:o=1e3}=e;if(!t.global)throw RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,n)this.addMatch=(e,t,r,i)=>n(i,r,r+e[0].length,e,t);else if("function"==typeof r)this.addMatch=(e,t,n,i)=>{let o=r(e,t,n);o&&i(n,n+e[0].length,o)};else if(r)this.addMatch=(e,t,n,i)=>i(n,n+e[0].length,r);else throw RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=i,this.maxLength=o}createDeco(e){let t=new v8,r=t.add.bind(t);for(let{from:t,to:n}of function(e,t){let r=e.visibleRanges;if(1==r.length&&r[0].from==e.viewport.from&&r[0].to==e.viewport.to)return r;let n=[];for(let{from:i,to:o}of r)i=Math.max(e.state.doc.lineAt(i).from,i-t),o=Math.min(e.state.doc.lineAt(o).to,o+t),n.length&&n[n.length-1].to>=i?n[n.length-1].to=o:n.push({from:i,to:o});return n}(e,this.maxLength))k8(e.state.doc,this.regexp,t,n,(t,n)=>this.addMatch(n,e,t,r));return t.finish()}updateDeco(e,t){let r=1e9,n=-1;return(e.docChanged&&e.changes.iterChanges((t,i,o,s)=>{s>=e.view.viewport.from&&o<=e.view.viewport.to&&(r=Math.min(o,r),n=Math.max(s,n))}),e.viewportMoved||n-r>1e3)?this.createDeco(e.view):n>-1?this.updateRange(e.view,t.map(e.changes),r,n):t}updateRange(e,t,r,n){for(let i of e.visibleRanges){let o=Math.max(i.from,r),s=Math.min(i.to,n);if(s>=o){let r=e.state.doc.lineAt(o),n=r.to<s?e.state.doc.lineAt(s):r,a=Math.max(i.from,r.from),l=Math.min(i.to,n.to);if(this.boundary){for(;o>r.from;o--)if(this.boundary.test(r.text[o-1-r.from])){a=o;break}for(;s<n.to;s++)if(this.boundary.test(n.text[s-n.from])){l=s;break}}let c=[],u,h=(e,t,r)=>c.push(r.range(e,t));if(r==n)for(this.regexp.lastIndex=a-r.from;(u=this.regexp.exec(r.text))&&u.index<l-r.from;)this.addMatch(u,e,u.index+r.from,h);else k8(e.state.doc,this.regexp,a,l,(t,r)=>this.addMatch(r,e,t,h));t=t.update({filterFrom:a,filterTo:l,filter:(e,t)=>e<a||t>l,add:c})}}return t}}let Ae=null!=/x/.unicode?"gu":"g",At=RegExp("[\0-\b\n-\x1f\x7f-\x9f\xad\u2028\u2029\uFEFF-]",Ae),Ar={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},An=null,Ai=vw.define({combine(e){let t=v1(e,{render:null,specialChars:At,addSpecialChars:null});return(t.replaceTabs=!function(){var e;if(null==An&&"u">typeof document&&document.body){let t=document.body.style;An=(null!=(e=t.tabSize)?e:t.MozTabSize)!=null}return An||!1}())&&(t.specialChars=RegExp("	|"+t.specialChars.source,Ae)),t.addSpecialChars&&(t.specialChars=RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,Ae)),t}}),Ao=null;class As extends bB{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){var t;let r=(t=this.code)>=32?"":10==t?"":String.fromCharCode(9216+t),n=e.state.phrase("Control character")+" "+(Ar[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,n,r);if(i)return i;let o=document.createElement("span");return o.textContent=r,o.title=n,o.setAttribute("aria-label",n),o.className="cm-specialChar",o}ignoreEvent(){return!1}}class Aa extends bB{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}let Al=bW.line({class:"cm-activeLine"}),Ac=xL.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.docChanged||e.selectionSet)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=-1,r=[];for(let n of e.state.selection.ranges){let i=e.lineBlockAt(n.head);i.from>t&&(r.push(Al.range(i.from)),t=i.from)}return bW.set(r)}},{decorations:e=>e.decorations});class Au extends bB{constructor(e){super(),this.content=e}toDOM(e){let t=document.createElement("span");return t.className="cm-placeholder",t.style.pointerEvents="none",t.appendChild("string"==typeof this.content?document.createTextNode(this.content):"function"==typeof this.content?this.content(e):this.content.cloneNode(!0)),t.setAttribute("aria-hidden","true"),t}coordsAt(e){let t=e.firstChild?bZ(e.firstChild):[];if(!t.length)return null;let r=window.getComputedStyle(e.parentNode),n=b3(t[0],"rtl"!=r.direction),i=parseInt(r.lineHeight);return n.bottom-n.top>1.5*i?{left:n.left,right:n.right,top:n.top,bottom:n.top+i}:n}ignoreEvent(){return!1}}function Ah(e,t){var r;let n,i=e.posAtCoords({x:t.clientX,y:t.clientY},!1),o=e.state.doc.lineAt(i),s=i-o.from,a=s>2e3?-1:s==o.length?(r=t.clientX,(n=e.coordsAtPos(e.viewport.from))?Math.round(Math.abs((n.left-r)/e.defaultCharacterWidth)):-1):bc(o.text,e.state.tabSize,i-o.from);return{line:o.number,col:a,off:s}}let Ad={Alt:[18,e=>!!e.altKey],Control:[17,e=>!!e.ctrlKey],Shift:[16,e=>!!e.shiftKey],Meta:[91,e=>!!e.metaKey]},Af={style:"cursor: crosshair"},Ap="-10000px";class Am{constructor(e,t,r,n){this.facet=t,this.createTooltipView=r,this.removeTooltipView=n,this.input=e.state.facet(t),this.tooltips=this.input.filter(e=>e);let i=null;this.tooltipViews=this.tooltips.map(e=>i=r(e,i))}update(e,t){var r;let n=e.state.facet(this.facet),i=n.filter(e=>e);if(n===this.input){for(let t of this.tooltipViews)t.update&&t.update(e);return!1}let o=[],s=t?[]:null;for(let r=0;r<i.length;r++){let n=i[r],a=-1;if(n){for(let e=0;e<this.tooltips.length;e++){let t=this.tooltips[e];t&&t.create==n.create&&(a=e)}if(a<0)o[r]=this.createTooltipView(n,r?o[r-1]:null),s&&(s[r]=!!n.above);else{let n=o[r]=this.tooltipViews[a];s&&(s[r]=t[a]),n.update&&n.update(e)}}}for(let e of this.tooltipViews)0>o.indexOf(e)&&(this.removeTooltipView(e),null==(r=e.destroy)||r.call(e));return t&&(s.forEach((e,r)=>t[r]=e),t.length=s.length),this.input=n,this.tooltips=i,this.tooltipViews=o,!0}}function Ag(e){let t=e.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:t.clientHeight,right:t.clientWidth}}let Ay=vw.define({combine:e=>{var t,r,n;return{position:bR.ios?"absolute":(null==(t=e.find(e=>e.position))?void 0:t.position)||"fixed",parent:(null==(r=e.find(e=>e.parent))?void 0:r.parent)||null,tooltipSpace:(null==(n=e.find(e=>e.tooltipSpace))?void 0:n.tooltipSpace)||Ag}}}),Av=new WeakMap,Ab=xL.fromClass(class{constructor(e){this.view=e,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let t=e.state.facet(Ay);this.position=t.position,this.parent=t.parent,this.classes=e.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver="function"==typeof ResizeObserver?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new Am(e,AA,(e,t)=>this.createTooltip(e,t),e=>{this.resizeObserver&&this.resizeObserver.unobserve(e.dom),e.dom.remove()}),this.above=this.manager.tooltips.map(e=>!!e.above),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver(e=>{Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),e.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver)for(let e of(this.intersectionObserver.disconnect(),this.manager.tooltipViews))this.intersectionObserver.observe(e.dom)}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(e){e.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(e,this.above);t&&this.observeIntersection();let r=t||e.geometryChanged,n=e.state.facet(Ay);if(n.position!=this.position&&!this.madeAbsolute){for(let e of(this.position=n.position,this.manager.tooltipViews))e.dom.style.position=this.position;r=!0}if(n.parent!=this.parent){for(let e of(this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer(),this.manager.tooltipViews))this.container.appendChild(e.dom);r=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);r&&this.maybeMeasure()}createTooltip(e,t){let r=e.create(this.view),n=t?t.dom:null;if(r.dom.classList.add("cm-tooltip"),e.arrow&&!r.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let e=document.createElement("div");e.className="cm-tooltip-arrow",r.dom.appendChild(e)}return r.dom.style.position=this.position,r.dom.style.top=Ap,r.dom.style.left="0px",this.container.insertBefore(r.dom,n),r.mount&&r.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(r.dom),r}destroy(){var e,t,r;for(let t of(this.view.win.removeEventListener("resize",this.measureSoon),this.manager.tooltipViews))t.dom.remove(),null==(e=t.destroy)||e.call(t);this.parent&&this.container.remove(),null==(t=this.resizeObserver)||t.disconnect(),null==(r=this.intersectionObserver)||r.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let e=1,t=1,r=!1;if("fixed"==this.position&&this.manager.tooltipViews.length){let{dom:e}=this.manager.tooltipViews[0];if(bR.safari){let t=e.getBoundingClientRect();r=Math.abs(t.top+1e4)>1||Math.abs(t.left)>1}else r=!!e.offsetParent&&e.offsetParent!=this.container.ownerDocument.body}if(r||"absolute"==this.position)if(this.parent){let r=this.parent.getBoundingClientRect();r.width&&r.height&&(e=r.width/this.parent.offsetWidth,t=r.height/this.parent.offsetHeight)}else({scaleX:e,scaleY:t}=this.view.viewState);let n=this.view.scrollDOM.getBoundingClientRect(),i=xJ(this.view);return{visible:{left:n.left+i.left,top:n.top+i.top,right:n.right-i.right,bottom:n.bottom-i.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((e,t)=>{let r=this.manager.tooltipViews[t];return r.getCoords?r.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(({dom:e})=>e.getBoundingClientRect()),space:this.view.state.facet(Ay).tooltipSpace(this.view),scaleX:e,scaleY:t,makeAbsolute:r}}writeMeasure(e){var t;if(e.makeAbsolute)for(let e of(this.madeAbsolute=!0,this.position="absolute",this.manager.tooltipViews))e.dom.style.position="absolute";let{visible:r,space:n,scaleX:i,scaleY:o}=e,s=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],c=this.manager.tooltipViews[a],{dom:u}=c,h=e.pos[a],d=e.size[a];if(!h||!1!==l.clip&&(h.bottom<=Math.max(r.top,n.top)||h.top>=Math.min(r.bottom,n.bottom)||h.right<Math.max(r.left,n.left)-.1||h.left>Math.min(r.right,n.right)+.1)){u.style.top=Ap;continue}let f=l.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,p=7*!!f,m=d.right-d.left,g=null!=(t=Av.get(c))?t:d.bottom-d.top,y=c.offset||Ak,v=this.view.textDirection==xo.LTR,b=d.width>n.right-n.left?v?n.left:n.right-d.width:v?Math.max(n.left,Math.min(h.left-14*!!f+y.x,n.right-m)):Math.min(Math.max(n.left,h.left-m+14*!!f-y.x),n.right-m),x=this.above[a];!l.strictSide&&(x?h.top-g-p-y.y<n.top:h.bottom+g+p+y.y>n.bottom)&&x==n.bottom-h.bottom>h.top-n.top&&(x=this.above[a]=!x);let w=(x?h.top-n.top:n.bottom-h.bottom)-p;if(w<g&&!1!==c.resize){if(w<this.view.defaultLineHeight){u.style.top=Ap;continue}Av.set(c,g),u.style.height=(g=w)/o+"px"}else u.style.height&&(u.style.height="");let k=x?h.top-g-p-y.y:h.bottom+p+y.y,A=b+m;if(!0!==c.overlap)for(let e of s)e.left<A&&e.right>b&&e.top<k+g&&e.bottom>k&&(k=x?e.top-g-2-p:e.bottom+p+2);if("absolute"==this.position?(u.style.top=(k-e.parent.top)/o+"px",Ax(u,(b-e.parent.left)/i)):(u.style.top=k/o+"px",Ax(u,b/i)),f){let e=h.left+(v?y.x:-y.x)-(b+14-7);f.style.left=e/i+"px"}!0!==c.overlap&&s.push({left:b,top:k,right:A,bottom:k+g}),u.classList.toggle("cm-tooltip-above",x),u.classList.toggle("cm-tooltip-below",!x),c.positioned&&c.positioned(e.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView)&&(this.inView=this.view.inView,!this.inView))for(let e of this.manager.tooltipViews)e.dom.style.top=Ap}},{eventObservers:{scroll(){this.maybeMeasure()}}});function Ax(e,t){let r=parseInt(e.style.left,10);(isNaN(r)||Math.abs(t-r)>1)&&(e.style.left=t+"px")}let Aw=k$.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Ak={x:0,y:0},AA=vw.define({enables:[Ab,Aw]}),AS=vw.define({combine:e=>e.reduce((e,t)=>e.concat(t),[])});class Aj{static create(e){return new Aj(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Am(e,AS,(e,t)=>this.createHostedView(e,t),e=>e.dom.remove())}createHostedView(e,t){let r=e.create(this.view);return r.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(r.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&r.mount&&r.mount(this.view),r}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)null==(e=t.destroy)||e.call(t)}passProp(e){let t;for(let r of this.manager.tooltipViews){let n=r[e];if(void 0!==n){if(void 0===t)t=n;else if(t!==n)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}let AC=AA.compute([AS],e=>{let t=e.facet(AS);return 0===t.length?null:{pos:Math.min(...t.map(e=>e.pos)),end:Math.max(...t.map(e=>{var t;return null!=(t=e.end)?t:e.pos})),create:Aj.create,above:t[0].above,arrow:t.some(e=>e.arrow)}});class AE{constructor(e,t,r,n,i){this.view=e,this.source=t,this.field=r,this.setHover=n,this.hoverTime=i,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,r=e.docView.tile.nearest(t.target);if(!r)return;let n,i=1;if(r.isWidget())n=r.posAtStart;else{if(null==(n=e.posAtCoords(t)))return;let r=e.coordsAtPos(n);if(!r||t.y<r.top||t.y>r.bottom||t.x<r.left-e.defaultCharacterWidth||t.x>r.right+e.defaultCharacterWidth)return;let o=e.bidiSpans(e.state.doc.lineAt(n)).find(e=>e.from<=n&&e.to>=n),s=o&&o.dir==xo.RTL?-1:1;i=t.x<r.left?-s:s}let o=this.source(e,n,i);if(null==o?void 0:o.then){let t=this.pending={pos:n};o.then(r=>{this.pending==t&&(this.pending=null,r&&!(Array.isArray(r)&&!r.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(r)?r:[r])}))},t=>xD(e.state,t,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(Ab),t=e?e.manager.tooltips.findIndex(e=>e.create==Aj.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,r;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:n,tooltip:i}=this;if(n.length&&i&&!function(e,t){let{left:r,right:n,top:i,bottom:o}=e.getBoundingClientRect(),s;if(s=e.querySelector(".cm-tooltip-arrow")){let e=s.getBoundingClientRect();i=Math.min(e.top,i),o=Math.max(e.bottom,o)}return t.clientX>=r-4&&t.clientX<=n+4&&t.clientY>=i-4&&t.clientY<=o+4}(i.dom,e)||this.pending){let{pos:i}=n[0]||this.pending,o=null!=(r=null==(t=n[0])?void 0:t.end)?r:i;(i==o?this.view.posAtCoords(this.lastMove)!=i:!function(e,t,r,n,i,o){let s=e.scrollDOM.getBoundingClientRect(),a=e.documentTop+e.documentPadding.top+e.contentHeight;if(s.left>n||s.right<n||s.top>i||Math.min(s.bottom,a)<i)return!1;let l=e.posAtCoords({x:n,y:i},!1);return l>=t&&l<=r}(this.view,i,o,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:t}=this;t&&t.dom.contains(e.relatedTarget)?this.watchTooltipLeave(t.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=r=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(r.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),clearTimeout(this.restartTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function AO(e,t){let r=e.plugin(Ab);if(!r)return null;let n=r.manager.tooltips.indexOf(t);return n<0?null:r.manager.tooltipViews[n]}let AM=vq.define(),AP=vw.define({combine(e){let t,r;for(let n of e)t=t||n.topContainer,r=r||n.bottomContainer;return{topContainer:t,bottomContainer:r}}});function AT(e,t){let r=e.plugin(AI),n=r?r.specs.indexOf(t):-1;return n>-1?r.panels[n]:null}let AI=xL.fromClass(class{constructor(e){this.input=e.state.facet(AR),this.specs=this.input.filter(e=>e),this.panels=this.specs.map(t=>t(e));let t=e.state.facet(AP);for(let r of(this.top=new A$(e,!0,t.topContainer),this.bottom=new A$(e,!1,t.bottomContainer),this.top.sync(this.panels.filter(e=>e.top)),this.bottom.sync(this.panels.filter(e=>!e.top)),this.panels))r.dom.classList.add("cm-panel"),r.mount&&r.mount()}update(e){let t=e.state.facet(AP);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new A$(e.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new A$(e.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let r=e.state.facet(AR);if(r!=this.input){let t=r.filter(e=>e),n=[],i=[],o=[],s=[];for(let r of t){let t=this.specs.indexOf(r),a;t<0?(a=r(e.view),s.push(a)):(a=this.panels[t]).update&&a.update(e),n.push(a),(a.top?i:o).push(a)}for(let e of(this.specs=t,this.panels=n,this.top.sync(i),this.bottom.sync(o),s))e.dom.classList.add("cm-panel"),e.mount&&e.mount()}else for(let t of this.panels)t.update&&t.update(e)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:e=>k$.scrollMargins.of(t=>{let r=t.plugin(e);return r&&{top:r.top.scrollMargin(),bottom:r.bottom.scrollMargin()}})});class A${constructor(e,t,r){this.view=e,this.top=t,this.container=r,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&0>e.indexOf(t)&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(0==this.panels.length){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=AD(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=AD(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function AD(e){let t=e.nextSibling;return e.remove(),t}let AR=vw.define({enables:AI}),AN=vE.define({create:()=>[],update(e,t){for(let r of t.effects)r.is(A_)?e=[r.value].concat(e):r.is(AL)&&(e=e.filter(e=>e!=r.value));return e},provide:e=>AR.computeN([e],t=>t.field(e))}),A_=vq.define(),AL=vq.define();class AF extends v2{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}AF.prototype.elementClass="",AF.prototype.toDOM=void 0,AF.prototype.mapMode=vl.TrackBefore,AF.prototype.startSide=AF.prototype.endSide=-1,AF.prototype.point=!0;let AB=vw.define(),Az=vw.define(),AW={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>v9.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},AV=vw.define(),AH=vw.define({combine:e=>e.some(e=>e)});function AU(e){let t=[Aq];return e&&!1===e.fixed&&t.push(AH.of(!0)),t}let Aq=xL.fromClass(class{constructor(e){for(let t of(this.view=e,this.domAfter=null,this.prevViewport=e.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=e.state.facet(AV).map(t=>new AY(e,t)),this.fixed=!e.state.facet(AH),this.gutters))"after"==t.config.side?this.getDOMAfter().appendChild(t.dom):this.dom.appendChild(t.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),e.scrollDOM.insertBefore(this.dom,e.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(e){if(this.updateGutters(e)){let t=this.prevViewport,r=e.view.viewport,n=Math.min(t.to,r.to)-Math.max(t.from,r.from);this.syncGutters(n<(r.to-r.from)*.8)}if(e.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(AH)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=e.view.viewport}syncGutters(e){let t=this.dom.nextSibling;e&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let r=v9.iter(this.view.state.facet(AB),this.view.viewport.from),n=[],i=this.gutters.map(e=>new AJ(e,this.view.viewport,-this.view.documentPadding.top));for(let e of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(e.type)){let t=!0;for(let o of e.type)if(o.type==bz.Text&&t){for(let e of(AG(r,n,o.from),i))e.line(this.view,o,n);t=!1}else if(o.widget)for(let e of i)e.widget(this.view,o)}else if(e.type==bz.Text)for(let t of(AG(r,n,e.from),i))t.line(this.view,e,n);else if(e.widget)for(let t of i)t.widget(this.view,e);for(let e of i)e.finish();e&&(this.view.scrollDOM.insertBefore(this.dom,t),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(e){let t=e.startState.facet(AV),r=e.state.facet(AV),n=e.docChanged||e.heightChanged||e.viewportChanged||!v9.eq(e.startState.facet(AB),e.state.facet(AB),e.view.viewport.from,e.view.viewport.to);if(t==r)for(let t of this.gutters)t.update(e)&&(n=!0);else{n=!0;let i=[];for(let n of r){let r=t.indexOf(n);r<0?i.push(new AY(this.view,n)):(this.gutters[r].update(e),i.push(this.gutters[r]))}for(let e of this.gutters)e.dom.remove(),0>i.indexOf(e)&&e.destroy();for(let e of i)"after"==e.config.side?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.gutters=i}return n}destroy(){for(let e of this.gutters)e.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:e=>k$.scrollMargins.of(t=>{let r=t.plugin(e);if(!r||0==r.gutters.length||!r.fixed)return null;let n=r.dom.offsetWidth*t.scaleX,i=r.domAfter?r.domAfter.offsetWidth*t.scaleX:0;return t.textDirection==xo.LTR?{left:n,right:i}:{right:n,left:i}})});function AK(e){return Array.isArray(e)?e:[e]}function AG(e,t,r){for(;e.value&&e.from<=r;)e.from==r&&t.push(e.value),e.next()}class AJ{constructor(e,t,r){this.gutter=e,this.height=r,this.i=0,this.cursor=v9.iter(e.markers,t.from)}addElement(e,t,r){let{gutter:n}=this,i=(t.top-this.height)/e.scaleY,o=t.height/e.scaleY;if(this.i==n.elements.length){let t=new AX(e,o,i,r);n.elements.push(t),n.dom.appendChild(t.dom)}else n.elements[this.i].update(e,o,i,r);this.height=t.bottom,this.i++}line(e,t,r){let n=[];AG(this.cursor,n,t.from),r.length&&(n=n.concat(r));let i=this.gutter.config.lineMarker(e,t,n);i&&n.unshift(i);let o=this.gutter;(0!=n.length||o.config.renderEmptyElements)&&this.addElement(e,t,n)}widget(e,t){let r=this.gutter.config.widgetMarker(e,t.widget,t),n=r?[r]:null;for(let r of e.state.facet(Az)){let i=r(e,t.widget,t);i&&(n||(n=[])).push(i)}n&&this.addElement(e,t,n)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class AY{constructor(e,t){for(let r in this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:""),t.domEventHandlers)this.dom.addEventListener(r,n=>{let i=n.target,o;if(i!=this.dom&&this.dom.contains(i)){for(;i.parentNode!=this.dom;)i=i.parentNode;let e=i.getBoundingClientRect();o=(e.top+e.bottom)/2}else o=n.clientY;let s=e.lineBlockAtHeight(o-e.documentTop);t.domEventHandlers[r](e,s,n)&&n.preventDefault()});this.markers=AK(t.markers(e)),t.initialSpacer&&(this.spacer=new AX(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=AK(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let t=this.config.updateSpacer(this.spacer.markers[0],e);t!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[t])}let r=e.view.viewport;return!v9.eq(this.markers,t,r.from,r.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(e)}destroy(){for(let e of this.elements)e.destroy()}}class AX{constructor(e,t,r,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,r,n)}update(e,t,r,n){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=r&&(this.dom.style.marginTop=(this.above=r)?r+"px":""),!function(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].compare(t[r]))return!1;return!0}(this.markers,n)&&this.setMarkers(e,n)}setMarkers(e,t){let r="cm-gutterElement",n=this.dom.firstChild;for(let i=0,o=0;;){let s=o,a=i<t.length?t[i++]:null,l=!1;if(a){let e=a.elementClass;e&&(r+=" "+e);for(let e=o;e<this.markers.length;e++)if(this.markers[e].compare(a)){s=e,l=!0;break}}else s=this.markers.length;for(;o<s;){let e=this.markers[o++];if(e.toDOM){e.destroy(n);let t=n.nextSibling;n.remove(),n=t}}if(!a)break;a.toDOM&&(l?n=n.nextSibling:this.dom.insertBefore(a.toDOM(e),n)),l&&o++}this.dom.className=r,this.markers=t}destroy(){this.setMarkers(null,[])}}let AZ=vw.define(),AQ=vw.define(),A0=vw.define({combine:e=>v1(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let r=Object.assign({},e);for(let e in t){let n=r[e],i=t[e];r[e]=n?(e,t,r)=>n(e,t,r)||i(e,t,r):i}return r}})});class A1 extends AF{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function A2(e,t){return e.state.facet(A0).formatNumber(t,e.state)}let A4=AV.compute([A0],e=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers:e=>e.state.facet(AZ),lineMarker:(e,t,r)=>r.some(e=>e.toDOM)?null:new A1(A2(e,e.state.doc.lineAt(t.from).number)),widgetMarker:(e,t,r)=>{for(let n of e.state.facet(AQ)){let i=n(e,t,r);if(i)return i}return null},lineMarkerChange:e=>e.startState.facet(A0)!=e.state.facet(A0),initialSpacer:e=>new A1(A2(e,A3(e.state.doc.lines))),updateSpacer(e,t){let r=A2(t.view,A3(t.view.state.doc.lines));return r==e.number?e:new A1(r)},domEventHandlers:e.facet(A0).domEventHandlers,side:"before"}));function A3(e){let t=9;for(;t<e;)t=10*t+9;return t}let A5=new class extends AF{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},A6=AB.compute(["selection"],e=>{let t=[],r=-1;for(let n of e.selection.ranges){let i=e.doc.lineAt(n.head).from;i>r&&(r=i,t.push(A5.range(i)))}return v9.of(t)}),A9=0;class A8{constructor(e,t){this.from=e,this.to=t}}class A7{constructor(e={}){this.id=A9++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw Error("This node type doesn't define a deserialize function")}),this.combine=e.combine||null}add(e){if(this.perNode)throw RangeError("Can't add per-node props to node types");return"function"!=typeof e&&(e=Sr.match(e)),t=>{let r=e(t);return void 0===r?null:[this,r]}}}A7.closedBy=new A7({deserialize:e=>e.split(" ")}),A7.openedBy=new A7({deserialize:e=>e.split(" ")}),A7.group=new A7({deserialize:e=>e.split(" ")}),A7.isolate=new A7({deserialize:e=>{if(e&&"rtl"!=e&&"ltr"!=e&&"auto"!=e)throw RangeError("Invalid value for isolate: "+e);return e||"auto"}}),A7.contextHash=new A7({perNode:!0}),A7.lookAhead=new A7({perNode:!0}),A7.mounted=new A7({perNode:!0});class Se{constructor(e,t,r,n=!1){this.tree=e,this.overlay=t,this.parser=r,this.bracketed=n}static get(e){return e&&e.props&&e.props[A7.mounted.id]}}let St=Object.create(null);class Sr{constructor(e,t,r,n=0){this.name=e,this.props=t,this.id=r,this.flags=n}static define(e){let t=e.props&&e.props.length?Object.create(null):St,r=!!e.top|2*!!e.skipped|4*!!e.error|8*(null==e.name),n=new Sr(e.name||"",t,e.id,r);if(e.props){for(let r of e.props)if(Array.isArray(r)||(r=r(n)),r){if(r[0].perNode)throw RangeError("Can't store a per-node prop on a node type");t[r[0].id]=r[1]}}return n}prop(e){return this.props[e.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(e){if("string"==typeof e){if(this.name==e)return!0;let t=this.prop(A7.group);return!!t&&t.indexOf(e)>-1}return this.id==e}static match(e){let t=Object.create(null);for(let r in e)for(let n of r.split(" "))t[n]=e[r];return e=>{for(let r=e.prop(A7.group),n=-1;n<(r?r.length:0);n++){let i=t[n<0?e.name:r[n]];if(i)return i}}}}Sr.none=new Sr("",Object.create(null),0,8);class Sn{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let r of this.types){let n=null;for(let t of e){let e=t(r);if(e){n||(n=Object.assign({},r.props));let t=e[1],i=e[0];i.combine&&i.id in n&&(t=i.combine(n[i.id],t)),n[i.id]=t}}t.push(n?new Sr(r.name,n,r.id,r.flags):r)}return new Sn(t)}}let Si=new WeakMap,So=new WeakMap;(p=m||(m={}))[p.ExcludeBuffers=1]="ExcludeBuffers",p[p.IncludeAnonymous=2]="IncludeAnonymous",p[p.IgnoreMounts=4]="IgnoreMounts",p[p.IgnoreOverlays=8]="IgnoreOverlays",p[p.EnterBracketed=16]="EnterBracketed";class Ss{constructor(e,t,r,n,i){if(this.type=e,this.children=t,this.positions=r,this.length=n,this.props=null,i&&i.length)for(let[e,t]of(this.props=Object.create(null),i))this.props["number"==typeof e?e:e.id]=t}toString(){let e=Se.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let e of this.children){let r=e.toString();r&&(t&&(t+=","),t+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new Sb(this.topNode,e)}cursorAt(e,t=0,r=0){let n=new Sb(Si.get(this)||this.topNode);return n.moveTo(e,t),Si.set(this,n._tree),n}get topNode(){return new Sd(this,0,0,null)}resolve(e,t=0){let r=Su(Si.get(this)||this.topNode,e,t,!1);return Si.set(this,r),r}resolveInner(e,t=0){let r=Su(So.get(this)||this.topNode,e,t,!0);return So.set(this,r),r}resolveStack(e,t=0){return function(e,t,r){let n=e.resolveInner(t,r),i=null;for(let e=n instanceof Sd?n:n.context.parent;e;e=e.parent)if(e.index<0){let o=e.parent;(i||(i=[n])).push(o.resolve(t,r)),e=o}else{let o=Se.get(e.tree);if(o&&o.overlay&&o.overlay[0].from<=t&&o.overlay[o.overlay.length-1].to>=t){let s=new Sd(o.tree,o.overlay[0].from+e.from,-1,e);(i||(i=[n])).push(Su(s,t,r,!1))}}return i?Sy(i):n}(this,e,t)}iterate(e){let{enter:t,leave:r,from:n=0,to:i=this.length}=e,o=e.mode||0,s=(o&m.IncludeAnonymous)>0;for(let e=this.cursor(o|m.IncludeAnonymous);;){let o=!1;if(e.from<=i&&e.to>=n&&(!s&&e.type.isAnonymous||!1!==t(e))){if(e.firstChild())continue;o=!0}for(;o&&r&&(s||!e.type.isAnonymous)&&r(e),!e.nextSibling();){if(!e.parent())return;o=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:SA(Sr.none,this.children,this.positions,0,this.children.length,0,this.length,(e,t,r)=>new Ss(this.type,e,t,r,this.propValues),e.makeTree||((e,t,r)=>new Ss(Sr.none,e,t,r)))}static build(e){return function(e){var t;let{buffer:r,nodeSet:n,maxBufferLength:i=1024,reused:o=[],minRepeatType:s=n.types.length}=e,a=Array.isArray(r)?new Sa(r,r.length):r,l=n.types,c=0,u=0;function h(e,t,r,i,o,s,a,l,c){let u=[],h=[];for(;e.length>i;)u.push(e.pop()),h.push(t.pop()+r-o);e.push(d(n.types[a],u,h,s-o,l-s,c)),t.push(o-r)}function d(e,t,r,n,i,o,s){if(o){let e=[A7.contextHash,o];s=s?[e].concat(s):[e]}if(i>25){let e=[A7.lookAhead,i];s=s?[e].concat(s):[e]}return new Ss(e,t,r,n,s)}let f=[],p=[];for(;a.pos>0;)!function e(t,r,f,p,m,g){let{id:y,start:v,end:b,size:x}=a,w=u,k=c;if(x<0){if(a.next(),-1==x){let e=o[y];f.push(e),p.push(v-t);return}if(-3==x){c=y;return}if(-4==x){u=y;return}else throw RangeError(`Unrecognized record size: ${x}`)}let A=l[y],S,j,C=v-t;if(b-v<=i&&(j=function(e,t){let r=a.fork(),n=0,o=0,l=0,c=r.end-i,u={size:0,start:0,skip:0};n:for(let i=r.pos-e;r.pos>i;){let e=r.size;if(r.id==t&&e>=0){u.size=n,u.start=o,u.skip=l,l+=4,n+=4,r.next();continue}let a=r.pos-e;if(e<0||a<i||r.start<c)break;let h=4*(r.id>=s),d=r.start;for(r.next();r.pos>a;){if(r.size<0)if(-3==r.size||-4==r.size)h+=4;else break n;else r.id>=s&&(h+=4);r.next()}o=d,n+=e,l+=h}return(t<0||n==e)&&(u.size=n,u.start=o,u.skip=l),u.size>4?u:void 0}(a.pos-r,m))){let e=new Uint16Array(j.size-j.skip),r=a.pos-j.size,i=e.length;for(;a.pos>r;)i=function e(t,r,n){let{id:i,start:o,end:l,size:h}=a;if(a.next(),h>=0&&i<s){let s=n;if(h>4){let i=a.pos-(h-4);for(;a.pos>i;)n=e(t,r,n)}r[--n]=s,r[--n]=l-t,r[--n]=o-t,r[--n]=i}else -3==h?c=i:-4==h&&(u=i);return n}(j.start,e,i);S=new Sl(e,b-j.start,n),C=j.start-t}else{let t=a.pos-x;a.next();let r=[],o=[],l=y>=s?y:-1,c=0,u=b;for(;a.pos>t;)l>=0&&a.id==l&&a.size>=0?(a.end<=u-i&&(h(r,o,v,c,a.end,u,l,w,k),c=r.length,u=a.end),a.next()):g>2500?function(e,t,r,o){let s=[],l=0,c=-1;for(;a.pos>t;){let{id:e,start:t,end:r,size:n}=a;if(n>4)a.next();else if(c>-1&&t<c)break;else c<0&&(c=r-i),s.push(e,t,r),l++,a.next()}if(l){let t=new Uint16Array(4*l),i=s[s.length-2];for(let e=s.length-3,r=0;e>=0;e-=3)t[r++]=s[e],t[r++]=s[e+1]-i,t[r++]=s[e+2]-i,t[r++]=r;r.push(new Sl(t,s[2]-i,n)),o.push(i-e)}}(v,t,r,o):e(v,t,r,o,l,g+1);if(l>=0&&c>0&&c<r.length&&h(r,o,v,c,v,u,l,w,k),r.reverse(),o.reverse(),l>-1&&c>0){let e=function(e,t){return(r,n,i)=>{let o=0,s=r.length-1,a,l;if(s>=0&&(a=r[s])instanceof Ss){if(!s&&a.type==e&&a.length==i)return a;(l=a.prop(A7.lookAhead))&&(o=n[s]+a.length+l)}return d(e,r,n,i,o,t)}}(A,k);S=SA(A,r,o,0,r.length,0,b-v,e,e)}else S=d(A,r,o,b-v,w-b,k)}f.push(S),p.push(C)}(e.start||0,e.bufferStart||0,f,p,-1,0);let m=null!=(t=e.length)?t:f.length?p[0]+f[0].length:0;return new Ss(l[e.topID],f.reverse(),p.reverse(),m)}(e)}}Ss.empty=new Ss(Sr.none,[],[],0);class Sa{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Sa(this.buffer,this.index)}}class Sl{constructor(e,t,r){this.buffer=e,this.length=t,this.set=r}get type(){return Sr.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],r=this.buffer[e+3],n=this.set.types[t],i=n.name;if(/\W/.test(i)&&!n.isError&&(i=JSON.stringify(i)),r==(e+=4))return i;let o=[];for(;e<r;)o.push(this.childString(e)),e=this.buffer[e+3];return i+"("+o.join(",")+")"}findChild(e,t,r,n,i){let{buffer:o}=this,s=-1;for(let a=e;a!=t&&(!Sc(i,n,o[a+1],o[a+2])||(s=a,!(r>0)));a=o[a+3]);return s}slice(e,t,r){let n=this.buffer,i=new Uint16Array(t-e),o=0;for(let s=e,a=0;s<t;){i[a++]=n[s++],i[a++]=n[s++]-r;let t=i[a++]=n[s++]-r;i[a++]=n[s++]-e,o=Math.max(o,t)}return new Sl(i,o,this.set)}}function Sc(e,t,r,n){switch(e){case -2:return r<t;case -1:return n>=t&&r<t;case 0:return r<t&&n>t;case 1:return r<=t&&n>t;case 2:return n>t;case 4:return!0}}function Su(e,t,r,n){for(var i;e.from==e.to||(r<1?e.from>=t:e.from>t)||(r>-1?e.to<=t:e.to<t);){let t=!n&&e instanceof Sd&&e.index<0?null:e.parent;if(!t)return e;e=t}let o=n?0:m.IgnoreOverlays;if(n)for(let n=e,s=n.parent;s;s=(n=s).parent)n instanceof Sd&&n.index<0&&(null==(i=s.enter(t,r,o))?void 0:i.from)!=n.from&&(e=s);for(;;){let n=e.enter(t,r,o);if(!n)return e;e=n}}class Sh{cursor(e=0){return new Sb(this,e)}getChild(e,t=null,r=null){let n=Sf(this,e,t,r);return n.length?n[0]:null}getChildren(e,t=null,r=null){return Sf(this,e,t,r)}resolve(e,t=0){return Su(this,e,t,!1)}resolveInner(e,t=0){return Su(this,e,t,!0)}matchContext(e){return Sp(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),r=this;for(;t;){let e=t.lastChild;if(!e||e.to!=t.to)break;e.type.isError&&e.from==e.to?(r=t,t=e.prevSibling):t=e}return r}get node(){return this}get next(){return this.parent}}class Sd extends Sh{constructor(e,t,r,n){super(),this._tree=e,this.from=t,this.index=r,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,r,n,i=0){for(let o=this;;){for(let{children:s,positions:a}=o._tree,l=t>0?s.length:-1;e!=l;e+=t){let l=s[e],c=a[e]+o.from,u;if(i&m.EnterBracketed&&l instanceof Ss&&(u=Se.get(l))&&!u.overlay&&u.bracketed&&r>=c&&r<=c+l.length||Sc(n,r,c,c+l.length)){if(l instanceof Sl){if(i&m.ExcludeBuffers)continue;let s=l.findChild(0,l.buffer.length,t,r-c,n);if(s>-1)return new Sg(new Sm(o,l,e,c),null,s)}else if(i&m.IncludeAnonymous||!l.type.isAnonymous||Sx(l)){let s;if(!(i&m.IgnoreMounts)&&(s=Se.get(l))&&!s.overlay)return new Sd(s.tree,c,e,o);let a=new Sd(l,c,e,o);return i&m.IncludeAnonymous||!a.type.isAnonymous?a:a.nextChild(t<0?l.children.length-1:0,t,r,n,i)}}}if(i&m.IncludeAnonymous||!o.type.isAnonymous||(e=o.index>=0?o.index+t:t<0?-1:o._parent._tree.children.length,!(o=o._parent)))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}prop(e){return this._tree.prop(e)}enter(e,t,r=0){let n;if(!(r&m.IgnoreOverlays)&&(n=Se.get(this._tree))&&n.overlay){let i=e-this.from,o=r&m.EnterBracketed&&n.bracketed;for(let{from:e,to:r}of n.overlay)if((t>0||o?e<=i:e<i)&&(t<0||o?r>=i:r>i))return new Sd(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Sf(e,t,r,n){let i=e.cursor(),o=[];if(!i.firstChild())return o;if(null!=r){for(let e=!1;!e;)if(e=i.type.is(r),!i.nextSibling())return o}for(;;){if(null!=n&&i.type.is(n))return o;if(i.type.is(t)&&o.push(i.node),!i.nextSibling())return null==n?o:[]}}function Sp(e,t,r=t.length-1){for(let n=e;r>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(t[r]&&t[r]!=n.name)return!1;r--}}return!0}class Sm{constructor(e,t,r,n){this.parent=e,this.buffer=t,this.index=r,this.start=n}}class Sg extends Sh{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,r){super(),this.context=e,this._parent=t,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}child(e,t,r){let{buffer:n}=this.context,i=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.context.start,r);return i<0?null:new Sg(this.context,this,i)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}prop(e){return this.type.prop(e)}enter(e,t,r=0){if(r&m.ExcludeBuffers)return null;let{buffer:n}=this.context,i=n.findChild(this.index+4,n.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return i<0?null:new Sg(this.context,this,i)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Sg(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Sg(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:r}=this.context,n=this.index+4,i=r.buffer[this.index+3];if(i>n){let o=r.buffer[this.index+1];e.push(r.slice(n,i,o)),t.push(0)}return new Ss(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Sy(e){if(!e.length)return null;let t=0,r=e[0];for(let n=1;n<e.length;n++){let i=e[n];(i.from>r.from||i.to<r.to)&&(r=i,t=n)}let n=r instanceof Sd&&r.index<0?null:r.parent,i=e.slice();return n?i[t]=n:i.splice(t,1),new Sv(i,r)}class Sv{constructor(e,t){this.heads=e,this.node=t}get next(){return Sy(this.heads)}}class Sb{get name(){return this.type.name}constructor(e,t=0){if(this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,this.mode=t&~m.EnterBracketed,e instanceof Sd)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let t=e._parent;t;t=t._parent)this.stack.unshift(t.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return!!e&&(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0)}yieldBuf(e,t){this.index=e;let{start:r,buffer:n}=this.buffer;return this.type=t||n.set.types[n.buffer[e]],this.from=r+n.buffer[e+1],this.to=r+n.buffer[e+2],!0}yield(e){return!!e&&(e instanceof Sd?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,r){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,r,this.mode));let{buffer:n}=this.buffer,i=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.buffer.start,r);return!(i<0)&&(this.stack.push(this.index),this.yieldBuf(i))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,r=this.mode){return this.buffer?!(r&m.ExcludeBuffers)&&this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&m.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&m.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode));let{buffer:t}=this.buffer,r=this.stack.length-1;if(e<0){let e=r<0?0:this.stack[r]+4;if(this.index!=e)return this.yieldBuf(t.findChild(e,this.index,-1,0,4))}else{let e=t.buffer[this.index+3];if(e<(r<0?t.buffer.length:t.buffer[this.stack[r]+3]))return this.yieldBuf(e)}return r<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,r,{buffer:n}=this;if(n){if(e>0){if(this.index<n.buffer.buffer.length)return!1}else for(let e=0;e<this.index;e++)if(n.buffer.buffer[e+3]<this.index)return!1;({index:t,parent:r}=n)}else({index:t,_parent:r}=this._tree);for(;r;{index:t,_parent:r}=r)if(t>-1)for(let n=t+e,i=e<0?-1:r._tree.children.length;n!=i;n+=e){let e=r._tree.children[n];if(this.mode&m.IncludeAnonymous||e instanceof Sl||!e.type.isAnonymous||Sx(e))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,r=0;if(e&&e.context==this.buffer)n:for(let n=this.index,i=this.stack.length;i>=0;){for(let o=e;o;o=o._parent)if(o.index==n){if(n==this.index)return o;t=o,r=i+1;break n}n=this.stack[--i]}for(let e=r;e<this.stack.length;e++)t=new Sg(this.buffer,t,this.stack[e]);return this.bufferNode=new Sg(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let r=0;;){let n=!1;if(this.type.isAnonymous||!1!==e(this)){if(this.firstChild()){r++;continue}this.type.isAnonymous||(n=!0)}for(;;){if(n&&t&&t(this),n=this.type.isAnonymous,!r)return;if(this.nextSibling())break;this.parent(),r--,n=!0}}}matchContext(e){if(!this.buffer)return Sp(this.node.parent,e);let{buffer:t}=this.buffer,{types:r}=t.set;for(let n=e.length-1,i=this.stack.length-1;n>=0;i--){if(i<0)return Sp(this._tree,e,n);let o=r[t.buffer[this.stack[i]]];if(!o.isAnonymous){if(e[n]&&e[n]!=o.name)return!1;n--}}return!0}}function Sx(e){return e.children.some(e=>e instanceof Sl||!e.type.isAnonymous||Sx(e))}let Sw=new WeakMap;function Sk(e,t){if(!e.isAnonymous||t instanceof Sl||t.type!=e)return 1;let r=Sw.get(t);if(null==r){for(let n of(r=1,t.children)){if(n.type!=e||!(n instanceof Ss)){r=1;break}r+=Sk(e,n)}Sw.set(t,r)}return r}function SA(e,t,r,n,i,o,s,a,l){let c=0;for(let r=n;r<i;r++)c+=Sk(e,t[r]);let u=Math.ceil(1.5*c/8),h=[],d=[];return!function t(r,n,i,s,a){for(let c=i;c<s;){let i=c,f=n[c],p=Sk(e,r[c]);for(c++;c<s;c++){let t=Sk(e,r[c]);if(p+t>=u)break;p+=t}if(c==i+1){if(p>u){let e=r[i];t(e.children,e.positions,0,e.children.length,n[i]+a);continue}h.push(r[i])}else{let t=n[c-1]+r[c-1].length-f;h.push(SA(e,r,n,i,c,f,t,null,l))}d.push(f+a-o)}}(t,r,n,i,0),(a||l)(h,d,s)}class SS{constructor(e,t,r,n,i=!1,o=!1){this.from=e,this.to=t,this.tree=r,this.offset=n,this.open=!!i|2*!!o}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(e,t=[],r=!1){let n=[new SS(0,e.length,e,0,!1,r)];for(let r of t)r.to>e.length&&n.push(r);return n}static applyChanges(e,t,r=128){if(!t.length)return e;let n=[],i=1,o=e.length?e[0]:null;for(let s=0,a=0,l=0;;s++){let c=s<t.length?t[s]:null,u=c?c.fromA:1e9;if(u-a>=r)for(;o&&o.from<u;){let t=o;if(a>=t.from||u<=t.to||l){let e=Math.max(t.from,a)-l,r=Math.min(t.to,u)-l;t=e>=r?null:new SS(e,r,t.tree,t.offset+l,s>0,!!c)}if(t&&n.push(t),o.to>u)break;o=i<e.length?e[i++]:null}if(!c)break;a=c.toA,l=c.toA-c.toB}return n}}class Sj{startParse(e,t,r){return"string"==typeof e&&(e=new SC(e)),r=r?r.length?r.map(e=>new A8(e.from,e.to)):[new A8(0,0)]:[new A8(0,e.length)],this.createParse(e,t||[],r)}parse(e,t,r){let n=this.startParse(e,t,r);for(;;){let e=n.advance();if(e)return e}}}class SC{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new A7({perNode:!0});let SE=0;class SO{constructor(e,t,r,n){this.name=e,this.set=t,this.base=r,this.modified=n,this.id=SE++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){if(e instanceof SO&&(t=e),null==t?void 0:t.base)throw Error("Can not derive from a modified tag");let r=new SO("string"==typeof e?e:"?",[],null,[]);if(r.set.push(r),t)for(let e of t.set)r.set.push(e);return r}static defineModifier(e){let t=new SP(e);return e=>e.modified.indexOf(t)>-1?e:SP.get(e.base||e,e.modified.concat(t).sort((e,t)=>e.id-t.id))}}let SM=0;class SP{constructor(e){this.name=e,this.instances=[],this.id=SM++}static get(e,t){if(!t.length)return e;let r=t[0].instances.find(r=>{var n,i;return r.base==e&&(n=t,i=r.modified,n.length==i.length&&n.every((e,t)=>e==i[t]))});if(r)return r;let n=[],i=new SO(e.name,n,e,t);for(let e of t)e.instances.push(i);let o=function(e){let t=[[]];for(let r=0;r<e.length;r++)for(let n=0,i=t.length;n<i;n++)t.push(t[n].concat(e[r]));return t.sort((e,t)=>t.length-e.length)}(t);for(let t of e.set)if(!t.modified.length)for(let e of o)n.push(SP.get(t,e));return i}}let ST=new A7({combine(e,t){let r,n,i;for(;e||t;){if(!e||t&&e.depth>=t.depth?(i=t,t=t.next):(i=e,e=e.next),r&&r.mode==i.mode&&!i.context&&!r.context)continue;let o=new SI(i.tags,i.mode,i.context);r?r.next=o:n=o,r=o}return n}});class SI{constructor(e,t,r,n){this.tags=e,this.mode=t,this.context=r,this.next=n}get opaque(){return 0==this.mode}get inherit(){return 1==this.mode}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}function S$(e,t){let r=Object.create(null);for(let t of e)if(Array.isArray(t.tag))for(let e of t.tag)r[e.id]=t.class;else r[t.tag.id]=t.class;let{scope:n,all:i=null}=t||{};return{style:e=>{let t=i;for(let n of e)for(let e of n.set){let n=r[e.id];if(n){t=t?t+" "+n:n;break}}return t},scope:n}}SI.empty=new SI([],2,null);class SD{constructor(e,t,r){this.at=e,this.highlighters=t,this.span=r,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,r,n,i){let{type:o,from:s,to:a}=e;if(s>=r||a<=t)return;o.isTop&&(i=this.highlighters.filter(e=>!e.scope||e.scope(o)));let l=n,c=function(e){let t=e.type.prop(ST);for(;t&&t.context&&!e.matchContext(t.context);)t=t.next;return t||null}(e)||SI.empty,u=function(e,t){let r=null;for(let n of e){let e=n.style(t);e&&(r=r?r+" "+e:e)}return r}(i,c.tags);if(u&&(l&&(l+=" "),l+=u,1==c.mode&&(n+=(n?" ":"")+u)),this.startSpan(Math.max(t,s),l),c.opaque)return;let h=e.tree&&e.tree.prop(A7.mounted);if(h&&h.overlay){let o=e.node.enter(h.overlay[0].from+s,1),c=this.highlighters.filter(e=>!e.scope||e.scope(h.tree.type)),u=e.firstChild();for(let d=0,f=s;;d++){let p=d<h.overlay.length?h.overlay[d]:null,m=p?p.from+s:a,g=Math.max(t,f),y=Math.min(r,m);if(g<y&&u)for(;e.from<y&&(this.highlightRange(e,g,y,n,i),this.startSpan(Math.min(y,e.to),l),!(e.to>=m)&&e.nextSibling()););if(!p||m>r)break;(f=p.to+s)>t&&(this.highlightRange(o.cursor(),Math.max(t,p.from+s),Math.min(r,f),"",c),this.startSpan(Math.min(r,f),l))}u&&e.parent()}else if(e.firstChild()){h&&(n="");do{if(e.to<=t)continue;if(e.from>=r)break;this.highlightRange(e,t,r,n,i),this.startSpan(Math.min(r,e.to),l)}while(e.nextSibling());e.parent()}}}let SR=SO.define,SN=SR(),S_=SR(),SL=SR(S_),SF=SR(S_),SB=SR(),Sz=SR(SB),SW=SR(SB),SV=SR(),SH=SR(SV),SU=SR(),Sq=SR(),SK=SR(),SG=SR(SK),SJ=SR(),SY={comment:SN,lineComment:SR(SN),blockComment:SR(SN),docComment:SR(SN),name:S_,variableName:SR(S_),typeName:SL,tagName:SR(SL),propertyName:SF,attributeName:SR(SF),className:SR(S_),labelName:SR(S_),namespace:SR(S_),macroName:SR(S_),literal:SB,string:Sz,docString:SR(Sz),character:SR(Sz),attributeValue:SR(Sz),number:SW,integer:SR(SW),float:SR(SW),bool:SR(SB),regexp:SR(SB),escape:SR(SB),color:SR(SB),url:SR(SB),keyword:SU,self:SR(SU),null:SR(SU),atom:SR(SU),unit:SR(SU),modifier:SR(SU),operatorKeyword:SR(SU),controlKeyword:SR(SU),definitionKeyword:SR(SU),moduleKeyword:SR(SU),operator:Sq,derefOperator:SR(Sq),arithmeticOperator:SR(Sq),logicOperator:SR(Sq),bitwiseOperator:SR(Sq),compareOperator:SR(Sq),updateOperator:SR(Sq),definitionOperator:SR(Sq),typeOperator:SR(Sq),controlOperator:SR(Sq),punctuation:SK,separator:SR(SK),bracket:SG,angleBracket:SR(SG),squareBracket:SR(SG),paren:SR(SG),brace:SR(SG),content:SV,heading:SH,heading1:SR(SH),heading2:SR(SH),heading3:SR(SH),heading4:SR(SH),heading5:SR(SH),heading6:SR(SH),contentSeparator:SR(SV),list:SR(SV),quote:SR(SV),emphasis:SR(SV),strong:SR(SV),link:SR(SV),monospace:SR(SV),strikethrough:SR(SV),inserted:SR(),deleted:SR(),changed:SR(),invalid:SR(),meta:SJ,documentMeta:SR(SJ),annotation:SR(SJ),processingInstruction:SR(SJ),definition:SO.defineModifier("definition"),constant:SO.defineModifier("constant"),function:SO.defineModifier("function"),standard:SO.defineModifier("standard"),local:SO.defineModifier("local"),special:SO.defineModifier("special")};for(let e in SY){let t=SY[e];t instanceof SO&&(t.name=e)}S$([{tag:SY.link,class:"tok-link"},{tag:SY.heading,class:"tok-heading"},{tag:SY.emphasis,class:"tok-emphasis"},{tag:SY.strong,class:"tok-strong"},{tag:SY.keyword,class:"tok-keyword"},{tag:SY.atom,class:"tok-atom"},{tag:SY.bool,class:"tok-bool"},{tag:SY.url,class:"tok-url"},{tag:SY.labelName,class:"tok-labelName"},{tag:SY.inserted,class:"tok-inserted"},{tag:SY.deleted,class:"tok-deleted"},{tag:SY.literal,class:"tok-literal"},{tag:SY.string,class:"tok-string"},{tag:SY.number,class:"tok-number"},{tag:[SY.regexp,SY.escape,SY.special(SY.string)],class:"tok-string2"},{tag:SY.variableName,class:"tok-variableName"},{tag:SY.local(SY.variableName),class:"tok-variableName tok-local"},{tag:SY.definition(SY.variableName),class:"tok-variableName tok-definition"},{tag:SY.special(SY.variableName),class:"tok-variableName2"},{tag:SY.definition(SY.propertyName),class:"tok-propertyName tok-definition"},{tag:SY.typeName,class:"tok-typeName"},{tag:SY.namespace,class:"tok-namespace"},{tag:SY.className,class:"tok-className"},{tag:SY.macroName,class:"tok-macroName"},{tag:SY.propertyName,class:"tok-propertyName"},{tag:SY.operator,class:"tok-operator"},{tag:SY.comment,class:"tok-comment"},{tag:SY.meta,class:"tok-meta"},{tag:SY.invalid,class:"tok-invalid"},{tag:SY.punctuation,class:"tok-punctuation"}]);let SX=new A7,SZ=new A7;class SQ{constructor(e,t,r=[],n=""){this.data=e,this.name=n,v0.prototype.hasOwnProperty("tree")||Object.defineProperty(v0.prototype,"tree",{get(){return S1(this)}}),this.parser=t,this.extension=[je.of(this),v0.languageData.of((e,t,r)=>{let n=S0(e,t,r),i=n.type.prop(SX);if(!i)return[];let o=e.facet(i),s=n.type.prop(SZ);if(s){let i=n.resolve(t-n.from,r);for(let t of s)if(t.test(i,e)){let r=e.facet(t.facet);return"replace"==t.type?r:r.concat(o)}}return o})].concat(r)}isActiveAt(e,t,r=-1){return S0(e,t,r).type.prop(SX)==this.data}findRegions(e){let t=e.facet(je);if((null==t?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let r=[],n=(e,t)=>{if(e.prop(SX)==this.data)return void r.push({from:t,to:t+e.length});let i=e.prop(A7.mounted);if(i){if(i.tree.prop(SX)==this.data){if(i.overlay)for(let e of i.overlay)r.push({from:e.from+t,to:e.to+t});else r.push({from:t,to:t+e.length});return}else if(i.overlay){let e=r.length;if(n(i.tree,i.overlay[0].from+t),r.length>e)return}}for(let r=0;r<e.children.length;r++){let i=e.children[r];i instanceof Ss&&n(i,e.positions[r]+t)}};return n(S1(e),0),r}get allowsNesting(){return!0}}function S0(e,t,r){let n=e.facet(je),i=S1(e).topNode;if(!n||n.allowsNesting)for(let e=i;e;e=e.enter(t,r,m.ExcludeBuffers|m.EnterBracketed))e.type.isTop&&(i=e);return i}function S1(e){let t=e.field(SQ.state,!1);return t?t.tree:Ss.empty}SQ.setState=vq.define();class S2{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let r=this.cursorPos-this.string.length;return e<r||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-r,t-r)}}let S4=null;class S3{constructor(e,t,r=[],n,i,o,s,a){this.parser=e,this.state=t,this.fragments=r,this.tree=n,this.treeLen=i,this.viewport=o,this.skipped=s,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(e,t,r){return new S3(e,t,[],Ss.empty,0,r,[],null)}startParse(){return this.parser.startParse(new S2(this.state.doc),this.fragments)}work(e,t){return(null!=t&&t>=this.state.doc.length&&(t=void 0),this.tree!=Ss.empty&&this.isDone(null!=t?t:this.state.doc.length))?(this.takeTree(),!0):this.withContext(()=>{var r;if("number"==typeof e){let t=Date.now()+e;e=()=>Date.now()>t}for(this.parse||(this.parse=this.startParse()),null!=t&&(null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let n=this.parse.advance();if(n){if(this.fragments=this.withoutTempSkipped(SS.addTree(n,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!=(r=this.parse.stoppedAt)?r:this.state.doc.length,this.tree=n,this.parse=null,!(this.treeLen<(null!=t?t:this.state.doc.length)))return!0;this.parse=this.startParse()}if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(SS.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=S4;S4=this;try{return e()}finally{S4=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=S5(e,t.from,t.to);return e}changes(e,t){let{fragments:r,tree:n,treeLen:i,viewport:o,skipped:s}=this;if(this.takeTree(),!e.empty){let t=[];if(e.iterChangedRanges((e,r,n,i)=>t.push({fromA:e,toA:r,fromB:n,toB:i})),r=SS.applyChanges(r,t),n=Ss.empty,i=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length)for(let t of(s=[],this.skipped)){let r=e.mapPos(t.from,1),n=e.mapPos(t.to,-1);r<n&&s.push({from:r,to:n})}}return new S3(this.parser,t,r,n,i,o,s,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let t=0;t<this.skipped.length;t++){let{from:r,to:n}=this.skipped[t];r<e.to&&n>e.from&&(this.fragments=S5(this.fragments,r,n),this.skipped.splice(t--,1))}return!(this.skipped.length>=t)&&(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends Sj{createParse(t,r,n){let i=n[0].from,o=n[n.length-1].to;return{parsedPos:i,advance(){let t=S4;if(t){for(let e of n)t.tempSkipped.push(e);e&&(t.scheduleOn=t.scheduleOn?Promise.all([t.scheduleOn,e]):e)}return this.parsedPos=o,new Ss(Sr.none,[],[],o-i)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&0==t[0].from&&t[0].to>=e}static get(){return S4}}function S5(e,t,r){return SS.applyChanges(e,[{fromA:t,toA:r,fromB:t,toB:r}])}class S6{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),r=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,r)||t.takeTree(),new S6(t)}static init(e){let t=Math.min(3e3,e.doc.length),r=S3.create(e.facet(je).parser,e,{from:0,to:t});return r.work(20,t)||r.takeTree(),new S6(r)}}SQ.state=vE.define({create:S6.init,update(e,t){for(let e of t.effects)if(e.is(SQ.setState))return e.value;return t.startState.facet(je)!=t.state.facet(je)?S6.init(t.state):e.apply(t)}});let S9=e=>{let t=setTimeout(()=>e(),500);return()=>clearTimeout(t)};"u">typeof requestIdleCallback&&(S9=e=>{let t=-1,r=setTimeout(()=>{t=requestIdleCallback(e,{timeout:400})},100);return()=>t<0?clearTimeout(r):cancelIdleCallback(t)});let S8="u">typeof navigator&&(null==(g=navigator.scheduling)?void 0:g.isInputPending)?()=>navigator.scheduling.isInputPending():null,S7=xL.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(SQ.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(SQ.state);t.tree==t.context.tree&&t.context.isDone(e.doc.length)||(this.working=S9(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:n}}=this.view,i=r.field(SQ.state);if(i.tree==i.context.tree&&i.context.isDone(n+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!S8?Math.max(25,e.timeRemaining()-5):1e9),s=i.context.treeLen<n&&r.doc.length>n+1e3,a=i.context.work(()=>S8&&S8()||Date.now()>o,n+1e5*!s);this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(i.context.takeTree(),this.view.dispatch({effects:SQ.setState.of(new S6(i.context))})),this.chunkBudget>0&&!(a&&!s)&&this.scheduleWork(),this.checkAsyncSchedule(i.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(e=>xD(this.view.state,e)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),je=vw.define({combine:e=>e.length?e[0]:null,enables:e=>[SQ.state,S7,k$.contentAttributes.compute([e],t=>{let r=t.facet(e);return r&&r.name?{"data-language":r.name}:{}})]}),jt=vw.define(),jr=vw.define({combine:e=>{if(!e.length)return"  ";let t=e[0];if(!t||/\S/.test(t)||Array.from(t).some(e=>e!=t[0]))throw Error("Invalid indent unit: "+JSON.stringify(e[0]));return t}});function jn(e){let t=e.facet(jr);return 9==t.charCodeAt(0)?e.tabSize*t.length:t.length}function ji(e,t){let r="",n=e.tabSize,i=e.facet(jr)[0];if("	"==i){for(;t>=n;)r+="	",t-=n;i=" "}for(let e=0;e<t;e++)r+=i;return r}function jo(e,t){for(let r of(e instanceof v0&&(e=new js(e)),e.state.facet(jt))){let n=r(e,t);if(void 0!==n)return n}let r=S1(e.state);return r.length>=t?function(e,t,r){let n=t.resolveStack(r),i=t.resolveInner(r,-1).resolve(r,0).enterUnfinishedNodesBefore(r);if(i!=n.node){let e=[];for(let t=i;t&&!(t.from<n.node.from||t.to>n.node.to||t.from==n.node.from&&t.type==n.node.type);t=t.parent)e.push(t);for(let t=e.length-1;t>=0;t--)n={node:e[t],next:n}}return jl(n,e,r)}(e,r,t):null}class js{constructor(e,t={}){this.state=e,this.options=t,this.unit=jn(e)}lineAt(e,t=1){let r=this.state.doc.lineAt(e),{simulateBreak:n,simulateDoubleBreak:i}=this.options;if(null!=n&&n>=r.from&&n<=r.to)if(i&&n==e)return{text:"",from:e};else if(t<0?n<e:n<=e)return{text:r.text.slice(n-r.from),from:n};else return{text:r.text.slice(0,n-r.from),from:r.from};return r}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:r,from:n}=this.lineAt(e,t);return r.slice(e-n,Math.min(r.length,e+100-n))}column(e,t=1){let{text:r,from:n}=this.lineAt(e,t),i=this.countColumn(r,e-n),o=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return o>-1&&(i+=o-this.countColumn(r,r.search(/\S|$/))),i}countColumn(e,t=e.length){return bc(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:r,from:n}=this.lineAt(e,t),i=this.options.overrideIndentation;if(i){let e=i(n);if(e>-1)return e}return this.countColumn(r,r.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}let ja=new A7;function jl(e,t,r){for(let n=e;n;n=n.next){let e=function(e){let t=e.type.prop(ja);if(t)return t;let r=e.firstChild,n;if(r&&(n=r.type.prop(A7.closedBy))){let t=e.lastChild,r=t&&n.indexOf(t.name)>-1;return e=>(function(e,t,r,n,i){let o=e.textAfter,s=o.match(/^\s*/)[0].length,a=n&&o.slice(s,s+n.length)==n||i==e.pos+s,l=t?function(e){let t=e.node,r=t.childAfter(t.from),n=t.lastChild;if(!r)return null;let i=e.options.simulateBreak,o=e.state.doc.lineAt(r.from),s=null==i||i<=o.from?o.to:Math.min(o.to,i);for(let e=r.to;;){let i=t.childAfter(e);if(!i||i==n)return null;if(!i.type.isSkipped){if(i.from>=s)return null;let e=/^ */.exec(o.text.slice(r.to-o.from))[0].length;return{from:r.from,to:r.to+e}}e=i.to}}(e):null;return l?a?e.column(l.from):e.column(l.to):e.baseIndent+(a?0:+e.unit)})(e,!0,1,void 0,r&&!(e.pos==e.options.simulateBreak&&e.options.simulateDoubleBreak)?t.from:void 0)}return null==e.parent?jc:null}(n.node);if(e)return e(ju.create(t,r,n))}return 0}function jc(){return 0}class ju extends js{constructor(e,t,r){super(e.state,e.options),this.base=e,this.pos=t,this.context=r}get node(){return this.context.node}static create(e,t,r){return new ju(e,t,r)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let r=e.resolve(t.from);for(;r.parent&&r.parent.from==r.from;)r=r.parent;if(function(e,t){for(let r=t;r;r=r.parent)if(e==r)return!0;return!1}(r,e))break;t=this.state.doc.lineAt(r.from)}return this.lineIndent(t.from)}continue(){return jl(this.context.next,this.base,this.pos)}}let jh=vw.define(),jd=new A7;function jf(e,t,r){for(let n of e.facet(jh)){let i=n(e,t,r);if(i)return i}return function(e,t,r){let n=S1(e);if(n.length<r)return null;let i=n.resolveStack(r,1),o=null;for(let s=i;s;s=s.next){let i=s.node;if(i.to<=r||i.from>r)continue;if(o&&i.from<t)break;let a=i.type.prop(jd);if(a&&(i.to<n.length-50||n.length==e.doc.length||!function(e){let t=e.lastChild;return t&&t.to==e.to&&t.type.isError}(i))){let n=a(i,e);n&&n.from<=r&&n.from>=t&&n.to>r&&(o=n)}}return o}(e,t,r)}function jp(e,t){let r=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);return r>=n?void 0:{from:r,to:n}}let jm=vq.define({map:jp}),jg=vq.define({map:jp});function jy(e){let t=[];for(let{head:r}of e.state.selection.ranges)t.some(e=>e.from<=r&&e.to>=r)||t.push(e.lineBlockAt(r));return t}let jv=vE.define({create:()=>bW.none,update(e,t){for(let r of(t.isUserEvent("delete")&&t.changes.iterChangedRanges((t,r)=>e=jb(e,t,r)),e=e.map(t.changes),t.effects))if(r.is(jm)&&!function(e,t,r){let n=!1;return e.between(t,t,(e,i)=>{e==t&&i==r&&(n=!0)}),n}(e,r.value.from,r.value.to)){let{preparePlaceholder:n}=t.state.facet(jj),i=n?bW.replace({widget:new jM(n(t.state,r.value))}):jO;e=e.update({add:[i.range(r.value.from,r.value.to)]})}else r.is(jg)&&(e=e.update({filter:(e,t)=>r.value.from!=e||r.value.to!=t,filterFrom:r.value.from,filterTo:r.value.to}));return t.selection&&(e=jb(e,t.selection.main.head)),e},provide:e=>k$.decorations.from(e),toJSON(e,t){let r=[];return e.between(0,t.doc.length,(e,t)=>{r.push(e,t)}),r},fromJSON(e){if(!Array.isArray(e)||e.length%2)throw RangeError("Invalid JSON for fold state");let t=[];for(let r=0;r<e.length;){let n=e[r++],i=e[r++];if("number"!=typeof n||"number"!=typeof i)throw RangeError("Invalid JSON for fold state");t.push(jO.range(n,i))}return bW.set(t,!0)}});function jb(e,t,r=t){let n=!1;return e.between(t,r,(e,i)=>{e<r&&i>t&&(n=!0)}),n?e.update({filterFrom:t,filterTo:r,filter:(e,n)=>e>=r||n<=t}):e}function jx(e,t,r){var n;let i=null;return null==(n=e.field(jv,!1))||n.between(t,r,(e,t)=>{(!i||i.from>e)&&(i={from:e,to:t})}),i}function jw(e,t){return e.field(jv,!1)?t:t.concat(vq.appendConfig.of(jC()))}function jk(e,t,r=!0){let n=e.state.doc.lineAt(t.from).number,i=e.state.doc.lineAt(t.to).number;return k$.announce.of(`${e.state.phrase(r?"Folded lines":"Unfolded lines")} ${n} ${e.state.phrase("to")} ${i}.`)}let jA=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:e=>{for(let t of jy(e)){let r=jf(e.state,t.from,t.to);if(r)return e.dispatch({effects:jw(e.state,[jm.of(r),jk(e,r)])}),!0}return!1}},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:e=>{if(!e.state.field(jv,!1))return!1;let t=[];for(let r of jy(e)){let n=jx(e.state,r.from,r.to);n&&t.push(jg.of(n),jk(e,n,!1))}return t.length&&e.dispatch({effects:t}),t.length>0}},{key:"Ctrl-Alt-[",run:e=>{let{state:t}=e,r=[];for(let n=0;n<t.doc.length;){let i=e.lineBlockAt(n),o=jf(t,i.from,i.to);o&&r.push(jm.of(o)),n=(o?e.lineBlockAt(o.to):i).to+1}return r.length&&e.dispatch({effects:jw(e.state,r)}),!!r.length}},{key:"Ctrl-Alt-]",run:e=>{let t=e.state.field(jv,!1);if(!t||!t.size)return!1;let r=[];return t.between(0,e.state.doc.length,(e,t)=>{r.push(jg.of({from:e,to:t}))}),e.dispatch({effects:r}),!0}}],jS={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},jj=vw.define({combine:e=>v1(e,jS)});function jC(e){let t=[jv,jI];return e&&t.push(jj.of(e)),t}function jE(e,t){let{state:r}=e,n=r.facet(jj),i=t=>{let r=e.lineBlockAt(e.posAtDOM(t.target)),n=jx(e.state,r.from,r.to);n&&e.dispatch({effects:jg.of(n)}),t.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(e,i,t);let o=document.createElement("span");return o.textContent=n.placeholderText,o.setAttribute("aria-label",r.phrase("folded code")),o.title=r.phrase("unfold"),o.className="cm-foldPlaceholder",o.onclick=i,o}let jO=bW.replace({widget:new class extends bB{toDOM(e){return jE(e,null)}}});class jM extends bB{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return jE(e,this.value)}}let jP={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class jT extends AF{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}let jI=k$.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class j${constructor(e,t){let r;function n(e){let t=bp.newName();return(r||(r=Object.create(null)))["."+t]=e,t}this.specs=e;const i="string"==typeof t.all?t.all:t.all?n(t.all):void 0,o=t.scope;this.scope=o instanceof SQ?e=>e.prop(SX)==o.data:o?e=>e==o:void 0,this.style=S$(e.map(e=>({tag:e.tag,class:e.class||n(Object.assign({},e,{tag:null}))})),{all:i}).style,this.module=r?new bp(r):null,this.themeType=t.themeType}static define(e,t){return new j$(e,t||{})}}let jD=vw.define(),jR=vw.define({combine:e=>e.length?[e[0]]:null});function jN(e){let t=e.facet(jD);return t.length?t:e.facet(jR)}function j_(e,t){let r=[jL],n;return e instanceof j$&&(e.module&&r.push(k$.styleModule.of(e.module)),n=e.themeType),(null==t?void 0:t.fallback)?r.push(jR.of(e)):n?r.push(jD.computeN([k$.darkTheme],t=>t.facet(k$.darkTheme)==("dark"==n)?[e]:[])):r.push(jD.of(e)),r}let jL=vM.high(xL.fromClass(class{constructor(e){this.markCache=Object.create(null),this.tree=S1(e.state),this.decorations=this.buildDeco(e,jN(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=S1(e.state),r=jN(e.state),n=r!=jN(e.startState),{viewport:i}=e.view,o=e.changes.mapPos(this.decoratedTo,1);t.length<i.to&&!n&&t.type==this.tree.type&&o>=i.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(t!=this.tree||e.viewportChanged||n)&&(this.tree=t,this.decorations=this.buildDeco(e.view,r),this.decoratedTo=i.to)}buildDeco(e,t){if(!t||!this.tree.length)return bW.none;let r=new v8;for(let{from:n,to:i}of e.visibleRanges)!function(e,t,r,n=0,i=e.length){let o=new SD(n,Array.isArray(t)?t:[t],r);o.highlightRange(e.cursor(),n,i,"",o.highlighters),o.flush(i)}(this.tree,t,(e,t,n)=>{r.add(e,t,this.markCache[n]||(this.markCache[n]=bW.mark({class:n})))},n,i);return r.finish()}},{decorations:e=>e.decorations})),jF=j$.define([{tag:SY.meta,color:"#404740"},{tag:SY.link,textDecoration:"underline"},{tag:SY.heading,textDecoration:"underline",fontWeight:"bold"},{tag:SY.emphasis,fontStyle:"italic"},{tag:SY.strong,fontWeight:"bold"},{tag:SY.strikethrough,textDecoration:"line-through"},{tag:SY.keyword,color:"#708"},{tag:[SY.atom,SY.bool,SY.url,SY.contentSeparator,SY.labelName],color:"#219"},{tag:[SY.literal,SY.inserted],color:"#164"},{tag:[SY.string,SY.deleted],color:"#a11"},{tag:[SY.regexp,SY.escape,SY.special(SY.string)],color:"#e40"},{tag:SY.definition(SY.variableName),color:"#00f"},{tag:SY.local(SY.variableName),color:"#30a"},{tag:[SY.typeName,SY.namespace],color:"#085"},{tag:SY.className,color:"#167"},{tag:[SY.special(SY.variableName),SY.macroName],color:"#256"},{tag:SY.definition(SY.propertyName),color:"#00c"},{tag:SY.comment,color:"#940"},{tag:SY.invalid,color:"#f00"}]),jB=k$.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),jz="()[]{}",jW=vw.define({combine:e=>v1(e,{afterCursor:!0,brackets:jz,maxScanDistance:1e4,renderMatch:jU})}),jV=bW.mark({class:"cm-matchingBracket"}),jH=bW.mark({class:"cm-nonmatchingBracket"});function jU(e){let t=[],r=e.matched?jV:jH;return t.push(r.range(e.start.from,e.start.to)),e.end&&t.push(r.range(e.end.from,e.end.to)),t}let jq=[vE.define({create:()=>bW.none,update(e,t){if(!t.docChanged&&!t.selection)return e;let r=[],n=t.state.facet(jW);for(let e of t.state.selection.ranges){if(!e.empty)continue;let i=jY(t.state,e.head,-1,n)||e.head>0&&jY(t.state,e.head-1,1,n)||n.afterCursor&&(jY(t.state,e.head,1,n)||e.head<t.state.doc.length&&jY(t.state,e.head+1,-1,n));i&&(r=r.concat(n.renderMatch(i,t.state)))}return bW.set(r,!0)},provide:e=>k$.decorations.from(e)}),jB],jK=new A7;function jG(e,t,r){let n=e.prop(t<0?A7.openedBy:A7.closedBy);if(n)return n;if(1==e.name.length){let n=r.indexOf(e.name);if(n>-1&&n%2==+(t<0))return[r[n+t]]}return null}function jJ(e){let t=e.type.prop(jK);return t?t(e.node):e}function jY(e,t,r,n={}){let i=n.maxScanDistance||1e4,o=n.brackets||jz,s=S1(e),a=s.resolveInner(t,r);for(let e=a;e;e=e.parent){let n=jG(e.type,r,o);if(n&&e.from<e.to){let i=jJ(e);if(i&&(r>0?t>=i.from&&t<i.to:t>i.from&&t<=i.to))return function(e,t,r,n,i,o,s){let a=n.parent,l={from:i.from,to:i.to},c=0,u=null==a?void 0:a.cursor();if(u&&(r<0?u.childBefore(n.from):u.childAfter(n.to)))do if(r<0?u.to<=n.from:u.from>=n.to){if(0==c&&o.indexOf(u.type.name)>-1&&u.from<u.to){let e=jJ(u);return{start:l,end:e?{from:e.from,to:e.to}:void 0,matched:!0}}else if(jG(u.type,r,s))c++;else if(jG(u.type,-r,s)){if(0==c){let e=jJ(u);return{start:l,end:e&&e.from<e.to?{from:e.from,to:e.to}:void 0,matched:!1}}c--}}while(r<0?u.prevSibling():u.nextSibling());return{start:l,matched:!1}}(0,0,r,e,i,n,o)}}return function(e,t,r,n,i,o,s){let a=r<0?e.sliceDoc(t-1,t):e.sliceDoc(t,t+1),l=s.indexOf(a);if(l<0||l%2==0!=r>0)return null;let c={from:r<0?t-1:t,to:r>0?t+1:t},u=e.doc.iterRange(t,r>0?e.doc.length:0),h=0;for(let e=0;!u.next().done&&e<=o;){let o=u.value;r<0&&(e+=o.length);let a=t+e*r;for(let e=r>0?0:o.length-1,t=r>0?o.length:-1;e!=t;e+=r){let t=s.indexOf(o[e]);if(!(t<0)&&n.resolveInner(a+e,1).type==i)if(t%2==0==r>0)h++;else{if(1==h)return{start:c,end:{from:a+e,to:a+e+1},matched:t>>1==l>>1};h--}}r>0&&(e+=o.length)}return u.done?{start:c,matched:!1}:null}(e,t,r,s,a.type,i,o)}function jX(e,t,r,n=0,i=0){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);let o=i;for(let i=n;i<t;i++)9==e.charCodeAt(i)?o+=r-o%r:o++;return o}class jZ{constructor(e,t,r,n){this.string=e,this.tabSize=t,this.indentUnit=r,this.overrideIndent=n,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return 0==this.pos}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t=this.string.charAt(this.pos);if("string"==typeof e?t==e:t&&(e instanceof RegExp?e.test(t):e(t)))return++this.pos,t}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=jX(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return null!=(e=this.overrideIndent)?e:jX(this.string,null,this.tabSize)}match(e,t,r){if("string"==typeof e){let n=e=>r?e.toLowerCase():e;return n(this.string.substr(this.pos,e.length))==n(e)?(!1!==t&&(this.pos+=e.length),!0):null}{let r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&!1!==t&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}}function jQ(e){if("object"!=typeof e)return e;let t={};for(let r in e){let n=e[r];t[r]=n instanceof Array?n.slice():n}return t}let j0=new WeakMap;class j1 extends SQ{constructor(e){let t=function(e){return vw.define({combine:e?t=>t.concat(e):void 0})}(e.languageData),r=function(e){return{name:e.name||"",token:e.token,blankLine:e.blankLine||(()=>{}),startState:e.startState||(()=>!0),copyState:e.copyState||jQ,indent:e.indent||(()=>null),languageData:e.languageData||{},tokenTable:e.tokenTable||j5,mergeTokens:!1!==e.mergeTokens}}(e),n;super(t,new class extends Sj{createParse(e,t,r){return new j4(n,e,t,r)}},[],e.name),this.topNode=function(e,t){let r=Sr.define({id:j6.length,name:"Document",props:[SX.add(()=>e),ja.add(()=>e=>t.getIndent(e))],top:!0});return j6.push(r),r}(t,this),n=this,this.streamParser=r,this.stateAfter=new A7({perNode:!0}),this.tokenTable=e.tokenTable?new Ct(r.tokenTable):Cr}static define(e){return new j1(e)}getIndent(e){let t,{overrideIndentation:r}=e.options;r&&null!=(t=j0.get(e.state))&&t<e.pos-1e4&&(t=void 0);let n=j2(this,e.node.tree,e.node.from,e.node.from,null!=t?t:e.pos),i,o;if(n?(o=n.state,i=n.pos+1):(o=this.streamParser.startState(e.unit),i=e.node.from),e.pos-i>1e4)return null;for(;i<e.pos;){let t=e.state.doc.lineAt(i),n=Math.min(e.pos,t.to);if(t.length){let i=r?r(t.from):-1,s=new jZ(t.text,e.state.tabSize,e.unit,i<0?void 0:i);for(;s.pos<n-t.from;)j3(this.streamParser.token,s,o)}else this.streamParser.blankLine(o,e.unit);if(n==e.pos)break;i=t.to+1}let s=e.lineAt(e.pos);return r&&null==t&&j0.set(e.state,s.from),this.streamParser.indent(o,/^\s*(.*)/.exec(s.text)[1],e)}get allowsNesting(){return!1}}function j2(e,t,r,n,i){let o=r>=n&&r+t.length<=i&&t.prop(e.stateAfter);if(o)return{state:e.streamParser.copyState(o),pos:r+t.length};for(let o=t.children.length-1;o>=0;o--){let s=t.children[o],a=r+t.positions[o],l=s instanceof Ss&&a<i&&j2(e,s,a,n,i);if(l)return l}return null}class j4{constructor(e,t,r,n){this.lang=e,this.input=t,this.fragments=r,this.ranges=n,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=n[n.length-1].to;let i=S3.get(),o=n[0].from,{state:s,tree:a}=function(e,t,r,n,i){for(let i of t){let t=i.from+25*!!i.openStart,o=i.to-25*!!i.openEnd,s=t<=r&&o>r&&j2(e,i.tree,0-i.offset,r,o),a;if(s&&s.pos<=n&&(a=function e(t,r,n,i,o){if(o&&n<=0&&i>=r.length)return r;o||0!=n||r.type!=t.topNode||(o=!0);for(let s=r.children.length-1;s>=0;s--){let a=r.positions[s],l=r.children[s],c;if(a<i&&l instanceof Ss){if(!(c=e(t,l,n-a,i-a,o)))break;return o?new Ss(r.type,r.children.slice(0,s).concat(c),r.positions.slice(0,s+1),a+c.length):c}}return null}(e,i.tree,r+i.offset,s.pos+i.offset,!1)))return{state:s.state,tree:a}}return{state:e.streamParser.startState(i?jn(i):4),tree:Ss.empty}}(e,r,o,this.to,null==i?void 0:i.state);this.state=s,this.parsedPos=this.chunkStart=o+a.length;for(let e=0;e<a.children.length;e++)this.chunks.push(a.children[e]),this.chunkPos.push(a.positions[e]);i&&this.parsedPos<i.viewport.from-1e5&&n.some(e=>e.from<=i.viewport.from&&e.to>=i.viewport.from)&&(this.state=this.lang.streamParser.startState(jn(i.state)),i.skipUntilInView(this.parsedPos,i.viewport.from),this.parsedPos=i.viewport.from),this.moveRangeIndex()}advance(){let e=S3.get(),t=null==this.stoppedAt?this.to:Math.min(this.to,this.stoppedAt),r=Math.min(t,this.chunkStart+512);for(e&&(r=Math.min(r,e.viewport.to));this.parsedPos<r;)this.parseLine(e);return(this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=t)?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,t),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let t=this.input.chunk(e);if(this.input.lineChunks)"\n"==t&&(t="");else{let e=t.indexOf("\n");e>-1&&(t=t.slice(0,e))}return e+t.length<=this.to?t:t.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,t=this.lineAfter(e),r=e+t.length;for(let e=this.rangeIndex;;){let n=this.ranges[e].to;if(n>=r||(t=t.slice(0,n-(r-t.length)),++e==this.ranges.length))break;let i=this.ranges[e].from,o=this.lineAfter(i);t+=o,r=i+o.length}return{line:t,end:r}}skipGapsTo(e,t,r){for(;;){let n=this.ranges[this.rangeIndex].to,i=e+t;if(r>0?n>i:n>=i)break;let o=this.ranges[++this.rangeIndex].from;t+=o-n}return t}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,t,r,n){let i=4;if(this.ranges.length>1){n=this.skipGapsTo(t,n,1),t+=n;let e=this.chunk.length;n=this.skipGapsTo(r,n,-1),r+=n,i+=this.chunk.length-e}let o=this.chunk.length-4;return this.lang.streamParser.mergeTokens&&4==i&&o>=0&&this.chunk[o]==e&&this.chunk[o+2]==t?this.chunk[o+2]=r:this.chunk.push(e,t,r,i),n}parseLine(e){let{line:t,end:r}=this.nextLine(),n=0,{streamParser:i}=this.lang,o=new jZ(t,e?e.state.tabSize:4,e?jn(e.state):2);if(o.eol())i.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let e=j3(i.token,o,this.state);if(e&&(n=this.emitToken(this.lang.tokenTable.resolve(e),this.parsedPos+o.start,this.parsedPos+o.pos,n)),o.start>1e4)break}this.parsedPos=r,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=Ss.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:j9,topID:0,maxBufferLength:512,reused:this.chunkReused});e=new Ss(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new Ss(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function j3(e,t,r){t.start=t.pos;for(let n=0;n<10;n++){let n=e(t,r);if(t.pos>t.start)return n}throw Error("Stream parser failed to advance stream.")}let j5=Object.create(null),j6=[Sr.none],j9=new Sn(j6),j8=[],j7=Object.create(null),Ce=Object.create(null);for(let[e,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Ce[e]=Ci(j5,t);class Ct{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),Ce)}resolve(e){return e?this.table[e]||(this.table[e]=Ci(this.extra,e)):0}}let Cr=new Ct(j5);function Cn(e,t){j8.indexOf(e)>-1||(j8.push(e),console.warn(t))}function Ci(e,t){let r=[];for(let n of t.split(" ")){let t=[];for(let r of n.split(".")){let n=e[r]||SY[r];n?"function"==typeof n?t.length?t=t.map(n):Cn(r,`Modifier ${r} used at start of tag`):t.length?Cn(r,`Tag ${r} used as modifier`):t=Array.isArray(n)?n:[n]:Cn(r,`Unknown highlighting tag ${r}`)}for(let e of t)r.push(e)}if(!r.length)return 0;let n=t.replace(/ /g,"_"),i=n+" "+r.map(e=>e.id),o=j7[i];if(o)return o.id;let s=j7[i]=Sr.define({id:j6.length,name:n,props:[function(e){let t=Object.create(null);for(let r in e){let n=e[r];for(let e of(Array.isArray(n)||(n=[n]),r.split(" ")))if(e){let r=[],i=2,o=e;for(let t=0;;){if("..."==o&&t>0&&t+3==e.length){i=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(o);if(!n)throw RangeError("Invalid path: "+e);if(r.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),(t+=n[0].length)==e.length)break;let s=e[t++];if(t==e.length&&"!"==s){i=0;break}if("/"!=s)throw RangeError("Invalid path: "+e);o=e.slice(t)}let s=r.length-1,a=r[s];if(!a)throw RangeError("Invalid path: "+e);let l=new SI(n,i,s>0?r.slice(0,s):null);t[a]=l.sort(t[a])}}return ST.add(t)}({[n]:r})]});return j6.push(s),s.id}function Co(e,t){return({state:r,dispatch:n})=>{if(r.readOnly)return!1;let i=e(t,r);return!!i&&(n(r.update(i)),!0)}}xo.RTL,xo.LTR;let Cs=Co(function(e,t,r=t.selection.ranges){let n=[],i=-1;for(let{from:e,to:o}of r){let r=n.length,s=1e9,a=Cc(t,e).line;if(a){for(let r=e;r<=o;){let l=t.doc.lineAt(r);if(l.from>i&&(e==o||o>l.from)){i=l.from;let e=/^\s*/.exec(l.text)[0].length,t=e==l.length,r=l.text.slice(e,e+a.length)==a?e:-1;e<l.text.length&&e<s&&(s=e),n.push({line:l,comment:r,token:a,indent:e,empty:t,single:!1})}r=l.to+1}if(s<1e9)for(let e=r;e<n.length;e++)n[e].indent<n[e].line.text.length&&(n[e].indent=s);n.length==r+1&&(n[r].single=!0)}}if(2!=e&&n.some(e=>e.comment<0&&(!e.empty||e.single))){let e=[];for(let{line:t,token:r,indent:i,empty:o,single:s}of n)(s||!o)&&e.push({from:t.from+i,insert:r+" "});let r=t.changes(e);return{changes:r,selection:t.selection.map(r,1)}}if(1!=e&&n.some(e=>e.comment>=0)){let e=[];for(let{line:t,comment:r,token:i}of n)if(r>=0){let n=t.from+r,o=n+i.length;" "==t.text[o-t.from]&&o++,e.push({from:n,to:o})}return{changes:e}}return null},0),Ca=Co(Cu,0),Cl=Co((e,t)=>Cu(e,t,function(e){let t=[];for(let r of e.selection.ranges){let n=e.doc.lineAt(r.from),i=r.to<=n.to?n:e.doc.lineAt(r.to);i.from>n.from&&i.from==r.to&&(i=r.to==n.to+1?n:e.doc.lineAt(r.to-1));let o=t.length-1;o>=0&&t[o].to>n.from?t[o].to=i.to:t.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:i.to})}return t}(t)),0);function Cc(e,t){let r=e.languageDataAt("commentTokens",t,1);return r.length?r[0]:{}}function Cu(e,t,r=t.selection.ranges){let n=r.map(e=>Cc(t,e.from).block);if(!n.every(e=>e))return null;let i=r.map((e,r)=>(function(e,{open:t,close:r},n,i){let o,s,a=e.sliceDoc(n-50,n),l=e.sliceDoc(i,i+50),c=/\s*$/.exec(a)[0].length,u=/^\s*/.exec(l)[0].length,h=a.length-c;if(a.slice(h-t.length,h)==t&&l.slice(u,u+r.length)==r)return{open:{pos:n-c,margin:c&&1},close:{pos:i+u,margin:u&&1}};i-n<=100?o=s=e.sliceDoc(n,i):(o=e.sliceDoc(n,n+50),s=e.sliceDoc(i-50,i));let d=/^\s*/.exec(o)[0].length,f=/\s*$/.exec(s)[0].length,p=s.length-f-r.length;return o.slice(d,d+t.length)==t&&s.slice(p,p+r.length)==r?{open:{pos:n+d+t.length,margin:+!!/\s/.test(o.charAt(d+t.length))},close:{pos:i-f-r.length,margin:+!!/\s/.test(s.charAt(p-1))}}:null})(t,n[r],e.from,e.to));if(2!=e&&!i.every(e=>e))return{changes:t.changes(r.map((e,t)=>i[t]?[]:[{from:e.from,insert:n[t].open+" "},{from:e.to,insert:" "+n[t].close}]))};if(1!=e&&i.some(e=>e)){let e=[];for(let t=0,r;t<i.length;t++)if(r=i[t]){let i=n[t],{open:o,close:s}=r;e.push({from:o.pos-i.open.length,to:o.pos+o.margin},{from:s.pos-s.margin,to:s.pos+i.close.length})}return{changes:e}}return null}let Ch=vV.define(),Cd=vV.define(),Cf=vw.define(),Cp=vw.define({combine:e=>v1(e,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(r,n)=>e(r,n)||t(r,n)})}),Cm=vE.define({create:()=>CO.empty,update(e,t){let r=t.state.facet(Cp),n=t.annotation(Ch);if(n){let i=Cw.fromTransaction(t,n.selection),o=n.side,s=0==o?e.undone:e.done;return s=i?Ck(s,s.length,r.minDepth,i):Cj(s,t.startState.selection),new CO(0==o?n.rest:s,0==o?s:n.rest)}let i=t.annotation(Cd);if(("full"==i||"before"==i)&&(e=e.isolate()),!1===t.annotation(vK.addToHistory))return t.changes.empty?e:e.addMapping(t.changes.desc);let o=Cw.fromTransaction(t),s=t.annotation(vK.time),a=t.annotation(vK.userEvent);return o?e=e.addChanges(o,s,a,r,t):t.selection&&(e=e.addSelection(t.startState.selection,s,a,r.newGroupDelay)),("full"==i||"after"==i)&&(e=e.isolate()),e},toJSON:e=>({done:e.done.map(e=>e.toJSON()),undone:e.undone.map(e=>e.toJSON())}),fromJSON:e=>new CO(e.done.map(Cw.fromJSON),e.undone.map(Cw.fromJSON))});function Cg(e,t){return function({state:r,dispatch:n}){if(!t&&r.readOnly)return!1;let i=r.field(Cm,!1);if(!i)return!1;let o=i.pop(e,r,t);return!!o&&(n(o),!0)}}let Cy=Cg(0,!1),Cv=Cg(1,!1),Cb=Cg(0,!0),Cx=Cg(1,!0);class Cw{constructor(e,t,r,n,i){this.changes=e,this.effects=t,this.mapped=r,this.startSelection=n,this.selectionsAfter=i}setSelAfter(e){return new Cw(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,r;return{changes:null==(e=this.changes)?void 0:e.toJSON(),mapped:null==(t=this.mapped)?void 0:t.toJSON(),startSelection:null==(r=this.startSelection)?void 0:r.toJSON(),selectionsAfter:this.selectionsAfter.map(e=>e.toJSON())}}static fromJSON(e){return new Cw(e.changes&&vu.fromJSON(e.changes),[],e.mapped&&vc.fromJSON(e.mapped),e.startSelection&&vv.fromJSON(e.startSelection),e.selectionsAfter.map(vv.fromJSON))}static fromTransaction(e,t){let r=CS;for(let t of e.startState.facet(Cf)){let n=t(e);n.length&&(r=r.concat(n))}return!r.length&&e.changes.empty?null:new Cw(e.changes.invert(e.startState.doc),r,void 0,t||e.startState.selection,CS)}static selection(e){return new Cw(void 0,CS,void 0,void 0,e)}}function Ck(e,t,r,n){let i=e.slice(t+1>r+20?t-r-1:0,t);return i.push(n),i}function CA(e,t){return e.length?t.length?e.concat(t):e:t}let CS=[];function Cj(e,t){if(!e.length)return[Cw.selection([t])];{let r=e[e.length-1],n=r.selectionsAfter.slice(Math.max(0,r.selectionsAfter.length-200));return n.length&&n[n.length-1].eq(t)?e:(n.push(t),Ck(e,e.length-1,1e9,r.setSelAfter(n)))}}function CC(e,t){if(!e.length)return e;let r=e.length,n=CS;for(;r;){let i=function(e,t,r){let n=CA(e.selectionsAfter.length?e.selectionsAfter.map(e=>e.map(t)):CS,r);if(!e.changes)return Cw.selection(n);let i=e.changes.map(t),o=t.mapDesc(e.changes,!0),s=e.mapped?e.mapped.composeDesc(o):o;return new Cw(i,vq.mapEffects(e.effects,t),s,e.startSelection.map(o),n)}(e[r-1],t,n);if(i.changes&&!i.changes.empty||i.effects.length){let t=e.slice(0,r);return t[r-1]=i,t}t=i.mapped,r--,n=i.selectionsAfter}return n.length?[Cw.selection(n)]:CS}let CE=/^(input\.type|delete)($|\.)/;class CO{constructor(e,t,r=0,n){this.done=e,this.undone=t,this.prevTime=r,this.prevUserEvent=n}isolate(){return this.prevTime?new CO(this.done,this.undone):this}addChanges(e,t,r,n,i){var o,s;let a,l,c=this.done,u=c[c.length-1];return new CO(c=u&&u.changes&&!u.changes.empty&&e.changes&&(!r||CE.test(r))&&(!u.selectionsAfter.length&&t-this.prevTime<n.newGroupDelay&&n.joinToEvent(i,(o=u.changes,s=e.changes,a=[],l=!1,o.iterChangedRanges((e,t)=>a.push(e,t)),s.iterChangedRanges((e,t,r,n)=>{for(let e=0;e<a.length;){let t=a[e++],i=a[e++];n>=t&&r<=i&&(l=!0)}}),l))||"input.type.compose"==r)?Ck(c,c.length-1,n.minDepth,new Cw(e.changes.compose(u.changes),CA(vq.mapEffects(e.effects,u.changes),u.effects),u.mapped,u.startSelection,CS)):Ck(c,c.length,n.minDepth,e),CS,t,r)}addSelection(e,t,r,n){var i;let o=this.done.length?this.done[this.done.length-1].selectionsAfter:CS;return o.length>0&&t-this.prevTime<n&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&(i=o[o.length-1],i.ranges.length==e.ranges.length&&0===i.ranges.filter((t,r)=>t.empty!=e.ranges[r].empty).length)?this:new CO(Cj(this.done,e),this.undone,t,r)}addMapping(e){return new CO(CC(this.done,e),CC(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,r){let n=0==e?this.done:this.undone;if(0==n.length)return null;let i=n[n.length-1],o=i.selectionsAfter[0]||t.selection;if(r&&i.selectionsAfter.length){let r,s;return t.update({selection:i.selectionsAfter[i.selectionsAfter.length-1],annotations:Ch.of({side:e,rest:(r=n[n.length-1],(s=n.slice())[n.length-1]=r.setSelAfter(r.selectionsAfter.slice(0,r.selectionsAfter.length-1)),s),selection:o}),userEvent:0==e?"select.undo":"select.redo",scrollIntoView:!0})}{if(!i.changes)return null;let r=1==n.length?CS:n.slice(0,n.length-1);return i.mapped&&(r=CC(r,i.mapped)),t.update({changes:i.changes,selection:i.startSelection,effects:i.effects,annotations:Ch.of({side:e,rest:r,selection:o}),filter:!1,userEvent:0==e?"undo":"redo",scrollIntoView:!0})}}}CO.empty=new CO(CS,CS);let CM=[{key:"Mod-z",run:Cy,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Cv,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Cv,preventDefault:!0},{key:"Mod-u",run:Cb,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Cx,preventDefault:!0}];function CP(e,t){return vv.create(e.ranges.map(t),e.mainIndex)}function CT(e,t){return e.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function CI({state:e,dispatch:t},r){let n=CP(e.selection,r);return!n.eq(e.selection,!0)&&(t(CT(e,n)),!0)}function C$(e,t){return vv.cursor(t?e.to:e.from)}function CD(e,t){return CI(e,r=>r.empty?e.moveByChar(r,t):C$(r,t))}function CR(e){return e.textDirectionAt(e.state.selection.main.head)==xo.LTR}let CN=e=>CD(e,!CR(e)),C_=e=>CD(e,CR(e));function CL(e,t){return CI(e,r=>r.empty?e.moveByGroup(r,t):C$(r,t))}function CF(e,t,r){let n,i,o=S1(e).resolveInner(t.head),s=r?A7.closedBy:A7.openedBy;for(let n=t.head;;){let t=r?o.childAfter(n):o.childBefore(n);if(!t)break;!function(e,t,r){if(t.type.prop(r))return!0;let n=t.to-t.from;return n&&(n>2||/[^\s,.;:]/.test(e.sliceDoc(t.from,t.to)))||t.firstChild}(e,t,s)?n=r?t.to:t.from:o=t}return i=o.type.prop(s)&&(n=r?jY(e,o.from,1):jY(e,o.to,-1))&&n.matched?r?n.end.to:n.end.from:r?o.to:o.from,vv.cursor(i,r?-1:1)}function CB(e,t){return CI(e,r=>{if(!r.empty)return C$(r,t);let n=e.moveVertically(r,t);return n.head!=r.head?n:e.moveToLineBoundary(r,t)})}"u">typeof Intl&&Intl.Segmenter;let Cz=e=>CB(e,!1),CW=e=>CB(e,!0);function CV(e){let t=e.scrollDOM.clientHeight<e.scrollDOM.scrollHeight-2,r=0,n=0,i;if(t){for(let t of e.state.facet(k$.scrollMargins)){let i=t(e);(null==i?void 0:i.top)&&(r=Math.max(null==i?void 0:i.top,r)),(null==i?void 0:i.bottom)&&(n=Math.max(null==i?void 0:i.bottom,n))}i=e.scrollDOM.clientHeight-r-n}else i=(e.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:r,marginBottom:n,selfScroll:t,height:Math.max(e.defaultLineHeight,i-5)}}function CH(e,t){let r,n=CV(e),{state:i}=e,o=CP(i.selection,r=>r.empty?e.moveVertically(r,t,n.height):C$(r,t));if(o.eq(i.selection))return!1;if(n.selfScroll){let t=e.coordsAtPos(i.selection.main.head),s=e.scrollDOM.getBoundingClientRect(),a=s.top+n.marginTop,l=s.bottom-n.marginBottom;t&&t.top>a&&t.bottom<l&&(r=k$.scrollIntoView(o.main.head,{y:"start",yMargin:t.top-a}))}return e.dispatch(CT(i,o),{effects:r}),!0}let CU=e=>CH(e,!1),Cq=e=>CH(e,!0);function CK(e,t,r){let n=e.lineBlockAt(t.head),i=e.moveToLineBoundary(t,r);if(i.head==t.head&&i.head!=(r?n.to:n.from)&&(i=e.moveToLineBoundary(t,r,!1)),!r&&i.head==n.from&&n.length){let r=/^\s*/.exec(e.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;r&&t.head!=n.from+r&&(i=vv.cursor(n.from+r))}return i}function CG(e,t){let r=CP(e.state.selection,e=>{let r=t(e);return vv.range(e.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return!r.eq(e.state.selection)&&(e.dispatch(CT(e.state,r)),!0)}function CJ(e,t){return CG(e,r=>e.moveByChar(r,t))}let CY=e=>CJ(e,!CR(e)),CX=e=>CJ(e,CR(e));function CZ(e,t){return CG(e,r=>e.moveByGroup(r,t))}function CQ(e,t){return CG(e,r=>e.moveVertically(r,t))}let C0=e=>CQ(e,!1),C1=e=>CQ(e,!0);function C2(e,t){return CG(e,r=>e.moveVertically(r,t,CV(e).height))}let C4=e=>C2(e,!1),C3=e=>C2(e,!0),C5=({state:e,dispatch:t})=>(t(CT(e,{anchor:0})),!0),C6=({state:e,dispatch:t})=>(t(CT(e,{anchor:e.doc.length})),!0),C9=({state:e,dispatch:t})=>(t(CT(e,{anchor:e.selection.main.anchor,head:0})),!0),C8=({state:e,dispatch:t})=>(t(CT(e,{anchor:e.selection.main.anchor,head:e.doc.length})),!0);function C7(e,t){let{state:r}=e,n=r.selection,i=r.selection.ranges.slice();for(let n of r.selection.ranges){let o=r.doc.lineAt(n.head);if(t?o.to<e.state.doc.length:o.from>0)for(let r=n;;){let n=e.moveVertically(r,t);if(n.head<o.from||n.head>o.to){i.some(e=>e.head==n.head)||i.push(n);break}if(n.head==r.head)break;r=n}}return i.length!=n.ranges.length&&(e.dispatch(CT(r,vv.create(i,i.length-1))),!0)}function Ee(e,t){if(e.state.readOnly)return!1;let r="delete.selection",{state:n}=e,i=n.changeByRange(n=>{let{from:i,to:o}=n;if(i==o){let s=t(n);s<i?(r="delete.backward",s=Et(e,s,!1)):s>i&&(r="delete.forward",s=Et(e,s,!0)),i=Math.min(i,s),o=Math.max(o,s)}else i=Et(e,i,!1),o=Et(e,o,!0);return i==o?{range:n}:{changes:{from:i,to:o},range:vv.cursor(i,i<n.head?-1:1)}});return!i.changes.empty&&(e.dispatch(n.update(i,{scrollIntoView:!0,userEvent:r,effects:"delete.selection"==r?k$.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function Et(e,t,r){if(e instanceof k$)for(let n of e.state.facet(k$.atomicRanges).map(t=>t(e)))n.between(t,t,(e,n)=>{e<t&&n>t&&(t=r?n:e)});return t}let Er=(e,t,r)=>Ee(e,n=>{let i=n.from,{state:o}=e,s=o.doc.lineAt(i),a,l;if(r&&!t&&i>s.from&&i<s.from+200&&!/[^ \t]/.test(a=s.text.slice(0,i-s.from))){if("	"==a[a.length-1])return i-1;let e=bc(a,o.tabSize)%jn(o)||jn(o);for(let t=0;t<e&&" "==a[a.length-1-t];t++)i--;l=i}else(l=vn(s.text,i-s.from,t,t)+s.from)==i&&s.number!=(t?o.doc.lines:1)?l+=t?1:-1:!t&&/[\ufe00-\ufe0f]/.test(s.text.slice(l-s.from,i-s.from))&&(l=vn(s.text,l-s.from,!1,!1)+s.from);return l}),En=e=>Er(e,!1,!0),Ei=e=>Er(e,!0,!1),Eo=(e,t)=>Ee(e,r=>{let n=r.head,{state:i}=e,o=i.doc.lineAt(n),s=i.charCategorizer(n);for(let e=null;;){if(n==(t?o.to:o.from)){n==r.head&&o.number!=(t?i.doc.lines:1)&&(n+=t?1:-1);break}let a=vn(o.text,n-o.from,t)+o.from,l=o.text.slice(Math.min(n,a)-o.from,Math.max(n,a)-o.from),c=s(l);if(null!=e&&c!=e)break;(" "!=l||n!=r.head)&&(e=c),n=a}return n}),Es=e=>Eo(e,!1);function Ea(e){let t=[],r=-1;for(let n of e.selection.ranges){let i=e.doc.lineAt(n.from),o=e.doc.lineAt(n.to);if(n.empty||n.to!=o.from||(o=e.doc.lineAt(n.to-1)),r>=i.number){let e=t[t.length-1];e.to=o.to,e.ranges.push(n)}else t.push({from:i.from,to:o.to,ranges:[n]});r=o.number+1}return t}function El(e,t,r){if(e.readOnly)return!1;let n=[],i=[];for(let t of Ea(e)){if(r?t.to==e.doc.length:0==t.from)continue;let o=e.doc.lineAt(r?t.to+1:t.from-1),s=o.length+1;if(r)for(let r of(n.push({from:t.to,to:o.to},{from:t.from,insert:o.text+e.lineBreak}),t.ranges))i.push(vv.range(Math.min(e.doc.length,r.anchor+s),Math.min(e.doc.length,r.head+s)));else for(let r of(n.push({from:o.from,to:t.from},{from:t.to,insert:e.lineBreak+o.text}),t.ranges))i.push(vv.range(r.anchor-s,r.head-s))}return!!n.length&&(t(e.update({changes:n,scrollIntoView:!0,selection:vv.create(i,e.selection.mainIndex),userEvent:"move.line"})),!0)}function Ec(e,t,r){if(e.readOnly)return!1;let n=[];for(let t of Ea(e))r?n.push({from:t.from,insert:e.doc.slice(t.from,t.to)+e.lineBreak}):n.push({from:t.to,insert:e.lineBreak+e.doc.slice(t.from,t.to)});let i=e.changes(n);return t(e.update({changes:i,selection:e.selection.map(i,r?1:-1),scrollIntoView:!0,userEvent:"input.copyline"})),!0}let Eu=Ed(!1),Eh=Ed(!0);function Ed(e){return({state:t,dispatch:r})=>{if(t.readOnly)return!1;let n=t.changeByRange(r=>{let{from:n,to:i}=r,o=t.doc.lineAt(n),s=!e&&n==i&&function(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};let r=S1(e).resolveInner(t),n=r.childBefore(t),i=r.childAfter(t),o;return n&&i&&n.to<=t&&i.from>=t&&(o=n.type.prop(A7.closedBy))&&o.indexOf(i.name)>-1&&e.doc.lineAt(n.to).from==e.doc.lineAt(i.from).from&&!/\S/.test(e.sliceDoc(n.to,i.from))?{from:n.to,to:i.from}:null}(t,n);e&&(n=i=(i<=o.to?o:t.doc.lineAt(i)).to);let a=new js(t,{simulateBreak:n,simulateDoubleBreak:!!s}),l=jo(a,n);for(null==l&&(l=bc(/^\s*/.exec(t.doc.lineAt(n).text)[0],t.tabSize));i<o.to&&/\s/.test(o.text[i-o.from]);)i++;s?{from:n,to:i}=s:n>o.from&&n<o.from+100&&!/\S/.test(o.text.slice(0,n))&&(n=o.from);let c=["",ji(t,l)];return s&&c.push(ji(t,a.lineIndent(o.from,-1))),{changes:{from:n,to:i,insert:y3.of(c)},range:vv.cursor(n+1+c[1].length)}});return r(t.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function Ef(e,t){let r=-1;return e.changeByRange(n=>{let i=[];for(let o=n.from;o<=n.to;){let s=e.doc.lineAt(o);s.number>r&&(n.empty||n.to>s.from)&&(t(s,i,n),r=s.number),o=s.to+1}let o=e.changes(i);return{changes:i,range:vv.range(o.mapPos(n.anchor,1),o.mapPos(n.head,1))}})}let Ep=({state:e,dispatch:t})=>!e.readOnly&&(t(e.update(Ef(e,(t,r)=>{r.push({from:t.from,insert:e.facet(jr)})}),{userEvent:"input.indent"})),!0),Em=({state:e,dispatch:t})=>!e.readOnly&&(t(e.update(Ef(e,(t,r)=>{let n=/^\s*/.exec(t.text)[0];if(!n)return;let i=bc(n,e.tabSize),o=0,s=ji(e,Math.max(0,i-jn(e)));for(;o<n.length&&o<s.length&&n.charCodeAt(o)==s.charCodeAt(o);)o++;r.push({from:t.from+o,to:t.from+n.length,insert:s.slice(o)})}),{userEvent:"delete.dedent"})),!0),Eg=[{key:"Ctrl-b",run:CN,shift:CY,preventDefault:!0},{key:"Ctrl-f",run:C_,shift:CX},{key:"Ctrl-p",run:Cz,shift:C0},{key:"Ctrl-n",run:CW,shift:C1},{key:"Ctrl-a",run:e=>CI(e,t=>vv.cursor(e.lineBlockAt(t.head).from,1)),shift:e=>CG(e,t=>vv.cursor(e.lineBlockAt(t.head).from))},{key:"Ctrl-e",run:e=>CI(e,t=>vv.cursor(e.lineBlockAt(t.head).to,-1)),shift:e=>CG(e,t=>vv.cursor(e.lineBlockAt(t.head).to))},{key:"Ctrl-d",run:Ei},{key:"Ctrl-h",run:En},{key:"Ctrl-k",run:e=>Ee(e,t=>{let r=e.lineBlockAt(t.head).to;return t.head<r?r:Math.min(e.state.doc.length,t.head+1)})},{key:"Ctrl-Alt-h",run:Es},{key:"Ctrl-o",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let r=e.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:y3.of(["",""])},range:vv.cursor(e.from)}));return t(e.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let r=e.changeByRange(t=>{if(!t.empty||0==t.from||t.from==e.doc.length)return{range:t};let r=t.from,n=e.doc.lineAt(r),i=r==n.from?r-1:vn(n.text,r-n.from,!1)+n.from,o=r==n.to?r+1:vn(n.text,r-n.from,!0)+n.from;return{changes:{from:i,to:o,insert:e.doc.slice(r,o).append(e.doc.slice(i,r))},range:vv.cursor(o)}});return!r.changes.empty&&(t(e.update(r,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:Cq}],Ey=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:e=>CI(e,t=>CF(e.state,t,!CR(e))),shift:e=>CG(e,t=>CF(e.state,t,!CR(e)))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:e=>CI(e,t=>CF(e.state,t,CR(e))),shift:e=>CG(e,t=>CF(e.state,t,CR(e)))},{key:"Alt-ArrowUp",run:({state:e,dispatch:t})=>El(e,t,!1)},{key:"Shift-Alt-ArrowUp",run:({state:e,dispatch:t})=>Ec(e,t,!1)},{key:"Alt-ArrowDown",run:({state:e,dispatch:t})=>El(e,t,!0)},{key:"Shift-Alt-ArrowDown",run:({state:e,dispatch:t})=>Ec(e,t,!0)},{key:"Mod-Alt-ArrowUp",run:e=>C7(e,!1)},{key:"Mod-Alt-ArrowDown",run:e=>C7(e,!0)},{key:"Escape",run:({state:e,dispatch:t})=>{let r=e.selection,n=null;return r.ranges.length>1?n=vv.create([r.main]):r.main.empty||(n=vv.create([vv.cursor(r.main.head)])),!!n&&(t(CT(e,n)),!0)}},{key:"Mod-Enter",run:Eh},{key:"Alt-l",mac:"Ctrl-l",run:({state:e,dispatch:t})=>{let r=Ea(e).map(({from:t,to:r})=>vv.range(t,Math.min(r+1,e.doc.length)));return t(e.update({selection:vv.create(r),userEvent:"select"})),!0}},{key:"Mod-i",run:({state:e,dispatch:t})=>{let r=CP(e.selection,t=>{let r=S1(e),n=r.resolveStack(t.from,1);if(t.empty){let e=r.resolveStack(t.from,-1);e.node.from>=n.node.from&&e.node.to<=n.node.to&&(n=e)}for(let e=n;e;e=e.next){let{node:r}=e;if((r.from<t.from&&r.to>=t.to||r.to>t.to&&r.from<=t.from)&&e.next)return vv.range(r.to,r.from)}return t});return!r.eq(e.selection)&&(t(CT(e,r)),!0)},preventDefault:!0},{key:"Mod-[",run:Em},{key:"Mod-]",run:Ep},{key:"Mod-Alt-\\",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let r=Object.create(null),n=new js(e,{overrideIndentation:e=>{let t=r[e];return null==t?-1:t}}),i=Ef(e,(t,i,o)=>{let s=jo(n,t.from);if(null==s)return;/\S/.test(t.text)||(s=0);let a=/^\s*/.exec(t.text)[0],l=ji(e,s);(a!=l||o.from<t.from+a.length)&&(r[t.from]=s,i.push({from:t.from,to:t.from+a.length,insert:l}))});return i.changes.empty||t(e.update(i,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:e=>{if(e.state.readOnly)return!1;let{state:t}=e,r=t.changes(Ea(t).map(({from:e,to:r})=>(e>0?e--:r<t.doc.length&&r++,{from:e,to:r}))),n=CP(t.selection,t=>{let r;if(e.lineWrapping){let n=e.lineBlockAt(t.head),i=e.coordsAtPos(t.head,t.assoc||1);i&&(r=n.bottom+e.documentTop-i.bottom+e.defaultLineHeight/2)}return e.moveVertically(t,!0,r)}).map(r);return e.dispatch({changes:r,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:({state:e,dispatch:t})=>{let r,n;return r=!1,n=CP(e.selection,t=>{let n=jY(e,t.head,-1)||jY(e,t.head,1)||t.head>0&&jY(e,t.head-1,1)||t.head<e.doc.length&&jY(e,t.head+1,-1);if(!n||!n.end)return t;r=!0;let i=n.start.from==t.head?n.end.to:n.end.from;return vv.cursor(i)}),!!r&&(t(CT(e,n)),!0)}},{key:"Mod-/",run:e=>{let{state:t}=e,r=t.doc.lineAt(t.selection.main.from),n=Cc(e.state,r.from);return n.line?Cs(e):!!n.block&&Cl(e)}},{key:"Alt-A",run:Ca},{key:"Ctrl-m",mac:"Shift-Alt-m",run:e=>(e.setTabFocusMode(),!0)}].concat([{key:"ArrowLeft",run:CN,shift:CY,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:e=>CL(e,!CR(e)),shift:e=>CZ(e,!CR(e)),preventDefault:!0},{mac:"Cmd-ArrowLeft",run:e=>CI(e,t=>CK(e,t,!CR(e))),shift:e=>CG(e,t=>CK(e,t,!CR(e))),preventDefault:!0},{key:"ArrowRight",run:C_,shift:CX,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:e=>CL(e,CR(e)),shift:e=>CZ(e,CR(e)),preventDefault:!0},{mac:"Cmd-ArrowRight",run:e=>CI(e,t=>CK(e,t,CR(e))),shift:e=>CG(e,t=>CK(e,t,CR(e))),preventDefault:!0},{key:"ArrowUp",run:Cz,shift:C0,preventDefault:!0},{mac:"Cmd-ArrowUp",run:C5,shift:C9},{mac:"Ctrl-ArrowUp",run:CU,shift:C4},{key:"ArrowDown",run:CW,shift:C1,preventDefault:!0},{mac:"Cmd-ArrowDown",run:C6,shift:C8},{mac:"Ctrl-ArrowDown",run:Cq,shift:C3},{key:"PageUp",run:CU,shift:C4},{key:"PageDown",run:Cq,shift:C3},{key:"Home",run:e=>CI(e,t=>CK(e,t,!1)),shift:e=>CG(e,t=>CK(e,t,!1)),preventDefault:!0},{key:"Mod-Home",run:C5,shift:C9},{key:"End",run:e=>CI(e,t=>CK(e,t,!0)),shift:e=>CG(e,t=>CK(e,t,!0)),preventDefault:!0},{key:"Mod-End",run:C6,shift:C8},{key:"Enter",run:Eu,shift:Eu},{key:"Mod-a",run:({state:e,dispatch:t})=>(t(e.update({selection:{anchor:0,head:e.doc.length},userEvent:"select"})),!0)},{key:"Backspace",run:En,shift:En,preventDefault:!0},{key:"Delete",run:Ei,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Es,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:e=>Eo(e,!0),preventDefault:!0},{mac:"Mod-Backspace",run:e=>Ee(e,t=>{let r=e.moveToLineBoundary(t,!1).head;return t.head>r?r:Math.max(0,t.head-1)}),preventDefault:!0},{mac:"Mod-Delete",run:e=>Ee(e,t=>{let r=e.moveToLineBoundary(t,!0).head;return t.head<r?r:Math.min(e.state.doc.length,t.head+1)}),preventDefault:!0}].concat(Eg.map(e=>({mac:e.key,run:e.run,shift:e.shift})))),Ev={key:"Tab",run:Ep,shift:Em},Eb="function"==typeof String.prototype.normalize?e=>e.normalize("NFKD"):e=>e;class Ex{constructor(e,t,r=0,n=e.length,i,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(r,n),this.bufferStart=r,this.normalize=i?e=>i(Eb(e)):Eb,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return -1;this.bufferPos=0,this.buffer=this.iter.value}return vi(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=vo(e),r=this.bufferStart+this.bufferPos;this.bufferPos+=vs(e);let n=this.normalize(t);if(n.length)for(let e=0,i=r;;e++){let o=n.charCodeAt(e),s=this.match(o,i,this.bufferPos+this.bufferStart);if(e==n.length-1){if(s)return this.value=s,this;break}i==r&&e<t.length&&t.charCodeAt(e)==o&&i++}}}match(e,t,r){let n=null;for(let t=0;t<this.matches.length;t+=2){let i=this.matches[t],o=!1;this.query.charCodeAt(i)==e&&(i==this.query.length-1?n={from:this.matches[t+1],to:r}:(this.matches[t]++,o=!0)),o||(this.matches.splice(t,2),t-=2)}return this.query.charCodeAt(0)==e&&(1==this.query.length?n={from:t,to:r}:this.matches.push(1,t)),n&&this.test&&!this.test(n.from,n.to,this.buffer,this.bufferStart)&&(n=null),n}}"u">typeof Symbol&&(Ex.prototype[Symbol.iterator]=function(){return this});let Ew={from:-1,to:-1,match:/.*/.exec("")},Ek="gm"+(null==/x/.unicode?"":"u");class EA{constructor(e,t,r,n=0,i=e.length){if(this.text=e,this.to=i,this.curLine="",this.done=!1,this.value=Ew,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new EC(e,t,r,n,i);this.re=new RegExp(t,Ek+((null==r?void 0:r.ignoreCase)?"i":"")),this.test=null==r?void 0:r.test,this.iter=e.iter();let o=e.lineAt(n);this.curLineStart=o.from,this.matchPos=EE(e,n),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let r=this.curLineStart+t.index,n=r+t[0].length;if(this.matchPos=EE(this.text,n+ +(r==n)),r==this.curLineStart+this.curLine.length&&this.nextLine(),(r<n||r>this.value.to)&&(!this.test||this.test(r,n,t)))return this.value={from:r,to:n,match:t},this;e=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),e=0}}}}let ES=new WeakMap;class Ej{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,r){let n=ES.get(e);if(!n||n.from>=r||n.to<=t){let n=new Ej(t,e.sliceString(t,r));return ES.set(e,n),n}if(n.from==t&&n.to==r)return n;let{text:i,from:o}=n;return o>t&&(i=e.sliceString(t,o)+i,o=t),n.to<r&&(i+=e.sliceString(n.to,r)),ES.set(e,new Ej(o,i)),new Ej(t,i.slice(t-o,r-o))}}class EC{constructor(e,t,r,n,i){this.text=e,this.to=i,this.done=!1,this.value=Ew,this.matchPos=EE(e,n),this.re=new RegExp(t,Ek+((null==r?void 0:r.ignoreCase)?"i":"")),this.test=null==r?void 0:r.test,this.flat=Ej.get(e,n,this.chunkEnd(n+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let e=this.flat.from+t.index,r=e+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(e,r,t)))return this.value={from:e,to:r,match:t},this.matchPos=EE(this.text,r+ +(e==r)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Ej.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}function EE(e,t){if(t>=e.length)return t;let r=e.lineAt(t),n;for(;t<r.to&&(n=r.text.charCodeAt(t-r.from))>=56320&&n<57344;)t++;return t}"u">typeof Symbol&&(EA.prototype[Symbol.iterator]=EC.prototype[Symbol.iterator]=function(){return this});let EO={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},EM=vw.define({combine:e=>v1(e,EO,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}),EP=bW.mark({class:"cm-selectionMatch"}),ET=bW.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function EI(e,t,r,n){return(0==r||e(t.sliceDoc(r-1,r))!=vZ.Word)&&(n==t.doc.length||e(t.sliceDoc(n,n+1))!=vZ.Word)}let E$=xL.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.selectionSet||e.docChanged||e.viewportChanged)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=e.state.facet(EM),{state:r}=e,n=r.selection;if(n.ranges.length>1)return bW.none;let i=n.main,o,s=null;if(i.empty){if(!t.highlightWordAroundCursor)return bW.none;let e=r.wordAt(i.head);if(!e)return bW.none;s=r.charCategorizer(i.head),o=r.sliceDoc(e.from,e.to)}else{let e=i.to-i.from;if(e<t.minSelectionLength||e>200)return bW.none;if(t.wholeWords){var a,l,c;if(o=r.sliceDoc(i.from,i.to),!(EI(s=r.charCategorizer(i.head),r,i.from,i.to)&&(a=s,l=i.from,c=i.to,a(r.sliceDoc(l,l+1))==vZ.Word&&a(r.sliceDoc(c-1,c))==vZ.Word)))return bW.none}else if(!(o=r.sliceDoc(i.from,i.to)))return bW.none}let u=[];for(let n of e.visibleRanges){let e=new Ex(r.doc,o,n.from,n.to);for(;!e.next().done;){let{from:n,to:o}=e.value;if((!s||EI(s,r,n,o))&&(i.empty&&n<=i.from&&o>=i.to?u.push(ET.range(n,o)):(n>=i.to||o<=i.from)&&u.push(EP.range(n,o)),u.length>t.maxMatches))return bW.none}}return bW.set(u)}},{decorations:e=>e.decorations}),ED=k$.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),ER=vw.define({combine:e=>v1(e,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new Oe(e),scrollToMatch:e=>k$.scrollIntoView(e)})});class EN{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||function(e){try{return new RegExp(e,Ek),!0}catch(e){return!1}}(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord,this.test=e.test}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(e,t)=>"n"==t?"\n":"r"==t?"\r":"t"==t?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord&&this.test==e.test}create(){return this.regexp?new EV(this):new EF(this)}getCursor(e,t=0,r){let n=e.doc?e:v0.create({doc:e});return null==r&&(r=n.doc.length),this.regexp?EB(this,n,t,r):EL(this,n,t,r)}}class E_{constructor(e){this.spec=e}}function EL(e,t,r,n){var i,o,s,a;let l;return e.wholeWord&&(s=t.doc,a=t.charCategorizer(t.selection.main.head),l=(e,t,r,n)=>((n>e||n+r.length<t)&&(n=Math.max(0,e-2),r=s.sliceString(n,Math.min(s.length,t+2))),(a(Ez(r,e-n))!=vZ.Word||a(EW(r,e-n))!=vZ.Word)&&(a(EW(r,t-n))!=vZ.Word||a(Ez(r,t-n))!=vZ.Word))),e.test&&(i=e.test,o=l,l=(e,r,n,s)=>(!o||!!o(e,r,n,s))&&i(e>=s&&r<=s+n.length?n.slice(e-s,r-s):t.doc.sliceString(e,r),t,e,r)),new Ex(t.doc,e.unquoted,r,n,e.caseSensitive?void 0:e=>e.toLowerCase(),l)}class EF extends E_{constructor(e){super(e)}nextMatch(e,t,r){let n=EL(this.spec,e,r,e.doc.length).nextOverlapping();if(n.done){let r=Math.min(e.doc.length,t+this.spec.unquoted.length);n=EL(this.spec,e,0,r).nextOverlapping()}return n.done||n.value.from==t&&n.value.to==r?null:n.value}prevMatchInRange(e,t,r){for(let n=r;;){let r=Math.max(t,n-1e4-this.spec.unquoted.length),i=EL(this.spec,e,r,n),o=null;for(;!i.nextOverlapping().done;)o=i.value;if(o)return o;if(r==t)return null;n-=1e4}}prevMatch(e,t,r){let n=this.prevMatchInRange(e,0,t);return n||(n=this.prevMatchInRange(e,Math.max(0,r-this.spec.unquoted.length),e.doc.length)),n&&(n.from!=t||n.to!=r)?n:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let r=EL(this.spec,e,0,e.doc.length),n=[];for(;!r.next().done;){if(n.length>=t)return null;n.push(r.value)}return n}highlight(e,t,r,n){let i=EL(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(r+this.spec.unquoted.length,e.doc.length));for(;!i.next().done;)n(i.value.from,i.value.to)}}function EB(e,t,r,n){var i,o,s;let a;return e.wholeWord&&(s=t.charCategorizer(t.selection.main.head),a=(e,t,r)=>!r[0].length||(s(Ez(r.input,r.index))!=vZ.Word||s(EW(r.input,r.index))!=vZ.Word)&&(s(EW(r.input,r.index+r[0].length))!=vZ.Word||s(Ez(r.input,r.index+r[0].length))!=vZ.Word)),e.test&&(i=e.test,o=a,a=(e,r,n)=>(!o||o(e,r,n))&&i(n[0],t,e,r)),new EA(t.doc,e.search,{ignoreCase:!e.caseSensitive,test:a},r,n)}function Ez(e,t){return e.slice(vn(e,t,!1),t)}function EW(e,t){return e.slice(t,vn(e,t))}class EV extends E_{nextMatch(e,t,r){let n=EB(this.spec,e,r,e.doc.length).next();return n.done&&(n=EB(this.spec,e,0,t).next()),n.done?null:n.value}prevMatchInRange(e,t,r){for(let n=1;;n++){let i=Math.max(t,r-1e4*n),o=EB(this.spec,e,i,r),s=null;for(;!o.next().done;)s=o.value;if(s&&(i==t||s.from>i+10))return s;if(i==t)return null}}prevMatch(e,t,r){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,r)=>{if("&"==r)return e.match[0];if("$"==r)return"$";for(let t=r.length;t>0;t--){let n=+r.slice(0,t);if(n>0&&n<e.match.length)return e.match[n]+r.slice(t)}return t})}matchAll(e,t){let r=EB(this.spec,e,0,e.doc.length),n=[];for(;!r.next().done;){if(n.length>=t)return null;n.push(r.value)}return n}highlight(e,t,r,n){let i=EB(this.spec,e,Math.max(0,t-250),Math.min(r+250,e.doc.length));for(;!i.next().done;)n(i.value.from,i.value.to)}}let EH=vq.define(),EU=vq.define(),Eq=vE.define({create:e=>new EK(E3(e).create(),null),update(e,t){for(let r of t.effects)r.is(EH)?e=new EK(r.value.create(),e.panel):r.is(EU)&&(e=new EK(e.query,r.value?E4:null));return e},provide:e=>AR.from(e,e=>e.panel)});class EK{constructor(e,t){this.query=e,this.panel=t}}let EG=bW.mark({class:"cm-searchMatch"}),EJ=bW.mark({class:"cm-searchMatch cm-searchMatch-selected"}),EY=xL.fromClass(class{constructor(e){this.view=e,this.decorations=this.highlight(e.state.field(Eq))}update(e){let t=e.state.field(Eq);(t!=e.startState.field(Eq)||e.docChanged||e.selectionSet||e.viewportChanged)&&(this.decorations=this.highlight(t))}highlight({query:e,panel:t}){if(!t||!e.spec.valid)return bW.none;let{view:r}=this,n=new v8;for(let t=0,i=r.visibleRanges,o=i.length;t<o;t++){let{from:s,to:a}=i[t];for(;t<o-1&&a>i[t+1].from-500;)a=i[++t].to;e.highlight(r.state,s,a,(e,t)=>{let i=r.state.selection.ranges.some(r=>r.from==e&&r.to==t);n.add(e,t,i?EJ:EG)})}return n.finish()}},{decorations:e=>e.decorations});function EX(e){return t=>{let r=t.state.field(Eq,!1);return r&&r.query.spec.valid?e(t,r):E9(t)}}let EZ=EX((e,{query:t})=>{let{to:r}=e.state.selection.main,n=t.nextMatch(e.state,r,r);if(!n)return!1;let i=vv.single(n.from,n.to),o=e.state.facet(ER);return e.dispatch({selection:i,effects:[On(e,n),o.scrollToMatch(i.main,e)],userEvent:"select.search"}),E6(e),!0}),EQ=EX((e,{query:t})=>{let{state:r}=e,{from:n}=r.selection.main,i=t.prevMatch(r,n,n);if(!i)return!1;let o=vv.single(i.from,i.to),s=e.state.facet(ER);return e.dispatch({selection:o,effects:[On(e,i),s.scrollToMatch(o.main,e)],userEvent:"select.search"}),E6(e),!0}),E0=EX((e,{query:t})=>{let r=t.matchAll(e.state,1e3);return!!r&&!!r.length&&(e.dispatch({selection:vv.create(r.map(e=>vv.range(e.from,e.to))),userEvent:"select.search.matches"}),!0)}),E1=EX((e,{query:t})=>{let{state:r}=e,{from:n,to:i}=r.selection.main;if(r.readOnly)return!1;let o=t.nextMatch(r,n,n);if(!o)return!1;let s=o,a=[],l,c,u=[];s.from==n&&s.to==i&&(c=r.toText(t.getReplacement(s)),a.push({from:s.from,to:s.to,insert:c}),s=t.nextMatch(r,s.from,s.to),u.push(k$.announce.of(r.phrase("replaced match on line $",r.doc.lineAt(n).number)+".")));let h=e.state.changes(a);return s&&(l=vv.single(s.from,s.to).map(h),u.push(On(e,s)),u.push(r.facet(ER).scrollToMatch(l.main,e))),e.dispatch({changes:h,selection:l,effects:u,userEvent:"input.replace"}),!0}),E2=EX((e,{query:t})=>{if(e.state.readOnly)return!1;let r=t.matchAll(e.state,1e9).map(e=>{let{from:r,to:n}=e;return{from:r,to:n,insert:t.getReplacement(e)}});if(!r.length)return!1;let n=e.state.phrase("replaced $ matches",r.length)+".";return e.dispatch({changes:r,effects:k$.announce.of(n),userEvent:"input.replace.all"}),!0});function E4(e){return e.state.facet(ER).createPanel(e)}function E3(e,t){var r,n,i,o,s;let a=e.selection.main,l=a.empty||a.to>a.from+100?"":e.sliceDoc(a.from,a.to);if(t&&!l)return t;let c=e.facet(ER);return new EN({search:(null!=(r=null==t?void 0:t.literal)?r:c.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:null!=(n=null==t?void 0:t.caseSensitive)?n:c.caseSensitive,literal:null!=(i=null==t?void 0:t.literal)?i:c.literal,regexp:null!=(o=null==t?void 0:t.regexp)?o:c.regexp,wholeWord:null!=(s=null==t?void 0:t.wholeWord)?s:c.wholeWord})}function E5(e){let t=AT(e,E4);return t&&t.dom.querySelector("[main-field]")}function E6(e){let t=E5(e);t&&t==e.root.activeElement&&t.select()}let E9=e=>{let t=e.state.field(Eq,!1);if(t&&t.panel){let r=E5(e);if(r&&r!=e.root.activeElement){let n=E3(e.state,t.query.spec);n.valid&&e.dispatch({effects:EH.of(n)}),r.focus(),r.select()}}else e.dispatch({effects:[EU.of(!0),t?EH.of(E3(e.state,t.query.spec)):vq.appendConfig.of(Oo)]});return!0},E8=e=>{let t=e.state.field(Eq,!1);if(!t||!t.panel)return!1;let r=AT(e,E4);return r&&r.dom.contains(e.root.activeElement)&&e.focus(),e.dispatch({effects:EU.of(!1)}),!0},E7=[{key:"Mod-f",run:E9,scope:"editor search-panel"},{key:"F3",run:EZ,shift:EQ,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:EZ,shift:EQ,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:E8,scope:"editor search-panel"},{key:"Mod-Shift-l",run:({state:e,dispatch:t})=>{let r=e.selection;if(r.ranges.length>1||r.main.empty)return!1;let{from:n,to:i}=r.main,o=[],s=0;for(let t=new Ex(e.doc,e.sliceDoc(n,i));!t.next().done;){if(o.length>1e3)return!1;t.value.from==n&&(s=o.length),o.push(vv.range(t.value.from,t.value.to))}return t(e.update({selection:vv.create(o,s),userEvent:"select.search.matches"})),!0}},{key:"Mod-Alt-g",run:e=>{var t;let r,n,i,o,{state:s}=e,a=String(s.doc.lineAt(e.state.selection.main.head).number),{close:l,result:c}=(t={label:s.phrase("Go to line"),input:{type:"text",name:"line",value:a},focus:!0,submitLabel:s.phrase("go")},n=new Promise(e=>r=e),i=e=>(function(e,t,r){let n=t.content?t.content(e,()=>s(null)):null;if(!n){if(n=bA("form"),t.input){let e=bA("input",t.input);/^(text|password|number|email|tel|url)$/.test(e.type)&&e.classList.add("cm-textfield"),e.name||(e.name="input"),n.appendChild(bA("label",(t.label||"")+": ",e))}else n.appendChild(document.createTextNode(t.label||""));n.appendChild(document.createTextNode(" ")),n.appendChild(bA("button",{class:"cm-button",type:"submit"},t.submitLabel||"OK"))}let i="FORM"==n.nodeName?[n]:n.querySelectorAll("form");for(let e=0;e<i.length;e++){let t=i[e];t.addEventListener("keydown",e=>{27==e.keyCode?(e.preventDefault(),s(null)):13==e.keyCode&&(e.preventDefault(),s(t))}),t.addEventListener("submit",e=>{e.preventDefault(),s(t)})}let o=bA("div",n,bA("button",{onclick:()=>s(null),"aria-label":e.state.phrase("close"),class:"cm-dialog-close",type:"button"},["\xd7"]));function s(t){o.contains(o.ownerDocument.activeElement)&&e.focus(),r(t)}return t.class&&(o.className=t.class),o.classList.add("cm-dialog"),{dom:o,top:t.top,mount:()=>{if(t.focus){let e;(e="string"==typeof t.focus?n.querySelector(t.focus):n.querySelector("input")||n.querySelector("button"))&&"select"in e?e.select():e&&"focus"in e&&e.focus()}}}})(e,t,r),e.state.field(AN,!1)?e.dispatch({effects:A_.of(i)}):e.dispatch({effects:vq.appendConfig.of(AN.init(()=>[i]))}),{close:o=AL.of(i),result:n.then(t=>((e.win.queueMicrotask||(t=>e.win.setTimeout(t,10)))(()=>{e.state.field(AN).indexOf(i)>-1&&e.dispatch({effects:o})}),t))});return c.then(t=>{let r=t&&/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.elements.line.value);if(!r)return void e.dispatch({effects:l});let n=s.doc.lineAt(s.selection.main.head),[,i,o,a,c]=r,u=a?+a.slice(1):0,h=o?+o:n.number;if(o&&c){let e=h/100;i&&(e=e*("-"==i?-1:1)+n.number/s.doc.lines),h=Math.round(s.doc.lines*e)}else o&&i&&(h=h*("-"==i?-1:1)+n.number);let d=s.doc.line(Math.max(1,Math.min(s.doc.lines,h))),f=vv.cursor(d.from+Math.max(0,Math.min(u,d.length)));e.dispatch({effects:[l,k$.scrollIntoView(f.from,{y:"center"})],selection:f})}),!0}},{key:"Mod-d",run:({state:e,dispatch:t})=>{let{ranges:r}=e.selection;if(r.some(e=>e.from===e.to))return(({state:e,dispatch:t})=>{let{selection:r}=e,n=vv.create(r.ranges.map(t=>e.wordAt(t.head)||vv.cursor(t.head)),r.mainIndex);return!n.eq(r)&&(t(e.update({selection:n})),!0)})({state:e,dispatch:t});let n=e.sliceDoc(r[0].from,r[0].to);if(e.selection.ranges.some(t=>e.sliceDoc(t.from,t.to)!=n))return!1;let i=function(e,t){let{main:r,ranges:n}=e.selection,i=e.wordAt(r.head),o=i&&i.from==r.from&&i.to==r.to;for(let r=!1,i=new Ex(e.doc,t,n[n.length-1].to);;)if(i.next(),i.done){if(r)return null;i=new Ex(e.doc,t,0,Math.max(0,n[n.length-1].from-1)),r=!0}else{if(r&&n.some(e=>e.from==i.value.from))continue;if(o){let t=e.wordAt(i.value.from);if(!t||t.from!=i.value.from||t.to!=i.value.to)continue}return i.value}}(e,n);return!!i&&(t(e.update({selection:e.selection.addRange(vv.range(i.from,i.to),!1),effects:k$.scrollIntoView(i.to)})),!0)},preventDefault:!0}];class Oe{constructor(e){this.view=e;let t=this.query=e.state.field(Eq).query.spec;function r(e,t,r){return bA("button",{class:"cm-button",name:e,onclick:t,type:"button"},r)}this.commit=this.commit.bind(this),this.searchField=bA("input",{value:t.search,placeholder:Ot(e,"Find"),"aria-label":Ot(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=bA("input",{value:t.replace,placeholder:Ot(e,"Replace"),"aria-label":Ot(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=bA("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=bA("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=bA("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit}),this.dom=bA("div",{onkeydown:e=>this.keydown(e),class:"cm-search"},[this.searchField,r("next",()=>EZ(e),[Ot(e,"next")]),r("prev",()=>EQ(e),[Ot(e,"previous")]),r("select",()=>E0(e),[Ot(e,"all")]),bA("label",null,[this.caseField,Ot(e,"match case")]),bA("label",null,[this.reField,Ot(e,"regexp")]),bA("label",null,[this.wordField,Ot(e,"by word")]),...e.state.readOnly?[]:[bA("br"),this.replaceField,r("replace",()=>E1(e),[Ot(e,"replace")]),r("replaceAll",()=>E2(e),[Ot(e,"replace all")])],bA("button",{name:"close",onclick:()=>E8(e),"aria-label":Ot(e,"close"),type:"button"},["\xd7"])])}commit(){let e=new EN({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:EH.of(e)}))}keydown(e){var t;(t=this.view,kq(kV(t.state),e,t,"search-panel"))?e.preventDefault():13==e.keyCode&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?EQ:EZ)(this.view)):13==e.keyCode&&e.target==this.replaceField&&(e.preventDefault(),E1(this.view))}update(e){for(let t of e.transactions)for(let e of t.effects)e.is(EH)&&!e.value.eq(this.query)&&this.setQuery(e.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(ER).top}}function Ot(e,t){return e.state.phrase(t)}let Or=/[\s\.,:;?!]/;function On(e,{from:t,to:r}){let n=e.state.doc.lineAt(t),i=e.state.doc.lineAt(r).to,o=Math.max(n.from,t-30),s=Math.min(i,r+30),a=e.state.sliceDoc(o,s);if(o!=n.from){for(let e=0;e<30;e++)if(!Or.test(a[e+1])&&Or.test(a[e])){a=a.slice(e);break}}if(s!=i){for(let e=a.length-1;e>a.length-30;e--)if(!Or.test(a[e-1])&&Or.test(a[e])){a=a.slice(0,e);break}}return k$.announce.of(`${e.state.phrase("current match")}. ${a} ${e.state.phrase("on line")} ${n.number}.`)}let Oi=k$.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Oo=[Eq,vM.low(EY),Oi];class Os{constructor(e,t,r,n){this.state=e,this.pos=t,this.explicit=r,this.view=n,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=S1(this.state).resolveInner(this.pos,-1);for(;t&&0>e.indexOf(t.name);)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),r=Math.max(t.from,this.pos-250),n=t.text.slice(r-t.from,this.pos-t.from),i=n.search(Ou(e,!1));return i<0?null:{from:r+i,to:this.pos,text:n.slice(i)}}get aborted(){return null==this.abortListeners}addEventListener(e,t,r){"abort"==e&&this.abortListeners&&(this.abortListeners.push(t),r&&r.onDocChange&&(this.abortOnDocChange=!0))}}function Oa(e){let t=Object.keys(e).join(""),r=/\w/.test(t);return r&&(t=t.replace(/\w/g,"")),`[${r?"\\w":""}${t.replace(/[^\w\s]/g,"\\$&")}]`}class Ol{constructor(e,t,r,n){this.completion=e,this.source=t,this.match=r,this.score=n}}function Oc(e){return e.selection.main.from}function Ou(e,t){var r;let{source:n}=e,i=t&&"^"!=n[0],o="$"!=n[n.length-1];return i||o?RegExp(`${i?"^":""}(?:${n})${o?"$":""}`,null!=(r=e.flags)?r:e.ignoreCase?"i":""):e}let Oh=vV.define(),Od=new WeakMap;function Of(e){if(!Array.isArray(e))return e;let t=Od.get(e);return t||Od.set(e,t=function(e){let t=e.map(e=>"string"==typeof e?{label:e}:e),[r,n]=t.every(e=>/^\w+$/.test(e.label))?[/\w*$/,/\w+$/]:function(e){let t=Object.create(null),r=Object.create(null);for(let{label:n}of e){t[n[0]]=!0;for(let e=1;e<n.length;e++)r[n[e]]=!0}let n=Oa(t)+Oa(r)+"*$";return[RegExp("^"+n),new RegExp(n)]}(t);return e=>{let i=e.matchBefore(n);return i||e.explicit?{from:i?i.from:e.pos,options:t,validFor:r}:null}}(e)),t}let Op=vq.define(),Om=vq.define();class Og{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let r=vi(e,t),n=vs(r);this.chars.push(r);let i=e.slice(t,t+n),o=i.toUpperCase();this.folded.push(vi(o==i?i.toLowerCase():o,0)),t+=n}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(0==this.pattern.length)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:r,any:n,precise:i,byWord:o}=this;if(1==t.length){let n=vi(e,0),i=vs(n),o=i==e.length?0:-100;if(n==t[0]);else{if(n!=r[0])return null;o+=-200}return this.ret(o,[0,i])}let s=e.indexOf(this.pattern);if(0==s)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=t.length,l=0;if(s<0){for(let i=0,o=Math.min(e.length,200);i<o&&l<a;){let o=vi(e,i);(o==t[l]||o==r[l])&&(n[l++]=i),i+=vs(o)}if(l<a)return null}let c=0,u=0,h=!1,d=0,f=-1,p=-1,m=/[a-z]/.test(e),g=!0;for(let n=0,l=Math.min(e.length,200),y=0;n<l&&u<a;){let l=vi(e,n);s<0&&(c<a&&l==t[c]&&(i[c++]=n),d<a&&(l==t[d]||l==r[d]?(0==d&&(f=n),p=n+1,d++):d=0));let v,b=l<255?l>=48&&l<=57||l>=97&&l<=122?2:+(l>=65&&l<=90):(v=vo(l))!=v.toLowerCase()?1:2*(v!=v.toUpperCase());(!n||1==b&&m||0==y&&0!=b)&&(t[u]==l||r[u]==l&&(h=!0)?o[u++]=n:o.length&&(g=!1)),y=b,n+=vs(l)}return u==a&&0==o[0]&&g?this.result(-100+(h?-200:0),o,e):d==a&&0==f?this.ret(-200-e.length+(p==e.length?0:-100),[0,p]):s>-1?this.ret(-700-e.length,[s,s+this.pattern.length]):d==a?this.ret(-900-e.length,[f,p]):u==a?this.result(-100+(h?-200:0)+-700+(g?0:-1100),o,e):2==t.length?null:this.result((n[0]?-700:0)+-200+-1100,n,e)}result(e,t,r){let n=[],i=0;for(let e of t){let t=e+(this.astral?vs(vi(r,e)):1);i&&n[i-1]==e?n[i-1]=t:(n[i++]=e,n[i++]=t)}return this.ret(e-r.length,n)}}class Oy{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),r=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return null==r?null:(this.matched=[0,t.length],this.score=r+(e.length==this.pattern.length?0:-100),this)}}let Ov=vw.define({combine:e=>v1(e,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:Ox,filterStrict:!1,compareCompletions:(e,t)=>(e.sortText||e.label).localeCompare(t.sortText||t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>r=>Ob(e(r),t(r)),optionClass:(e,t)=>r=>Ob(e(r),t(r)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})});function Ob(e,t){return e?t?e+" "+t:e:t}function Ox(e,t,r,n,i,o){let s=e.textDirection==xo.RTL,a=s,l=!1,c="top",u,h,d=t.left-i.left,f=i.right-t.right,p=n.right-n.left,m=n.bottom-n.top;if(a&&d<Math.min(p,f)?a=!1:!a&&f<Math.min(p,d)&&(a=!0),p<=(a?d:f))u=Math.max(i.top,Math.min(r.top,i.bottom-m))-t.top,h=Math.min(400,a?d:f);else{l=!0,h=Math.min(400,(s?t.right:i.right-t.left)-30);let e=i.bottom-t.bottom;e>=m||e>t.top?u=r.bottom-t.top:(c="bottom",u=t.bottom-r.top)}let g=(t.bottom-t.top)/o.offsetHeight,y=(t.right-t.left)/o.offsetWidth;return{style:`${c}: ${u/g}px; max-width: ${h/y}px`,class:"cm-completionInfo-"+(l?s?"left-narrow":"right-narrow":a?"left":"right")}}function Ow(e,t,r){if(e<=r)return{from:0,to:e};if(t<0&&(t=0),t<=e>>1){let e=Math.floor(t/r);return{from:e*r,to:(e+1)*r}}let n=Math.floor((e-t)/r);return{from:e-(n+1)*r,to:e-n*r}}class Ok{constructor(e,t,r){this.view=e,this.stateField=t,this.applyCompletion=r,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:e=>this.placeInfo(e),key:this},this.space=null,this.currentClass="";let n=e.state.field(t),{options:i,selected:o}=n.open,s=e.state.facet(Ov);this.optionContent=function(e){let t=e.addToOptions.slice();return e.icons&&t.push({render(e){let t=document.createElement("div");return t.classList.add("cm-completionIcon"),e.type&&t.classList.add(...e.type.split(/\s+/g).map(e=>"cm-completionIcon-"+e)),t.setAttribute("aria-hidden","true"),t},position:20}),t.push({render(e,t,r,n){let i=document.createElement("span");i.className="cm-completionLabel";let o=e.displayLabel||e.label,s=0;for(let e=0;e<n.length;){let t=n[e++],r=n[e++];t>s&&i.appendChild(document.createTextNode(o.slice(s,t)));let a=i.appendChild(document.createElement("span"));a.appendChild(document.createTextNode(o.slice(t,r))),a.className="cm-completionMatchedText",s=r}return s<o.length&&i.appendChild(document.createTextNode(o.slice(s))),i},position:50},{render(e){if(!e.detail)return null;let t=document.createElement("span");return t.className="cm-completionDetail",t.textContent=e.detail,t},position:80}),t.sort((e,t)=>e.position-t.position).map(e=>e.render)}(s),this.optionClass=s.optionClass,this.tooltipClass=s.tooltipClass,this.range=Ow(i.length,o,s.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",r=>{let{options:n}=e.state.field(t).open;for(let t=r.target,i;t&&t!=this.dom;t=t.parentNode)if("LI"==t.nodeName&&(i=/-(\d+)$/.exec(t.id))&&+i[1]<n.length){this.applyCompletion(e,n[+i[1]]),r.preventDefault();return}}),this.dom.addEventListener("focusout",t=>{let r=e.state.field(this.stateField,!1);r&&r.tooltip&&e.state.facet(Ov).closeOnBlur&&t.relatedTarget!=e.contentDOM&&e.dispatch({effects:Om.of(null)})}),this.showOptions(i,n.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let r=e.state.field(this.stateField),n=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),r!=n){let{options:i,selected:o,disabled:s}=r.open;n.open&&n.open.options==i||(this.range=Ow(i.length,o,e.state.facet(Ov).maxRenderedOptions),this.showOptions(i,r.id)),this.updateSel(),s!=(null==(t=n.open)?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!s)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let e of this.currentClass.split(" "))e&&this.dom.classList.remove(e);for(let e of t.split(" "))e&&this.dom.classList.add(e);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;(t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=Ow(t.options.length,t.selected,this.view.state.facet(Ov).maxRenderedOptions),this.showOptions(t.options,e.id));let r=this.updateSelectedOption(t.selected);if(r){this.destroyInfo();let{completion:n}=t.options[t.selected],{info:i}=n;if(!i)return;let o="string"==typeof i?document.createTextNode(i):i(n);if(!o)return;"then"in o?o.then(t=>{t&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(t,n)}).catch(e=>xD(this.view.state,e,"completion info")):(this.addInfoPane(o,n),r.setAttribute("aria-describedby",this.info.id))}}addInfoPane(e,t){this.destroyInfo();let r=this.info=document.createElement("div");if(r.className="cm-tooltip cm-completionInfo",r.id="cm-completionInfo-"+Math.floor(65535*Math.random()).toString(16),null!=e.nodeType)r.appendChild(e),this.infoDestroy=null;else{let{dom:t,destroy:n}=e;r.appendChild(t),this.infoDestroy=n||null}this.dom.appendChild(r),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){var t,r;let n,i,o,s=null;for(let t=this.list.firstChild,r=this.range.from;t;t=t.nextSibling,r++)"LI"==t.nodeName&&t.id?r==e?t.hasAttribute("aria-selected")||(t.setAttribute("aria-selected","true"),s=t):t.hasAttribute("aria-selected")&&(t.removeAttribute("aria-selected"),t.removeAttribute("aria-describedby")):r--;return s&&(t=this.list,r=s,n=t.getBoundingClientRect(),i=r.getBoundingClientRect(),o=n.height/t.offsetHeight,i.top<n.top?t.scrollTop-=(n.top-i.top)/o:i.bottom>n.bottom&&(t.scrollTop+=(i.bottom-n.bottom)/o)),s}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),r=this.info.getBoundingClientRect(),n=e.getBoundingClientRect(),i=this.space;if(!i){let e=this.dom.ownerDocument.documentElement;i={left:0,top:0,right:e.clientWidth,bottom:e.clientHeight}}return n.top>Math.min(i.bottom,t.bottom)-10||n.bottom<Math.max(i.top,t.top)+10?null:this.view.state.facet(Ov).positionInfo(this.view,t,n,r,i,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,r){let n=document.createElement("ul");n.id=t,n.setAttribute("role","listbox"),n.setAttribute("aria-expanded","true"),n.setAttribute("aria-label",this.view.state.phrase("Completions")),n.addEventListener("mousedown",e=>{e.target==n&&e.preventDefault()});let i=null;for(let o=r.from;o<r.to;o++){let{completion:s,match:a}=e[o],{section:l}=s;if(l){let e="string"==typeof l?l:l.name;e!=i&&(o>r.from||0==r.from)&&(i=e,"string"!=typeof l&&l.header?n.appendChild(l.header(l)):n.appendChild(document.createElement("completion-section")).textContent=e)}let c=n.appendChild(document.createElement("li"));c.id=t+"-"+o,c.setAttribute("role","option");let u=this.optionClass(s);for(let e of(u&&(c.className=u),this.optionContent)){let t=e(s,this.view.state,this.view,a);t&&c.appendChild(t)}}return r.from&&n.classList.add("cm-completionListIncompleteTop"),r.to<e.length&&n.classList.add("cm-completionListIncompleteBottom"),n}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function OA(e){return 100*(e.boost||0)+10*!!e.apply+5*!!e.info+ +!!e.type}class OS{constructor(e,t,r,n,i,o){this.options=e,this.attrs=t,this.tooltip=r,this.timestamp=n,this.selected=i,this.disabled=o}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new OS(this.options,OO(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,r,n,i,o){if(n&&!o&&e.some(e=>e.isPending))return n.setDisabled();let s=function(e,t){let r=[],n=null,i=null,o=e=>{r.push(e);let{section:t}=e.completion;if(t){n||(n=[]);let e="string"==typeof t?t:t.name;n.some(t=>t.name==e)||n.push("string"==typeof t?{name:e}:t)}},s=t.facet(Ov);for(let n of e)if(n.hasResult()){let e=n.result.getMatch;if(!1===n.result.filter)for(let t of n.result.options)o(new Ol(t,n.source,e?e(t):[],1e9-r.length));else{let r=t.sliceDoc(n.from,n.to),a,l=s.filterStrict?new Oy(r):new Og(r);for(let t of n.result.options)if(a=l.match(t.label)){let r=t.displayLabel?e?e(t,a.matched):[]:a.matched,s=a.score+(t.boost||0);if(o(new Ol(t,n.source,r,s)),"object"==typeof t.section&&"dynamic"===t.section.rank){let{name:e}=t.section;i||(i=Object.create(null)),i[e]=Math.max(s,i[e]||-1e9)}}}}if(n){let e=Object.create(null),t=0;for(let r of n.sort((e,t)=>("dynamic"===e.rank&&"dynamic"===t.rank?i[t.name]-i[e.name]:0)||("number"==typeof e.rank?e.rank:1e9)-("number"==typeof t.rank?t.rank:1e9)||(e.name<t.name?-1:1)))t-=1e5,e[r.name]=t;for(let t of r){let{section:r}=t.completion;r&&(t.score+=e["string"==typeof r?r:r.name])}}let a=[],l=null,c=s.compareCompletions;for(let e of r.sort((e,t)=>t.score-e.score||c(e.completion,t.completion))){let t=e.completion;l&&l.label==t.label&&l.detail==t.detail&&(null==l.type||null==t.type||l.type==t.type)&&l.apply==t.apply&&l.boost==t.boost?OA(e.completion)>OA(l)&&(a[a.length-1]=e):a.push(e),l=e.completion}return a}(e,t);if(!s.length)return n&&e.some(e=>e.isPending)?n.setDisabled():null;let a=t.facet(Ov).selectOnOpen?0:-1;if(n&&n.selected!=a&&-1!=n.selected){let e=n.options[n.selected].completion;for(let t=0;t<s.length;t++)if(s[t].completion==e){a=t;break}}return new OS(s,OO(r,a),{pos:e.reduce((e,t)=>t.hasResult()?Math.min(e,t.from):e,1e8),create:O_,above:i.aboveCursor},n?n.timestamp:Date.now(),a,!1)}map(e){return new OS(this.options,this.attrs,{...this.tooltip,pos:e.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new OS(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class Oj{constructor(e,t,r){this.active=e,this.id=t,this.open=r}static start(){return new Oj(OM,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(e){let{state:t}=e,r=t.facet(Ov),n=(r.override||t.languageDataAt("autocomplete",Oc(t)).map(Of)).map(t=>(this.active.find(e=>e.source==t)||new OT(t,+!!this.active.some(e=>0!=e.state))).update(e,r));n.length==this.active.length&&n.every((e,t)=>e==this.active[t])&&(n=this.active);let i=this.open,o=e.effects.some(e=>e.is(O$));for(let s of(i&&e.docChanged&&(i=i.map(e.changes)),e.selection||n.some(t=>t.hasResult()&&e.changes.touchesRange(t.from,t.to))||!function(e,t){if(e==t)return!0;for(let r=0,n=0;;){for(;r<e.length&&!e[r].hasResult();)r++;for(;n<t.length&&!t[n].hasResult();)n++;let i=r==e.length,o=n==t.length;if(i||o)return i==o;if(e[r++].result!=t[n++].result)return!1}}(n,this.active)||o?i=OS.build(n,t,this.id,i,r,o):i&&i.disabled&&!n.some(e=>e.isPending)&&(i=null),!i&&n.every(e=>!e.isPending)&&n.some(e=>e.hasResult())&&(n=n.map(e=>e.hasResult()?new OT(e.source,0):e)),e.effects))s.is(OD)&&(i=i&&i.setSelected(s.value,this.id));return n==this.active&&i==this.open?this:new Oj(n,this.id,i)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?OC:OE}}let OC={"aria-autocomplete":"list"},OE={};function OO(e,t){let r={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":e};return t>-1&&(r["aria-activedescendant"]=e+"-"+t),r}let OM=[];function OP(e,t){if(e.isUserEvent("input.complete")){let r=e.annotation(Oh);if(r&&t.activateOnCompletion(r))return 12}let r=e.isUserEvent("input.type");return r&&t.activateOnTyping?5:r?1:e.isUserEvent("delete.backward")?2:e.selection?8:16*!!e.docChanged}class OT{constructor(e,t,r=!1){this.source=e,this.state=t,this.explicit=r}hasResult(){return!1}get isPending(){return 1==this.state}update(e,t){let r=OP(e,t),n=this;for(let t of((8&r||16&r&&this.touches(e))&&(n=new OT(n.source,0)),4&r&&0==n.state&&(n=new OT(this.source,1)),n=n.updateFor(e,r),e.effects))if(t.is(Op))n=new OT(n.source,1,t.value);else if(t.is(Om))n=new OT(n.source,0);else if(t.is(O$))for(let e of t.value)e.source==n.source&&(n=e);return n}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(Oc(e.state))}}class OI extends OT{constructor(e,t,r,n,i,o){super(e,3,t),this.limit=r,this.result=n,this.from=i,this.to=o}hasResult(){return!0}updateFor(e,t){var r;if(!(3&t))return this.map(e.changes);let n=this.result;n.map&&!e.changes.empty&&(n=n.map(n,e.changes));let i=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),s=Oc(e.state);if(s>o||!n||2&t&&(Oc(e.startState)==this.from||s<this.limit))return new OT(this.source,4&t?1:0);let a=e.changes.mapPos(this.limit);return!function(e,t,r,n){if(!e)return!1;let i=t.sliceDoc(r,n);return"function"==typeof e?e(i,r,n,t):Ou(e,!0).test(i)}(n.validFor,e.state,i,o)?n.update&&(n=n.update(n,i,o,new Os(e.state,s,!1)))?new OI(this.source,this.explicit,a,n,n.from,null!=(r=n.to)?r:Oc(e.state)):new OT(this.source,1,this.explicit):new OI(this.source,this.explicit,a,n,i,o)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new OI(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new OT(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}let O$=vq.define({map:(e,t)=>e.map(e=>e.map(t))}),OD=vq.define(),OR=vE.define({create:()=>Oj.start(),update:(e,t)=>e.update(t),provide:e=>[AA.from(e,e=>e.tooltip),k$.contentAttributes.from(e,e=>e.attrs)]});function ON(e,t){let r=t.completion.apply||t.completion.label,n=e.state.field(OR).active.find(e=>e.source==t.source);return n instanceof OI&&("string"==typeof r?e.dispatch({...function(e,t,r,n){let{main:i}=e.selection,o=r-i.from,s=n-i.from;return{...e.changeByRange(a=>{if(a!=i&&r!=n&&e.sliceDoc(a.from+o,a.from+s)!=e.sliceDoc(r,n))return{range:a};let l=e.toText(t);return{changes:{from:a.from+o,to:n==i.from?a.to:a.from+s,insert:l},range:vv.cursor(a.from+o+l.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}(e.state,r,n.from,n.to),annotations:Oh.of(t.completion)}):r(e,t.completion,n.from,n.to),!0)}let O_=e=>new Ok(e,OR,ON);function OL(e,t="option"){return r=>{let n=r.state.field(OR,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<r.state.facet(Ov).interactionDelay)return!1;let i=1,o;"page"==t&&(o=AO(r,n.open.tooltip))&&(i=Math.max(2,Math.floor(o.dom.offsetHeight/o.dom.querySelector("li").offsetHeight)-1));let{length:s}=n.open.options,a=n.open.selected>-1?n.open.selected+i*(e?1:-1):e?0:s-1;return a<0?a="page"==t?0:s-1:a>=s&&(a="page"==t?s-1:0),r.dispatch({effects:OD.of(a)}),!0}}let OF=e=>!!e.state.field(OR,!1)&&(e.dispatch({effects:Op.of(!0)}),!0);class OB{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}let Oz=xL.fromClass(class{constructor(e){for(let t of(this.view=e,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0,e.state.field(OR).active))t.isPending&&this.startQuery(t)}update(e){let t=e.state.field(OR),r=e.state.facet(Ov);if(!e.selectionSet&&!e.docChanged&&e.startState.field(OR)==t)return;let n=e.transactions.some(e=>{let t=OP(e,r);return 8&t||(e.selection||e.docChanged)&&!(3&t)});for(let t=0;t<this.running.length;t++){let r=this.running[t];if(n||r.context.abortOnDocChange&&e.docChanged||r.updates.length+e.transactions.length>50&&Date.now()-r.time>1e3){for(let e of r.context.abortListeners)try{e()}catch(e){xD(this.view.state,e)}r.context.abortListeners=null,this.running.splice(t--,1)}else r.updates.push(...e.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),e.transactions.some(e=>e.effects.some(e=>e.is(Op)))&&(this.pendingStart=!0);let i=this.pendingStart?50:r.activateOnTypingDelay;if(this.debounceUpdate=t.active.some(e=>e.isPending&&!this.running.some(t=>t.active.source==e.source))?setTimeout(()=>this.startUpdate(),i):-1,0!=this.composing)for(let t of e.transactions)t.isUserEvent("input.type")?this.composing=2:2==this.composing&&t.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:e}=this.view,t=e.field(OR);for(let e of t.active)e.isPending&&!this.running.some(t=>t.active.source==e.source)&&this.startQuery(e);this.running.length&&t.open&&t.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Ov).updateSyncTime))}startQuery(e){let{state:t}=this.view,r=Oc(t),n=new Os(t,r,e.explicit,this.view),i=new OB(e,n);this.running.push(i),Promise.resolve(e.source(n)).then(e=>{i.context.aborted||(i.done=e||null,this.scheduleAccept())},e=>{this.view.dispatch({effects:Om.of(null)}),xD(this.view.state,e)})}scheduleAccept(){this.running.every(e=>void 0!==e.done)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Ov).updateSyncTime))}accept(){var e;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let t=[],r=this.view.state.facet(Ov),n=this.view.state.field(OR);for(let i=0;i<this.running.length;i++){let o=this.running[i];if(void 0===o.done)continue;if(this.running.splice(i--,1),o.done){let n=Oc(o.updates.length?o.updates[0].startState:this.view.state),i=Math.min(n,o.done.from+ +!o.active.explicit),s=new OI(o.active.source,o.active.explicit,i,o.done,o.done.from,null!=(e=o.done.to)?e:n);for(let e of o.updates)s=s.update(e,r);if(s.hasResult()){t.push(s);continue}}let s=n.active.find(e=>e.source==o.active.source);if(s&&s.isPending)if(null==o.done){let e=new OT(o.active.source,0);for(let t of o.updates)e=e.update(t,r);e.isPending||t.push(e)}else this.startQuery(s)}(t.length||n.open&&n.open.disabled)&&this.view.dispatch({effects:O$.of(t)})}},{eventHandlers:{blur(e){let t=this.view.state.field(OR,!1);if(t&&t.tooltip&&this.view.state.facet(Ov).closeOnBlur){let r=t.open&&AO(this.view,t.open.tooltip);r&&r.dom.contains(e.relatedTarget)||setTimeout(()=>this.view.dispatch({effects:Om.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout(()=>this.view.dispatch({effects:Op.of(!1)}),20),this.composing=0}}}),OW="object"==typeof navigator&&/Win/.test(navigator.platform),OV=vM.highest(k$.domEventHandlers({keydown(e,t){let r=t.state.field(OR,!1);if(!r||!r.open||r.open.disabled||r.open.selected<0||e.key.length>1||e.ctrlKey&&!(OW&&e.altKey)||e.metaKey)return!1;let n=r.open.options[r.open.selected],i=r.active.find(e=>e.source==n.source),o=n.completion.commitCharacters||i.result.commitCharacters;return o&&o.indexOf(e.key)>-1&&ON(t,n),!1}})),OH=k$.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xb7\xb7\xb7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"'\uD835\uDC65'"}},".cm-completionIcon-constant":{"&:after":{content:"'\uD835\uDC36'"}},".cm-completionIcon-type":{"&:after":{content:"'\uD835\uDC61'"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"'\uD83D\uDD11'"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),OU={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Oq=vq.define({map(e,t){let r=t.mapPos(e,-1,vl.TrackAfter);return null==r?void 0:r}}),OK=new class extends v2{};OK.startSide=1,OK.endSide=-1;let OG=vE.define({create:()=>v9.empty,update(e,t){if(e=e.map(t.changes),t.selection){let r=t.state.doc.lineAt(t.selection.main.head);e=e.update({filter:e=>e>=r.from&&e<=r.to})}for(let r of t.effects)r.is(Oq)&&(e=e.update({add:[OK.range(r.value,r.value+1)]}));return e}}),OJ="()[]{}<>\xab\xbb\xbb\xab";function OY(e){for(let t=0;t<OJ.length;t+=2)if(OJ.charCodeAt(t)==e)return OJ.charAt(t+1);return vo(e<128?e:e+1)}function OX(e,t){return e.languageDataAt("closeBrackets",t)[0]||OU}let OZ="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),OQ=k$.inputHandler.of((e,t,r,n)=>{if((OZ?e.composing:e.compositionStarted)||e.state.readOnly)return!1;let i=e.state.selection.main;if(n.length>2||2==n.length&&1==vs(vi(n,0))||t!=i.from||r!=i.to)return!1;let o=function(e,t){let r=OX(e,e.selection.main.head),n=r.brackets||OU.brackets;for(let i of n){let o=OY(vi(i,0));if(t==i)return o==i?function(e,t,r,n){let i=n.stringPrefixes||OU.stringPrefixes,o=null,s=e.changeByRange(n=>{if(!n.empty)return{changes:[{insert:t,from:n.from},{insert:t,from:n.to}],effects:Oq.of(n.to+t.length),range:vv.range(n.anchor+t.length,n.head+t.length)};let s=n.head,a=O2(e.doc,s),l;if(a==t){if(O4(e,s))return{changes:{insert:t+t,from:s},effects:Oq.of(s+t.length),range:vv.cursor(s+t.length)};else if(O1(e,s)){let n=r&&e.sliceDoc(s,s+3*t.length)==t+t+t?t+t+t:t;return{changes:{from:s,to:s+n.length,insert:n},range:vv.cursor(s+n.length)}}}else if(r&&e.sliceDoc(s-2*t.length,s)==t+t&&(l=O3(e,s-2*t.length,i))>-1&&O4(e,l))return{changes:{insert:t+t+t+t,from:s},effects:Oq.of(s+t.length),range:vv.cursor(s+t.length)};else if(e.charCategorizer(s)(a)!=vZ.Word&&O3(e,s,i)>-1&&!function(e,t,r,n){let i=S1(e).resolveInner(t,-1),o=n.reduce((e,t)=>Math.max(e,t.length),0);for(let s=0;s<5;s++){let s=e.sliceDoc(i.from,Math.min(i.to,i.from+r.length+o)),a=s.indexOf(r);if(!a||a>-1&&n.indexOf(s.slice(0,a))>-1){let t=i.firstChild;for(;t&&t.from==i.from&&t.to-t.from>r.length+a;){if(e.sliceDoc(t.to-r.length,t.to)==r)return!1;t=t.firstChild}return!0}let l=i.to==t&&i.parent;if(!l)break;i=l}return!1}(e,s,t,i))return{changes:{insert:t+t,from:s},effects:Oq.of(s+t.length),range:vv.cursor(s+t.length)};return{range:o=n}});return o?null:e.update(s,{scrollIntoView:!0,userEvent:"input.type"})}(e,i,n.indexOf(i+i+i)>-1,r):function(e,t,r,n){let i=null,o=e.changeByRange(o=>{if(!o.empty)return{changes:[{insert:t,from:o.from},{insert:r,from:o.to}],effects:Oq.of(o.to+t.length),range:vv.range(o.anchor+t.length,o.head+t.length)};let s=O2(e.doc,o.head);return!s||/\s/.test(s)||n.indexOf(s)>-1?{changes:{insert:t+r,from:o.head},effects:Oq.of(o.head+t.length),range:vv.cursor(o.head+t.length)}:{range:i=o}});return i?null:e.update(o,{scrollIntoView:!0,userEvent:"input.type"})}(e,i,o,r.before||OU.before);if(t==o&&O1(e,e.selection.main.from))return function(e,t,r){let n=null,i=e.changeByRange(t=>t.empty&&O2(e.doc,t.head)==r?{changes:{from:t.head,to:t.head+r.length,insert:r},range:vv.cursor(t.head+r.length)}:n={range:t});return n?null:e.update(i,{scrollIntoView:!0,userEvent:"input.type"})}(e,0,o)}return null}(e.state,n);return!!o&&(e.dispatch(o),!0)}),O0=[{key:"Backspace",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let r=OX(e,e.selection.main.head).brackets||OU.brackets,n=null,i=e.changeByRange(t=>{if(t.empty){var i,o;let n,s=(i=e.doc,o=t.head,vs(vi(n=i.sliceString(o-2,o),0))==n.length?n:n.slice(1));for(let n of r)if(n==s&&O2(e.doc,t.head)==OY(vi(n,0)))return{changes:{from:t.head-n.length,to:t.head+n.length},range:vv.cursor(t.head-n.length)}}return{range:n=t}});return n||t(e.update(i,{scrollIntoView:!0,userEvent:"delete.backward"})),!n}}];function O1(e,t){let r=!1;return e.field(OG).between(0,e.doc.length,e=>{e==t&&(r=!0)}),r}function O2(e,t){let r=e.sliceString(t,t+2);return r.slice(0,vs(vi(r,0)))}function O4(e,t){let r=S1(e).resolveInner(t+1);return r.parent&&r.from==t}function O3(e,t,r){let n=e.charCategorizer(t);if(n(e.sliceDoc(t-1,t))!=vZ.Word)return t;for(let i of r){let r=t-i.length;if(e.sliceDoc(r,t)==i&&n(e.sliceDoc(r-1,r))!=vZ.Word)return r}return -1}let O5=[{key:"Ctrl-Space",run:OF},{mac:"Alt-`",run:OF},{mac:"Alt-i",run:OF},{key:"Escape",run:e=>{let t=e.state.field(OR,!1);return!!t&&!!t.active.some(e=>0!=e.state)&&(e.dispatch({effects:Om.of(null)}),!0)}},{key:"ArrowDown",run:OL(!0)},{key:"ArrowUp",run:OL(!1)},{key:"PageDown",run:OL(!0,"page")},{key:"PageUp",run:OL(!1,"page")},{key:"Enter",run:e=>{let t=e.state.field(OR,!1);return!(e.state.readOnly||!t||!t.open||t.open.selected<0||t.open.disabled||Date.now()-t.open.timestamp<e.state.facet(Ov).interactionDelay)&&ON(e,t.open.options[t.open.selected])}}],O6=vM.highest(kz.computeN([Ov],e=>e.facet(Ov).defaultKeymap?[O5]:[]));class O9{constructor(e,t,r){this.from=e,this.to=t,this.diagnostic=r}}class O8{constructor(e,t,r){this.diagnostics=e,this.panel=t,this.selected=r}static init(e,t,r){let n=r.facet(Ma).markerFilter;n&&(e=n(e,r));let i=e.slice().sort((e,t)=>e.from-t.from||e.to-t.to),o=new v8,s=[],a=0,l=r.doc.iter(),c=0,u=r.doc.length;for(let e=0;;){let t,r,n=e==i.length?null:i[e];if(!n&&!s.length)break;if(s.length)t=a,r=s.reduce((e,t)=>Math.min(e,t.to),n&&n.from>t?n.from:1e8);else{if((t=n.from)>u)break;r=n.to,s.push(n),e++}for(;e<i.length;){let n=i[e];if(n.from==t&&(n.to>n.from||n.to==t))s.push(n),e++,r=Math.min(n.to,r);else{r=Math.min(n.from,r);break}}r=Math.min(r,u);let h=!1;if(s.some(e=>e.from==t&&(e.to==r||r==u))&&!(h=t==r)&&r-t<10){let e=t-(c+l.value.length);e>0&&(l.next(e),c=t);for(let e=t;;){if(e>=r){h=!0;break}if(!l.lineBreak&&c+l.value.length>e)break;e=c+l.value.length,c+=l.value.length,l.next()}}let d=function(e){let t="hint",r=1;for(let i of e){var n;let e="error"==(n=i.severity)?4:"warning"==n?3:"info"==n?2:1;e>r&&(r=e,t=i.severity)}return t}(s);if(h)o.add(t,t,bW.widget({widget:new Mh(d),diagnostics:s.slice()}));else{let e=s.reduce((e,t)=>t.markClass?e+" "+t.markClass:e,"");o.add(t,r,bW.mark({class:"cm-lintRange cm-lintRange-"+d+e,diagnostics:s.slice(),inclusiveEnd:s.some(e=>e.to>r)}))}if((a=r)==u)break;for(let e=0;e<s.length;e++)s[e].to<=a&&s.splice(e--,1)}let h=o.finish();return new O8(h,t,O7(h))}}function O7(e,t=null,r=0){let n=null;return e.between(r,1e9,(e,r,{spec:i})=>{if(!(t&&0>i.diagnostics.indexOf(t)))if(n){if(0>i.diagnostics.indexOf(n.diagnostic))return!1;n=new O9(n.from,r,n.diagnostic)}else n=new O9(e,r,t||i.diagnostics[0])}),n}let Me=vq.define(),Mt=vq.define(),Mr=vq.define(),Mn=vE.define({create:()=>new O8(bW.none,null,null),update(e,t){if(t.docChanged&&e.diagnostics.size){let r=e.diagnostics.map(t.changes),n=null,i=e.panel;if(e.selected){let i=t.changes.mapPos(e.selected.from,1);n=O7(r,e.selected.diagnostic,i)||O7(r,null,i)}!r.size&&i&&t.state.facet(Ma).autoPanel&&(i=null),e=new O8(r,i,n)}for(let r of t.effects)if(r.is(Me)){let n=t.state.facet(Ma).autoPanel?r.value.length?Mf.open:null:e.panel;e=O8.init(r.value,n,t.state)}else r.is(Mt)?e=new O8(e.diagnostics,r.value?Mf.open:null,e.selected):r.is(Mr)&&(e=new O8(e.diagnostics,e.panel,r.value));return e},provide:e=>[AR.from(e,e=>e.panel),k$.decorations.from(e,e=>e.diagnostics)]}),Mi=bW.mark({class:"cm-lintRange cm-lintRange-active"}),Mo=e=>{let t=e.state.field(Mn,!1);return!!t&&!!t.panel&&(e.dispatch({effects:Mt.of(!1)}),!0)},Ms=[{key:"Mod-Shift-m",run:e=>{var t,r;let n=e.state.field(Mn,!1);n&&n.panel||e.dispatch({effects:(t=e.state,r=[Mt.of(!0)],t.field(Mn,!1)?r:r.concat(vq.appendConfig.of(Mg)))});let i=AT(e,Mf.open);return i&&i.dom.querySelector(".cm-panel-lint ul").focus(),!0},preventDefault:!0},{key:"F8",run:e=>{let t=e.state.field(Mn,!1);if(!t)return!1;let r=e.state.selection.main,n=t.diagnostics.iter(r.to+1);return(!!n.value||!!(n=t.diagnostics.iter(0)).value&&(n.from!=r.from||n.to!=r.to))&&(e.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)}}],Ma=vw.define({combine:e=>({sources:e.map(e=>e.source).filter(e=>null!=e),...v1(e.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:Ml,tooltipFilter:Ml,needsRefresh:(e,t)=>e?t?r=>e(r)||t(r):e:t,hideOn:(e,t)=>e?t?(r,n,i)=>e(r,n,i)||t(r,n,i):e:t,autoPanel:(e,t)=>e||t})})});function Ml(e,t){return e?t?(r,n)=>t(e(r,n),n):e:t}function Mc(e){let t=[];if(e)i:for(let{name:r}of e){for(let e=0;e<r.length;e++){let n=r[e];if(/[a-zA-Z]/.test(n)&&!t.some(e=>e.toLowerCase()==n.toLowerCase())){t.push(n);continue i}}t.push("")}return t}function Mu(e,t,r){var n;let i=r?Mc(t.actions):[];return bA("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},bA("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage(e):t.message),null==(n=t.actions)?void 0:n.map((r,n)=>{let o=!1,s=n=>{if(n.preventDefault(),o)return;o=!0;let i=O7(e.state.field(Mn).diagnostics,t);i&&r.apply(e,i.from,i.to)},{name:a}=r,l=i[n]?a.indexOf(i[n]):-1,c=l<0?a:[a.slice(0,l),bA("u",a.slice(l,l+1)),a.slice(l+1)];return bA("button",{type:"button",class:"cm-diagnosticAction"+(r.markClass?" "+r.markClass:""),onclick:s,onmousedown:s,"aria-label":` Action: ${a}${l<0?"":` (access key "${i[n]})"`}.`},c)}),t.source&&bA("div",{class:"cm-diagnosticSource"},t.source))}class Mh extends bB{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return bA("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class Md{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(0xffffffff*Math.random()).toString(16),this.dom=Mu(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Mf{constructor(e){this.view=e,this.items=[];let t=t=>{if(!t.ctrlKey&&!t.altKey&&!t.metaKey){if(27==t.keyCode)Mo(this.view),this.view.focus();else if(38==t.keyCode||33==t.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==t.keyCode||34==t.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==t.keyCode)this.moveSelection(0);else if(35==t.keyCode)this.moveSelection(this.items.length-1);else if(13==t.keyCode)this.view.focus();else{if(!(t.keyCode>=65)||!(t.keyCode<=90)||!(this.selectedIndex>=0))return;let{diagnostic:r}=this.items[this.selectedIndex],n=Mc(r.actions);for(let i=0;i<n.length;i++)if(n[i].toUpperCase().charCodeAt(0)==t.keyCode){let t=O7(this.view.state.field(Mn).diagnostics,r);t&&r.actions[i].apply(e,t.from,t.to)}}t.preventDefault()}},r=e=>{for(let t=0;t<this.items.length;t++)this.items[t].dom.contains(e.target)&&this.moveSelection(t)};this.list=bA("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:r}),this.dom=bA("div",{class:"cm-panel-lint"},this.list,bA("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Mo(this.view)},"\xd7")),this.update()}get selectedIndex(){let e=this.view.state.field(Mn).selected;if(!e)return -1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return -1}update(){let{diagnostics:e,selected:t}=this.view.state.field(Mn),r=0,n=!1,i=null,o=new Set;for(e.between(0,this.view.state.doc.length,(e,s,{spec:a})=>{for(let e of a.diagnostics){if(o.has(e))continue;o.add(e);let s=-1,a;for(let t=r;t<this.items.length;t++)if(this.items[t].diagnostic==e){s=t;break}s<0?(a=new Md(this.view,e),this.items.splice(r,0,a),n=!0):(a=this.items[s],s>r&&(this.items.splice(r,s-r),n=!0)),t&&a.diagnostic==t.diagnostic?a.dom.hasAttribute("aria-selected")||(a.dom.setAttribute("aria-selected","true"),i=a):a.dom.hasAttribute("aria-selected")&&a.dom.removeAttribute("aria-selected"),r++}});r<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)n=!0,this.items.pop();0==this.items.length&&(this.items.push(new Md(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),n=!0),i?(this.list.setAttribute("aria-activedescendant",i.id),this.view.requestMeasure({key:this,read:()=>({sel:i.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:e,panel:t})=>{let r=t.height/this.list.offsetHeight;e.top<t.top?this.list.scrollTop-=(t.top-e.top)/r:e.bottom>t.bottom&&(this.list.scrollTop+=(e.bottom-t.bottom)/r)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),n&&this.sync()}sync(){let e=this.list.firstChild;function t(){let t=e;e=t.nextSibling,t.remove()}for(let r of this.items)if(r.dom.parentNode==this.list){for(;e!=r.dom;)t();e=r.dom.nextSibling}else this.list.insertBefore(r.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=O7(this.view.state.field(Mn).diagnostics,this.items[e].diagnostic);t&&this.view.dispatch({selection:{anchor:t.from,head:t.to},scrollIntoView:!0,effects:Mr.of(t)})}static open(e){return new Mf(e)}}function Mp(e){return function(e,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(e)}</svg>')`}(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${e}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}let Mm=k$.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Mp("#d11")},".cm-lintRange-warning":{backgroundImage:Mp("orange")},".cm-lintRange-info":{backgroundImage:Mp("#999")},".cm-lintRange-hint":{backgroundImage:Mp("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),Mg=[Mn,k$.decorations.compute([Mn],e=>{let{selected:t,panel:r}=e.field(Mn);return t&&r&&t.from!=t.to?bW.set([Mi.range(t.from,t.to)]):bW.none}),function(e,t={}){let r=vq.define(),n=vE.define({create:()=>[],update(e,n){if(e.length&&(t.hideOnChange&&(n.docChanged||n.selection)?e=[]:t.hideOn&&(e=e.filter(e=>!t.hideOn(n,e))),n.docChanged)){let t=[];for(let r of e){let e=n.changes.mapPos(r.pos,-1,vl.TrackDel);if(null!=e){let i=Object.assign(Object.create(null),r);i.pos=e,null!=i.end&&(i.end=n.changes.mapPos(i.end)),t.push(i)}}e=t}for(let t of n.effects)t.is(r)&&(e=t.value),t.is(AM)&&(e=[]);return e},provide:e=>AS.from(e)});return{active:n,extension:[n,xL.define(i=>new AE(i,e,n,r,t.hoverTime||300)),AC]}}(function(e,t,r){let{diagnostics:n}=e.state.field(Mn),i,o=-1,s=-1;n.between(t-(r<0),t+ +(r>0),(e,n,{spec:a})=>{if(t>=e&&t<=n&&(e==n||(t>e||r>0)&&(t<n||r<0)))return i=a.diagnostics,o=e,s=n,!1});let a=e.state.facet(Ma).tooltipFilter;return(i&&a&&(i=a(i,e.state)),i)?{pos:o,end:s,above:e.state.doc.lineAt(o).to<s,create:()=>{var t;return{dom:(t=e,bA("ul",{class:"cm-tooltip-lint"},i.map(e=>Mu(t,e,!1))))}}}:null},{hideOn:function(e,t){let r=t.pos,n=t.end||r,i=e.state.facet(Ma).hideOn(e,r,n);if(null!=i)return i;let o=e.startState.doc.lineAt(t.pos);return!!(e.effects.some(e=>e.is(Me))||e.changes.touchesRange(o.from,Math.max(o.to,n)))}}),Mm];var My=function(e){let t;void 0===e&&(e={});var{crosshairCursor:r=!1}=e,n=[];!1!==e.closeBracketsKeymap&&(n=n.concat(O0)),!1!==e.defaultKeymap&&(n=n.concat(Ey)),!1!==e.searchKeymap&&(n=n.concat(E7)),!1!==e.historyKeymap&&(n=n.concat(CM)),!1!==e.foldKeymap&&(n=n.concat(jA)),!1!==e.completionKeymap&&(n=n.concat(O5)),!1!==e.lintKeymap&&(n=n.concat(Ms));var i=[];return!1!==e.lineNumbers&&i.push(function(e={}){return[A0.of(e),AU(),A4]}()),!1!==e.highlightActiveLineGutter&&i.push(A6),!1!==e.highlightSpecialChars&&i.push(function(e={}){return[Ai.of(e),Ao||(Ao=xL.fromClass(class{constructor(e){this.view=e,this.decorations=bW.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(e.state.facet(Ai)),this.decorations=this.decorator.createDeco(e)}makeDecorator(e){return new k7({regexp:e.specialChars,decoration:(t,r,n)=>{let{doc:i}=r.state,o=vi(t[0],0);if(9==o){let e=i.lineAt(n),t=r.state.tabSize,o=bc(e.text,t,n-e.from);return bW.replace({widget:new Aa((t-o%t)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[o]||(this.decorationCache[o]=bW.replace({widget:new As(e,o)}))},boundary:e.replaceTabs?void 0:/[^]/})}update(e){let t=e.state.facet(Ai);e.startState.facet(Ai)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(e.view)):this.decorations=this.decorator.updateDeco(e,this.decorations)}},{decorations:e=>e.decorations}))]}()),!1!==e.history&&i.push(function(e={}){return[Cm,Cp.of(e),k$.domEventHandlers({beforeinput(e,t){let r="historyUndo"==e.inputType?Cy:"historyRedo"==e.inputType?Cv:null;return!!r&&(e.preventDefault(),r(t))}})]}()),!1!==e.foldGutter&&i.push(function(e={}){var t;let r={...jP,...e},n=new jT(r,!0),i=new jT(r,!1),o=xL.fromClass(class{constructor(e){this.from=e.viewport.from,this.markers=this.buildMarkers(e)}update(e){(e.docChanged||e.viewportChanged||e.startState.facet(je)!=e.state.facet(je)||e.startState.field(jv,!1)!=e.state.field(jv,!1)||S1(e.startState)!=S1(e.state)||r.foldingChanged(e))&&(this.markers=this.buildMarkers(e.view))}buildMarkers(e){let t=new v8;for(let r of e.viewportLineBlocks){let o=jx(e.state,r.from,r.to)?i:jf(e.state,r.from,r.to)?n:null;o&&t.add(r.from,r.from,o)}return t.finish()}}),{domEventHandlers:s}=r;return[o,(t={class:"cm-foldGutter",markers(e){var t;return(null==(t=e.plugin(o))?void 0:t.markers)||v9.empty},initialSpacer:()=>new jT(r,!1),domEventHandlers:{...s,click:(e,t,r)=>{if(s.click&&s.click(e,t,r))return!0;let n=jx(e.state,t.from,t.to);if(n)return e.dispatch({effects:jg.of(n)}),!0;let i=jf(e.state,t.from,t.to);return!!i&&(e.dispatch({effects:jm.of(i)}),!0)}}},[AU(),AV.of({...AW,...t})]),jC()]}()),!1!==e.drawSelection&&i.push(function(e={}){return[kQ.of(e),k1,k4,k3,xM.of(!0)]}()),!1!==e.dropCursor&&i.push([k6,k9]),!1!==e.allowMultipleSelections&&i.push(v0.allowMultipleSelections.of(!0)),!1!==e.indentOnInput&&i.push(v0.transactionFilter.of(e=>{if(!e.docChanged||!e.isUserEvent("input.type")&&!e.isUserEvent("input.complete"))return e;let t=e.startState.languageDataAt("indentOnInput",e.startState.selection.main.head);if(!t.length)return e;let r=e.newDoc,{head:n}=e.newSelection.main,i=r.lineAt(n);if(n>i.from+200)return e;let o=r.sliceString(i.from,n);if(!t.some(e=>e.test(o)))return e;let{state:s}=e,a=-1,l=[];for(let{head:e}of s.selection.ranges){let t=s.doc.lineAt(e);if(t.from==a)continue;a=t.from;let r=jo(s,t.from);if(null==r)continue;let n=/^\s*/.exec(t.text)[0],i=ji(s,r);n!=i&&l.push({from:t.from,to:t.from+n.length,insert:i})}return l.length?[e,{changes:l,sequential:!0}]:e})),!1!==e.syntaxHighlighting&&i.push(j_(jF,{fallback:!0})),!1!==e.bracketMatching&&i.push(function(e={}){return[jW.of(e),jq]}()),!1!==e.closeBrackets&&i.push([OQ,OG]),!1!==e.autocompletion&&i.push(function(e={}){return[OV,OR,Ov.of(e),Oz,O6,OH]}()),!1!==e.rectangularSelection&&i.push((t=e=>e.altKey&&0==e.button,k$.mouseSelectionStyle.of((e,r)=>{let n,i;return t(r)?(n=Ah(e,r),i=e.state.selection,n?{update(e){if(e.docChanged){let t=e.changes.mapPos(e.startState.doc.line(n.line).from),r=e.state.doc.lineAt(t);n={line:r.number,col:n.col,off:Math.min(n.off,r.length)},i=i.map(e.changes)}},get(t,r,o){let s=Ah(e,t);if(!s)return i;let a=function(e,t,r){let n=Math.min(t.line,r.line),i=Math.max(t.line,r.line),o=[];if(t.off>2e3||r.off>2e3||t.col<0||r.col<0){let s=Math.min(t.off,r.off),a=Math.max(t.off,r.off);for(let t=n;t<=i;t++){let r=e.doc.line(t);r.length<=a&&o.push(vv.range(r.from+s,r.to+a))}}else{let s=Math.min(t.col,r.col),a=Math.max(t.col,r.col);for(let t=n;t<=i;t++){let r=e.doc.line(t),n=bu(r.text,s,e.tabSize,!0);if(n<0)o.push(vv.cursor(r.to));else{let t=bu(r.text,a,e.tabSize);o.push(vv.range(r.from+n,r.from+t))}}}return o}(e.state,n,s);return a.length?o?vv.create(a.concat(i.ranges)):vv.create(a):i}}:null):null}))),!1!==r&&i.push(function(e={}){let[t,r]=Ad[e.key||"Alt"],n=xL.fromClass(class{constructor(e){this.view=e,this.isDown=!1}set(e){this.isDown!=e&&(this.isDown=e,this.view.update([]))}},{eventObservers:{keydown(e){this.set(e.keyCode==t||r(e))},keyup(e){e.keyCode!=t&&r(e)||this.set(!1)},mousemove(e){this.set(r(e))}}});return[n,k$.contentAttributes.of(e=>{var t;return(null==(t=e.plugin(n))?void 0:t.isDown)?Af:null})]}()),!1!==e.highlightActiveLine&&i.push(Ac),!1!==e.highlightSelectionMatches&&i.push([ED,E$]),e.tabSize&&"number"==typeof e.tabSize&&i.push(jr.of(" ".repeat(e.tabSize))),i.concat([kz.of(n.flat())]).filter(Boolean)};let Mv="#e06c75",Mb="#abb2bf",Mx="#7d8799",Mw="#d19a66",Mk="#2c313a",MA="#282c34",MS="#353a42",Mj="#528bff",MC=[k$.theme({"&":{color:Mb,backgroundColor:MA},".cm-content":{caretColor:Mj},".cm-cursor, .cm-dropCursor":{borderLeftColor:Mj},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:"#3E4451"},".cm-panels":{backgroundColor:"#21252b",color:Mb},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:MA,color:Mx,border:"none"},".cm-activeLineGutter":{backgroundColor:Mk},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:MS},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:MS,borderBottomColor:MS},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:Mk,color:Mb}}},{dark:!0}),j_(j$.define([{tag:SY.keyword,color:"#c678dd"},{tag:[SY.name,SY.deleted,SY.character,SY.propertyName,SY.macroName],color:Mv},{tag:[SY.function(SY.variableName),SY.labelName],color:"#61afef"},{tag:[SY.color,SY.constant(SY.name),SY.standard(SY.name)],color:Mw},{tag:[SY.definition(SY.name),SY.separator],color:Mb},{tag:[SY.typeName,SY.className,SY.number,SY.changed,SY.annotation,SY.modifier,SY.self,SY.namespace],color:"#e5c07b"},{tag:[SY.operator,SY.operatorKeyword,SY.url,SY.escape,SY.regexp,SY.link,SY.special(SY.string)],color:"#56b6c2"},{tag:[SY.meta,SY.comment],color:Mx},{tag:SY.strong,fontWeight:"bold"},{tag:SY.emphasis,fontStyle:"italic"},{tag:SY.strikethrough,textDecoration:"line-through"},{tag:SY.link,color:Mx,textDecoration:"underline"},{tag:SY.heading,fontWeight:"bold",color:Mv},{tag:[SY.atom,SY.bool,SY.special(SY.variableName)],color:Mw},{tag:[SY.processingInstruction,SY.string,SY.inserted],color:"#98c379"},{tag:SY.invalid,color:"#ffffff"}]))];var ME=k$.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),MO=function(e){let t;void 0===e&&(e={});var{indentWithTab:r=!0,editable:n=!0,readOnly:i=!1,theme:o="light",placeholder:s="",basicSetup:a=!0}=e,l=[];switch(r&&l.unshift(kz.of([Ev])),a&&("boolean"==typeof a?l.unshift(My()):l.unshift(My(a))),s&&l.unshift((t=xL.fromClass(class{constructor(e){this.view=e,this.placeholder=s?bW.set([bW.widget({widget:new Au(s),side:1}).range(0)]):bW.none}get decorations(){return this.view.state.doc.length?bW.none:this.placeholder}},{decorations:e=>e.decorations}),"string"==typeof s?[t,k$.contentAttributes.of({"aria-placeholder":s})]:t)),o){case"light":l.push(ME);break;case"dark":l.push(MC);break;case"none":break;default:l.push(o)}return!1===n&&l.push(k$.editable.of(!1)),i&&l.push(v0.readOnly.of(!0)),[...l]};class MM{constructor(e,t){this.timeLeftMS=void 0,this.timeoutMS=void 0,this.isCancelled=!1,this.isTimeExhausted=!1,this.callbacks=[],this.timeLeftMS=t,this.timeoutMS=t,this.callbacks.push(e)}tick(){if(!this.isCancelled&&!this.isTimeExhausted&&(this.timeLeftMS--,this.timeLeftMS<=0)){this.isTimeExhausted=!0;var e=this.callbacks.slice();this.callbacks.length=0,e.forEach(e=>{try{e()}catch(e){console.error("TimeoutLatch callback error:",e)}})}}cancel(){this.isCancelled=!0,this.callbacks.length=0}reset(){this.timeLeftMS=this.timeoutMS,this.isCancelled=!1,this.isTimeExhausted=!1}get isDone(){return this.isCancelled||this.isTimeExhausted}}class MP{constructor(){this.interval=null,this.latches=new Set}add(e){this.latches.add(e),this.start()}remove(e){this.latches.delete(e),0===this.latches.size&&this.stop()}start(){null===this.interval&&(this.interval=setInterval(()=>{this.latches.forEach(e=>{e.tick(),e.isDone&&this.remove(e)})},1))}stop(){null!==this.interval&&(clearInterval(this.interval),this.interval=null)}}var MT=null,MI=vV.define(),M$=[],MD=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],MR=(0,tZ.forwardRef)((e,t)=>{var{className:r,value:n="",selection:i,extensions:o=[],onChange:s,onStatistics:a,onCreateEditor:l,onUpdate:c,autoFocus:u,theme:h="light",height:d,minHeight:f,maxHeight:p,width:m,minWidth:g,maxWidth:y,basicSetup:b,placeholder:x,indentWithTab:w,editable:k,readOnly:A,root:S,initialState:j}=e,C=(0,yG.A)(e,MD),E=(0,tZ.useRef)(null),{state:O,view:M,container:P,setContainer:T}=function(e){var{value:t,selection:r,onChange:n,onStatistics:i,onCreateEditor:o,onUpdate:s,extensions:a=M$,autoFocus:l,theme:c="light",height:u=null,minHeight:h=null,maxHeight:d=null,width:f=null,minWidth:p=null,maxWidth:m=null,placeholder:g="",editable:y=!0,readOnly:v=!1,indentWithTab:b=!0,basicSetup:x=!0,root:w,initialState:k}=e,[A,S]=(0,tZ.useState)(),[j,C]=(0,tZ.useState)(),[E,O]=(0,tZ.useState)(),M=(0,tZ.useState)(()=>({current:null}))[0],P=(0,tZ.useState)(()=>({current:null}))[0],T=k$.theme({"&":{height:u,minHeight:h,maxHeight:d,width:f,minWidth:p,maxWidth:m},"& .cm-scroller":{height:"100% !important"}}),I=[k$.updateListener.of(e=>{e.docChanged&&"function"==typeof n&&!e.transactions.some(e=>e.annotation(MI))&&(M.current?M.current.reset():(M.current=new MM(()=>{if(P.current){var e=P.current;P.current=null,e()}M.current=null},200),("u"<typeof window?new MP:(!MT&&(MT=new MP),MT)).add(M.current)),n(e.state.doc.toString(),e)),i&&i({line:e.state.doc.lineAt(e.state.selection.main.from),lineCount:e.state.doc.lines,lineBreak:e.state.lineBreak,length:e.state.doc.length,readOnly:e.state.readOnly,tabSize:e.state.tabSize,selection:e.state.selection,selectionAsSingle:e.state.selection.asSingle().main,ranges:e.state.selection.ranges,selectionCode:e.state.sliceDoc(e.state.selection.main.from,e.state.selection.main.to),selections:e.state.selection.ranges.map(t=>e.state.sliceDoc(t.from,t.to)),selectedText:e.state.selection.ranges.some(e=>!e.empty)})}),T,...MO({theme:c,editable:y,readOnly:v,placeholder:g,indentWithTab:b,basicSetup:x})];return s&&"function"==typeof s&&I.push(k$.updateListener.of(s)),I=I.concat(a),(0,tZ.useLayoutEffect)(()=>{if(A&&!E){var e={doc:t,selection:r,extensions:I},n=k?v0.fromJSON(k.json,e,k.fields):v0.create(e);if(O(n),!j){var i=new k$({state:n,parent:A,root:w});C(i),o&&o(i,n)}}return()=>{j&&(O(void 0),C(void 0))}},[A,E]),(0,tZ.useEffect)(()=>{e.container&&S(e.container)},[e.container]),(0,tZ.useEffect)(()=>()=>{j&&(j.destroy(),C(void 0)),M.current&&(M.current.cancel(),M.current=null)},[j]),(0,tZ.useEffect)(()=>{l&&j&&j.focus()},[l,j]),(0,tZ.useEffect)(()=>{j&&j.dispatch({effects:vq.reconfigure.of(I)})},[c,a,u,h,d,f,p,m,g,y,v,b,x,n,s]),(0,tZ.useEffect)(()=>{if(void 0!==t){var e=j?j.state.doc.toString():"";if(j&&t!==e){var r=M.current&&!M.current.isDone,n=()=>{j&&t!==j.state.doc.toString()&&j.dispatch({changes:{from:0,to:j.state.doc.toString().length,insert:t||""},annotations:[MI.of(!0)]})};r?P.current=n:n()}}},[t,j]),{state:E,setState:O,view:j,setView:C,container:A,setContainer:S}}({root:S,value:n,autoFocus:u,theme:h,height:d,minHeight:f,maxHeight:p,width:m,minWidth:g,maxWidth:y,basicSetup:b,placeholder:x,indentWithTab:w,editable:k,readOnly:A,selection:i,onChange:s,onStatistics:a,onCreateEditor:l,onUpdate:c,extensions:o,initialState:j});(0,tZ.useImperativeHandle)(t,()=>({editor:E.current,state:O,view:M}),[E,P,O,M]);var I=(0,tZ.useCallback)(e=>{E.current=e,T(e)},[T]);if("string"!=typeof n)throw Error("value must be typeof string but got "+typeof n);var $="string"==typeof h?"cm-theme-"+h:"cm-theme";return(0,v.jsx)("div",(0,yK.A)({ref:I,className:""+$+(r?" "+r:"")},C))});MR.displayName="CodeMirror";var MN=RegExp("\\b((true)|(false)|(on)|(off)|(yes)|(no))$","i");let M_={name:"yaml",token:function(e,t){var r=e.peek(),n=t.escaped;if(t.escaped=!1,"#"==r&&(0==e.pos||/\s/.test(e.string.charAt(e.pos-1))))return e.skipToEnd(),"comment";if(e.match(/^('([^']|\\.)*'?|"([^"]|\\.)*"?)/))return"string";if(t.literal&&e.indentation()>t.keyCol)return e.skipToEnd(),"string";if(t.literal&&(t.literal=!1),e.sol()){if(t.keyCol=0,t.pair=!1,t.pairStart=!1,e.match("---")||e.match("..."))return"def";if(e.match(/^\s*-\s+/))return"meta"}if(e.match(/^(\{|\}|\[|\])/))return"{"==r?t.inlinePairs++:"}"==r?t.inlinePairs--:"["==r?t.inlineList++:t.inlineList--,"meta";if(t.inlineList>0&&!n&&","==r)return e.next(),"meta";if(t.inlinePairs>0&&!n&&","==r)return t.keyCol=0,t.pair=!1,t.pairStart=!1,e.next(),"meta";if(t.pairStart){if(e.match(/^\s*(\||\>)\s*/))return t.literal=!0,"meta";if(e.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable";if(0==t.inlinePairs&&e.match(/^\s*-?[0-9\.\,]+\s?$/)||t.inlinePairs>0&&e.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(e.match(MN))return"keyword"}return!t.pair&&e.match(/^\s*(?:[,\[\]{}&*!|>'"%@`][^\s'":]|[^,\[\]{}#&*!|>'"%@`])[^#]*?(?=\s*:($|\s))/)?(t.pair=!0,t.keyCol=e.indentation(),"atom"):t.pair&&e.match(/^:\s*/)?(t.pairStart=!0,"meta"):(t.pairStart=!1,t.escaped="\\"==r,e.next(),null)},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}},languageData:{commentTokens:{line:"#"}}};var ML=r(48240);let MF=(0,tZ.createContext)(void 0);function MB(e){let t=p$(),r=(0,k.gf)(rC.z),{secrets:n}=(0,t9.Z)(),[i,o]=(0,tZ.useState)({results:[],selectedResult:void 0}),s=(0,tZ.useRef)(1),a=(0,tZ.useCallback)(e=>{o(t=>{let r=t.results.find(t=>t.id===e);return r===t.selectedResult?t:{results:t.results,selectedResult:r}})},[]),l=(0,tZ.useCallback)(e=>{o(t=>{let r=t.results.findIndex(t=>t.id===e);if(-1===r)return t;let n=t.results.slice(),[i]=n.splice(r,1);return{results:n,selectedResult:t.selectedResult?.id===i.id?n[0]:t.selectedResult}})},[]),c=(0,tZ.useCallback)(async e=>{if(!r.dryRun)throw Error("Scaffolder API does not support dry-run");let i=yq.Ay.parse(e.templateContent),{formState:a,secrets:l}=await t.run({formState:e.values,secrets:n,manifest:i?.spec}),c={...await r.dryRun({template:i,values:a,secrets:l,directoryContents:e.files.map(e=>({path:e.path,base64Content:function(e){if(e.length>65536)return window.btoa("<file too large>");try{return window.btoa(e)}catch{let t=new TextEncoder().encode(e),r=[];for(let e=0;e<t.length;e+=32768)r.push(String.fromCharCode(...t.slice(e,e+32768)));return window.btoa(r.join(""))}}(e.content)}))}),id:s.current++};o(e=>({results:[...e.results,c],selectedResult:e.selectedResult??c}))},[r,t,n]),u=(0,tZ.useMemo)(()=>({...i,selectResult:a,deleteResult:l,execute:c}),[i,a,l,c]);return(0,v.jsx)(MF.Provider,{value:u,children:e.children})}function Mz(){let e=(0,tZ.useContext)(MF);if(!e)throw Error("must be used within a DryRunProvider");return e}let MW=(0,rI.A)({containerWrapper:{width:"100%"}});class MV extends tZ.Component{state={shouldRender:!0};componentDidUpdate(e){e.invalidator!==this.props.invalidator&&this.setState({shouldRender:!0})}componentDidCatch(e){this.props.setErrorText(e.message),this.setState({shouldRender:!1})}render(){return this.state.shouldRender?this.props.children:null}}function MH(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function MU(e){let{content:t,contentIsSpec:r,onDryRun:n,setErrorText:i,fieldExtensions:o=[],layouts:s=[]}=e,a=MW(),l=(0,k.Q2)(),{t:c}=(0,rK.i)(nt.W),[u,h]=(0,tZ.useState)(),d=(0,tZ.useMemo)(()=>Object.fromEntries(o.map(({name:e,component:t})=>[e,t])),[o]);return(0,ML.A)(()=>{try{if(!t)return void h(void 0);let e=yq.Ay.parseAllDocuments(t).filter(e=>e).map(e=>e.toJSON())[0];if(!MH(e))return void h(void 0);let n=e;if(!r){if("template"!==String(e.kind).toLocaleLowerCase("en-US"))return void h(void 0);n=MH(e.spec)?e.spec:{}}let{parameters:s}=n;if(!Array.isArray(s)){i("Template parameters must be an array"),h(void 0);return}let a=Object.fromEntries(o.map(({name:e,validation:t})=>[e,t]));i(),h(s.flatMap(e=>MH(e)?[{title:String(e.title),schema:e,validate:pg(e,a,{apiHolder:l})}]:[]))}catch(e){i(e.message)}},250,[r,t,l]),(0,v.jsx)("div",{className:a.containerWrapper,children:u?(0,v.jsx)(ns.A,{variant:"outlined",children:(0,v.jsx)(MV,{invalidator:u,setErrorText:i,children:(0,v.jsx)(pj,{manifest:{steps:u,title:"Template Editor"},extensions:o,components:d,onCreate:async e=>{await n?.(e)},layouts:s,formProps:e.formProps})})}):(0,v.jsx)(rT.A,{variant:"body1",color:"textSecondary",children:c("templateEditorForm.stepper.emptyText")})})}MU.DirectoryEditorDryRun=function(e){let{setErrorText:t,fieldExtensions:r=[],layouts:n}=e,i=Mz(),o=gv(),{selectedFile:s}=o??{},a=async e=>{if(s)try{await i.execute({templateContent:s.content,values:e,files:o?.files??[]}),t()}catch(e){throw t(String(e.cause||e)),e}},l=s&&s.path.match(/\.ya?ml$/)?s.content:void 0;return o?(0,v.jsx)(MU,{onDryRun:a,fieldExtensions:r,setErrorText:t,content:l,layouts:n,formProps:e.formProps}):null};let Mq=(0,rI.A)(e=>({root:{gridArea:"pageContent",display:"grid",gridTemplateRows:"auto 1fr"},controls:{marginBottom:e.spacing(3)},code:{width:"100%"}}),{name:"ScaffolderCustomFieldExtensionsPlaygroud"}),MK=({fieldExtensions:e=[]})=>{let t=Mq(),{t:r}=(0,rK.i)(nt.W),n=e.filter(e=>!!e.schema),[i,o]=(0,tZ.useState)(Date.now()),[s,a]=(0,tZ.useState)({}),[l,c]=(0,tZ.useState)(n[0]),u=(0,tZ.useMemo)(()=>yq.Ay.stringify({parameters:[{title:`${l.name} Example`,properties:{[l.name]:{type:l.schema?.returnValue?.type,"ui:field":l.name,"ui:options":s}}}]}),[s,l]),h=(0,tZ.useMemo)(()=>Object.fromEntries(e.map(({name:e,component:t})=>[e,t])),[e]),d=(0,tZ.useCallback)(e=>{c(e),a({})},[a,c]),f=(0,tZ.useCallback)(e=>{a(e),o(Date.now())},[a,o]);return(0,v.jsxs)("main",{className:t.root,children:[(0,v.jsx)("div",{className:t.controls,children:(0,v.jsx)(rR.Ay,{id:"custom-fields-autocomplete",value:l,options:n,getOptionLabel:e=>e.name,renderInput:e=>(0,v.jsx)(rl.A,{...e,"aria-label":r("templateEditorPage.customFieldExplorer.selectFieldLabel"),placeholder:r("templateEditorPage.customFieldExplorer.selectFieldLabel"),variant:"outlined",InputProps:{...e.InputProps,startAdornment:(0,v.jsx)(rN.A,{position:"start",children:(0,v.jsx)(r_.default,{})})}}),onChange:(e,t)=>{t&&d(t)},disableClearable:!0,fullWidth:!0})}),(0,v.jsxs)("div",{children:[(0,v.jsxs)(rE.A,{defaultExpanded:!0,children:[(0,v.jsx)(rM.A,{expandIcon:(0,v.jsx)(r$.default,{}),"aria-controls":"panel-code-content",id:"panel-code-header",children:(0,v.jsx)(rT.A,{variant:"h6",children:r("templateEditorPage.customFieldExplorer.preview.title")})}),(0,v.jsx)(rO.A,{children:(0,v.jsx)("div",{className:t.code,children:(0,v.jsx)(MR,{readOnly:!0,theme:"dark",height:"100%",width:"100%",extensions:[j1.define(M_)],value:u})})})]}),(0,v.jsxs)(rE.A,{defaultExpanded:!0,children:[(0,v.jsx)(rM.A,{expandIcon:(0,v.jsx)(r$.default,{}),"aria-controls":"panel-preview-content",id:"panel-preview-header",children:(0,v.jsx)(rT.A,{variant:"h6",children:r("templateEditorPage.customFieldExplorer.fieldPreview.title")})}),(0,v.jsx)(rO.A,{children:(0,v.jsx)(MU,{content:u,contentIsSpec:!0,fieldExtensions:e,setErrorText:()=>null},i)})]}),(0,v.jsxs)(rE.A,{defaultExpanded:!0,children:[(0,v.jsx)(rM.A,{expandIcon:(0,v.jsx)(r$.default,{}),"aria-controls":"panel-options-content",id:"panel-options-header",children:(0,v.jsx)(rT.A,{variant:"h6",children:r("templateEditorPage.customFieldExplorer.fieldForm.title")})}),(0,v.jsx)(rO.A,{children:(0,v.jsx)(pl,{showErrorList:!1,fields:{...h},noHtml5Validate:!0,formData:s,formContext:{fieldFormState:s},onSubmit:e=>f(e.formData),validator:u$,schema:l.schema?.uiOptions||{},experimental_defaultFormStateBehavior:{allOf:"populateDefaults"},children:(0,v.jsx)(iB.A,{variant:"contained",color:"primary",type:"submit",disabled:!l.schema?.uiOptions,children:r("templateEditorPage.customFieldExplorer.fieldForm.applyButtonTitle")})})})]})]})]})};var MG=r(38605),MJ=r(74953),MY=r(27062),MX=r(65859);let MZ=["filter","function","value"],MQ=e=>`${e.kind}_${e.name}`;function M0(e){return"object"==typeof e}function M1(e){let t=e=>t=>e in t&&Object.keys(t).every(t=>t.startsWith("$")||t===e);if(M0(e)&&t("anyOf")(e)&&e.anyOf?.length===2){let r=e.anyOf[0];if(M0(r)&&t("not")(r)){let t=r.not;if(M0(t)&&!Object.keys(t).length)return[e.anyOf[1],!1]}}return[e,!0]}let M2=({t:e,classes:t,name:r,filter:n})=>{let i=(0,tZ.useState)({});if(!Object.keys(n).length)return(0,v.jsx)(rT.A,{style:{fontStyle:"italic"},children:e("templatingExtensions.content.filters.metadataAbsent")});let o=n.schema,s={classes:t,expanded:i,headings:[(0,v.jsx)(rT.A,{variant:"h6",component:"h4"})]};return(0,v.jsxs)(tZ.Fragment,{children:[n.description&&(0,v.jsx)(rV.h,{content:n.description}),(0,v.jsxs)(rP.A,{pb:2,children:[(0,v.jsx)(rT.A,{variant:"h5",component:"h3",children:e("templatingExtensions.content.filters.schema.input")}),(0,v.jsx)(nP,{strategy:"root",context:{parentId:`${r}.input`,...s},schema:o?.input??{}})]}),o?.arguments?.length&&(0,v.jsxs)(rP.A,{pb:2,children:[(0,v.jsx)(rT.A,{variant:"h5",component:"h3",children:e("templatingExtensions.content.filters.schema.arguments")}),o.arguments.map((e,n)=>{let[i,o]=M1(e);return(0,v.jsxs)(tZ.Fragment,{children:[(0,v.jsx)("div",{className:ny()({[t.argRequired]:o}),children:(0,v.jsx)(rT.A,{variant:"h6",component:"h4",children:`[${n}]`})}),(0,v.jsx)(nP,{strategy:"root",context:{parentId:`${r}.arg${n}`,...s,headings:[(0,v.jsx)(rT.A,{variant:"h6",component:"h5"})]},schema:i})]},n)})]},`${r}.args`),(0,v.jsxs)(rP.A,{pb:2,children:[(0,v.jsx)(rT.A,{variant:"h5",component:"h3",children:e("templatingExtensions.content.filters.schema.output")}),(0,v.jsx)(nP,{strategy:"root",context:{parentId:`${r}.output`,...s},schema:o?.output??{}})]}),n.examples&&(0,v.jsxs)(rE.A,{children:[(0,v.jsx)(rM.A,{expandIcon:(0,v.jsx)(r$.default,{}),children:(0,v.jsx)(rT.A,{variant:"h5",component:"h3",children:e("templatingExtensions.content.filters.examples")})}),(0,v.jsx)(rO.A,{children:(0,v.jsx)(rP.A,{pb:2,children:(0,v.jsx)(n$,{examples:n.examples})})})]})]},`${r}.detail`)},M4=({t:e,classes:t,filters:r,baseLink:n,selectedItem:i})=>i&&"filter"!==i.kind?(0,v.jsx)(v.Fragment,{}):Object.keys(r).length?(0,v.jsx)("div",{"data-testid":"filters",children:Object.entries(i?{[i.name]:r[i.name]}:r).map(([r,i])=>{let o=MQ({kind:"filter",name:r});return(0,v.jsxs)(rP.A,{pb:4,"data-testid":r,children:[(0,v.jsx)(rT.A,{id:o,variant:"h4",component:"h2",className:t.code,children:r}),(0,tZ.cloneElement)(n,{to:`${n.props.to}#${o}`}),(0,v.jsx)(M2,{t:e,classes:t,name:r,filter:i})]},r)})}):(0,v.jsx)("div",{"data-testid":"no-filters",children:e("templatingExtensions.content.filters.notAvailable")}),M3=({classes:e,name:t,fn:r,t:n})=>{let i=(0,tZ.useState)({});if(!Object.keys(r).length)return(0,v.jsx)(rT.A,{style:{fontStyle:"italic"},"data-testid":`${t}.metadataAbsent`,children:n("templatingExtensions.content.functions.metadataAbsent")});let o=r.schema,s={classes:e,expanded:i,headings:[(0,v.jsx)(rT.A,{variant:"h6",component:"h4"})]};return(0,v.jsxs)(tZ.Fragment,{children:[r.description&&(0,v.jsx)(rV.h,{content:r.description}),o?.arguments?.length&&(0,v.jsxs)(rP.A,{pb:2,children:[(0,v.jsx)(rT.A,{variant:"h5",component:"h3",children:n("templatingExtensions.content.functions.schema.arguments")}),o.arguments.map((r,n)=>{let[i,o]=M1(r);return(0,v.jsxs)(tZ.Fragment,{children:[(0,v.jsx)("div",{className:ny()({[e.argRequired]:o}),children:(0,v.jsx)(rT.A,{variant:"h6",component:"h4",children:`[${n}]`})}),(0,v.jsx)(nP,{strategy:"root",context:{parentId:`${t}.arg${n}`,...s,headings:[(0,v.jsx)(rT.A,{variant:"h6",component:"h5"})]},schema:i})]},n)})]},`${t}.args`),(0,v.jsxs)(rP.A,{pb:2,children:[(0,v.jsx)(rT.A,{variant:"h5",component:"h3",children:n("templatingExtensions.content.functions.schema.output")}),(0,v.jsx)(nP,{strategy:"root",context:{parentId:`${t}.output`,...s},schema:o?.output??{}})]}),r.examples&&(0,v.jsxs)(rE.A,{children:[(0,v.jsx)(rM.A,{expandIcon:(0,v.jsx)(r$.default,{}),children:(0,v.jsx)(rT.A,{variant:"h5",component:"h3",children:n("templatingExtensions.content.functions.examples")})}),(0,v.jsx)(rO.A,{children:(0,v.jsx)(rP.A,{pb:2,children:(0,v.jsx)(n$,{examples:r.examples})})})]})]},`${t}.detail`)},M5=({classes:e,functions:t,t:r,baseLink:n,selectedItem:i})=>i&&"function"!==i.kind?(0,v.jsx)(v.Fragment,{}):Object.keys(t).length?(0,v.jsx)("div",{"data-testid":"functions",children:Object.entries(i?{[i.name]:t[i.name]}:t).map(([t,i])=>{let o=MQ({kind:"function",name:t});return(0,v.jsxs)(rP.A,{pb:4,"data-testid":t,children:[(0,v.jsx)(rT.A,{id:o,variant:"h4",component:"h2",className:e.code,children:t}),(0,tZ.cloneElement)(n,{to:`${n.props.to}#${o}`}),(0,v.jsx)(M3,{classes:e,name:t,fn:i,t:r})]},t)})}):(0,v.jsx)("div",{"data-testid":"no-functions",children:r("templatingExtensions.content.functions.notAvailable")}),M6=({classes:e,t,values:r,baseLink:n,selectedItem:i})=>i&&"value"!==i.kind?(0,v.jsx)(v.Fragment,{}):Object.keys(r).length?(0,v.jsx)("div",{"data-testid":"values",children:Object.entries(i?{[i.name]:r[i.name]}:r).map(([t,r])=>{let i=MQ({kind:"value",name:t});return(0,v.jsxs)(rP.A,{pb:4,"data-testid":t,children:[(0,v.jsx)(rT.A,{id:i,variant:"h4",component:"h2",className:e.code,children:t}),(0,tZ.cloneElement)(n,{to:`${n.props.to}#${i}`}),r.description&&(0,v.jsx)(rV.h,{content:r.description}),(0,v.jsx)(rP.A,{padding:1,"data-testid":`${t}.value`,children:(0,v.jsx)(nT.z,{text:JSON.stringify(r.value,null,2),showCopyCodeButton:!0,language:"json"})})]},t)})}):(0,v.jsx)("div",{"data-testid":"no-values",children:t("templatingExtensions.content.values.notAvailable")}),M9=(0,rI.A)(e=>({code:{fontFamily:"Menlo, monospace",padding:e.spacing(1),backgroundColor:"dark"===e.palette.type?e.palette.grey[700]:e.palette.grey[300],display:"inline-block",borderRadius:5,border:`1px solid ${e.palette.grey[500]}`,position:"relative"},codeRequired:{"&::after":{position:"absolute",content:'"*"',top:0,right:e.spacing(.5),fontWeight:"bolder",color:e.palette.error.light}},argRequired:{position:"relative","& > *":{display:"inline",position:"relative","&::after":{position:"absolute",content:'"*"',top:0,right:e.spacing(-1),fontWeight:"bolder",color:e.palette.error.light}}},link:{paddingLeft:e.spacing(1),cursor:"pointer"},tabs:{display:"block",minHeight:"initial",overflow:"initial"}})),M8=({linkLocal:e})=>{let t,r=(0,k.gf)(rC.z),n=M9(),{t:i}=(0,rK.i)(nt.W),{loading:o,value:s,error:a}=(0,rj.A)(async()=>r.listTemplatingExtensions?r.listTemplatingExtensions():(console.warn("listTemplatingExtensions is not implemented in the scaffolderApi; please make sure to implement this method."),Promise.resolve({filters:{},globals:{functions:{},values:{}}})),[r]),[l,c]=(0,tZ.useState)("filter"),[u,h]=(0,tZ.useState)(null),[d,f]=(0,tZ.useState)("");(0,tZ.useEffect)(()=>{if(s&&window.location.hash)try{c((e=>{let[t,r]=e.split("_",2);if(MZ.includes(t))return{kind:t,name:r};throw Error(e)})(window.location.hash.substring(1)).kind),document.querySelector(window.location.hash)?.scrollIntoView()}catch(e){}},[s]);let p=(0,tZ.useMemo)(()=>({filter:{icon:(0,v.jsx)(MX.default,{}),label:i("templatingExtensions.content.filters.title")},function:{icon:(0,v.jsx)(r3.default,{}),label:i("templatingExtensions.content.functions.title")},value:{icon:(0,v.jsx)(MY.default,{}),label:i("templatingExtensions.content.values.title")}}),[i]),m=(0,rL.S)(rS.SE);if(o)return(0,v.jsx)(rF.k,{});if(a||!s)return(0,v.jsxs)("div",{"data-testid":"empty",children:[a&&(0,v.jsx)(rB.b,{error:a}),(0,v.jsx)(rz.p,{missing:"info",title:i("templatingExtensions.content.emptyState.title"),description:i("templatingExtensions.content.emptyState.description")})]});let{filters:g,globals:y}=s,b=(0,v.jsx)(rW.N_,{className:n.link,to:m(),...e?{}:{target:"_blank",rel:"noopener noreferrer"},children:(0,v.jsx)(rD.default,{})});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(rR.Ay,{renderInput:e=>(0,v.jsx)(rl.A,{...e,"aria-label":i("templatingExtensions.content.searchFieldPlaceholder"),placeholder:i("templatingExtensions.content.searchFieldPlaceholder"),variant:"outlined",InputProps:{...e.InputProps,startAdornment:(0,v.jsx)(rN.A,{position:"start",children:(0,v.jsx)(r_.default,{})})}}),getOptionLabel:e=>e.name,getOptionSelected:(e,t)=>e===t,options:[...(t=(e,t)=>t?Object.keys(t).map(t=>({kind:e,name:t})):[])("filter",s.filters),...t("function",s.globals?.functions),...t("value",s.globals?.values)],groupBy:e=>e.kind,renderGroup:e=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(rP.A,{display:"flex",alignItems:"center",children:[p[e.group].icon,(0,v.jsx)(rP.A,{sx:{ml:1},children:p[e.group].label})]}),(0,v.jsx)("ul",{children:e.children})]}),renderOption:e=>(0,v.jsx)(rY.A,{primary:e.name}),onChange:(e,t)=>{h(t),t&&c(t.kind)},inputValue:d,onInputChange:(e,t)=>f(t),loading:o,fullWidth:!0,clearOnEscape:!0}),(0,v.jsx)(MJ.A,{value:l,onChange:(e,t)=>{u?.kind!==t&&(h(null),f("")),c(t)},centered:!0,className:n.tabs,children:Object.entries(p).map(([e,t])=>(0,v.jsx)(MG.A,{value:e,...t},e))}),"filter"===l&&(0,v.jsx)(M4,{baseLink:b,t:i,classes:n,filters:g,selectedItem:u}),"function"===l&&(0,v.jsx)(M5,{functions:y.functions,...{baseLink:b,t:i,classes:n,selectedItem:u}}),"value"===l&&(0,v.jsx)(M6,{values:y.values,...{baseLink:b,t:i,classes:n,selectedItem:u}})]})},M7=e=>{let t=(0,b.Zp)(),r=(0,rL.S)(rS.Dg),n=(0,rL.S)(rS.JX),i=(0,rL.S)(rS.rQ),o=(0,rL.S)(rS.GF),s={onEditorClicked:e?.contextMenu?.editor!==!1?()=>t(r()):void 0,onActionsClicked:e?.contextMenu?.actions!==!1?()=>t(o()):void 0,onTasksClicked:e?.contextMenu?.tasks!==!1?()=>t(n()):void 0,onCreateClicked:e?.contextMenu?.create!==!1?()=>t(i()):void 0,onTemplatingExtensionsClicked:void 0},{t:a}=(0,rK.i)(nt.W);return(0,v.jsxs)(rH.Y,{themeId:"home",children:[(0,v.jsx)(rU.Y,{pageTitleOverride:a("templatingExtensions.pageTitle"),title:a("templatingExtensions.title"),subtitle:a("templatingExtensions.subtitle"),children:(0,v.jsx)(ne,{...s})}),(0,v.jsx)(rq.U,{children:(0,v.jsx)(M8,{linkLocal:!0})})]})},Pe=(0,rI.A)(e=>({paper:{width:"90%",padding:e.spacing(2),backgroundColor:e.palette.background.default,[e.breakpoints.up("sm")]:{width:"70%"},[e.breakpoints.up("md")]:{width:"50%"}},appbar:{zIndex:1},toolbar:{display:"grid",gridTemplateColumns:"auto 1fr",gridGap:e.spacing(1),padding:e.spacing(0,1),backgroundColor:e.palette.background.paper},toolbarCustomActions:{display:"grid",alignItems:"center",gridAutoFlow:"Column",gridGap:e.spacing(1)},toolbarDefaultActions:{justifySelf:"end"}}),{name:"ScaffolderTemplateEditorToolbar"});function Pt(e){let{children:t,fieldExtensions:r}=e,n=Pe(),{t:i}=(0,rK.i)(nt.W),[o,s]=(0,tZ.useState)(!1),[a,l]=(0,tZ.useState)(!1),[c,u]=(0,tZ.useState)(!1),[h,d]=(0,tZ.useState)(!1);return(0,v.jsx)(yN.A,{className:n.appbar,position:"relative",children:(0,v.jsxs)(y_.A,{className:n.toolbar,children:[(0,v.jsx)("div",{className:n.toolbarCustomActions,children:t}),(0,v.jsxs)(yL.A,{className:n.toolbarDefaultActions,variant:"text",children:[(0,v.jsx)(nf.Ay,{title:i("templateEditorToolbar.customFieldExplorerTooltip"),children:(0,v.jsx)(iB.A,{onClick:()=>s(!0),children:(0,v.jsx)(yU.default,{})})}),(0,v.jsx)(nf.Ay,{title:i("templateEditorToolbar.installedActionsDocumentationTooltip"),children:(0,v.jsx)(iB.A,{onClick:()=>l(!0),children:(0,v.jsx)(r1.default,{})})}),(0,v.jsx)(nf.Ay,{title:i("templateEditorToolbar.templatingExtensionsDocumentationTooltip"),children:(0,v.jsx)(iB.A,{onClick:()=>u(!0),children:(0,v.jsx)(r3.default,{})})}),(0,v.jsx)(iB.A,{onClick:()=>d(!0),children:i("templateEditorToolbar.addToCatalogButton")})]}),(0,v.jsx)(yF.Ay,{classes:{paper:n.paper},anchor:"right",open:o,onClose:()=>s(!1),children:(0,v.jsx)(MK,{fieldExtensions:r})}),(0,v.jsx)(yF.Ay,{classes:{paper:n.paper},anchor:"right",open:a,onClose:()=>l(!1),children:(0,v.jsx)(nR,{})}),(0,v.jsx)(yF.Ay,{classes:{paper:n.paper},anchor:"right",open:c,onClose:()=>u(!1),children:(0,v.jsx)(M8,{})}),(0,v.jsxs)(yB.A,{onClose:()=>d(!1),open:h,"aria-labelledby":"publish-dialog-title","aria-describedby":"publish-dialog-description",children:[(0,v.jsx)(yz.A,{id:"publish-dialog-title",children:i("templateEditorToolbar.addToCatalogDialogTitle")}),(0,v.jsx)(yW.A,{dividers:!0,children:(0,v.jsxs)(yV.A,{id:"publish-dialog-slide-description",children:[i("templateEditorToolbar.addToCatalogDialogContent.stepsIntroduction"),(0,v.jsx)("ul",{children:i("templateEditorToolbar.addToCatalogDialogContent.stepsListItems").split("\n").map((e,t)=>(0,v.jsx)("li",{children:e},t))})]})}),(0,v.jsx)(yH.A,{children:(0,v.jsx)(iB.A,{color:"primary",href:i("templateEditorToolbar.addToCatalogDialogActions.documentationUrl"),target:"_blank",children:i("templateEditorToolbar.addToCatalogDialogActions.documentationButton")})})]})]})})}var Pr=r(37757);function Pn(e){let{onOpenDirectory:t,onCreateDirectory:r,onCloseDirectory:n}=e,{t:i}=(0,rK.i)(nt.W),[o,s]=(0,tZ.useState)(null),a=(0,tZ.useCallback)(e=>{s(e.currentTarget)},[s]),l=(0,tZ.useCallback)(()=>{s(null)},[s]),c=(0,tZ.useCallback)(()=>{l(),t?.()},[l,t]),u=(0,tZ.useCallback)(()=>{l(),r?.()},[l,r]),h=(0,tZ.useCallback)(()=>{l(),n?.()},[l,n]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(iB.A,{"aria-controls":"file-menu","aria-haspopup":"true",onClick:a,children:i("templateEditorToolbarFileMenu.button")}),(0,v.jsxs)(Pr.A,{id:"file-menu",anchorEl:o,open:!!o,onClose:l,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:[(0,v.jsx)(rX.A,{onClick:c,disabled:!t,children:i("templateEditorToolbarFileMenu.options.openDirectory")}),(0,v.jsx)(rX.A,{onClick:u,disabled:!r,divider:!0,children:i("templateEditorToolbarFileMenu.options.createDirectory")}),(0,v.jsx)(rX.A,{onClick:h,disabled:!n,children:i("templateEditorToolbarFileMenu.options.closeEditor")})]})]})}var Pi=r(32881),Po=r(87629),Ps=r(71108),Pa=r(1400),Pl=r(39850),Pc=r(57384),Pu=r(45065),Ph=tZ.createContext({}),Pd=function(e,t,r){for(var n=t;n<e.length;n+=1)if(r===e[n])return n;return -1},Pf=[],Pp=[],Pm=tZ.forwardRef(function(e,t){var r=e.children,n=e.classes,i=e.className,o=e.defaultCollapseIcon,s=e.defaultEndIcon,a=e.defaultExpanded,l=e.defaultExpandIcon,c=e.defaultParentIcon,u=e.defaultSelected,h=e.disableSelection,d=void 0!==h&&h,f=e.multiSelect,p=void 0!==f&&f,m=e.expanded,g=e.onNodeSelect,y=e.onNodeToggle,v=e.selected,b=(0,Pl.A)(e,["children","classes","className","defaultCollapseIcon","defaultEndIcon","defaultExpanded","defaultExpandIcon","defaultParentIcon","defaultSelected","disableSelection","multiSelect","expanded","onNodeSelect","onNodeToggle","selected"]),x=tZ.useState(null),w=x[0],k=x[1],A=tZ.useState(null),S=A[0],j=A[1],C=tZ.useRef({}),E=tZ.useRef({}),O=tZ.useRef([]),M=(0,Pu.A)({controlled:m,default:void 0===a?Pf:a,name:"TreeView",state:"expanded"}),P=(0,Pa.A)(M,2),T=P[0],I=P[1],$=(0,Pu.A)({controlled:v,default:void 0===u?Pp:u,name:"TreeView",state:"selected"}),D=(0,Pa.A)($,2),R=D[0],N=D[1],_=tZ.useCallback(function(e){return!!Array.isArray(T)&&-1!==T.indexOf(e)},[T]),L=tZ.useCallback(function(e){return Array.isArray(R)?-1!==R.indexOf(e):R===e},[R]),F=function(e){var t=O.current.indexOf(e);return -1!==t&&t+1<O.current.length?O.current[t+1]:null},B=function(e){var t=O.current.indexOf(e);return -1!==t&&t-1>=0?O.current[t-1]:null},z=function(){return O.current[O.current.length-1]},W=function(){return O.current[0]},V=function(e,t){var r=O.current.indexOf(e),n=O.current.indexOf(t),i=Math.min(r,n),o=Math.max(r,n);return O.current.slice(i,o+1)},H=function(e){e&&(k(e),j(e))},U=tZ.useRef(null),q=tZ.useRef(!1),K=tZ.useRef([]),G=function(e,t){var r=R,n=t.start,i=t.next,o=t.current;i&&o&&(-1===K.current.indexOf(o)&&(K.current=[]),q.current?-1!==K.current.indexOf(i)?(r=r.filter(function(e){return e===n||e!==o}),K.current=K.current.filter(function(e){return e===n||e!==o})):(r.push(i),K.current.push(i)):(r.push(i),K.current.push(o,i)),g&&g(e,r),N(r))},J=function(e,t){var r=R,n=t.start,i=t.end;q.current&&(r=R.filter(function(e){return -1===K.current.indexOf(e)}));var o=V(n,i);K.current=o;var s=r.concat(o);s=s.filter(function(e,t){return s.indexOf(e)===t}),g&&g(e,s),N(s)},Y=function(e,t){var r=[];r=-1!==R.indexOf(t)?R.filter(function(e){return e!==t}):[t].concat(R),g&&g(e,r),N(r)},X=function(e,t){var r=p?[t]:t;g&&g(e,r),N(r)},Z=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t.start,i=void 0===n?U.current:n,o=t.end,s=t.current;return r?G(e,{start:i,next:o,current:s}):J(e,{start:i,end:o}),q.current=!0,!0},Q=tZ.useCallback(function(e){var t=C.current[e],r=[];return t&&(r.push(e),t.children&&(r.concat(t.children),t.children.forEach(function(e){r.concat(Q(e))}))),r},[]),ee=tZ.useCallback(function(e){var t=(0,yK.A)({},E.current);e.forEach(function(e){t[e]&&delete t[e]}),E.current=t},[]),et=tZ.useCallback(function(e){var t=Q(e);ee(t);var r=(0,yK.A)({},C.current);t.forEach(function(e){var t=r[e];if(t){if(t.parent){var n=r[t.parent];if(n&&n.children){var i=n.children.filter(function(t){return t!==e});r[t.parent]=(0,yK.A)({},n,{children:i})}}delete r[e]}}),C.current=r,j(function(t){return t===e?null:t})},[Q,ee]),er=tZ.useRef([]),en=tZ.useState(!1),ei=en[0],eo=en[1];tZ.useEffect(function(){var e=[];tZ.Children.forEach(r,function(t){tZ.isValidElement(t)&&t.props.nodeId&&e.push(t.props.nodeId)}),function(e,t){if(e.length!==t.length)return!0;for(var r=0;r<e.length;r+=1)if(e[r]!==t[r])return!0;return!1}(er.current,e)&&(C.current[-1]={parent:null,children:e},e.forEach(function(e,t){0===t&&k(e)}),O.current=C.current[-1].children,er.current=e,eo(!0))},[r]),tZ.useEffect(function(){ei&&(O.current=function e(t){for(var r=[],n=0;n<t.length;n+=1){var i=t[n];r.push(i);var o=C.current[i].children;_(i)&&o&&(r=r.concat(e(o)))}return r}(C.current[-1].children))},[T,ei,_,r]);var es=function(){return!1};return tZ.createElement(Ph.Provider,{value:{icons:{defaultCollapseIcon:o,defaultExpandIcon:l,defaultParentIcon:c,defaultEndIcon:s},focus:H,focusFirstNode:function(){return H(W())},focusLastNode:function(){return H(z())},focusNextNode:function(e){return H(F(e))},focusPreviousNode:function(e){return H(B(e))},focusByFirstCharacter:function(e,t){var r,n,i=t.toLowerCase(),o=[],s=[];Object.keys(E.current).forEach(function(e){var t=E.current[e],r=C.current[e];(!r.parent||_(r.parent))&&(o.push(e),s.push(t))}),(r=o.indexOf(e)+1)===C.current.length&&(r=0),-1===(n=Pd(s,r,i))&&(n=Pd(s,0,i)),n>-1&&H(o[n])},expandAllSiblings:function(e,t){var r,n=C.current[t],i=C.current[n.parent];r=i?i.children.filter(function(e){return!_(e)}):C.current[-1].children.filter(function(e){return!_(e)});var o=T.concat(r);r.length>0&&(I(o),y&&y(e,o))},toggleExpansion:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S;-1!==T.indexOf(r)?(t=T.filter(function(e){return e!==r}),k(function(e){var t=C.current[e];return e&&(t&&t.parent?t.parent.id:null)===r?r:e})):t=[r].concat(T),y&&y(e,t),I(t)},isExpanded:_,isFocused:function(e){return S===e},isSelected:L,selectNode:d?es:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!!t&&(r?Y(e,t):X(e,t),U.current=t,q.current=!1,K.current=[],!0)},selectRange:d?es:Z,selectNextNode:d?es:function(e,t){return Z(e,{end:F(t),current:t},!0)},selectPreviousNode:d?es:function(e,t){return Z(e,{end:B(t),current:t},!0)},rangeSelectToFirst:d?es:function(e,t){return U.current||(U.current=t),Z(e,{start:q.current?U.current:t,end:W()})},rangeSelectToLast:d?es:function(e,t){return U.current||(U.current=t),Z(e,{start:q.current?U.current:t,end:z()})},selectAllNodes:d?es:function(e){return Z(e,{start:W(),end:z()})},isTabbable:function(e){return w===e},multiSelect:p,getParent:function(e){return C.current[e].parent},mapFirstChar:function(e,t){E.current[e]=t},addNodeToNodeMap:function(e,t){var r=C.current[e];C.current[e]=(0,yK.A)({},r,{children:t,id:e}),t.forEach(function(t){var r=C.current[t];C.current[t]=(0,yK.A)({},r,{parent:e,id:t})})},removeNodeFromNodeMap:et}},tZ.createElement("ul",(0,yK.A)({role:"tree","aria-multiselectable":p,className:(0,Pc.A)(n.root,i),ref:t},b),r))});let Pg=(0,gx.A)({root:{padding:0,margin:0,listStyle:"none"}},{name:"MuiTreeView"})(Pm);var Py=r(63798),Pv=r(268),Pb=r(19878),Px=tZ.forwardRef(function(e,t){var r,n=e.children,i=e.classes,o=e.className,s=e.collapseIcon,a=e.endIcon,l=e.expandIcon,c=e.icon,u=e.label,h=e.nodeId,d=e.onClick,f=e.onLabelClick,p=e.onIconClick,m=e.onFocus,g=e.onKeyDown,y=e.onMouseDown,v=e.TransitionComponent,b=void 0===v?nn.A:v,x=e.TransitionProps,w=(0,Pl.A)(e,["children","classes","className","collapseIcon","endIcon","expandIcon","icon","label","nodeId","onClick","onLabelClick","onIconClick","onFocus","onKeyDown","onMouseDown","TransitionComponent","TransitionProps"]),k=tZ.useContext(Ph),A=k.icons,S=k.focus,j=k.focusFirstNode,C=k.focusLastNode,E=k.focusNextNode,O=k.focusPreviousNode,M=k.focusByFirstCharacter,P=k.selectNode,T=k.selectRange,I=k.selectNextNode,$=k.selectPreviousNode,D=k.rangeSelectToFirst,R=k.rangeSelectToLast,N=k.selectAllNodes,_=k.expandAllSiblings,L=k.toggleExpansion,F=k.isExpanded,B=k.isFocused,z=k.isSelected,W=k.isTabbable,V=k.multiSelect,H=k.getParent,U=k.mapFirstChar,q=k.addNodeToNodeMap,K=k.removeNodeFromNodeMap,G=tZ.useRef(null),J=tZ.useRef(null),Y=(0,Pb.A)(G,t),X=c,Z=!!(Array.isArray(n)?n.length:n),Q=!!F&&F(h),ee=!!B&&B(h),et=!!W&&W(h),er=!!z&&z(h),en=A||{},ei=(0,iS.A)();!X&&(Z?(X=Q?s||en.defaultCollapseIcon:l||en.defaultExpandIcon)||(X=en.defaultParentIcon):X=a||en.defaultEndIcon);var eo=function(e){return Z&&(Q?E(h):L(e)),!0},es=function(e){if(Q)return L(e,h),!0;var t=H(h);return!!t&&(S(t),!0)};return tZ.useEffect(function(){if(q){var e=[];tZ.Children.forEach(n,function(t){tZ.isValidElement(t)&&t.props.nodeId&&e.push(t.props.nodeId)}),q(h,e)}},[n,h,q]),tZ.useEffect(function(){if(K)return function(){K(h)}},[h,K]),tZ.useEffect(function(){U&&u&&U(h,J.current.textContent.substring(0,1).toLowerCase())},[U,h,u]),tZ.useEffect(function(){ee&&G.current.focus()},[ee]),V?r=er:er&&(r=!0),tZ.createElement("li",(0,yK.A)({className:(0,Pc.A)(i.root,o,Q&&i.expanded,er&&i.selected),role:"treeitem",onKeyDown:function(e){var t=!1,r=e.key;if(!e.altKey&&e.currentTarget===e.target){var n,i=e.ctrlKey||e.metaKey;switch(r){case" ":G.current===e.currentTarget&&(t=V&&e.shiftKey?T(e,{end:h}):V?P(e,h,!0):P(e,h)),e.stopPropagation();break;case"Enter":G.current===e.currentTarget&&Z&&(L(e),t=!0),e.stopPropagation();break;case"ArrowDown":V&&e.shiftKey&&I(e,h),E(h),t=!0;break;case"ArrowUp":V&&e.shiftKey&&$(e,h),O(h),t=!0;break;case"ArrowRight":t="rtl"===ei.direction?es(e):eo(e);break;case"ArrowLeft":t="rtl"===ei.direction?eo(e):es(e);break;case"Home":V&&i&&e.shiftKey&&D(e,h),j(),t=!0;break;case"End":V&&i&&e.shiftKey&&R(e,h),C(),t=!0;break;default:"*"===r?(_(e,h),t=!0):V&&i&&"a"===r.toLowerCase()?t=N(e):!i&&!e.shiftKey&&(n=r)&&1===n.length&&n.match(/\S/)&&(M(h,r),t=!0)}t&&(e.preventDefault(),e.stopPropagation()),g&&g(e)}},onFocus:function(e){ee||e.currentTarget!==e.target||S(h),m&&m(e)},"aria-expanded":Z?Q:null,"aria-selected":r,ref:Y,tabIndex:et?0:-1},w),tZ.createElement("div",{className:i.content,onClick:function(e){ee||S(h);var t=V&&(e.shiftKey||e.ctrlKey||e.metaKey);!Z||e.defaultPrevented||t&&F(h)||L(e,h),t?e.shiftKey?T(e,{end:h}):P(e,h,!0):P(e,h),d&&d(e)},onMouseDown:function(e){(e.shiftKey||e.ctrlKey||e.metaKey)&&e.preventDefault(),y&&y(e)},ref:J},tZ.createElement("div",{onClick:p,className:i.iconContainer},X),tZ.createElement(rT.A,{onClick:f,component:"div",className:i.label},u)),n&&tZ.createElement(b,(0,yK.A)({unmountOnExit:!0,className:i.group,in:Q,component:"ul",role:"group"},x),n))});let Pw=(0,gx.A)(function(e){return{root:{listStyle:"none",margin:0,padding:0,outline:0,WebkitTapHighlightColor:"transparent","&:focus > $content $label":{backgroundColor:e.palette.action.hover},"&$selected > $content $label":{backgroundColor:(0,Pv.X4)(e.palette.primary.main,e.palette.action.selectedOpacity)},"&$selected > $content $label:hover, &$selected:focus > $content $label":{backgroundColor:(0,Pv.X4)(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},expanded:{},selected:{},group:{margin:0,padding:0,marginLeft:17},content:{width:"100%",display:"flex",alignItems:"center",cursor:"pointer"},iconContainer:{marginRight:4,width:15,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},label:{width:"100%",paddingLeft:4,position:"relative","&:hover":{backgroundColor:e.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}}},{name:"MuiTreeItem"})(Px),Pk=(0,rI.A)(e=>({root:{whiteSpace:"nowrap",overflowY:"auto",padding:e.spacing(1)}}));function PA({entry:e}){return"file"===e.type?(0,v.jsx)(Pw,{nodeId:e.path,label:e.name}):(0,v.jsx)(Pw,{nodeId:e.path,label:e.name,children:e.children.map(e=>(0,v.jsx)(PA,{entry:e},e.path))})}function PS(e){let t=Pk(),r=(0,tZ.useMemo)(()=>(function(e){let t={children:[]};for(let r of e.slice().sort()){let e=r.split("/"),n=t;for(let t=0;t<e.length;t++){let r=e[t];if(""===r)throw Error("Invalid path part: ''");let i=e.slice(0,t+1).join("/"),o=n.children.find(e=>e.name===r);if(o?.type==="file")throw Error(`Duplicate filename at '${i}'`);if(o)n=o;else if(t<e.length-1){let e={type:"directory",name:r,path:i,children:[]},t=n.children.findIndex(e=>"file"===e.type);n.children.splice(t,0,e),n=e}else n.children.push({type:"file",name:r,path:i})}}return t.children})(e.filePaths),[e.filePaths]);return(0,v.jsx)(Pg,{selected:e.selected,className:t.root,defaultCollapseIcon:(0,v.jsx)(r$.default,{}),defaultExpandIcon:(0,v.jsx)(Py.default,{}),onNodeSelect:(t,r)=>{e.onSelect&&e.filePaths.includes(r)&&e.onSelect(r)},children:r.map(e=>(0,v.jsx)(PA,{entry:e},e.path))})}let Pj=(0,rI.A)(e=>({grid:{"& svg":{margin:e.spacing(1)}},closeButton:{marginLeft:"auto"}}),{name:"ScaffolderTemplateEditorBrowser"});function PC(e){let t=Pj(),r=gv(),n=r?.files.filter(e=>e.dirty),{t:i}=(0,rK.i)(nt.W);return r?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(nI.A,{className:t.grid,container:!0,spacing:0,alignItems:"center",children:[(0,v.jsx)(nf.Ay,{title:i("templateEditorPage.templateEditorBrowser.saveIconTooltip"),children:(0,v.jsx)(rG.A,{size:"small",disabled:r.files.every(e=>!e.dirty),onClick:()=>r.save(),children:(0,v.jsx)(Ps.default,{})})}),(0,v.jsx)(nf.Ay,{title:i("templateEditorPage.templateEditorBrowser.reloadIconTooltip"),children:(0,v.jsx)(rG.A,{size:"small",onClick:()=>r.reload(),children:(0,v.jsx)(Po.default,{})})}),(0,v.jsx)(nf.Ay,{title:i("templateEditorPage.templateEditorBrowser.closeIconTooltip"),children:(0,v.jsx)(rG.A,{size:"small",className:t.closeButton,onClick:()=>{e.onClose&&(!n?.length||window.confirm(i("templateEditorPage.templateEditorBrowser.closeConfirmMessage")))&&e.onClose()},children:(0,v.jsx)(Pi.default,{})})})]}),(0,v.jsx)(iA.A,{}),(0,v.jsx)(PS,{selected:r.selectedFile?.path??"",onSelect:r.setSelectedFile,filePaths:r.files.map(e=>e.path)??[]})]}):null}var PE=r(16261),PO=r(71039);let PM=r(99416).Bd?window:null,PP=(0,rI.A)(e=>({container:{position:"relative",width:"100%",height:"100%"},typography:{padding:e.spacing(1.5)},button:{verticalAlign:"top"},codeMirror:{height:"100%",[e.breakpoints.up("md")]:{position:"absolute",top:0,bottom:0,left:0,right:0}},errorPanel:{color:e.palette.error.main,lineHeight:2,margin:e.spacing(0,1)},floatingButtons:{position:"absolute",top:e.spacing(1),right:e.spacing(3)},floatingButton:{padding:e.spacing(1)}}));function PT(e){let{errorText:t}=e,r=PP(),{t:n}=(0,rK.i)(nt.W),i=(0,tZ.useMemo)(()=>{if(!t)return AR.of(null);let e=document.createElement("div");return e.classList.add(r.errorPanel),e.textContent=t,AR.of(()=>({dom:e,bottom:!0}))},[r,t]);return!function(e,t,r=[],n={}){let{event:i="keydown",target:o=PM,eventOptions:s}=n,a=(0,PE.J)(t);!function(e,...t){let r=function(e=!1){let t=(0,tZ.useRef)(e),r=(0,tZ.useCallback)(()=>t.current,[]);return(0,tZ.useEffect)(()=>(t.current=!0,()=>{t.current=!1}),[]),r}(),n=(0,PE.J)(t[1]),i=(0,tZ.useMemo)(()=>function(...e){r()&&("function"==typeof n.current?n.current.apply(this,e):"function"==typeof n.current.handleEvent&&n.current.handleEvent.apply(this,e))},[]);(0,tZ.useEffect)(()=>{var r;let n=null!==(r=e)&&"object"==typeof r&&(0,PO.mQ)(r,"current")?e.current:e;if(!n)return;let o=t.slice(2);return(0,PO.on)(n,t[0],i,...o),()=>{(0,PO.AU)(n,t[0],i,...o)}},[e,t[0]])}(o,i,(0,tZ.useMemo)(()=>{let t="function"==typeof e?e:"string"==typeof e?t=>t.key===e:e?PO.ud:PO.HD;return function(e){t(e)&&a.current.call(this,e)}},r),s)}(e=>"s"===e.key&&(e.ctrlKey||e.metaKey),t=>{t.preventDefault(),e.onSave&&e.onSave()}),(0,v.jsxs)("div",{className:r.container,children:[(0,v.jsx)(MR,{className:r.codeMirror,theme:"dark",height:"100%",extensions:[j1.define(M_),i],value:e.content,onChange:e.onUpdate}),(e.onSave||e.onReload)&&(0,v.jsx)("div",{className:r.floatingButtons,children:(0,v.jsxs)(ns.A,{children:[e.onSave&&(0,v.jsx)(nf.Ay,{title:n("templateEditorPage.templateEditorTextArea.saveIconTooltip"),children:(0,v.jsx)(rG.A,{className:r.floatingButton,onClick:()=>e.onSave?.(),children:(0,v.jsx)(Ps.default,{})})}),e.onReload&&(0,v.jsx)(nf.Ay,{title:n("templateEditorPage.templateEditorTextArea.refreshIconTooltip"),children:(0,v.jsx)(rG.A,{className:r.floatingButton,onClick:()=>e.onReload?.(),children:(0,v.jsx)(Po.default,{})})})]})})]})}PT.DirectoryEditor=function(e){let t=PP(),r=gv(),{t:n}=(0,rK.i)(nt.W);if(!r)return(0,v.jsx)(rT.A,{className:t.typography,color:"textSecondary",align:"center",children:n("templateEditorPage.templateEditorTextArea.emptyStateParagraph")});let i=r?.selectedFile?.dirty?{onSave:()=>r.save(),onReload:()=>r.reload()}:{onReload:()=>r.reload()};return(0,v.jsx)(PT,{errorText:e.errorText,content:r.selectedFile?.content,onUpdate:e=>r?.selectedFile?.updateContent(e),...i})};var PI=r(65569),P$=r(62461),PD=r(39590),PR=r(12326);let PN=(0,rI.A)(e=>({root:{overflowY:"auto",background:e.palette.background.default},iconSuccess:{minWidth:0,marginRight:e.spacing(1),color:e.palette.status.ok},iconFailure:{minWidth:0,marginRight:e.spacing(1),color:e.palette.status.error}}));function P_(){let e=PN(),t=Mz(),{t:r}=(0,rK.i)(nt.W);return(0,v.jsx)(ni.A,{className:e.root,dense:!0,children:t.results.map(n=>{let i=n.log.some(e=>"failed"===e.body.status),o=!1;async function s(){o=!0,await PL(n.directoryContents,`dry-run-result-${n.id}.zip`),o=!1}return(0,v.jsxs)(no.A,{button:!0,selected:t.selectedResult?.id===n.id,onClick:()=>t.selectResult(n.id),children:[(0,v.jsx)(rJ.A,{className:i?e.iconFailure:e.iconSuccess,children:i?(0,v.jsx)(mR.default,{}):(0,v.jsx)(P$.default,{})}),(0,v.jsx)(rY.A,{primary:r("templateEditorPage.dryRunResultsList.title",{resultId:`${n.id}`})}),(0,v.jsxs)(PI.A,{children:[(0,v.jsx)(rG.A,{edge:"end","aria-label":"download",title:r("templateEditorPage.dryRunResultsList.downloadButtonTitle"),disabled:o,onClick:()=>s(),children:(0,v.jsx)(PR.default,{})}),(0,v.jsx)(rG.A,{edge:"end","aria-label":"delete",title:r("templateEditorPage.dryRunResultsList.deleteButtonTitle"),onClick:()=>t.deleteResult(n.id),children:(0,v.jsx)(PD.default,{})})]})]},n.id)})})}async function PL(e,t){var n;let i,{default:o}=await r.e("3214").then(r.t.bind(r,32461,23)),s=new o;for(let t of e){let e=atob(t.base64Content);await s.file(t.path,e)}n=await s.generateAsync({type:"blob"}),(i=document.createElement("a")).href=URL.createObjectURL(n),i.download=t,i.click(),URL.revokeObjectURL(i.href),i.remove()}let PF=(0,rI.A)(e=>({root:{display:"grid",gridTemplateColumns:"280px auto 3fr",gridTemplateRows:"1fr"},child:{overflowY:"auto",height:"100%",minHeight:0},firstChild:{background:e.palette.background.paper}}));function PB(e){let t=PF(),r=tZ.Children.toArray(e.children);if(2!==r.length)throw Error("must have exactly 2 children");return(0,v.jsxs)("div",{className:t.root,children:[(0,v.jsx)("div",{className:ny()(t.child,t.firstChild),children:r[0]}),(0,v.jsx)(iA.A,{orientation:"horizontal"}),(0,v.jsx)("div",{className:t.child,children:r[1]})]})}let Pz=(0,rI.A)({svgIcon:{display:"inline-block","& svg":{display:"inline-block",fontSize:"inherit",verticalAlign:"baseline"}}}),PW=e=>{let{href:t,text:r,Icon:n,...i}=e,o=Pz();return(0,v.jsxs)(nI.A,{container:!0,direction:"row",spacing:1,children:[(0,v.jsx)(nI.A,{item:!0,children:(0,v.jsx)(rT.A,{component:"div",className:o.svgIcon,children:n?(0,v.jsx)(n,{}):(0,v.jsx)(iD.default,{})})}),(0,v.jsx)(nI.A,{item:!0,children:(0,v.jsx)(rW.N_,{to:t,...i,children:r||t})})]})},PV=({output:e})=>{let{links:t=[]}=e,r=(0,n1.n)(),n=(0,rL.S)(iE.s);return(0,v.jsx)(rP.A,{px:3,pb:3,children:t.filter(({url:e,entityRef:t})=>e||t).map(({url:e,entityRef:t,title:r,icon:i})=>t?{title:r,icon:i,url:n((0,nG.KU)(t,{defaultKind:"<unknown>",defaultNamespace:"<unknown>"}))}:{title:r,icon:i,url:e}).map(({url:e,title:t,icon:n},i)=>(0,v.jsx)(PW,{href:e,text:t??e,Icon:n?r.getSystemIcon(n)??iD.default:iD.default,target:"_blank"},`output-link-${i}`))})};var PH=r(3380);let PU=(0,rI.A)(e=>(0,py.A)({root:{width:"100%"},button:{marginBottom:e.spacing(2),marginLeft:e.spacing(2)},actionsContainer:{marginBottom:e.spacing(2)},resetContainer:{padding:e.spacing(3)},labelWrapper:{display:"flex",flex:1,flexDirection:"row",justifyContent:"space-between"},stepWrapper:{width:"100%"}})),Pq=(0,rI.A)(e=>(0,py.A)({root:{color:e.palette.text.disabled,display:"flex",height:22,alignItems:"center"},completed:{color:e.palette.status.ok},error:{color:e.palette.status.error}})),PK=({step:e})=>{let[t,r]=(0,tZ.useState)("");return(0,m0.A)(()=>{if(!e.startedAt)return void r("");let t=e.endedAt?nH.c9.fromISO(e.endedAt):nH.c9.local(),n=nH.c9.fromISO(e.startedAt),i=nH.IX.fromDateTimes(n,t).toDuration().valueOf();r(t1()(i,{round:!0}))},1e3),(0,v.jsx)(rT.A,{variant:"caption",children:t})};function PG(e){let t=Pq(),{active:r,completed:n,error:i}=e;return(0,v.jsx)("div",{className:ny()(t.root,{[t.completed]:n,[t.error]:i}),children:r?(0,v.jsx)(mK.A,{size:"24px"}):n?(0,v.jsx)(P$.default,{}):i?(0,v.jsx)(mR.default,{}):(0,v.jsx)(PH.default,{})})}let PJ=(0,tZ.memo)(e=>{let{steps:t,currentStepId:r,onUserStepChange:n}=e,i=PU(e),{t:o}=(0,rK.i)(nt.W);return(0,v.jsx)("div",{className:i.root,children:(0,v.jsx)(oe.A,{activeStep:t.findIndex(e=>e.id===r),orientation:"vertical",nonLinear:!0,children:t.map((e,t)=>{let r="cancelled"===e.status,s="processing"===e.status,a="completed"===e.status,l="failed"===e.status,c="skipped"===e.status;return(0,v.jsx)(i8.A,{expanded:!0,children:(0,v.jsx)(mq.A,{onClick:()=>n(e.id),children:(0,v.jsx)(i7.A,{StepIconProps:{completed:a,error:l||r,active:s},StepIconComponent:PG,className:i.stepWrapper,children:(0,v.jsxs)("div",{className:i.labelWrapper,children:[(0,v.jsx)(rT.A,{variant:"subtitle2",children:e.name}),c?(0,v.jsx)(rT.A,{variant:"caption",children:o("templateEditorPage.taskStatusStepper.skippedStepTitle")}):(0,v.jsx)(PK,{step:e})]})})})},String(t))})})})}),PY=(0,rI.A)({root:{display:"flex",flexFlow:"column nowrap"},contentWrapper:{flex:1,position:"relative"},content:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex","& > *":{flex:1}},codeMirror:{height:"100%",overflowY:"auto"}});function PX(){let e=PY(),{selectedResult:t}=Mz(),[r,n]=(0,tZ.useState)(""),i=t?.directoryContents.find(e=>e.path===r);return((0,tZ.useEffect)(()=>{if(t){let[e]=t.directoryContents;e?n(e.path):n("")}},[t]),t)?(0,v.jsxs)(PB,{children:[(0,v.jsx)(PS,{selected:r,onSelect:n,filePaths:t.directoryContents.map(e=>e.path)}),(0,v.jsx)(MR,{className:e.codeMirror,theme:"dark",height:"100%",extensions:[j1.define(M_)],readOnly:!0,value:i?.base64Content?atob(i.base64Content):""})]}):null}function PZ(){let{selectedResult:e}=Mz(),[t,r]=(0,tZ.useState)(),n=(0,tZ.useMemo)(()=>e?e.steps.map(t=>{let r=e.log.filter(e=>e.body.stepId===t.id);return{id:t.id,name:t.name,logString:r.map(e=>e.body.message).join("\n"),status:r[r.length-1]?.body.status??"completed"}})??[]:[],[e]);if(!e)return null;let i=n.find(e=>e.id===t)??n[0];return(0,v.jsxs)(PB,{children:[(0,v.jsx)(PJ,{steps:n,currentStepId:i.id,onUserStepChange:r}),(0,v.jsx)(m5.r,{text:i?.logString??""})]})}function PQ(){let e=PY(),{selectedResult:t}=Mz();return t?(0,v.jsxs)(PB,{children:[(0,v.jsx)(rP.A,{pt:2,children:t.output?.links?.length&&(0,v.jsx)(PV,{output:t.output})}),(0,v.jsx)(MR,{className:e.codeMirror,theme:"dark",height:"100%",extensions:[j1.define(M_)],readOnly:!0,value:JSON.stringify(t.output,null,2)})]}):null}function P0(){let e=PY(),[t,r]=(0,tZ.useState)("files"),{t:n}=(0,rK.i)(nt.W);return(0,v.jsxs)("div",{className:e.root,children:[(0,v.jsxs)(MJ.A,{value:t,onChange:(e,t)=>r(t),children:[(0,v.jsx)(MG.A,{value:"files",label:n("templateEditorPage.dryRunResultsView.tab.files")}),(0,v.jsx)(MG.A,{value:"log",label:n("templateEditorPage.dryRunResultsView.tab.log")}),(0,v.jsx)(MG.A,{value:"output",label:n("templateEditorPage.dryRunResultsView.tab.output")})]}),(0,v.jsx)(iA.A,{}),(0,v.jsx)("div",{className:e.contentWrapper,children:(0,v.jsxs)("div",{className:e.content,children:["files"===t&&(0,v.jsx)(PX,{}),"log"===t&&(0,v.jsx)(PZ,{}),"output"===t&&(0,v.jsx)(PQ,{})]})})]})}let P1=(0,rI.A)(e=>({header:{height:48,minHeight:0,"&.Mui-expanded":{height:48,minHeight:0}},content:{display:"grid",background:e.palette.background.default,gridTemplateColumns:"180px auto 1fr",gridTemplateRows:"1fr",padding:0,height:400}}));function P2(){let e,t=P1(),r=Mz(),[n,i]=(0,tZ.useState)(!1),[o,s]=(0,tZ.useState)(!0),{t:a}=(0,rK.i)(nt.W),l=r.results.length,c=(e=(0,tZ.useRef)(),(0,tZ.useEffect)(()=>{e.current=l}),e.current);return(0,tZ.useEffect)(()=>{0===c&&1===l?(s(!1),i(!0)):1===c&&0===l&&i(!1)},[c,l]),(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)(rE.A,{variant:"outlined",expanded:n,hidden:0===l&&o,onChange:(e,t)=>i(t),onTransitionEnd:()=>0===l&&s(!0),children:[(0,v.jsx)(rM.A,{className:t.header,expandIcon:(0,v.jsx)(np.default,{}),children:(0,v.jsx)(rT.A,{children:a("templateEditorPage.dryRunResults.title")})}),(0,v.jsx)(iA.A,{orientation:"horizontal"}),(0,v.jsxs)(rO.A,{className:t.content,children:[(0,v.jsx)(P_,{}),(0,v.jsx)(iA.A,{orientation:"horizontal"}),(0,v.jsx)(P0,{})]})]})})}let P4=e=>{let{layouts:t,formProps:r,fieldExtensions:n}=e,[i,o]=(0,tZ.useState)(),s=(0,b.Zp)(),a=(0,rL.S)(rS.Dg),{directory:l,openDirectory:c,createDirectory:u,closeDirectory:h}=gf(),d=(0,tZ.useCallback)(()=>{h().then(()=>s(a()))},[h,s,a]);return(0,v.jsx)(gb,{directory:l,children:(0,v.jsx)(MB,{children:(0,v.jsxs)(yO,{children:[(0,v.jsx)(yM,{children:(0,v.jsx)(Pt,{fieldExtensions:n,children:(0,v.jsx)(Pn,{onOpenDirectory:c,onCreateDirectory:u,onCloseDirectory:d})})}),(0,v.jsx)(yP,{children:(0,v.jsx)(PC,{onClose:h})}),(0,v.jsx)(yR,{autoSaveId:"template-editor",files:(0,v.jsx)(yT,{children:(0,v.jsx)(PT.DirectoryEditor,{errorText:i})}),preview:(0,v.jsx)(yI,{children:(0,v.jsx)(MU.DirectoryEditorDryRun,{setErrorText:o,fieldExtensions:n,layouts:t,formProps:r})})}),(0,v.jsx)(y$,{children:(0,v.jsx)(P2,{})})]})})})},P3=(0,rI.A)({content:{padding:0}},{name:"ScaffolderTemplateEditorToolbar"});function P5(e){let t=P3(),r=(0,rL.S)(rS.Dg),{t:n}=(0,rK.i)(nt.W);return(0,v.jsxs)(rH.Y,{themeId:"home",children:[(0,v.jsx)(rU.Y,{title:n("templateEditorPage.title"),subtitle:n("templateEditorPage.subtitle"),type:n("templateIntroPage.title"),typeLink:r()}),(0,v.jsx)(rq.U,{className:t.content,children:(0,v.jsx)(P4,{layouts:e.layouts,formProps:e.formProps,fieldExtensions:e.fieldExtensions})})]})}var P6=r(53318);let P9=(0,rI.A)({menu:{maxHeight:240}});function P8(e){let{options:t,selectedOption:r,onSelectOption:n}=e,i=P9(),[o,s]=(0,tZ.useState)(null),{t:a}=(0,rK.i)(nt.W),l=(0,tZ.useCallback)(e=>!!r&&r.value===e.value,[r]),c=(0,tZ.useCallback)(e=>{s(e.currentTarget)},[s]),u=(0,tZ.useCallback)(()=>{s(null)},[s]),h=(0,tZ.useCallback)(e=>{u(),n(e)},[u,n]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(iB.A,{"aria-controls":"templates-menu","aria-haspopup":"true",onClick:c,children:a("templateEditorToolbarTemplatesMenu.button")}),(0,v.jsx)(Pr.A,{id:"templates-menu",anchorEl:o,open:!!o,onClose:u,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},PaperProps:{className:i.menu},children:t.map((e,t)=>(0,v.jsx)(rX.A,{selected:l(e),"aria-selected":l(e),onClick:()=>h(e),children:e.label},t))})]})}let P7=`# Edit the template parameters below to see how they will render in the scaffolder form UI
parameters:
  - title: Fill in some steps
    required:
      - name
    properties:
      name:
        title: Name
        type: string
        description: Unique name of the component
      owner:
        title: Owner
        type: string
        description: Owner of the component
        ui:field: OwnerPicker
        ui:options:
          catalogFilter:
            kind: Group
  - title: Choose a location
    required:
      - repoUrl
    properties:
      repoUrl:
        title: Repository Location
        type: string
        ui:field: RepoUrlPicker
        ui:options:
          allowedHosts:
            - github.com
steps:
  - id: fetch-base
    name: Fetch Base
    action: fetch:template
    input:
      url: ./template
      values:
        name: \${{parameters.name}}
`,Te=(0,rI.A)(e=>({root:{height:"100%",gridArea:"pageContent",display:"grid",gridTemplateAreas:`
      "toolbar"
      "textArea"
      "preview"
    `,[e.breakpoints.up("md")]:{gridTemplateAreas:`
      "toolbar toolbar"
      "textArea preview"
    `,gridTemplateRows:"auto 1fr",gridTemplateColumns:"1fr"}},files:{gridArea:"textArea"}}),{name:"ScaffolderTemplateFormPreviewer"}),Tt=({defaultPreviewTemplate:e=P7,customFieldExtensions:t=[],layouts:r=[],formProps:n})=>{let i=Te(),o=(0,k.gf)(it.k),s=(0,k.gf)(nq.v),a=(0,b.Zp)(),l=(0,rL.S)(rS.Dg),[c,u]=(0,tZ.useState)(),[h,d]=(0,tZ.useState)(),[f,p]=(0,tZ.useState)([]),[m,g]=(0,tZ.useState)(e),y=(0,tZ.useCallback)(()=>{a(l())},[a,l]);(0,rj.A)(()=>s.getEntities({filter:{kind:"template"},fields:["kind","metadata.namespace","metadata.name","metadata.title","spec.parameters","spec.steps","spec.output"]}).then(({items:e})=>p(e.map(e=>({label:e.metadata.title??(0,P6.S)(e,{defaultKind:"template"}),value:e})))).catch(e=>o.post({message:`Error loading existing templates: ${e.message}`,severity:"error"})),[s]);let x=(0,tZ.useCallback)(e=>{d(e),g(yq.Ay.stringify(e.value.spec))},[d,g]);return(0,v.jsxs)(yO,{classes:{root:i.root},children:[(0,v.jsx)(yM,{children:(0,v.jsxs)(Pt,{fieldExtensions:t,children:[(0,v.jsx)(Pn,{onCloseDirectory:y}),(0,v.jsx)(P8,{options:f,selectedOption:h,onSelectOption:x})]})}),(0,v.jsx)(yR,{autoSaveId:"template-form-previewer",files:(0,v.jsx)(yT,{classes:{root:i.files},children:(0,v.jsx)(PT,{content:m,onUpdate:g,errorText:c})}),preview:(0,v.jsx)(yI,{children:(0,v.jsx)(MU,{content:m,contentIsSpec:!0,fieldExtensions:t,setErrorText:u,layouts:r,formProps:n})})})]})},Tr=(0,rI.A)({root:{padding:0}});function Tn(e){let t=Tr(),r=(0,b.Zp)(),n=(0,rL.S)(rS.Dg),{t:i}=(0,rK.i)(nt.W),o=(0,tZ.useCallback)(()=>{r(n())},[r,n]);return(0,v.jsxs)(rH.Y,{themeId:"home",children:[(0,v.jsx)(rU.Y,{title:i("templateFormPage.title"),subtitle:i("templateFormPage.subtitle"),type:i("templateIntroPage.title"),typeLink:n()}),(0,v.jsx)(rq.U,{className:t.root,children:(0,v.jsx)(Tt,{layouts:e.layouts,formProps:e.formProps,customFieldExtensions:e.fieldExtensions,defaultPreviewTemplate:e.defaultPreviewTemplate,onClose:o})})]})}var Ti=r(67349),To=r(20947),Ts=r(80342),Ta=r(58055),Tl=r(89031),Tc=r(57369),Tu=r(68482);let Th=(0,rI.A)(e=>({gridRoot:{display:"flex",flex:1,alignItems:"center",justifyContent:"center"},cardGrid:{maxWidth:1e3,display:"grid",gridGap:e.spacing(2),gridAutoFlow:"row",[e.breakpoints.up("md")]:{gridTemplateRows:"1fr 1fr",gridTemplateColumns:"1fr 1fr"}},card:{display:"grid",gridTemplateColumns:"auto 1fr",gridTemplateRows:"1fr",alignItems:"center",margin:e.spacing(0,1),marginTop:e.spacing(2),padding:e.spacing(2)},icon:{justifySelf:"center",paddingTop:e.spacing(1),fontSize:48},introText:{textAlign:"center",marginTop:e.spacing(2)},infoIcon:{position:"absolute",top:e.spacing(1),right:e.spacing(1)},cardContent:{padding:e.spacing(1)}}));function Td(e){let t=!e.requireLoad||gd.isSupported(),{t:r}=(0,rK.i)(nt.W),n=Th(),{Icon:i,title:o,description:s,action:a}=e;return(0,v.jsxs)(nF.A,{className:n.card,children:[!t&&(0,v.jsx)(nf.Ay,{placement:"top",title:r("templateEditorPage.templateEditorIntro.loadLocal.unsupportedTooltip"),children:(0,v.jsx)(Tl.default,{})}),(0,v.jsxs)(Ti.A,{onClick:a,children:[(0,v.jsx)(Tc.A,{children:(0,v.jsx)(i,{className:n.icon,color:t?void 0:"disabled"})}),(0,v.jsxs)(ik.A,{className:n.cardContent,children:[(0,v.jsx)(rT.A,{gutterBottom:!0,variant:"h5",component:"h2",color:t?void 0:"textSecondary",children:o}),(0,v.jsx)(rT.A,{variant:"body2",color:"textSecondary",component:"p",children:s})]})]})]})}function Tf(e){let t=Th(),{t:r}=(0,rK.i)(nt.W);return(0,v.jsxs)("div",{style:e.style,children:[(0,v.jsx)(rT.A,{variant:"h4",component:"h2",className:t.introText,children:r("templateEditorPage.templateEditorIntro.title")}),(0,v.jsx)("div",{className:t.gridRoot,children:(0,v.jsxs)("div",{className:t.cardGrid,children:[(0,v.jsx)(Td,{title:r("templateEditorPage.templateEditorIntro.loadLocal.title"),description:r("templateEditorPage.templateEditorIntro.loadLocal.description"),requireLoad:!0,Icon:Tu.default,action:()=>e.onSelect?.("local")}),(0,v.jsx)(Td,{title:r("templateEditorPage.templateEditorIntro.createLocal.title"),description:r("templateEditorPage.templateEditorIntro.createLocal.description"),requireLoad:!0,action:()=>e.onSelect?.("create-template"),Icon:To.default}),(0,v.jsx)(Td,{title:r("templateEditorPage.templateEditorIntro.formEditor.title"),description:r("templateEditorPage.templateEditorIntro.formEditor.description"),Icon:Ts.default,action:()=>e.onSelect?.("form")}),(0,v.jsx)(Td,{title:r("templateEditorPage.templateEditorIntro.fieldExplorer.title"),description:r("templateEditorPage.templateEditorIntro.fieldExplorer.description"),Icon:Ta.default,action:()=>e.onSelect?.("field-explorer")})]})})]})}function Tp(){let e=(0,b.Zp)(),t=(0,rL.S)(rS.rQ),r=(0,rL.S)(rS.GH),n=(0,rL.S)(rS.P),i=(0,rL.S)(rS.t6),{t:o}=(0,rK.i)(nt.W),{openDirectory:s,createDirectory:a}=gf(),l=(0,tZ.useCallback)(t=>{"local"===t?s().then(()=>e(r())).catch(()=>{}):"create-template"===t?a().then(()=>e(r())).catch(()=>{}):"form"===t?e(n()):"field-explorer"===t&&e(i())},[s,a,e,r,n,i]);return(0,v.jsxs)(rH.Y,{themeId:"home",children:[(0,v.jsx)(rU.Y,{title:o("templateIntroPage.title"),type:"Scaffolder",typeLink:t(),subtitle:o("templateIntroPage.subtitle")}),(0,v.jsx)(rq.U,{children:(0,v.jsx)(Tf,{onSelect:l})})]})}var Tm=r(45685);let Tg=(0,rI.A)(e=>({root:{gridArea:"pageContent",display:"grid",gridGap:e.spacing(2),gridTemplateAreas:`
      "controls"
      "fieldForm"
      "preview"
    `,[e.breakpoints.up("md")]:{gridTemplateAreas:`
      "controls controls"
      "fieldForm preview"
    `,gridTemplateRows:"auto 1fr",gridTemplateColumns:"1fr 1fr"}},controls:{gridArea:"controls",display:"flex",flexFlow:"row nowrap",alignItems:"center"},fieldForm:{gridArea:"fieldForm"},preview:{gridArea:"preview",display:"grid",gridGap:e.spacing(2),alignContent:"start"}}),{name:"ScaffolderCustomFieldExplorer"}),Ty=({customFieldExtensions:e=[]})=>{let t=Tg(),{t:r}=(0,rK.i)(nt.W),n=e.filter(e=>!!e.schema),[i,o]=(0,tZ.useState)(n?.[0]),[s,a]=(0,tZ.useState)({}),[l,c]=(0,tZ.useState)(Date.now()),u=(0,tZ.useMemo)(()=>i?yq.Ay.stringify({parameters:[{title:`${i.name} Example`,properties:{[i.name]:{type:i.schema?.returnValue?.type,"ui:field":i.name,"ui:options":s}}}]}):"",[s,i]),h=(0,tZ.useMemo)(()=>Object.fromEntries(e.map(({name:e,component:t})=>[e,t])),[e]),d=(0,tZ.useCallback)(e=>{o(e),a({})},[a,o]),f=(0,tZ.useCallback)(e=>{a(e),c(Date.now())},[a,c]);return(0,v.jsxs)("main",{className:t.root,children:[(0,v.jsx)("div",{className:t.controls,children:(0,v.jsx)(rR.Ay,{id:"custom-fields-autocomplete",value:i,options:n,getOptionLabel:e=>e.name,renderInput:e=>(0,v.jsx)(rl.A,{...e,"aria-label":r("templateEditorPage.customFieldExplorer.selectFieldLabel"),placeholder:r("templateEditorPage.customFieldExplorer.selectFieldLabel"),variant:"outlined",InputProps:{...e.InputProps,startAdornment:(0,v.jsx)(rN.A,{position:"start",children:(0,v.jsx)(r_.default,{})})}}),onChange:(e,t)=>{t&&d(t)},disableClearable:!0,fullWidth:!0})}),(0,v.jsx)("div",{className:t.fieldForm,children:(0,v.jsxs)(nF.A,{children:[(0,v.jsx)(Tm.A,{title:r("templateEditorPage.customFieldExplorer.fieldForm.title")}),(0,v.jsx)(ik.A,{children:(0,v.jsx)(pl,{showErrorList:!1,fields:{...h},noHtml5Validate:!0,formData:s,formContext:{fieldFormState:s},onSubmit:e=>f(e.formData),validator:u$,schema:i?.schema?.uiOptions||{},experimental_defaultFormStateBehavior:{allOf:"populateDefaults"},children:(0,v.jsx)(iB.A,{variant:"contained",color:"primary",type:"submit",disabled:!i?.schema?.uiOptions,children:r("templateEditorPage.customFieldExplorer.fieldForm.applyButtonTitle")})})})]})}),(0,v.jsxs)("div",{className:t.preview,children:[(0,v.jsxs)(nF.A,{children:[(0,v.jsx)(Tm.A,{title:r("templateEditorPage.customFieldExplorer.preview.title")}),(0,v.jsx)(ik.A,{children:(0,v.jsx)(MR,{readOnly:!0,theme:"dark",height:"100%",extensions:[j1.define(M_)],value:u})})]}),(0,v.jsx)(MU,{content:u,contentIsSpec:!0,fieldExtensions:e,setErrorText:()=>null},l)]})]})};function Tv(e){let t=(0,rL.S)(rS.Dg),{t:r}=(0,rK.i)(nt.W);return(0,v.jsxs)(rH.Y,{themeId:"home",children:[(0,v.jsx)(rU.Y,{title:r("templateCustomFieldPage.title"),subtitle:r("templateCustomFieldPage.subtitle"),type:r("templateIntroPage.title"),typeLink:t()}),(0,v.jsx)(rq.U,{children:(0,v.jsx)(Ty,{customFieldExtensions:e.fieldExtensions})})]})}var Tb=r(75014);let Tx=pT.create({type:"@backstage/scaffolder/FormField",versions:["v1"]}),Tw=e=>{let{components:{TemplateCardComponent:t,TaskPageComponent:r=ge,ReviewStepComponent:n,EXPERIMENTAL_TemplateOutputsComponent:i,EXPERIMENTAL_TemplateListPageComponent:o=i0,EXPERIMENTAL_TemplateWizardPageComponent:s=pD}={}}=e,a=(0,b.P1)()||e.children,l=(e=>{let t=(0,k.gf)(S.v),[{result:r},{execute:n}]=(0,x.Y)(()=>t.getFormFields(),[]);(0,w.u)(n);let i=(0,A.O)(e,e=>e.selectByComponentData({key:t6.R}).findComponentData({key:t6.b}));return[...r?.map(e=>({component:e.component,name:e.name,validation:e.validation,schema:e.schema?.schema})),...i]})(a),c=function(e){let[{result:t},{execute:r}]=(0,x.Y)(async()=>(await Promise.all((e??[]).map(e=>e()))).map(e=>Tx.toInternal(e)),[]);return(0,w.u)(r),t}(e.formFieldLoaders),{NotFoundErrorPage:u}=(0,n1.n)().getComponents(),h=[...l,...c,...rA.filter(({name:e})=>!l.some(t=>t.name===e))],d=(0,A.O)(a,e=>e.selectByComponentData({key:"scaffolder.layouts.wrapper.v1"}).findComponentData({key:"scaffolder.layout.v1"}));return(0,v.jsxs)(b.BV,{children:[(0,v.jsx)(b.qh,{path:"/",element:(0,v.jsx)(o,{TemplateCardComponent:t,contextMenu:e.contextMenu,groups:e.groups,templateFilter:e.templateFilter,headerOptions:e.headerOptions})}),(0,v.jsx)(b.qh,{path:rS.sP.path,element:(0,v.jsx)(t9.Q,{children:(0,v.jsx)(s,{headerOptions:e.headerOptions,customFieldExtensions:h,layouts:d,components:{ReviewStepComponent:n},formProps:e.formProps})})}),(0,v.jsx)(b.qh,{path:rS.bW.path,element:(0,v.jsx)(r,{TemplateOutputsComponent:i})}),(0,v.jsx)(b.qh,{path:rS.Dg.path,element:(0,v.jsx)(Tb.T,{permission:r9.$,children:(0,v.jsx)(t9.Q,{children:(0,v.jsx)(Tp,{})})})}),(0,v.jsx)(b.qh,{path:rS.t6.path,element:(0,v.jsx)(Tb.T,{permission:r9.$,children:(0,v.jsx)(t9.Q,{children:(0,v.jsx)(Tv,{fieldExtensions:h})})})}),(0,v.jsx)(b.qh,{path:rS.P.path,element:(0,v.jsx)(Tb.T,{permission:r9.$,children:(0,v.jsx)(t9.Q,{children:(0,v.jsx)(Tn,{layouts:d,formProps:e.formProps,fieldExtensions:h})})})}),(0,v.jsx)(b.qh,{path:rS.GF.path,element:(0,v.jsx)(nN,{contextMenu:e.contextMenu})}),(0,v.jsx)(b.qh,{path:rS.JX.path,element:(0,v.jsx)(n0,{contextMenu:e.contextMenu})}),(0,v.jsx)(b.qh,{path:rS.GH.path,element:(0,v.jsx)(Tb.T,{permission:r9.$,children:(0,v.jsx)(t9.Q,{children:(0,v.jsx)(P5,{layouts:d,formProps:e.formProps,fieldExtensions:h})})})}),(0,v.jsx)(b.qh,{path:rS.SE.path,element:(0,v.jsx)(M7,{contextMenu:e.contextMenu})}),(0,v.jsx)(b.qh,{path:"*",element:(0,v.jsx)(u,{})})]})},Tk=e=>(0,v.jsx)(Tw,{...e})},27062(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M18.6 6.62c-1.44 0-2.8.56-3.77 1.53L12 10.66 10.48 12h.01L7.8 14.39c-.64.64-1.49.99-2.4.99-1.87 0-3.39-1.51-3.39-3.38S3.53 8.62 5.4 8.62c.91 0 1.76.35 2.44 1.03l1.13 1 1.51-1.34L9.22 8.2C8.2 7.18 6.84 6.62 5.4 6.62 2.42 6.62 0 9.04 0 12s2.42 5.38 5.4 5.38c1.44 0 2.8-.56 3.77-1.53l2.83-2.5.01.01L13.52 12h-.01l2.69-2.39c.64-.64 1.49-.99 2.4-.99 1.87 0 3.39 1.51 3.39 3.38s-1.52 3.38-3.39 3.38c-.9 0-1.76-.35-2.44-1.03l-1.14-1.01-1.51 1.34 1.27 1.12c1.02 1.01 2.37 1.57 3.82 1.57 2.98 0 5.4-2.41 5.4-5.38s-2.42-5.37-5.4-5.37z"}),"AllInclusive")},68594(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward")},86868(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"ControlPoint")},39590(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete")},7147(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"}),"Error")},23164(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess")},3380(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("circle",{cx:"12",cy:"12",r:"8"}),"FiberManualRecord")},58055(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"}),"FormatListBulleted")},43135(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M18 4H6v2l6.5 6L6 18v2h12v-3h-7l5-5-5-5h7z"}),"Functions")},12326(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"GetApp")},20353(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"}),"List")},80342(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M19 5v14H5V5h14m1.1-2H3.9c-.5 0-.9.4-.9.9v16.2c0 .4.4.9.9.9h16.2c.4 0 .9-.5.9-.9V3.9c0-.5-.5-.9-.9-.9zM11 7h6v2h-6V7zm0 4h6v2h-6v-2zm0 4h6v2h-6zM7 7h2v2H7zm0 4h2v2H7zm0 4h2v2H7z"}),"ListAlt")},25711(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"PanoramaFishEye")},68482(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M5 4v2h14V4H5zm0 10h4v6h6v-6h4l-7-7-7 7z"}),"Publish")},87629(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),"Refresh")},51767(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"RemoveCircleOutline")},55534(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"}),"Repeat")},64118(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"}),"Replay")},71108(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save")},25283(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M3 9h14V7H3v2zm0 4h14v-2H3v2zm0 4h14v-2H3v2zm16 0h2v-2h-2v2zm0-10v2h2V7h-2zm0 6h2v-2h-2v2z"}),"Toc")},85006(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var o=i(r(14041));t.default=(0,n(r(74044)).default)(o.createElement("path",{d:"M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3 3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"}),"WrapText")},11259(e,t){"use strict";var r,n=Symbol.for("react.element"),i=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.server_context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen");function y(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case o:case a:case s:case d:case f:return e;default:switch(e=e&&e.$$typeof){case u:case c:case h:case m:case p:case l:return e;default:return t}}case i:return t}}}r=Symbol.for("react.module.reference"),t.ContextConsumer=c,t.ContextProvider=l,t.Element=n,t.ForwardRef=h,t.Fragment=o,t.Lazy=m,t.Memo=p,t.Portal=i,t.Profiler=a,t.StrictMode=s,t.Suspense=d,t.SuspenseList=f,t.isAsyncMode=function(){return!1},t.isConcurrentMode=function(){return!1},t.isContextConsumer=function(e){return y(e)===c},t.isContextProvider=function(e){return y(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return y(e)===h},t.isFragment=function(e){return y(e)===o},t.isLazy=function(e){return y(e)===m},t.isMemo=function(e){return y(e)===p},t.isPortal=function(e){return y(e)===i},t.isProfiler=function(e){return y(e)===a},t.isStrictMode=function(e){return y(e)===s},t.isSuspense=function(e){return y(e)===d},t.isSuspenseList=function(e){return y(e)===f},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===a||e===s||e===d||e===f||e===g||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===p||e.$$typeof===l||e.$$typeof===c||e.$$typeof===h||e.$$typeof===r||void 0!==e.getModuleId)||!1},t.typeOf=y},35631(e,t,r){"use strict";e.exports=r(11259)},95716(e){"u">typeof self&&self,e.exports=(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"u">typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function r(e){return"#"===e||""===e||Array.isArray(e)&&0===e.length||!1}e.r(t),e.d(t,{default:()=>A,get:()=>u,isRoot:()=>r,join:()=>w,remove:()=>g,removeUndefinedItems:()=>m,set:()=>f,split:()=>c,splitLast:()=>k});let n=/~1/g,i=/~0/g,o=/\/+/g,s=/(^[#/]*|\/+$)/g;function a(e){return e.replace(n,"/").replace(i,"~")}function l(e){return a(decodeURIComponent(e))}function c(e){if(null==e||"string"!=typeof e||r(e))return Array.isArray(e)?e:[];let t=e.indexOf("#")>=0?l:a,n=(e=(e=e.replace(o,"/")).replace(s,"")).split("/");for(let e=0,r=n.length;e<r;e+=1)n[e]=t(n[e]);return n}function u(e,t,n){if(null==t||null==e)return n;if(r(t))return e;let i=function e(t,r){let n=r.shift();if(void 0!==t)return void 0!==n?e(t[n],r):t}(e,c(t));return void 0===i?n:i}let h=/^\[.*\]$/,d=/^\[(.+)\]$/;function f(e,t,r){if(null==t)return e;let n=c(t);if(0===n.length)return e;null==e&&(e=h.test(n[0])?[]:{});let i,o,s=e;for(;n.length>1;){var a;i=n.shift(),o=h.test(n[0]),"__proto__"===(a=i)||"constructor"==a&&n.length>0&&"prototype"==n[0]||(s=function(e,t,r){if(null!=e[t])return e[t];let n=r?[]:{};return p(e,t,n),n}(s,i,o))}return p(s,i=n.pop(),r),e}function p(e,t,r){let n=t.match(d);"[]"===t&&Array.isArray(e)?e.push(r):n?e[n.pop()]=r:e[t]=r}function m(e){let t=0,r=0;for(;t+r<e.length;)void 0===e[t+r]&&(r+=1),e[t]=e[t+r],t+=1;return e.length=e.length-r,e}function g(e,t,r){let n=c(t),i=n.pop(),o=u(e,n);return o&&delete o[i],Array.isArray(o)&&!0!==r&&m(o),e}let y=/\/+/g,v=/~/g,b=/\//g;function x(e,t){if(0===e.length)return t?"#":"";for(let r=0,n=e.length;r<n;r+=1)e[r]=e[r].replace(v,"~0").replace(b,"~1"),t&&(e[r]=encodeURIComponent(e[r]));return((t?"#/":"/")+e.join("/")).replace(y,"/")}function w(e){let t=[];if(Array.isArray(e))return x(e,!0===arguments[1]);let r=arguments[arguments.length-1],n="boolean"==typeof r?r:e&&"#"===e[0];for(let e=0,r=arguments.length;e<r;e+=1)t.push.apply(t,c(arguments[e]));let i=[];for(let e=0,r=t.length;e<r;e+=1)if(".."===t[e]){if(0===i.length)return n?"#":"";i.pop()}else i.push(t[e]);return x(i,n)}function k(e){let t=c(e);if(0===t.length)return"string"==typeof e&&"#"===e[0]?["#",t[0]]:["",void 0];if(1===t.length)return"#"===e[0]?["#",t[0]]:["",t[0]];let r=t.pop();return[w(t,"#"===e[0]),r]}let A={get:u,set:f,remove:g,join:w,split:c,splitLast:k,isRoot:r,removeUndefinedItems:m};return t})()},49004(e,t,r){"use strict";var n=r(10646),i=r(50709),o=r(43225);function s(e,t){var r,n=1;if(0===e)return t;if(0===t)return e;for(;e%2==0&&t%2==0;)e/=2,t/=2,n*=2;for(;e%2==0;)e/=2;for(;t;){for(;t%2==0;)t/=2;e>t&&(r=t,t=e,e=r),t-=e}return n*e}function a(e,t){var r,n=0;if(0===e)return t;if(0===t)return e;for(;(1&e)==0&&(1&t)==0;)e>>>=1,t>>>=1,n++;for(;(1&e)==0;)e>>>=1;for(;t;){for(;(1&t)==0;)t>>>=1;e>t&&(r=t,t=e,e=r),t-=e}return e<<n}e.exports=function(){var e,t,r,l,c,u,h,d=arguments.length;for(h=0,e=Array(d);h<d;h++)e[h]=arguments[h];if(i(e)){if(2===d)return(c=e[0],u=e[1],c<0&&(c=-c),u<0&&(u=-u),c<=0x7fffffff&&u<=0x7fffffff)?a(c,u):s(c,u);r=e}else if(n(e[0]))if(d>1){if(r=e[0],!o(t=e[1]))throw TypeError("gcd()::invalid input argument. Accessor must be a function. Value: `"+t+"`.")}else r=e[0];else throw TypeError("gcd()::invalid input argument. Must provide an array of integers. Value: `"+e[0]+"`.");if((l=r.length)<2)return null;if(t){for(h=0,c=Array(l);h<l;h++)c[h]=t(r[h],h);r=c}if(d<3&&!i(r))throw TypeError("gcd()::invalid input argument. Accessed array values must be integers. Value: `"+r+"`.");for(h=0;h<l;h++)(c=r[h])<0&&(r[h]=-c);for(h=1,c=r[0];h<l;h++)c=(u=r[h])<=0x7fffffff&&c<=0x7fffffff?a(c,u):s(c,u);return c}},23050(e,t,r){"use strict";var n=r(49004),i=r(10646),o=r(50709),s=r(43225);e.exports=function(){var e,t,r,a,l,c,u,h=arguments.length;for(u=0,e=Array(h);u<h;u++)e[u]=arguments[u];if(o(e)){if(2===h)return(l=e[0],c=e[1],l<0&&(l=-l),c<0&&(c=-c),0===l||0===c)?0:l/n(l,c)*c;r=e}else if(i(e[0]))if(h>1){if(r=e[0],!s(t=e[1]))throw TypeError("lcm()::invalid input argument. Accessor must be a function. Value: `"+t+"`.")}else r=e[0];else throw TypeError("lcm()::invalid input argument. Must provide an array of integers. Value: `"+e[0]+"`.");if((a=r.length)<2)return null;if(t){for(u=0,l=Array(a);u<a;u++)l[u]=t(r[u],u);r=l}if(h<3&&!o(r))throw TypeError("lcm()::invalid input argument. Accessed array values must be integers. Value: `"+r+"`.");for(u=0;u<a;u++)(l=r[u])<0&&(r[u]=-l);for(u=1,l=r[0];u<a;u++){if(c=r[u],0===l||0===c)return 0;l=l/n(l,c)*c}return l}},22193(e,t,r){"use strict";var n;let i=r(65280);!function(e){e.RULES=[{name:"Grammar",bnf:[["RULE_S*","%Atomic*","EOF"]]},{name:"%Atomic",bnf:[["Production","RULE_S*"]],fragment:!0},{name:"Production",bnf:[["NCName","RULE_S*",'"::="',"RULE_WHITESPACE*","Choice","RULE_WHITESPACE*","RULE_EOL+","RULE_S*"]]},{name:"NCName",bnf:[[/[a-zA-Z][a-zA-Z_0-9]*/]]},{name:"Choice",bnf:[["SequenceOrDifference","%_Choice_1*"]],fragment:!0},{name:"%_Choice_1",bnf:[["RULE_WHITESPACE*",'"|"',"RULE_WHITESPACE*","SequenceOrDifference"]],fragment:!0},{name:"SequenceOrDifference",bnf:[["Item","RULE_WHITESPACE*","%_Item_1?"]]},{name:"%_Item_1",bnf:[["Minus","Item"],["Item*"]],fragment:!0},{name:"Minus",bnf:[['"-"']]},{name:"Item",bnf:[["RULE_WHITESPACE*","%Primary","PrimaryDecoration?"]],fragment:!0},{name:"PrimaryDecoration",bnf:[['"?"'],['"*"'],['"+"']]},{name:"DecorationName",bnf:[['"ebnf://"',/[^\x5D#]+/]]},{name:"%Primary",bnf:[["NCName"],["StringLiteral"],["CharCode"],["CharClass"],["SubItem"]],fragment:!0},{name:"SubItem",bnf:[['"("',"RULE_WHITESPACE*","Choice","RULE_WHITESPACE*",'")"']]},{name:"StringLiteral",bnf:[["'\"'",/[^"]*/,"'\"'"],['"\'"',/[^']*/,'"\'"']],pinned:1},{name:"CharCode",bnf:[['"#x"',/[0-9a-zA-Z]+/]]},{name:"CharClass",bnf:[["'['","'^'?","%RULE_CharClass_1+",'"]"']]},{name:"%RULE_CharClass_1",bnf:[["CharCodeRange"],["CharRange"],["CharCode"],["RULE_Char"]],fragment:!0},{name:"RULE_Char",bnf:[[/\x09/],[/\x0A/],[/\x0D/],[/[\x20-\x5c]/],[/[\x5e-\uD7FF]/],[/[\uE000-\uFFFD]/]]},{name:"CharRange",bnf:[["RULE_Char",'"-"',"RULE_Char"]]},{name:"CharCodeRange",bnf:[["CharCode",'"-"',"CharCode"]]},{name:"RULE_WHITESPACE",bnf:[["%RULE_WHITESPACE_CHAR*"],["Comment","RULE_WHITESPACE*"]]},{name:"RULE_S",bnf:[["RULE_WHITESPACE","RULE_S*"],["RULE_EOL","RULE_S*"]]},{name:"%RULE_WHITESPACE_CHAR",bnf:[[/\x09/],[/\x20/]],fragment:!0},{name:"Comment",bnf:[['"/*"',"%RULE_Comment_Body*",'"*/"']]},{name:"%RULE_Comment_Body",bnf:[['!"*/"',/[^*]/]],fragment:!0},{name:"RULE_EOL",bnf:[[/\x0D/,/\x0A/],[/\x0A/],[/\x0D/]]},{name:"Link",bnf:[["'['","Url","']'"]]},{name:"Url",bnf:[[/[^\x5D:/?#]/,'"://"',/[^\x5D#]+/,"%Url1?"]]},{name:"%Url1",bnf:[['"#"',"NCName"]],fragment:!0}],e.defaultParser=new i.Parser(e.RULES,{debug:!1});let t=/^(!|&)/,r=/(\?|\+|\*)$/,n=/^%/;function o(e){let o=[];return e.grammarRules.forEach(s=>{if(!/^%/.test(s.name)){let a=s.recover?" /* { recoverUntil="+s.recover+" } */":"";o.push(s.name+" ::= "+function e(o,s){let a=i.findRuleByName(o,s);return a?a.bnf.map(o=>o.map(o=>(function(o,s){if("string"!=typeof o)return o.source.replace(/\\(?:x|u)([a-zA-Z0-9]+)/g,"#x$1").replace(/\[\\(?:x|u)([a-zA-Z0-9]+)-\\(?:x|u)([a-zA-Z0-9]+)\]/g,"[#x$1-#x$2]");if(t.test(o))return"";if(n.test(o)){var a,l;let t,n=r.exec(o),c=n?n[0]+" ":"";return(a=o,l=s,(t=i.findRuleByName(a,l))&&1==t.bnf.length&&1==t.bnf[0].length&&(t.bnf[0][0]instanceof RegExp||'"'==t.bnf[0][0][0]||"'"==t.bnf[0][0][0]))?e(o,s)+c:"("+e(o,s)+")"+c}return o})(o,s)).join(" ")).join(" | "):"RULE_NOT_FOUND {"+o+"}"}(s.name,e)+a)}}),o.join("\n")}e.emit=o;let s=0;function a(e){return new RegExp(e.replace(/#x([a-zA-Z0-9]{4})/g,"\\u$1").replace(/#x([a-zA-Z0-9]{3})/g,"\\u0$1").replace(/#x([a-zA-Z0-9]{2})/g,"\\x$1").replace(/#x([a-zA-Z0-9]{1})/g,"\\x0$1"))}function l(t,r=e.defaultParser){let n=r.getAST(t);if(!n)throw Error("Could not parse "+t);if(n.errors&&n.errors.length)throw n.errors[0];let i=[];return n.children.filter(e=>"Production"==e.type).map(e=>{let t=e.children.filter(e=>"NCName"==e.type)[0].text;!function e(t,r,n){let i=r.children.filter(e=>"SequenceOrDifference"==e.type).map(r=>{let i,o;return i=null,o=[],r.children.forEach((l,c)=>{if("Minus"==l.type)throw console.log("reberia restar "+l+" a "+i),Error("Difference not supported yet");let u=r.children[c+1];switch(u=u&&"PrimaryDecoration"==u.type&&u.text||"",l.type){case"SubItem":let h="%"+(n+s++);e(t,l,h),o.push(""+h+u);break;case"NCName":case"StringLiteral":o.push(""+l.text+u);break;case"CharCode":case"CharClass":if(u){let e={name:"%"+(n+s++),bnf:[[a(l.text)]]};t.push(e),o.push(""+e.name+u)}else o.push(a(l.text));break;case"PrimaryDecoration":break;default:throw Error(" HOW SHOULD I PARSE THIS? "+l.type+" -> "+JSON.stringify(l.text))}i=l}),o}),o={name:n,bnf:i},l=null;i.forEach(e=>{l=l||e.recover,delete e.recover}),0==n.indexOf("%")&&(o.fragment=!0),l&&(o.recover=l),t.push(o)}(i,e,t)}),i}e.getRules=l,e.Transform=function(t,r=e.defaultParser){return l(t.join(""),r)};class c extends i.Parser{constructor(t,r){super(l(t,r&&!0===r.debugRulesParser?new i.Parser(e.RULES,{debug:!0}):e.defaultParser),r)}emitSource(){return o(this)}}e.Parser=c}(n||(n={})),t.default=n},65280(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=t.findRuleByName=t.parseRuleName=t.escapeRegExp=t.readToken=void 0;let n=/^[A-Z0-9_]+$/,i=/(\?|\+|\*)$/,o=/^(@|&|!)/,s=r(89849);function a(e,t){let r=t.exec(e);return r&&0==r.index?0==r[0].length&&t.source.length>0?null:{type:null,text:r[0],rest:e.substr(r[0].length),start:0,end:r[0].length-1,fullText:r[0],errors:[],children:[],parent:null}:null}function l(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function c(e){let t=i.exec(e),r=o.exec(e),n=t&&t[0]||"",s=r&&r[0]||"",a={raw:e,name:e.replace(i,"").replace(o,""),isOptional:"?"==n||"*"==n,allowRepetition:"+"==n||"*"==n,atLeastOne:"+"==n,lookupPositive:"&"==s,lookupNegative:"!"==s,pinned:"@"==s,lookup:!1,isLiteral:!1};return a.isLiteral="'"==a.name[0]||'"'==a.name[0],a.lookup=a.lookupNegative||a.lookupPositive,a}function u(e,t){let r=c(e);return t.cachedRules[r.name]||null}function h(e,t){if(e.children){let r=e.children.filter(e=>e.type&&t.test(e.type));for(let t=0;t<r.length;t++){let n=e.children.indexOf(r[t]);-1!=n&&e.children.splice(n,1)}e.children.forEach(e=>h(e,t))}}t.readToken=a,t.escapeRegExp=l,t.parseRuleName=c,t.findRuleByName=u;let d=["EOF"];class f{constructor(e,t){this.grammarRules=e,this.options=t,this.cachedRules={},this.debug=!!t&&!0===t.debug;let r=[],n=[];if(e.forEach(e=>{let t=c(e.name);if(t.name in this.cachedRules)return void r.push("Duplicated rule "+t.name);if(this.cachedRules[t.name]=e,e.bnf&&e.bnf.length)e.bnf.forEach(t=>{if("string"==typeof t[0]&&c(t[0]).name==e.name){let t="Left recursion is not allowed, rule: "+e.name;-1==r.indexOf(t)&&r.push(t)}t.forEach(e=>{if("string"==typeof e){let t=c(e);t.isLiteral||-1!=n.indexOf(t.name)||-1!=d.indexOf(t.name)||n.push(t.name)}})});else{let t="Missing rule content, rule: "+e.name;-1==r.indexOf(t)&&r.push(t)}"WS"==e.name&&(e.implicitWs=!1),e.implicitWs&&-1==n.indexOf("WS")&&n.push("WS"),e.recover&&-1==n.indexOf(e.recover)&&n.push(e.recover)}),n.forEach(e=>{e in this.cachedRules||r.push("Missing rule "+e)}),r.length)throw Error(r.join("\n"))}getAST(e,t){t||(t=this.grammarRules.filter(e=>!e.fragment&&0!=e.name.indexOf("%"))[0].name);let r=this.parse(e,t);if(r){!function e(t,r){r.errors&&r.errors.length&&r.errors.forEach(e=>t.push(e)),r.children&&r.children.forEach(r=>e(t,r))}(r.errors,r),function e(t,r){t.start+=r,t.end+=r,t.children&&t.children.forEach(r=>e(r,t.start))}(r,0),h(r,/^%/),this.options&&this.options.keepUpperRules||h(r,n);let e=r.rest;e&&new s.TokenError("Unexpected end of input: \n"+e,r),function e(t){t.rest="",t.children&&t.children.forEach(t=>e(t))}(r),r.rest=e}return r}emitSource(){return"CANNOT EMIT SOURCE FROM BASE Parser"}parse(e,t,r=0){let i,o=null,h=c(t),d=this.debug&&!n.test(h.name);d&&console.log(Array(r).join("  ")+"Trying to get "+t+" from "+JSON.stringify(e.split("\n")[0]));let f=h.name,p=u(h.name,this);if("EOF"==h.name){if(e.length)return null;else if(0==e.length)return{type:"EOF",text:"",rest:"",start:0,end:0,fullText:"",errors:[],children:[],parent:null}}try{if(!p&&h.isLiteral){let t=h.name.trim();if(t.startsWith('"')?t=JSON.parse(t):t.startsWith("'")&&(t=t.replace(/^'(.+)'$/,"$1").replace(/\\'/g,"'")),""===t)return{type:"%%EMPTY%%",text:"",rest:e,start:0,end:0,fullText:"",errors:[],children:[],parent:null};i=new RegExp(l(t)),f=null}}catch(e){return e instanceof ReferenceError&&console.error(e),null}if(i){let t=a(e,i);if(t)return t.type=f,t}else{let t=p.bnf;t instanceof Array&&t.forEach(t=>{if(o)return;let n=null,i={type:h.name,text:"",children:[],end:0,errors:[],fullText:"",parent:null,start:0,rest:e};p.fragment&&(i.fragment=!0);let l=e,u=0,f=t.length>0,m=!1;for(let e=0;e<t.length;e++)if("string"==typeof t[e]){let a,h=c(t[e]);f=f&&h.isOptional;let g=!1;do{if(a=null,p.implicitWs&&!(a=this.parse(l,h.name,r+1))){let e;do if(e=this.parse(l,"WS",r+1))i.text=i.text+e.text,i.end=i.text.length,e.parent=i,i.children.push(e),l=l.substr(e.text.length),u+=e.text.length;else break;while(e&&e.text.length)}if(a=a||this.parse(l,h.name,r+1),h.lookupNegative){if(a)return;break}if(h.lookupPositive&&!a)return;if(!a&&(h.isOptional||h.atLeastOne&&g))break;if(a&&p.pinned==e+1&&(n=a,d&&console.log(Array(r+1).join("  ")+" "+a.type+" PINNED")),a||(a=this.parseRecovery(p,l,r+1)),!a)if(!n)return;else o=i,a={type:"SyntaxError",text:l,children:[],end:l.length,errors:[],fullText:"",parent:null,start:0,rest:""},l.length?new s.TokenError(`Unexpected end of input. Expecting ${h.name} Got: ${l}`,a):new s.TokenError(`Unexpected end of input. Missing ${h.name}`,a),d&&console.log(Array(r+1).join("  ")+" "+a.type+" "+JSON.stringify(a.text));if(g=!0,m=!0,"%%EMPTY%%"==a.type)break;a.start+=u,a.end+=u,!h.lookupPositive&&a.type&&(a.fragment?a.children&&a.children.forEach(e=>{e.start+=u,e.end+=u,e.parent=i,i.children.push(e)}):(a.parent=i,i.children.push(a))),h.lookup&&(a.lookup=!0),d&&console.log(Array(r+1).join("  ")+" "+a.type+" "+JSON.stringify(a.text)),h.lookup||a.lookup||(i.text=i.text+a.text,i.end=i.text.length,l=l.substr(a.text.length),u+=a.text.length),i.rest=l}while(a&&h.allowRepetition&&l.length&&!a.lookup)}else{let n=a(l,t[e]);if(!n)return;d&&console.log(Array(r+1).join("  ")+"> "+JSON.stringify(n.text)+t[e].source),m=!0,n.start+=u,n.end+=u,i.text=i.text+n.text,i.end=i.text.length,l=l.substr(n.text.length),u+=n.text.length,i.rest=l}m&&(o=i,d&&console.log(Array(r).join("  ")+"<< PUSHING "+o.type+" "+JSON.stringify(o.text)))}),o&&p.simplifyWhenOneChildren&&1==o.children.length&&(o=o.children[0])}return!o&&d&&console.log(t+" NOT RESOLVED FROM "+e),o}parseRecovery(e,t,r){if(e.recover&&t.length){let n,i=this.debug;i&&console.log(Array(r+1).join("  ")+"Trying to recover until token "+e.recover+" from "+JSON.stringify(t.split("\n")[0]+t.split("\n")[1]));let o={type:"SyntaxError",text:"",children:[],end:0,errors:[],fullText:"",parent:null,start:0,rest:""};do{if(n=this.parse(t,e.recover,r+1)){new s.TokenError('Unexpected input: "'+o.text+`" Expecting: ${e.name}`,o);break}o.text=o.text+t[0],o.end=o.text.length,t=t.substr(1)}while(!n&&t.length>0);if(o.text.length>0&&n)return i&&console.log(Array(r+1).join("  ")+"Recovered text: "+JSON.stringify(o.text)),o}return null}}t.Parser=f,t.default=f},89849(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenError=void 0,t.TokenError=class extends Error{constructor(e,t){if(super(e),this.message=e,this.token=t,t&&t.errors)t.errors.push(this);else throw this}inspect(){return"SyntaxError: "+this.message}}},4794(e){!function(){var t=Object.assign||function(e){for(var t,r=1;r<arguments.length;r++)for(var n in t=arguments[r])g(t,n)&&(e[n]=t[n]);return e},r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},n=a(["",""],["",""],["",""],["",""],["",""],["",""],["",""],["  ","  "],","),i={af:a(["jaar","jaar"],["maand","maande"],["week","weke"],["dag","dae"],["uur","ure"],["minuut","minute"],["sekonde","sekondes"],["millisekonde","millisekondes"],","),am:o("","","","","","","",""),ar:t(o(function(e){return["","",""][h(e)]},function(e){return["","",""][h(e)]},function(e){return["","",""][h(e)]},function(e){return["","",""][h(e)]},function(e){return["","",""][h(e)]},function(e){return["","",""][h(e)]},function(e){return["","",""][h(e)]},function(e){return["  ","  ","  "][h(e)]},","),{delimiter:"  ",_hideCountIf2:!0,_digitReplacements:["","","","","","","","","",""]}),bg:u(["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""]),bn:o("","","","","","","",""),ca:a(["any","anys"],["mes","mesos"],["setmana","setmanes"],["dia","dies"],["hora","hores"],["minut","minuts"],["segon","segons"],["milisegon","milisegons"],","),ckb:o("","","","","","",""," ","."),cs:o(function(e){return["rok","roku","roky","let"][f(e)]},function(e){return["ms\xedc","ms\xedce","ms\xedce","ms\xedc"][f(e)]},function(e){return["t\xfdden","t\xfddne","t\xfddny","t\xfddn"][f(e)]},function(e){return["den","dne","dny","dn\xed"][f(e)]},function(e){return["hodina","hodiny","hodiny","hodin"][f(e)]},function(e){return["minuta","minuty","minuty","minut"][f(e)]},function(e){return["sekunda","sekundy","sekundy","sekund"][f(e)]},function(e){return["milisekunda","milisekundy","milisekundy","milisekund"][f(e)]},","),cy:o("flwyddyn","mis","wythnos","diwrnod","awr","munud","eiliad","milieiliad"),da:a(["\xe5r","\xe5r"],["m\xe5ned","m\xe5neder"],["uge","uger"],["dag","dage"],["time","timer"],["minut","minutter"],["sekund","sekunder"],["millisekund","millisekunder"],","),de:a(["Jahr","Jahre"],["Monat","Monate"],["Woche","Wochen"],["Tag","Tage"],["Stunde","Stunden"],["Minute","Minuten"],["Sekunde","Sekunden"],["Millisekunde","Millisekunden"],","),el:n,en:a(["year","years"],["month","months"],["week","weeks"],["day","days"],["hour","hours"],["minute","minutes"],["second","seconds"],["millisecond","milliseconds"]),eo:a(["jaro","jaroj"],["monato","monatoj"],["semajno","semajnoj"],["tago","tagoj"],["horo","horoj"],["minuto","minutoj"],["sekundo","sekundoj"],["milisekundo","milisekundoj"],","),es:a(["a\xf1o","a\xf1os"],["mes","meses"],["semana","semanas"],["d\xeda","d\xedas"],["hora","horas"],["minuto","minutos"],["segundo","segundos"],["milisegundo","milisegundos"],","),et:a(["aasta","aastat"],["kuu","kuud"],["n\xe4dal","n\xe4dalat"],["p\xe4ev","p\xe4eva"],["tund","tundi"],["minut","minutit"],["sekund","sekundit"],["millisekund","millisekundit"],","),eu:o("urte","hilabete","aste","egun","ordu","minutu","segundo","milisegundo",","),fa:o("","","","","","",""," "),fi:a(["vuosi","vuotta"],["kuukausi","kuukautta"],["viikko","viikkoa"],["p\xe4iv\xe4","p\xe4iv\xe4\xe4"],["tunti","tuntia"],["minuutti","minuuttia"],["sekunti","sekuntia"],["millisekunti","millisekuntia"],","),fo:a(["\xe1r","\xe1r"],["m\xe1na\xf0ur","m\xe1na\xf0ir"],["vika","vikur"],["dagur","dagar"],["t\xedmi","t\xedmar"],["minuttur","minuttir"],["sekund","sekund"],["millisekund","millisekund"],","),fr:o(function(e){return"an"+(e>=2?"s":"")},"mois",function(e){return"semaine"+(e>=2?"s":"")},function(e){return"jour"+(e>=2?"s":"")},function(e){return"heure"+(e>=2?"s":"")},function(e){return"minute"+(e>=2?"s":"")},function(e){return"seconde"+(e>=2?"s":"")},function(e){return"milliseconde"+(e>=2?"s":"")},","),gr:n,he:a(["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]),hr:o(function(e){return e%10==2||e%10==3||e%10==4?"godine":"godina"},function(e){return 1===e?"mjesec":2===e||3===e||4===e?"mjeseca":"mjeseci"},function(e){return e%10==1&&11!==e?"tjedan":"tjedna"},s(["dan","dana"]),function(e){return 1===e?"sat":2===e||3===e||4===e?"sata":"sati"},function(e){var t=e%10;return(2===t||3===t||4===t)&&(e<10||e>14)?"minute":"minuta"},function(e){var t=e%10;if(5===t||Math.floor(e)===e&&e>=10&&e<=19);else if(1===t)return"sekunda";else if(2===t||3===t||4===t)return"sekunde";return"sekundi"},function(e){return 1===e?"milisekunda":e%10==2||e%10==3||e%10==4?"milisekunde":"milisekundi"},","),hi:o("",s(["",""]),s(["",""]),"",s(["",""]),"","",""),hu:o("\xe9v","h\xf3nap","h\xe9t","nap","\xf3ra","perc","m\xe1sodperc","ezredm\xe1sodperc",","),id:o("tahun","bulan","minggu","hari","jam","menit","detik","milidetik"),is:a(["\xe1r","\xe1r"],["m\xe1nu\xf0ur","m\xe1nu\xf0ir"],["vika","vikur"],["dagur","dagar"],["klukkut\xedmi","klukkut\xedmar"],["m\xedn\xfata","m\xedn\xfatur"],["sek\xfanda","sek\xfandur"],["millisek\xfanda","millisek\xfandur"]),it:a(["anno","anni"],["mese","mesi"],["settimana","settimane"],["giorno","giorni"],["ora","ore"],["minuto","minuti"],["secondo","secondi"],["millisecondo","millisecondi"],","),ja:o("","","","","","","",""),km:o("","","","","","","",""),kn:a(["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]),ko:o("","","","","","",""," "),ku:o("sal","meh","hefte","roj","seet","deqe","saniye","m\xeel\xee\xe7irk",","),lo:o("","","","","","","","",","),lt:o(function(e){return e%10==0||e%100>=10&&e%100<=20?"met":"metai"},function(e){return["mnuo","mnesiai","mnesi"][p(e)]},function(e){return["savait","savaits","savaii"][p(e)]},function(e){return["diena","dienos","dien"][p(e)]},function(e){return["valanda","valandos","valand"][p(e)]},function(e){return["minut","minuts","minui"][p(e)]},function(e){return["sekund","sekunds","sekundi"][p(e)]},function(e){return["milisekund","milisekunds","milisekundi"][p(e)]},","),lv:o(function(e){return m(e)?"gads":"gadi"},function(e){return m(e)?"mnesis":"mnei"},function(e){return m(e)?"neda":"nedas"},function(e){return m(e)?"diena":"dienas"},function(e){return m(e)?"stunda":"stundas"},function(e){return m(e)?"minte":"mintes"},function(e){return m(e)?"sekunde":"sekundes"},function(e){return m(e)?"milisekunde":"milisekundes"},","),mk:a(["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],","),mn:o("",""," ","","","","",""),mr:o(s(["",""]),s(["",""]),s(["",""]),"","",s(["",""]),"",""),ms:o("tahun","bulan","minggu","hari","jam","minit","saat","milisaat"),nl:a(["jaar","jaar"],["maand","maanden"],["week","weken"],["dag","dagen"],["uur","uur"],["minuut","minuten"],["seconde","seconden"],["milliseconde","milliseconden"],","),no:a(["\xe5r","\xe5r"],["m\xe5ned","m\xe5neder"],["uke","uker"],["dag","dager"],["time","timer"],["minutt","minutter"],["sekund","sekunder"],["millisekund","millisekunder"],","),pl:o(function(e){return["rok","roku","lata","lat"][d(e)]},function(e){return["miesic","miesica","miesice","miesicy"][d(e)]},function(e){return["tydzie","tygodnia","tygodnie","tygodni"][d(e)]},function(e){return["dzie","dnia","dni","dni"][d(e)]},function(e){return["godzina","godziny","godziny","godzin"][d(e)]},function(e){return["minuta","minuty","minuty","minut"][d(e)]},function(e){return["sekunda","sekundy","sekundy","sekund"][d(e)]},function(e){return["milisekunda","milisekundy","milisekundy","milisekund"][d(e)]},","),pt:a(["ano","anos"],["m\xeas","meses"],["semana","semanas"],["dia","dias"],["hora","horas"],["minuto","minutos"],["segundo","segundos"],["milissegundo","milissegundos"],","),ro:o(l("an","ani","de ani"),l("lun","luni","de luni"),l("sptm\xe2n","sptm\xe2ni","de sptm\xe2ni"),l("zi","zile","de zile"),l("or","ore","de ore"),l("minut","minute","de minute"),l("secund","secunde","de secunde"),l("milisecund","milisecunde","de milisecunde"),","),ru:u(["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""]),sq:o(s(["vit","vjet"]),"muaj","jav\xeb","dit\xeb","or\xeb",function(e){return"minut"+(1===e?"\xeb":"a")},function(e){return"sekond"+(1===e?"\xeb":"a")},function(e){return"milisekond"+(1===e?"\xeb":"a")},","),sr:u(["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""]),sr_Latn:u(["godini","godina","godine"],["meseci","mesec","meseca"],["nedelji","nedelja","nedelje"],["dani","dan","dana"],["sati","sat","sata"],["minuta","minut","minuta"],["sekundi","sekunda","sekunde"],["milisekundi","milisekunda","milisekunde"]),ta:a(["",""],["",""],["",""],["",""],["",""],["",""],["",""],[" "," "]),te:a(["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]),uk:u(["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""]),ur:o("",s(["",""]),s(["",""]),"",s(["",""]),"",""," "),sk:o(function(e){return["rok","roky","roky","rokov"][f(e)]},function(e){return["mesiac","mesiace","mesiace","mesiacov"][f(e)]},function(e){return["t\xfdde","t\xfddne","t\xfddne","t\xfddov"][f(e)]},function(e){return["de","dni","dni","dn\xed"][f(e)]},function(e){return["hodina","hodiny","hodiny","hod\xedn"][f(e)]},function(e){return["min\xfata","min\xfaty","min\xfaty","min\xfat"][f(e)]},function(e){return["sekunda","sekundy","sekundy","sek\xfand"][f(e)]},function(e){return["milisekunda","milisekundy","milisekundy","milisek\xfand"][f(e)]},","),sl:o(function(e){return e%10==1?"leto":e%100==2?"leti":e%100==3||e%100==4||Math.floor(e)!==e&&e%100<=5?"leta":"let"},function(e){return e%10==1?"mesec":e%100==2||Math.floor(e)!==e&&e%100<=5?"meseca":e%10==3||e%10==4?"mesece":"mesecev"},function(e){return e%10==1?"teden":e%10==2||Math.floor(e)!==e&&e%100<=4?"tedna":e%10==3||e%10==4?"tedne":"tednov"},function(e){return e%100==1?"dan":"dni"},function(e){return e%10==1?"ura":e%100==2?"uri":e%10==3||e%10==4||Math.floor(e)!==e?"ure":"ur"},function(e){return e%10==1?"minuta":e%10==2?"minuti":e%10==3||e%10==4||Math.floor(e)!==e&&e%100<=4?"minute":"minut"},function(e){return e%10==1?"sekunda":e%100==2?"sekundi":e%100==3||e%100==4||Math.floor(e)!==e?"sekunde":"sekund"},function(e){return e%10==1?"milisekunda":e%100==2?"milisekundi":e%100==3||e%100==4||Math.floor(e)!==e?"milisekunde":"milisekund"},","),sv:a(["\xe5r","\xe5r"],["m\xe5nad","m\xe5nader"],["vecka","veckor"],["dag","dagar"],["timme","timmar"],["minut","minuter"],["sekund","sekunder"],["millisekund","millisekunder"],","),sw:t(a(["mwaka","miaka"],["mwezi","miezi"],["wiki","wiki"],["siku","masiku"],["saa","masaa"],["dakika","dakika"],["sekunde","sekunde"],["milisekunde","milisekunde"]),{_numberFirst:!0}),tr:o("yl","ay","hafta","g\xfcn","saat","dakika","saniye","milisaniye",","),th:o("","","","","","","",""),uz:o("yil","oy","hafta","kun","soat","minut","sekund","millisekund"),uz_CYR:o("","","","","","","",""),vi:o("nm","th\xe1ng","tun","ng\xe0y","gi","ph\xfat","gi\xe2y","mili gi\xe2y",","),zh_CN:o("","","","","","","",""),zh_TW:o("","","","","","","","")};function o(e,t,r,n,i,o,s,a,l){var c={y:e,mo:t,w:r,d:n,h:i,m:o,s:s,ms:a};return l&&(c.decimal=l),c}function s(e){return function(t){return 1===t?e[0]:e[1]}}function a(e,t,r,n,i,a,l,c,u){return o(s(e),s(t),s(r),s(n),s(i),s(a),s(l),s(c),u)}function l(e,t,r){return function(n){if(1===n)return e;if(Math.floor(n)!==n||0===n)return t;var i=n%100;return i>=1&&i<=19?t:r}}function c(e){return function(t){return Math.floor(t)!==t?e[2]:t%100>=5&&t%100<=20||t%10>=5&&t%10<=9||t%10==0?e[0]:t%10==1?e[1]:t>1?e[2]:e[1]}}function u(e,t,r,n,i,s,a,l){return o(c(e),c(t),c(r),c(n),c(i),c(s),c(a),c(l),",")}function h(e){return 2===e?1:2*(e>2&&e<11)}function d(e){return 1===e?0:Math.floor(e)!==e?1:e%10>=2&&e%10<=4&&!(e%100>10&&e%100<20)?2:3}function f(e){return 1===e?0:Math.floor(e)!==e?1:e%10>=2&&e%10<=4&&e%100<10?2:3}function p(e){return 1===e||e%10==1&&e%100>20?0:Math.floor(e)!==e||e%10>=2&&e%100>20||e%10>=2&&e%100<10?1:2}function m(e){return e%10==1&&e%100!=11}function g(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function y(e,t,r){var n,i,o,s,a=e.unitName,l=e.unitCount,c=r.spacer,u=r.maxDecimalPoints;n=g(r,"decimal")?r.decimal:g(t,"decimal")?t.decimal:".","digitReplacements"in r?i=r.digitReplacements:"_digitReplacements"in t&&(i=t._digitReplacements);var h=(void 0===u?l:Math.floor(l*Math.pow(10,u))/Math.pow(10,u)).toString();if(t._hideCountIf2&&2===l)o="",c="";else if(i){o="";for(var d=0;d<h.length;d++){var f=h[d];"."===f?o+=n:o+=i[f]}}else o=h.replace(".",n);var p=t[a];return(s="function"==typeof p?p(l):p,t._numberFirst)?s+c+o:o+c+s}function v(e){var n=function(e,o){e=Math.abs(e);var s=t({},n,o||{});return function(e,t){var n,o=function(e){var t=[e.language];if(g(e,"fallbacks"))if(r(e.fallbacks)&&e.fallbacks.length)t=t.concat(e.fallbacks);else throw Error("fallbacks must be an array with at least one element");for(var n=0;n<t.length;n++){var o=t[n];if(g(e.languages,o))return e.languages[o];if(g(i,o))return i[o]}throw Error("No language found.")}(t);if(!e.length){var s=t.units;return y({unitName:s[s.length-1],unitCount:0},o,t)}var a=t.conjunction,l=t.serialComma;n=g(t,"delimiter")?t.delimiter:g(o,"delimiter")?o.delimiter:", ";for(var c=[],u=0;u<e.length;u++)c.push(y(e[u],o,t));return a&&1!==e.length?2===e.length?c.join(a):c.slice(0,-1).join(n)+(l?",":"")+a+c.slice(-1):c.join(n)}(function(e,t){var r,n,i,o,s=t.units,a=t.unitMeasures,l="largest"in t?t.largest:1/0;if(!s.length)return[];var c={};for(n=0,o=e;n<s.length;n++){var u=a[r=s[n]];i=n===s.length-1?o/u:Math.floor(o/u),c[r]=i,o-=i*u}if(t.round){var h=l;for(n=0;n<s.length;n++)if(0!==(i=c[r=s[n]])&&0==--h){for(var d=n+1;d<s.length;d++){var f=s[d],p=c[f];c[r]+=p*a[f]/a[r],c[f]=0}break}for(n=s.length-1;n>=0;n--)if(0!==(i=c[r=s[n]])){var m=Math.round(i);if(c[r]=m,0===n)break;var g=s[n-1],y=a[g],v=Math.floor(m*a[r]/y);if(v)c[g]+=v,c[r]=0;else break}}var b=[];for(n=0;n<s.length&&b.length<l;n++)(i=c[r=s[n]])&&b.push({unitName:r,unitCount:i});return b}(e,s),s)};return t(n,{language:"en",spacer:" ",conjunction:"",serialComma:!0,units:["y","mo","w","d","h","m","s"],languages:{},round:!1,unitMeasures:{y:315576e5,mo:26298e5,w:6048e5,d:864e5,h:36e5,m:6e4,s:1e3,ms:1}},e)}var b=t(v({}),{getSupportedLanguages:function(){var e=[];for(var t in i)g(i,t)&&"gr"!==t&&e.push(t);return e},humanizer:v});"function"==typeof define&&define.amd?define(function(){return b}):e.exports?e.exports=b:this.humanizeDuration=b}()},12651(e,t,r){var n=r(46343),i=r(40074),o=r(82438),s=r(19106),a=r(54674),l=r(30306),c=r(48360),u=r(22563),h=e=>Array.isArray(e)?e:[e],d=e=>c(e)||Array.isArray(e)?Object.keys(e):[],f=e=>void 0===e||Array.isArray(e)&&0===e.length,p=(e,t)=>void 0===e&&0===t||void 0===t&&0===e||n(e,t),m=e=>void 0===e||n(e,{})||!0===e,g=e=>void 0===e||n(e,{}),y=e=>void 0===e||c(e)||!0===e||!1===e;function v(e,t){return!!(f(e)&&f(t))||n(i(o(e)),i(o(t)))}function b(e,t,r,s){var a=o(d(e).concat(d(t)));return!!(g(e)&&g(t))||!(g(e)&&d(t).length||g(t)&&d(e).length)&&a.every(function(r){var a=e[r],l=t[r];return Array.isArray(a)&&Array.isArray(l)?n(i(o(e)),i(o(t))):!(Array.isArray(a)&&!Array.isArray(l)||Array.isArray(l)&&!Array.isArray(a))&&t&&t.hasOwnProperty(r)&&e&&e.hasOwnProperty(r)&&s(e[r],t[r])})}function x(e,t,r,n){var i=s(e,n),o=s(t,n);return l(i,o,n).length===Math.max(i.length,o.length)}var w={title:n,uniqueItems:(e,t)=>void 0===e&&!1===t||void 0===t&&!1===e||n(e,t),minLength:p,minItems:p,minProperties:p,required:v,enum:v,type:function(e,t){return e=h(e),t=h(t),n(i(o(e)),i(o(t)))},items:function(e,t,r,i){return c(e)&&c(t)?i(e,t):Array.isArray(e)&&Array.isArray(t)?b(e,t,r,i):n(e,t)},anyOf:x,allOf:x,oneOf:x,properties:b,patternProperties:b,dependencies:b},k=["properties","patternProperties","dependencies","uniqueItems","minLength","minItems","minProperties","required"],A=["additionalProperties","additionalItems","contains","propertyNames","not"];e.exports=function e(t,r,i){if(i=a(i,{ignore:[]}),m(t)&&m(r))return!0;if(!y(t)||!y(r))throw Error("Either of the values are not a JSON schema.");if(t===r)return!0;if(u(t)&&u(r))return t===r;if(void 0===t&&!1===r||void 0===r&&!1===t||void 0===t&&void 0!==r||void 0!==t&&void 0===r)return!1;var s=o(Object.keys(t).concat(Object.keys(r)));if(i.ignore.length&&(s=s.filter(e=>-1===i.ignore.indexOf(e))),!s.length)return!0;function l(t,r){return e(t,r,i)}return s.every(function(o){var s=t[o],a=r[o];if(-1!==A.indexOf(o))return e(s,a,i);var c=w[o];if(c||(c=n),n(s,a))return!0;if(-1===k.indexOf(o)&&(!t.hasOwnProperty(o)&&r.hasOwnProperty(o)||t.hasOwnProperty(o)&&!r.hasOwnProperty(o)))return s===a;var h=c(s,a,o,l);if(!u(h))throw Error("Comparer must return true or false");return h})}},11543(e,t){"use strict";function r(e){return e[0]}Object.defineProperty(t,"__esModule",{value:!0});let n=e=>[].concat(...e.map(e=>Array.isArray(e)?n(e):e));function i(e){return e?Array.isArray(e)?n(e).join(""):e:""}t.default={Lexer:void 0,ParserRules:[{name:"Reverse_path",symbols:["Path"]},{name:"Reverse_path$string$1",symbols:[{literal:"<"},{literal:">"}],postprocess:e=>e.join("")},{name:"Reverse_path",symbols:["Reverse_path$string$1"]},{name:"Forward_path$subexpression$1$subexpression$1",symbols:[{literal:"<"},/[pP]/,/[oO]/,/[sS]/,/[tT]/,/[mM]/,/[aA]/,/[sS]/,/[tT]/,/[eE]/,/[rR]/,{literal:"@"}],postprocess:function(e){return e.join("")}},{name:"Forward_path$subexpression$1",symbols:["Forward_path$subexpression$1$subexpression$1","Domain",{literal:">"}]},{name:"Forward_path",symbols:["Forward_path$subexpression$1"]},{name:"Forward_path$subexpression$2",symbols:[{literal:"<"},/[pP]/,/[oO]/,/[sS]/,/[tT]/,/[mM]/,/[aA]/,/[sS]/,/[tT]/,/[eE]/,/[rR]/,{literal:">"}],postprocess:function(e){return e.join("")}},{name:"Forward_path",symbols:["Forward_path$subexpression$2"]},{name:"Forward_path",symbols:["Path"]},{name:"Path$ebnf$1$subexpression$1",symbols:["A_d_l",{literal:":"}]},{name:"Path$ebnf$1",symbols:["Path$ebnf$1$subexpression$1"],postprocess:r},{name:"Path$ebnf$1",symbols:[],postprocess:()=>null},{name:"Path",symbols:[{literal:"<"},"Path$ebnf$1","Mailbox",{literal:">"}]},{name:"A_d_l$ebnf$1",symbols:[]},{name:"A_d_l$ebnf$1$subexpression$1",symbols:[{literal:","},"At_domain"]},{name:"A_d_l$ebnf$1",symbols:["A_d_l$ebnf$1","A_d_l$ebnf$1$subexpression$1"],postprocess:e=>e[0].concat([e[1]])},{name:"A_d_l",symbols:["At_domain","A_d_l$ebnf$1"]},{name:"At_domain",symbols:[{literal:"@"},"Domain"]},{name:"Domain$ebnf$1",symbols:[]},{name:"Domain$ebnf$1$subexpression$1",symbols:[{literal:"."},"sub_domain"]},{name:"Domain$ebnf$1",symbols:["Domain$ebnf$1","Domain$ebnf$1$subexpression$1"],postprocess:e=>e[0].concat([e[1]])},{name:"Domain",symbols:["sub_domain","Domain$ebnf$1"]},{name:"sub_domain",symbols:["U_label"]},{name:"Let_dig",symbols:["ALPHA_DIGIT"],postprocess:r},{name:"Ldh_str$ebnf$1",symbols:[]},{name:"Ldh_str$ebnf$1",symbols:["Ldh_str$ebnf$1","ALPHA_DIG_DASH"],postprocess:e=>e[0].concat([e[1]])},{name:"Ldh_str",symbols:["Ldh_str$ebnf$1","Let_dig"]},{name:"U_Let_dig",symbols:["ALPHA_DIGIT_U"],postprocess:r},{name:"U_Ldh_str$ebnf$1",symbols:[]},{name:"U_Ldh_str$ebnf$1",symbols:["U_Ldh_str$ebnf$1","ALPHA_DIG_DASH_U"],postprocess:e=>e[0].concat([e[1]])},{name:"U_Ldh_str",symbols:["U_Ldh_str$ebnf$1","U_Let_dig"]},{name:"U_label$ebnf$1$subexpression$1",symbols:["U_Ldh_str"]},{name:"U_label$ebnf$1",symbols:["U_label$ebnf$1$subexpression$1"],postprocess:r},{name:"U_label$ebnf$1",symbols:[],postprocess:()=>null},{name:"U_label",symbols:["U_Let_dig","U_label$ebnf$1"]},{name:"address_literal$subexpression$1",symbols:["IPv4_address_literal"]},{name:"address_literal$subexpression$1",symbols:["IPv6_address_literal"]},{name:"address_literal$subexpression$1",symbols:["General_address_literal"]},{name:"address_literal",symbols:[{literal:"["},"address_literal$subexpression$1",{literal:"]"}]},{name:"non_local_part",symbols:["Domain"],postprocess:function(e){return{DomainName:i(e[0])}}},{name:"non_local_part",symbols:["address_literal"],postprocess:function(e){return{AddressLiteral:i(e[0])}}},{name:"Mailbox",symbols:["Local_part",{literal:"@"},"non_local_part"],postprocess:function(e){return{localPart:i(e[0]),domainPart:i(e[2])}}},{name:"Local_part",symbols:["Dot_string"],postprocess:function(e){return{DotString:i(e[0])}}},{name:"Local_part",symbols:["Quoted_string"],postprocess:function(e){return{QuotedString:i(e[0])}}},{name:"Dot_string$ebnf$1",symbols:[]},{name:"Dot_string$ebnf$1$subexpression$1",symbols:[{literal:"."},"Atom"]},{name:"Dot_string$ebnf$1",symbols:["Dot_string$ebnf$1","Dot_string$ebnf$1$subexpression$1"],postprocess:e=>e[0].concat([e[1]])},{name:"Dot_string",symbols:["Atom","Dot_string$ebnf$1"]},{name:"Atom$ebnf$1",symbols:[/[0-9A-Za-z!#$%&'*+\-/=?^_`{|}~\u0080-\uFFFF/]/]},{name:"Atom$ebnf$1",symbols:["Atom$ebnf$1",/[0-9A-Za-z!#$%&'*+\-/=?^_`{|}~\u0080-\uFFFF/]/],postprocess:e=>e[0].concat([e[1]])},{name:"Atom",symbols:["Atom$ebnf$1"]},{name:"Quoted_string$ebnf$1",symbols:[]},{name:"Quoted_string$ebnf$1",symbols:["Quoted_string$ebnf$1","QcontentSMTP"],postprocess:e=>e[0].concat([e[1]])},{name:"Quoted_string",symbols:["DQUOTE","Quoted_string$ebnf$1","DQUOTE"]},{name:"QcontentSMTP",symbols:["qtextSMTP"]},{name:"QcontentSMTP",symbols:["quoted_pairSMTP"]},{name:"quoted_pairSMTP",symbols:[{literal:"\\"},/[\x20-\x7e]/]},{name:"qtextSMTP",symbols:[/[\x20-\x21\x23-\x5b\x5d-\x7e\u0080-\uFFFF]/],postprocess:r},{name:"IPv4_address_literal$macrocall$2",symbols:[{literal:"."},"Snum"]},{name:"IPv4_address_literal$macrocall$1",symbols:["IPv4_address_literal$macrocall$2","IPv4_address_literal$macrocall$2","IPv4_address_literal$macrocall$2"]},{name:"IPv4_address_literal",symbols:["Snum","IPv4_address_literal$macrocall$1"]},{name:"IPv6_address_literal$subexpression$1",symbols:[/[iI]/,/[pP]/,/[vV]/,{literal:"6"},{literal:":"}],postprocess:function(e){return e.join("")}},{name:"IPv6_address_literal",symbols:["IPv6_address_literal$subexpression$1","IPv6_addr"]},{name:"General_address_literal$ebnf$1",symbols:["dcontent"]},{name:"General_address_literal$ebnf$1",symbols:["General_address_literal$ebnf$1","dcontent"],postprocess:e=>e[0].concat([e[1]])},{name:"General_address_literal",symbols:["Standardized_tag",{literal:":"},"General_address_literal$ebnf$1"]},{name:"Standardized_tag",symbols:["Ldh_str"]},{name:"dcontent",symbols:[/[\x21-\x5a\x5e-\x7e]/],postprocess:r},{name:"Snum",symbols:["DIGIT"]},{name:"Snum$subexpression$1",symbols:[/[1-9]/,"DIGIT"]},{name:"Snum",symbols:["Snum$subexpression$1"]},{name:"Snum$subexpression$2",symbols:[{literal:"1"},"DIGIT","DIGIT"]},{name:"Snum",symbols:["Snum$subexpression$2"]},{name:"Snum$subexpression$3",symbols:[{literal:"2"},/[0-4]/,"DIGIT"]},{name:"Snum",symbols:["Snum$subexpression$3"]},{name:"Snum$subexpression$4",symbols:[{literal:"2"},{literal:"5"},/[0-5]/]},{name:"Snum",symbols:["Snum$subexpression$4"]},{name:"IPv6_addr",symbols:["IPv6_full"]},{name:"IPv6_addr",symbols:["IPv6_comp"]},{name:"IPv6_addr",symbols:["IPv6v4_full"]},{name:"IPv6_addr",symbols:["IPv6v4_comp"]},{name:"IPv6_hex",symbols:["HEXDIG"]},{name:"IPv6_hex$subexpression$1",symbols:["HEXDIG","HEXDIG"]},{name:"IPv6_hex",symbols:["IPv6_hex$subexpression$1"]},{name:"IPv6_hex$subexpression$2",symbols:["HEXDIG","HEXDIG","HEXDIG"]},{name:"IPv6_hex",symbols:["IPv6_hex$subexpression$2"]},{name:"IPv6_hex$subexpression$3",symbols:["HEXDIG","HEXDIG","HEXDIG","HEXDIG"]},{name:"IPv6_hex",symbols:["IPv6_hex$subexpression$3"]},{name:"IPv6_full$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6_full$macrocall$1",symbols:["IPv6_full$macrocall$2","IPv6_full$macrocall$2","IPv6_full$macrocall$2","IPv6_full$macrocall$2","IPv6_full$macrocall$2","IPv6_full$macrocall$2","IPv6_full$macrocall$2"]},{name:"IPv6_full",symbols:["IPv6_hex","IPv6_full$macrocall$1"]},{name:"IPv6_comp$ebnf$1$subexpression$1$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6_comp$ebnf$1$subexpression$1$macrocall$1",symbols:["IPv6_comp$ebnf$1$subexpression$1$macrocall$2","IPv6_comp$ebnf$1$subexpression$1$macrocall$2","IPv6_comp$ebnf$1$subexpression$1$macrocall$2","IPv6_comp$ebnf$1$subexpression$1$macrocall$2","IPv6_comp$ebnf$1$subexpression$1$macrocall$2"]},{name:"IPv6_comp$ebnf$1$subexpression$1",symbols:["IPv6_hex","IPv6_comp$ebnf$1$subexpression$1$macrocall$1"]},{name:"IPv6_comp$ebnf$1",symbols:["IPv6_comp$ebnf$1$subexpression$1"],postprocess:r},{name:"IPv6_comp$ebnf$1",symbols:[],postprocess:()=>null},{name:"IPv6_comp$string$1",symbols:[{literal:":"},{literal:":"}],postprocess:e=>e.join("")},{name:"IPv6_comp$ebnf$2$subexpression$1$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6_comp$ebnf$2$subexpression$1$macrocall$1",symbols:["IPv6_comp$ebnf$2$subexpression$1$macrocall$2","IPv6_comp$ebnf$2$subexpression$1$macrocall$2","IPv6_comp$ebnf$2$subexpression$1$macrocall$2","IPv6_comp$ebnf$2$subexpression$1$macrocall$2","IPv6_comp$ebnf$2$subexpression$1$macrocall$2"]},{name:"IPv6_comp$ebnf$2$subexpression$1",symbols:["IPv6_hex","IPv6_comp$ebnf$2$subexpression$1$macrocall$1"]},{name:"IPv6_comp$ebnf$2",symbols:["IPv6_comp$ebnf$2$subexpression$1"],postprocess:r},{name:"IPv6_comp$ebnf$2",symbols:[],postprocess:()=>null},{name:"IPv6_comp",symbols:["IPv6_comp$ebnf$1","IPv6_comp$string$1","IPv6_comp$ebnf$2"]},{name:"IPv6v4_full$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6v4_full$macrocall$1",symbols:["IPv6v4_full$macrocall$2","IPv6v4_full$macrocall$2","IPv6v4_full$macrocall$2","IPv6v4_full$macrocall$2","IPv6v4_full$macrocall$2"]},{name:"IPv6v4_full",symbols:["IPv6_hex","IPv6v4_full$macrocall$1",{literal:":"},"IPv4_address_literal"]},{name:"IPv6v4_comp$ebnf$1$subexpression$1$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6v4_comp$ebnf$1$subexpression$1$macrocall$1",symbols:["IPv6v4_comp$ebnf$1$subexpression$1$macrocall$2","IPv6v4_comp$ebnf$1$subexpression$1$macrocall$2","IPv6v4_comp$ebnf$1$subexpression$1$macrocall$2"]},{name:"IPv6v4_comp$ebnf$1$subexpression$1",symbols:["IPv6_hex","IPv6v4_comp$ebnf$1$subexpression$1$macrocall$1"]},{name:"IPv6v4_comp$ebnf$1",symbols:["IPv6v4_comp$ebnf$1$subexpression$1"],postprocess:r},{name:"IPv6v4_comp$ebnf$1",symbols:[],postprocess:()=>null},{name:"IPv6v4_comp$string$1",symbols:[{literal:":"},{literal:":"}],postprocess:e=>e.join("")},{name:"IPv6v4_comp$ebnf$2$subexpression$1$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6v4_comp$ebnf$2$subexpression$1$macrocall$1",symbols:["IPv6v4_comp$ebnf$2$subexpression$1$macrocall$2","IPv6v4_comp$ebnf$2$subexpression$1$macrocall$2","IPv6v4_comp$ebnf$2$subexpression$1$macrocall$2"]},{name:"IPv6v4_comp$ebnf$2$subexpression$1",symbols:["IPv6_hex","IPv6v4_comp$ebnf$2$subexpression$1$macrocall$1",{literal:":"}]},{name:"IPv6v4_comp$ebnf$2",symbols:["IPv6v4_comp$ebnf$2$subexpression$1"],postprocess:r},{name:"IPv6v4_comp$ebnf$2",symbols:[],postprocess:()=>null},{name:"IPv6v4_comp",symbols:["IPv6v4_comp$ebnf$1","IPv6v4_comp$string$1","IPv6v4_comp$ebnf$2","IPv4_address_literal"]},{name:"DIGIT",symbols:[/[0-9]/],postprocess:r},{name:"ALPHA_DIGIT_U",symbols:[/[0-9A-Za-z\u0080-\uFFFF]/],postprocess:r},{name:"ALPHA_DIGIT",symbols:[/[0-9A-Za-z]/],postprocess:r},{name:"ALPHA_DIG_DASH",symbols:[/[-0-9A-Za-z]/],postprocess:r},{name:"ALPHA_DIG_DASH_U",symbols:[/[-0-9A-Za-z\u0080-\uFFFF]/],postprocess:r},{name:"HEXDIG",symbols:[/[0-9A-Fa-f]/],postprocess:r},{name:"DQUOTE",symbols:[{literal:'"'}],postprocess:r}],ParserStart:"Reverse_path"}},96542(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.canonicalize=t.canonicalize_quoted_string=t.normalize=t.normalize_dot_string=t.parse=void 0;let i=r(63662),o=n(r(11543));o.default.ParserStart="Mailbox";let s=i.Grammar.fromCompiled(o.default);function a(e){let t=new i.Parser(s);if(t.feed(e),1!==t.results.length)throw Error("address parsing failed: ambiguous grammar");return t.results[0]}function l(e){let t;return(-1===(t=e.indexOf("+"))?e:e.substr(0,t)).replace(/\./g,"").toLowerCase()}function c(e){let t=e.substr(1).substr(0,e.length-2).replace(/(?:\\(.))/g,"$1").replace(/(?:(["\\]))/g,"\\$1");return`"${t}"`}t.parse=a,t.normalize_dot_string=l,t.normalize=function(e){var t,r;let n=a(e),i=null!=(t=n.domainPart.AddressLiteral)?t:n.domainPart.DomainName.toLowerCase(),o=null!=(r=n.localPart.QuotedString)?r:l(n.localPart.DotString);return`${o}@${i}`},t.canonicalize_quoted_string=c,t.canonicalize=function(e){var t;let r=a(e),n=null!=(t=r.domainPart.AddressLiteral)?t:r.domainPart.DomainName.toLowerCase(),i=r.localPart.QuotedString?c(r.localPart.QuotedString):r.localPart.DotString;return`${i}@${n}`}},28690(e,t,r){let n=r(75857),i=r(53435),o=r(48360),s=r(82438),a=r(19106),l=r(30795),c=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u=e=>o(e)||Array.isArray(e)?Object.keys(e):[],h=e=>!u(e).length&&!1!==e&&!0!==e;e.exports={allUniqueKeys:e=>s(i(e.map(u))),deleteUndefinedProps:function(e){for(let t in e)c(e,t)&&h(e[t])&&delete e[t];return e},getValues:(e,t)=>e.map(e=>e&&e[t]),has:c,isEmptySchema:h,isSchema:e=>o(e)||!0===e||!1===e,keys:u,notUndefined:e=>void 0!==e,uniqWith:a,withoutArr:(e,...t)=>l.apply(null,[e].concat(n(t)))}},52474(e,t,r){let n=r(12651),i=r(83657),{allUniqueKeys:o,deleteUndefinedProps:s,has:a,isSchema:l,notUndefined:c,uniqWith:u}=r(28690);e.exports={keywords:["items","additionalItems"],resolver(e,t,r){var h,d;let f,p=e.map(e=>e.items),m=p.filter(c),g={};return m.every(l)?g.items=r.items(p):(h=r.items,g.items=o(p).reduce(function(t,r){let i=u(e.map(function(e){if(e)if(!Array.isArray(e.items))return e.items;else{let t=e.items[r];if(l(t))return t;if(a(e,"additionalItems"))return e.additionalItems}}).filter(c),n);return t[r]=h(i,r),t},[])),m.every(Array.isArray)?f=e.map(e=>e.additionalItems):m.some(Array.isArray)&&(f=e.map(function(e){if(e)return Array.isArray(e.items)?e.additionalItems:e.items})),f&&(g.additionalItems=r.additionalItems(f)),!1===g.additionalItems&&Array.isArray(g.items)&&i(d=g.items,function(e,t){!1===e&&d.splice(t,1)}),s(g)}}},51537(e,t,r){let n=r(12651),i=r(83657),{allUniqueKeys:o,deleteUndefinedProps:s,getValues:a,keys:l,notUndefined:c,uniqWith:u,withoutArr:h}=r(28690);function d(e,t){return o(e).reduce(function(r,i){let o=u(a(e,i).filter(c),n);return r[i]=t(o,i),r},{})}e.exports={keywords:["properties","patternProperties","additionalProperties"],resolver(e,t,r,n){var o;n.ignoreAdditionalProperties||(e.forEach(function(t){let n=e.filter(e=>e!==t),i=l(t.properties),o=l(t.patternProperties).map(e=>new RegExp(e));n.forEach(function(e){let n=l(e.properties),s=n.filter(e=>o.some(t=>t.test(e)));h(n,i,s).forEach(function(n){e.properties[n]=r.properties([e.properties[n],t.additionalProperties],n)})})}),e.forEach(function(t){let r=e.filter(e=>e!==t),n=l(t.patternProperties);!1===t.additionalProperties&&r.forEach(function(e){h(l(e.patternProperties),n).forEach(t=>delete e.patternProperties[t])})}));let a={additionalProperties:r.additionalProperties(e.map(e=>e.additionalProperties)),patternProperties:d(e.map(e=>e.patternProperties),r.patternProperties),properties:d(e.map(e=>e.properties),r.properties)};return!1===a.additionalProperties&&i(o=a.properties,function(e,t){!1===e&&delete o[t]}),s(a)}}},587(e,t,r){let n=r(46108),i=r(12651),o=r(23050),s=r(69383),a=r(75857),l=r(53435),c=r(58150),u=r(30306),h=r(46343),d=r(48360),f=r(92962),p=r(40074),m=r(82438),g=r(19106),y=r(51537),v=r(52474),b=(e,t)=>-1!==e.indexOf(t),x=e=>d(e)||!0===e||!1===e,w=e=>!1===e,k=e=>!0===e,A=(e,t,r)=>r(e),S=e=>p(m(l(e))),j=e=>void 0!==e,C=e=>m(l(e.map(T))),E=e=>e[0],O=e=>Math.max.apply(Math,e),M=e=>Math.min.apply(Math,e);function P(e,t){return e.map(e=>e&&e[t])}function T(e){return d(e)||Array.isArray(e)?Object.keys(e):[]}function I(e,t){let r;try{r=e.map(function(e){return JSON.stringify(e,null,2)}).join("\n")}catch(t){r=e.join(", ")}throw Error('Could not resolve values for path:"'+t.join(".")+'". They are probably incompatible. Values: \n'+r)}function $(e){return{required:e}}let D=["properties","patternProperties","definitions","dependencies"],R=["anyOf","oneOf"],N=["additionalProperties","additionalItems","contains","propertyNames","not","items"],_={type(e){if(e.some(Array.isArray)){let t=e.map(function(e){return Array.isArray(e)?e:[e]}),r=c.apply(null,t);if(1===r.length)return r[0];if(r.length>1)return m(r)}},dependencies:(e,t,r)=>C(e).reduce(function(t,n){let o=g(P(e,n).filter(j),h),s=o.filter(Array.isArray);if(s.length){if(s.length===o.length)t[n]=S(o);else{let e=o.filter(x),i=s.map($);t[n]=r(e.concat(i),n)}return t}return o=g(o,i),t[n]=r(o,n),t},{}),oneOf(e,t,r){var o;let s=g((o=function e(t,r){if(r=r||[],!t.length)return r;let n=t.slice(0).shift(),i=t.slice(1);return r.length?e(i,a(r.map(e=>n.map(t=>[t].concat(e))))):e(i,n.map(e=>e))}(n(e)),o.map(function(e,t){try{return r(e,t)}catch(e){return}}).filter(j)),i);if(s.length)return s},not:e=>({anyOf:e}),pattern:e=>e.map(e=>"(?="+e+")").join(""),multipleOf(e){let t=e.slice(0),r=1;for(;t.some(e=>!Number.isInteger(e));)t=t.map(e=>10*e),r*=10;return o(t)/r},enum(e){let t=u.apply(null,e.concat(h));if(t.length)return p(t)}};_.$id=E,_.$ref=E,_.$schema=E,_.additionalItems=A,_.additionalProperties=A,_.anyOf=_.oneOf,_.contains=A,_.default=E,_.definitions=_.dependencies,_.description=E,_.examples=e=>g(a(e),h),_.exclusiveMaximum=M,_.exclusiveMinimum=O,_.items=v,_.maximum=M,_.maxItems=M,_.maxLength=M,_.maxProperties=M,_.minimum=O,_.minItems=O,_.minLength=O,_.minProperties=O,_.properties=y,_.propertyNames=A,_.required=e=>S(e),_.title=E,_.uniqueItems=e=>e.some(k);let L={properties:y,items:v};function F(e,t,r){r=r||[];let o=Object.entries((t=s(t,{ignoreAdditionalProperties:!1,resolvers:_,complexResolvers:L,deep:!0})).complexResolvers);return function e(s,a,l){s=n(s.filter(j)),l=l||[];let c=d(a)?a:{};if(!s.length)return;if(s.some(w))return!1;if(s.every(k))return!0;let u=C(s=s.filter(d));if(t.deep&&b(u,"allOf"))return F({allOf:s},t,r);let h=o.map(([e,t])=>u.filter(e=>t.keywords.includes(e)));return h.forEach(e=>f(u,e)),u.forEach(function(r){let n=g(P(s,r).filter(j),function(e,t){return i({[r]:e},{[r]:t})});if(1===n.length&&b(R,r))c[r]=n[0].map(t=>e([t],t));else if(1!==n.length||b(D,r)||b(N,r)){let i=t.resolvers[r]||t.resolvers.defaultResolver;if(!i)throw Error("No resolver found for key "+r+". You can provide a resolver for this keyword in the options, or provide a default resolver.");c[r]=i(n,l.concat(r),(t,n=[])=>e(t,null,l.concat(r,n)),t),void 0===c[r]?I(n,l.concat(r)):void 0===c[r]&&delete c[r]}else c[r]=n[0]}),o.reduce((r,[n,o],a)=>({...r,...function(e,t,r,n,o,s){if(e.length){let a=o.complexResolvers[t];if(!a||!a.resolver)throw Error("No resolver found for "+t);let l=g(r.map(t=>e.reduce((e,r)=>(void 0!==t[r]&&(e[r]=t[r]),e),{})),i),c=a.keywords.reduce((e,t)=>({...e,[t]:(e,r=[])=>n(e,null,s.concat(t,r))}),{}),u=a.resolver(l,s.concat(t),c,o);return d(u)||I(l,s.concat(t)),u}}(h[a],n,s,e,t,l)}),c)}(l(function e(t){let{allOf:r=[],...n}=t;return[n=d(t)?n:t,...r.map(e)]}(e)))}F.options={resolvers:_},e.exports=F},96576(e,t,r){var n=r(23212),i=r(59756),o=r(43316),s=r(65111),a=r(49460),l=r(65568);e.exports=function(e,t,r,c){var u=-1,h=i,d=!0,f=e.length,p=[],m=t.length;if(!f)return p;r&&(t=s(t,a(r))),c?(h=o,d=!1):t.length>=200&&(h=l,d=!1,t=new n(t));e:for(;++u<f;){var g=e[u],y=null==r?g:r(g);if(g=c||0!==g?g:0,d&&y==y){for(var v=m;v--;)if(t[v]===y)continue e;p.push(g)}else h(t,y,c)||p.push(g)}return p}},38250(e){e.exports=function(e,t,r,n){for(var i=r-1,o=e.length;++i<o;)if(n(e[i],t))return i;return -1}},93854(e,t,r){var n=r(23212),i=r(59756),o=r(43316),s=r(65111),a=r(49460),l=r(65568),c=Math.min;e.exports=function(e,t,r){for(var u=r?o:i,h=e[0].length,d=e.length,f=d,p=Array(d),m=1/0,g=[];f--;){var y=e[f];f&&t&&(y=s(y,a(t))),m=c(y.length,m),p[f]=!r&&(t||h>=120&&y.length>=120)?new n(f&&y):void 0}y=e[0];var v=-1,b=p[0];e:for(;++v<h&&g.length<m;){var x=y[v],w=t?t(x):x;if(x=r||0!==x?x:0,!(b?l(b,w):u(g,w,r))){for(f=d;--f;){var k=p[f];if(!(k?l(k,w):u(e[f],w,r)))continue e}b&&b.push(w),g.push(x)}}return g}},49261(e,t,r){var n=r(65111),i=r(2478),o=r(38250),s=r(49460),a=r(84354),l=Array.prototype.splice;e.exports=function(e,t,r,c){var u=c?o:i,h=-1,d=t.length,f=e;for(e===t&&(t=a(t)),r&&(f=n(e,s(r)));++h<d;)for(var p=0,m=t[h],g=r?r(m):m;(p=u(f,g,p,c))>-1;)f!==e&&l.call(f,p,1),l.call(e,p,1);return e}},47648(e,t,r){var n=r(65406);e.exports=function(e){return n(e)?e:[]}},23997(e,t,r){var n=r(22053);e.exports=function(e){return"function"==typeof e?e:n}},52107(e,t,r){var n=r(40091),i=r(41580);e.exports=function e(t,r,o,s,a,l){return i(t)&&i(r)&&(l.set(r,t),n(t,r,void 0,e,l),l.delete(r)),t}},46108(e,t,r){var n=r(69334);e.exports=function(e){return n(e,5)}},54674(e,t,r){var n=r(23945),i=r(46285),o=r(74535),s=r(25288),a=Object.prototype,l=a.hasOwnProperty;e.exports=n(function(e,t){e=Object(e);var r=-1,n=t.length,c=n>2?t[2]:void 0;for(c&&o(t[0],t[1],c)&&(n=1);++r<n;)for(var u=t[r],h=s(u),d=-1,f=h.length;++d<f;){var p=h[d],m=e[p];(void 0===m||i(m,a[p])&&!l.call(e,p))&&(e[p]=u[p])}return e})},69383(e,t,r){var n=r(86912),i=r(23945),o=r(52107),s=r(48875);e.exports=i(function(e){return e.push(void 0,o),n(s,void 0,e)})},53435(e,t,r){var n=r(90313),i=1/0;e.exports=function(e){return(null==e?0:e.length)?n(e,i):[]}},83657(e,t,r){var n=r(79968),i=r(84570),o=r(23997),s=r(53142);e.exports=function(e,t){return(s(e)?n:i)(e,o(t))}},58150(e,t,r){var n=r(65111),i=r(93854),o=r(23945),s=r(47648);e.exports=o(function(e){var t=n(e,s);return t.length&&t[0]===e[0]?i(t):[]})},30306(e,t,r){var n=r(65111),i=r(93854),o=r(23945),s=r(47648),a=r(98087);e.exports=o(function(e){var t=a(e),r=n(e,s);return(t="function"==typeof t?t:void 0)&&r.pop(),r.length&&r[0]===e[0]?i(r,void 0,t):[]})},48875(e,t,r){var n=r(40091);e.exports=r(77848)(function(e,t,r,i){n(e,t,r,i)})},92962(e,t,r){var n=r(49261);e.exports=function(e,t){return e&&e.length&&t&&t.length?n(e,t):e}},19106(e,t,r){var n=r(15630);e.exports=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?n(e,void 0,t):[]}},30795(e,t,r){var n=r(96576),i=r(23945),o=r(65406);e.exports=i(function(e,t){return o(e)?n(e,t):[]})},63662(e){var t;t=function(){function e(t,r,n){return this.id=++e.highestId,this.name=t,this.symbols=r,this.postprocess=n,this}function t(e,t,r,n){this.rule=e,this.dot=t,this.reference=r,this.data=[],this.wantedBy=n,this.isComplete=this.dot===e.symbols.length}function r(e,t){this.grammar=e,this.index=t,this.states=[],this.wants={},this.scannable=[],this.completed={}}function n(e,t){this.rules=e,this.start=t||this.rules[0].name;var r=this.byName={};this.rules.forEach(function(e){r.hasOwnProperty(e.name)||(r[e.name]=[]),r[e.name].push(e)})}function i(){this.reset("")}function o(e,t,o){if(e instanceof n)var s=e,o=t;else var s=n.fromCompiled(e,t);for(var a in this.grammar=s,this.options={keepHistory:!1,lexer:s.lexer||new i},o||{})this.options[a]=o[a];this.lexer=this.options.lexer,this.lexerState=void 0;var l=new r(s,0);this.table=[l],l.wants[s.start]=[],l.predict(s.start),l.process(),this.current=0}function s(e){var t=typeof e;if("string"===t)return e;if("object"===t)if(e.literal)return JSON.stringify(e.literal);else if(e instanceof RegExp)return e.toString();else if(e.type)return"%"+e.type;else if(e.test)return"<"+String(e.test)+">";else throw Error("Unknown symbol type: "+e)}return e.highestId=0,e.prototype.toString=function(e){var t=void 0===e?this.symbols.map(s).join(" "):this.symbols.slice(0,e).map(s).join(" ")+"  "+this.symbols.slice(e).map(s).join(" ");return this.name+"  "+t},t.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},t.prototype.nextState=function(e){var r=new t(this.rule,this.dot+1,this.reference,this.wantedBy);return r.left=this,r.right=e,r.isComplete&&(r.data=r.build(),r.right=void 0),r},t.prototype.build=function(){var e=[],t=this;do e.push(t.right.data),t=t.left;while(t.left);return e.reverse(),e},t.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,o.fail))},r.prototype.process=function(e){for(var t=this.states,r=this.wants,n=this.completed,i=0;i<t.length;i++){var s=t[i];if(s.isComplete){if(s.finish(),s.data!==o.fail){for(var a=s.wantedBy,l=a.length;l--;){var c=a[l];this.complete(c,s)}if(s.reference===this.index){var u=s.rule.name;(this.completed[u]=this.completed[u]||[]).push(s)}}}else{var u=s.rule.symbols[s.dot];if("string"!=typeof u){this.scannable.push(s);continue}if(r[u]){if(r[u].push(s),n.hasOwnProperty(u))for(var h=n[u],l=0;l<h.length;l++){var d=h[l];this.complete(s,d)}}else r[u]=[s],this.predict(u)}}},r.prototype.predict=function(e){for(var r=this.grammar.byName[e]||[],n=0;n<r.length;n++){var i=r[n],o=this.wants[e],s=new t(i,0,this.index,o);this.states.push(s)}},r.prototype.complete=function(e,t){var r=e.nextState(t);this.states.push(r)},n.fromCompiled=function(t,r){var i=t.Lexer;t.ParserStart&&(r=t.ParserStart,t=t.ParserRules);var t=t.map(function(t){return new e(t.name,t.symbols,t.postprocess)}),o=new n(t,r);return o.lexer=i,o},i.prototype.reset=function(e,t){this.buffer=e,this.index=0,this.line=t?t.line:1,this.lastLineBreak=t?-t.col:0},i.prototype.next=function(){if(this.index<this.buffer.length){var e=this.buffer[this.index++];return"\n"===e&&(this.line+=1,this.lastLineBreak=this.index),{value:e}}},i.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},i.prototype.formatError=function(e,t){var r=this.buffer;if("string"!=typeof r)return t+" at index "+(this.index-1);var n=r.split("\n").slice(Math.max(0,this.line-5),this.line),i=r.indexOf("\n",this.index);-1===i&&(i=r.length);var o=this.index-this.lastLineBreak,s=String(this.line).length;return t+=" at line "+this.line+" col "+o+":\n\n",t+=n.map(function(e,t){return a(this.line-n.length+t+1,s)+" "+e},this).join("\n"),t+="\n"+a("",s+o)+"^\n";function a(e,t){var r=String(e);return Array(t-r.length+1).join(" ")+r}},o.fail={},o.prototype.feed=function(e){var t,n=this.lexer;for(n.reset(e,this.lexerState);;){try{if(!(t=n.next()))break}catch(e){var o=new r(this.grammar,this.current+1);this.table.push(o);var s=Error(this.reportLexerError(e));throw s.offset=this.current,s.token=e.token,s}var a=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var l=this.current+1,o=new r(this.grammar,l);this.table.push(o);for(var c=void 0!==t.text?t.text:t.value,u=n.constructor===i?t.value:t,h=a.scannable,d=h.length;d--;){var f=h[d],p=f.rule.symbols[f.dot];if(p.test?p.test(u):p.type?p.type===t.type:p.literal===c){var m=f.nextState({data:u,token:t,isToken:!0,reference:l-1});o.states.push(m)}}if(o.process(),0===o.states.length){var s=Error(this.reportError(t));throw s.offset=this.current,s.token=t,s}this.options.keepHistory&&(a.lexerState=n.save()),this.current++}return a&&(this.lexerState=n.save()),this.results=this.finish(),this},o.prototype.reportLexerError=function(e){var t,r,n=e.token;return n?(t="input "+JSON.stringify(n.text[0])+" (lexer error)",r=this.lexer.formatError(n,"Syntax error")):(t="input (lexer error)",r=e.message),this.reportErrorCommon(r,t)},o.prototype.reportError=function(e){var t=(e.type?e.type+" token: ":"")+JSON.stringify(void 0!==e.value?e.value:e),r=this.lexer.formatError(e,"Syntax error");return this.reportErrorCommon(r,t)},o.prototype.reportErrorCommon=function(e,t){var r=[];r.push(e);var n=this.table.length-2,i=this.table[n],o=i.states.filter(function(e){var t=e.rule.symbols[e.dot];return t&&"string"!=typeof t});return 0===o.length?(r.push("Unexpected "+t+". I did not expect any more input. Here is the state of my parse table:\n"),this.displayStateStack(i.states,r)):(r.push("Unexpected "+t+". Instead, I was expecting to see one of the following:\n"),o.map(function(e){return this.buildFirstStateStack(e,[])||[e]},this).forEach(function(e){var t=e[0],n=t.rule.symbols[t.dot],i=this.getSymbolDisplay(n);r.push("A "+i+" based on:"),this.displayStateStack(e,r)},this)),r.push(""),r.join("\n")},o.prototype.displayStateStack=function(e,t){for(var r,n=0,i=0;i<e.length;i++){var o=e[i],s=o.rule.toString(o.dot);s===r?n++:(n>0&&t.push("    ^ "+n+" more lines identical to this"),n=0,t.push("    "+s)),r=s}},o.prototype.getSymbolDisplay=function(e){var t=e,r=typeof t;if("string"===r)return t;if("object"===r)if(t.literal)return JSON.stringify(t.literal);else if(t instanceof RegExp)return"character matching "+t;else if(t.type)return t.type+" token";else if(t.test)return"token matching "+String(t.test);else throw Error("Unknown symbol type: "+t)},o.prototype.buildFirstStateStack=function(e,t){if(-1!==t.indexOf(e))return null;if(0===e.wantedBy.length)return[e];var r=e.wantedBy[0],n=[e].concat(t),i=this.buildFirstStateStack(r,n);return null===i?null:[e].concat(i)},o.prototype.save=function(){var e=this.table[this.current];return e.lexerState=this.lexerState,e},o.prototype.restore=function(e){var t=e.index;this.current=t,this.table[t]=e,this.table.splice(t+1),this.lexerState=e.lexerState,this.results=this.finish()},o.prototype.rewind=function(e){if(!this.options.keepHistory)throw Error("set option `keepHistory` to enable rewinding");this.restore(this.table[e])},o.prototype.finish=function(){var e=[],t=this.grammar.start;return this.table[this.table.length-1].states.forEach(function(r){r.rule.name===t&&r.dot===r.rule.symbols.length&&0===r.reference&&r.data!==o.fail&&e.push(r)}),e.map(function(e){return e.data})},{Parser:o,Grammar:n,Rule:e}},e.exports?e.exports=t():this.nearley=t()},16983(e,t,r){"use strict";var n=r(85608),i=r(14041),o=n.__importDefault(r(49069));t.default=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=[]);var n=o.default(e,t),s=n[0],a=n[1],l=n[2];return i.useEffect(l,r),[s,a]}},49069(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14041);t.default=function(e,t){void 0===t&&(t=0);var r=n.useRef(!1),i=n.useRef(),o=n.useRef(e),s=n.useCallback(function(){return r.current},[]),a=n.useCallback(function(){r.current=!1,i.current&&clearTimeout(i.current),i.current=setTimeout(function(){r.current=!0,o.current()},t)},[t]),l=n.useCallback(function(){r.current=null,i.current&&clearTimeout(i.current)},[]);return n.useEffect(function(){o.current=e},[e]),n.useEffect(function(){return a(),l},[t]),[s,l,a]}},47112(e,t,r){!function(e){"use strict";e.exports.is_uri=r,e.exports.is_http_uri=n,e.exports.is_https_uri=i,e.exports.is_web_uri=o,e.exports.isUri=r,e.exports.isHttpUri=n,e.exports.isHttpsUri=i,e.exports.isWebUri=o;var t=function(e){return e.match(/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/)};function r(e){if(!(!e||/[^a-z0-9\:\/\?\#\[\]\@\!\$\&\'\(\)\*\+\,\;\=\.\-\_\~\%]/i.test(e)||/%[^0-9a-f]/i.test(e)||/%[0-9a-f](:?[^0-9a-f]|$)/i.test(e))){var r=[],n="",i="",o="",s="",a="",l="";if(n=(r=t(e))[1],i=r[2],o=r[3],s=r[4],a=r[5],n&&n.length&&o.length>=0){if(i&&i.length){if(!(0===o.length||/^\//.test(o)))return}else if(/^\/\//.test(o))return;if(/^[a-z][a-z0-9\+\-\.]*$/.test(n.toLowerCase()))return l+=n+":",i&&i.length&&(l+="//"+i),l+=o,s&&s.length&&(l+="?"+s),a&&a.length&&(l+="#"+a),l}}}function n(e,n){if(r(e)){var i=[],o="",s="",a="",l="",c="",u="",h="";if(o=(i=t(e))[1],s=i[2],a=i[3],c=i[4],u=i[5],o){if(n){if("https"!=o.toLowerCase())return}else if("http"!=o.toLowerCase())return;if(s)return/:(\d+)$/.test(s)&&(l=s.match(/:(\d+)$/)[0],s=s.replace(/:\d+$/,"")),h+=o+":",h+="//"+s,l&&(h+=l),h+=a,c&&c.length&&(h+="?"+c),u&&u.length&&(h+="#"+u),h}}}function i(e){return n(e,!0)}function o(e){return n(e)||i(e)}}(e=r.nmd(e))},10646(e){"use strict";e.exports=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},43225(e){"use strict";e.exports=function(e){return"function"==typeof e}},50709(e,t,r){"use strict";var n=r(10646),i=r(70925);e.exports=function(e){var t;if(!n(e)||!(t=e.length))return!1;for(var r=0;r<t;r++)if(!i(e[r]))return!1;return!0}},70925(e,t,r){"use strict";var n=r(72100);e.exports=function(e){return n(e)&&e%1==0}},72100(e){"use strict";e.exports=function(e){return("number"==typeof e||"[object Number]"===Object.prototype.toString.call(e))&&e.valueOf()===e.valueOf()}},91042(e,t,r){"use strict";r.d(t,{Y:()=>o});var n=r(14041),i=r(16261);function o(e,t){let[r,o]=(0,n.useState)({status:"not-executed",error:void 0,result:t}),s=(0,n.useRef)(),a=(0,n.useRef)(),l=(0,i.J)({execute(...t){a.current=t;let r=e(...t);return s.current=r,o(e=>({...e,status:"loading"})),r.then(e=>{r===s.current&&o(t=>({...t,status:"success",error:void 0,result:e}))},e=>{r===s.current&&o(t=>({...t,status:"error",error:e}))}),r},reset(){o({status:"not-executed",error:void 0,result:t}),s.current=void 0,a.current=void 0}});return[r,(0,n.useMemo)(()=>({reset(){l.current.reset()},execute:(...e)=>l.current.execute(...e)}),[]),{promise:s.current,lastArgs:a.current}]}}}]);
//# sourceMappingURL=3366.f06d821d.chunk.js.map